<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>GraphQL 学习笔记 | 鴻鵠誌達</title><meta name="author" content="鴻達"><meta name="copyright" content="鴻達"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#1a1a1a"><meta name="description" content="GraphQL 学习笔记"><meta property="og:type" content="article"><meta property="og:title" content="GraphQL 学习笔记"><meta property="og:url" content="https://hongdalin.blog/posts/69cd31bf.html"><meta property="og:site_name" content="鴻鵠誌達"><meta property="og:description" content="GraphQL 学习笔记"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://raw.githubusercontent.com/Hongda-Lin/ImageStore/master/img700px-Dot_raid_manacar_1.png"><meta property="article:published_time" content="2024-08-02T15:15:05.000Z"><meta property="article:modified_time" content="2025-11-22T01:23:15.515Z"><meta property="article:author" content="鴻達"><meta property="article:tag" content="GraphQL"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://raw.githubusercontent.com/Hongda-Lin/ImageStore/master/img700px-Dot_raid_manacar_1.png"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/德克萨斯.GIF"><link rel="canonical" href="https://hongdalin.blog/posts/69cd31bf.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!0,languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!0,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!1}}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"GraphQL 学习笔记",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2025-11-21 19:23:15"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,n){if(0===n)return;const o=864e5*n,a={value:t,expiry:(new Date).getTime()+o};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const n=JSON.parse(t);if(!((new Date).getTime()>n.expiry))return n.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise(((t,n)=>{const o=document.createElement("script");o.src=e,o.async=!0,o.onerror=n,o.onload=o.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(o.onload=o.onreadystatechange=null,t())},document.head.appendChild(o)})),e.getCSS=e=>new Promise(((t,n)=>{const o=document.createElement("link");o.rel="stylesheet",o.href=e,o.onload=()=>t(),o.onerror=()=>n(),document.head.appendChild(o)}));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/color.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="/css/font.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="/css/icon.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="/css/layout.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="defer" onload='this.media="all"'><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/德狗子.GIF" onerror='onerror=null,src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/404.GIF"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">31</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">16</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i> <span>链接</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友情链接</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('https://raw.githubusercontent.com/Hongda-Lin/ImageStore/master/img700px-Dot_raid_manacar_1.png')"><nav id="nav"><span id="blog-info"><a href="/" title="鴻鵠誌達"><span class="site-name">鴻鵠誌達</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i> <span>链接</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友情链接</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>关于</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">GraphQL 学习笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-08-02T15:15:05.000Z" title="发表于 2024-08-02 10:15:05">2024-08-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-11-22T01:23:15.515Z" title="更新于 2025-11-21 19:23:15">2025-11-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>27分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="GraphQL 学习笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><blockquote><p>参考文章: <a target="_blank" rel="noopener" href="https://chenyitian.gitbooks.io/graphql/content/introduction.html">https://chenyitian.gitbooks.io/graphql/content/introduction.html</a><br>参考网站: <a target="_blank" rel="noopener" href="https://www.howtographql.com/basics/0-introduction/">https://www.howtographql.com/basics/0-introduction/</a></p></blockquote><hr><h3 id="GraphQL基础"><a href="#GraphQL基础" class="headerlink" title="GraphQL基础"></a><code>GraphQL</code>基础</h3><h4 id="1-什么是GraphQL"><a href="#1-什么是GraphQL" class="headerlink" title="1. 什么是GraphQL"></a>1. 什么是<code>GraphQL</code></h4><p><code>GraphQL</code>是一种用于<code>API</code>的查询语言，同时也是一种运行在服务端的执行引擎。它使用基于类型系统的模式定义和验证查询结构（类型系统由你的数据定义）。<code>GraphQL</code>不依赖任何特定数据库或存储引擎，而是通过现有代码和数据来支持查询</p><h5 id="为什么使用GraphQL"><a href="#为什么使用GraphQL" class="headerlink" title="为什么使用GraphQL"></a><p style="font-size:14px">为什么使用<code>GraphQL</code></p></h5><ul><li>灵活的数据获取: 客户端可以请求确切的数据结构，避免数据过多或不足的问题</li><li>单一端点: 所有查询通过一个端点完成，简化了客户端与服务端的交互</li><li>强类型系统: 定义<code>API</code>时使用强类型，可以捕获开发错误，增强工具支持（如自动生成文档和代码）</li><li>实时更新: 通过订阅（<code>subscriptions</code>），支持实时数据更新，客户端在数据变化时能自动接收更新</li></ul><h5 id="与REST的对比"><a href="#与REST的对比" class="headerlink" title="与REST的对比"></a><p style="font-size:14px">与<code>REST</code>的对比</p></h5><p><strong>优点</strong></p><ul><li>避免多次请求: 例如获取用户和其文章，<code>REST</code>需要<code>GET /users/1</code>和<code>GET /users/1/posts</code>两次请求，<code>GraphQL</code>只需一次查询同时获取用户和文章数据</li><li>精确的数据获取: 客户端明确指定需要的字段 (如只要<code>name</code>和<code>age</code>，不要<code>email</code>)，避免多余数据传输，特别适用于移动端或弱网环境</li></ul><p><strong>缺点</strong></p><ul><li>查询解析复杂: 服务器需要解析客户端自定义的查询结构、验证类型、执行深度检查，比<code>REST</code>固定端点的处理逻辑更复杂</li><li>缓存困难: <code>REST</code>使用<code>URL</code>作为缓存键 (如<code>GET /users/1</code>)，而<code>GraphQL</code>所有请求都是<code>POST /graphql</code>，查询内容在请求体中，无法利用标准<code>HTTP</code>缓存，需要使用 Apollo Client 等工具自行实现缓存策略</li><li>学习曲线: 需要掌握 Schema 设计、类型系统、Resolver 实现、N+1 查询问题等新概念，比<code>REST</code>的学习成本更高</li></ul><hr><h4 id="2-字段Fields"><a href="#2-字段Fields" class="headerlink" title="2. 字段Fields"></a>2. 字段<code>Fields</code></h4><p>在<code>GraphQL</code>中，字段 (<code>fields</code>) 是定义在类型 (<code>type</code>) 上的属性，表示类型包含的数据内容。字段有以下特点</p><ul><li>每个字段都有名称和返回类型，类型可以是标量（如<code>String</code>、<code>Int</code>）、对象、枚举、列表等</li><li>字段可以接受参数，用于传递附加信息或过滤数据</li></ul><h5 id="字段的基本定义"><a href="#字段的基本定义" class="headerlink" title="字段的基本定义"></a><p style="font-size:14px">字段的基本定义</p></h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">type User &#123;</span><br><span class="line">  id: ID!</span><br><span class="line">  name: String!</span><br><span class="line">  age: Int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Query &#123;</span><br><span class="line">  user(id: ID!): User</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>User</code>类型: 定义用户数据结构，包含<code>id</code>、<code>name</code>、<code>age</code>三个字段，其中<code>!</code>表示字段为必需（非空）</li><li><code>Query</code>类型: 定义查询操作<code>user</code>，通过必需参数<code>id</code>查询并返回对应的<code>User</code>对象</li></ul><h5 id="客户端查询示例"><a href="#客户端查询示例" class="headerlink" title="客户端查询示例"></a><p style="font-size:14px">客户端查询示例</p></h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">query &#123;</span><br><span class="line">  user(id: &quot;1&quot;) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>客户端传入参数<code>id: &quot;1&quot;</code>，请求该用户的<code>id</code>、<code>name</code>和<code>age</code>字段</li><li>服务器返回对应用户的数据</li></ul><h5 id="什么是Schema"><a href="#什么是Schema" class="headerlink" title="什么是Schema"></a><p style="font-size:14px">什么是<code>Schema</code></p></h5><ul><li><code>Schema</code>是<code>GraphQL</code>的核心概念，用于描述<code>API</code>的结构。它定义了客户端可以查询的所有类型和操作</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 定义用户类型</span><br><span class="line">type User &#123;</span><br><span class="line">  id: ID!</span><br><span class="line">  name: String!</span><br><span class="line">  age: Int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 定义查询操作</span><br><span class="line">type Query &#123;</span><br><span class="line">  user(id: ID!): User</span><br><span class="line">  users: [User]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 定义变更操作</span><br><span class="line">type Mutation &#123;</span><br><span class="line">  createUser(name: String!, age: Int!): User</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Schema 将所有类型组合起来</span><br><span class="line">schema &#123;</span><br><span class="line">  query: Query</span><br><span class="line">  mutation: Mutation</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>Schema</code>的组成部分<ul><li>类型定义<code>Type</code>: 定义数据结构，如<code>User</code>类型包含<code>id</code>、<code>name</code>、<code>age</code>字段</li><li>根类型<code>Root Types</code>: <code>Query</code>(查询)、<code>Mutation</code>(变更)、<code>Subscription</code>(订阅)</li><li><code>schema</code>声明: 指定哪些类型作为入口点（通常可以省略，默认使用<code>Query</code>、<code>Mutation</code>、<code>Subscription</code>）</li></ul></li></ul><h5 id="解析器Resolver"><a href="#解析器Resolver" class="headerlink" title="解析器Resolver"></a><p style="font-size:14px">解析器<code>Resolver</code></p></h5><ul><li>解析器定义了如何获取<code>Schema</code>中每个字段的实际数据。当客户端请求某个字段时，<code>GraphQL</code>会调用对应的解析器</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 模拟数据源（实际项目中通常来自数据库）</span></span><br><span class="line"><span class="keyword">const</span> users = [</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&#x27;1&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&#x27;2&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;Bob&#x27;</span>, <span class="attr">age</span>: <span class="number">25</span> &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义解析器</span></span><br><span class="line"><span class="keyword">const</span> resolvers = &#123;</span><br><span class="line">  <span class="title class_">Query</span>: &#123;</span><br><span class="line">    <span class="attr">user</span>: <span class="function">(<span class="params">parent, args, context, info</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> users.<span class="title function_">find</span>(<span class="function"><span class="params">user</span> =&gt;</span> user.<span class="property">id</span> === args.<span class="property">id</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">users</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> users;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>解析器函数接收 4 个参数<ul><li><code>parent</code>: 上一级解析器的返回值（嵌套查询时使用）</li><li><code>args</code>: 客户端传入的参数对象（如<code>&#123; id: &quot;1&quot; &#125;</code>）</li><li><code>context</code>: 所有解析器共享的上下文对象（如数据库连接、用户认证信息）</li><li><code>info</code>: 当前查询的元数据信息（字段名、路径等）</li></ul></li></ul><hr><h4 id="3-参数Arguments"><a href="#3-参数Arguments" class="headerlink" title="3. 参数Arguments"></a>3. 参数<code>Arguments</code></h4><ul><li>在<code>GraphQL</code>中，参数 (<code>Arguments</code>) 用于向字段或操作（如查询<code>Query</code>和变更<code>Mutation</code>）传递输入数据。参数允许客户端在请求中提供额外信息，用于筛选、过滤或指定要操作的数据</li></ul><h5 id="参数的定义"><a href="#参数的定义" class="headerlink" title="参数的定义"></a><p style="font-size:14px">参数的定义</p></h5><ul><li>参数可以定义在<code>GraphQL schema</code>中的字段上，分为必需参数（使用<code>!</code>符号）和可选参数（无<code>!</code>符号）</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">type User &#123;</span><br><span class="line">  id: ID!</span><br><span class="line">  name: String!</span><br><span class="line">  age: Int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Query &#123;</span><br><span class="line">  user(id: ID!): User</span><br><span class="line">  users(age: Int): [User]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>代码说明<ul><li><code>user(id: ID!)</code>: <code>id</code>是必需参数，必须提供才能查询</li><li><code>users(age: Int)</code>: <code>age</code>是可选参数，可以用于筛选特定年龄的用户</li><li><code>[User]</code>: 方括号表示返回值是用户列表</li></ul></li></ul><h5 id="解析器中的参数"><a href="#解析器中的参数" class="headerlink" title="解析器中的参数"></a><p style="font-size:14px">解析器中的参数</p></h5><ul><li>在解析器 (<code>Resolver</code>) 中，参数通过<code>args</code>对象传递，可以使用这些参数来筛选或操作数据</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> resolvers = &#123;</span><br><span class="line">  <span class="title class_">Query</span>: &#123;</span><br><span class="line">    <span class="attr">user</span>: <span class="function">(<span class="params">parent, args, context, info</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">getUserById</span>(args.<span class="property">id</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">users</span>: <span class="function">(<span class="params">parent, args, context, info</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (args.<span class="property">age</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">getUsersByAge</span>(args.<span class="property">age</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">getAllUsers</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>参数使用说明<ul><li><code>args.id</code> &#x2F; <code>args.age</code>: 客户端请求中传递的参数</li><li><code>user</code>查询: 通过<code>id</code>获取单个用户</li><li><code>users</code>查询: 根据<code>age</code>筛选用户列表，未提供<code>age</code>时返回所有用户</li></ul></li></ul><h5 id="客户端查询"><a href="#客户端查询" class="headerlink" title="客户端查询"></a><p style="font-size:14px">客户端查询</p></h5><ul><li>客户端可以通过查询请求传递参数</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">query &#123;</span><br><span class="line">  user(id: &quot;1&quot;) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  users(age: 30) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>查询说明<ul><li><code>user(id: &quot;1&quot;)</code>: 请求<code>id</code>为<code>&quot;1&quot;</code>的单个用户</li><li><code>users(age: 30)</code>: 请求所有<code>age</code>为<code>30</code>的用户列表</li></ul></li></ul><h5 id="Mutation中的参数"><a href="#Mutation中的参数" class="headerlink" title="Mutation中的参数"></a><p style="font-size:14px"><code>Mutation</code>中的参数</p></h5><ul><li><p>参数在变更操作中用于提供执行所需的输入数据（如创建用户）</p></li><li><p>示例代码（按执行顺序: Schema -&gt; Resolver -&gt; 客户端请求）</p></li></ul><figure class="highlight text"><table><tr><td class="code"><pre><span class="line"># Schema -----------------</span><br><span class="line">type Mutation &#123;</span><br><span class="line">  createUser(name: String!, age: Int): User</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type User &#123;</span><br><span class="line">  id: ID!</span><br><span class="line">  name: String!</span><br><span class="line">  age: Int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Resolver (JavaScript) ---</span><br><span class="line">const resolvers = &#123;</span><br><span class="line">  Mutation: &#123;</span><br><span class="line">    createUser: (parent, args, context, info) =&gt; &#123;</span><br><span class="line">      const newUser = &#123;</span><br><span class="line">        id: generateUniqueId(),</span><br><span class="line">        name: args.name,</span><br><span class="line">        age: args.age,</span><br><span class="line">      &#125;;</span><br><span class="line">      saveUserToDatabase(newUser);</span><br><span class="line">      return newUser;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"># Client Request ----------</span><br><span class="line">mutation &#123;</span><br><span class="line">  createUser(name: &quot;Alice&quot;, age: 30) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>执行流程说明<ul><li>客户端传递<code>name</code>和可选<code>age</code>参数到<code>createUser</code></li><li>解析器生成包含唯一<code>id</code>的新用户对象</li><li>保存用户数据到持久化存储</li><li>返回新增用户的完整数据（<code>id</code>、<code>name</code>、<code>age</code>）</li></ul></li></ul><hr><h3 id="GraphQL核心功能"><a href="#GraphQL核心功能" class="headerlink" title="GraphQL核心功能"></a><code>GraphQL</code>核心功能</h3><h4 id="4-别名Aliases"><a href="#4-别名Aliases" class="headerlink" title="4. 别名Aliases"></a>4. 别名<code>Aliases</code></h4><ul><li><p>别名 (<code>Aliases</code>) 用于在响应中重命名字段，解决同字段多次请求的冲突并调整返回结构</p></li><li><p>使用场景</p><ul><li>避免命名冲突: 多次查询同一字段但参数不同</li><li>自定义响应结构: 让返回键名更贴近业务语义</li></ul></li></ul><h5 id="避免命名冲突"><a href="#避免命名冲突" class="headerlink" title="避免命名冲突"></a><p style="font-size:14px">避免命名冲突</p></h5><ul><li>为每次对同一字段的不同参数请求添加不同别名，避免响应中键名重复</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">query &#123;</span><br><span class="line">  user1: user(id: &quot;1&quot;) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">  user2: user(id: &quot;2&quot;) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>示例说明<ul><li><code>user1: user(id: &quot;1&quot;)</code>: 使用别名<code>user1</code>标识第一条<code>user</code>查询</li><li><code>user2: user(id: &quot;2&quot;)</code>: 使用别名<code>user2</code>标识第二条<code>user</code>查询</li><li>服务端仍调用同一个<code>user</code>解析器两次，客户端通过不同键名接收结果，无命名冲突</li></ul></li></ul><h5 id="定义响应格式"><a href="#定义响应格式" class="headerlink" title="定义响应格式"></a><p style="font-size:14px">定义响应格式</p></h5><ul><li>别名可以改变返回数据中的字段名称，使其更符合业务需求或提高可读性</li></ul><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;user1&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Alice&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">30</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;user2&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Bob&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">25</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><ul><li><code>user1</code>和<code>user2</code>成为响应数据中的字段名称，分别包含两个不同用户的信息</li></ul><hr><h4 id="5-片段Fragments"><a href="#5-片段Fragments" class="headerlink" title="5. 片段Fragments"></a>5. 片段<code>Fragments</code></h4><ul><li>片段用于复用一组字段选择，避免在多个查询&#x2F;变更&#x2F;订阅中重复书写相同字段，提升可读性与维护性</li><li>使用价值<ul><li>减少重复: 一处定义，多处引用</li><li>保持一致: 保证不同查询返回字段结构一致</li><li>易于修改: 修改片段即可同步更新所有使用位置</li></ul></li></ul><h5 id="片段的语法"><a href="#片段的语法" class="headerlink" title="片段的语法"></a><p style="font-size:14px">片段的语法</p></h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fragment FragmentName on TypeName &#123;</span><br><span class="line">  field1</span><br><span class="line">  field2</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>语法说明<ul><li><code>FragmentName</code>: 片段名称，后续通过<code>...FragmentName</code>引用</li><li><code>on TypeName</code>: 指定该片段绑定的类型（只能在该类型或其实现处使用）</li><li>片段体: 需要复用的字段集合</li></ul></li></ul><h5 id="片段的使用示例"><a href="#片段的使用示例" class="headerlink" title="片段的使用示例"></a><p style="font-size:14px">片段的使用示例</p></h5><ul><li>场景: 多次查询<code>User</code>不同实例但需要相同字段集合</li><li>示例代码（片段定义 -&gt; 查询使用 -&gt; 返回结果）</li></ul><figure class="highlight text"><table><tr><td class="code"><pre><span class="line"># Fragment Definition -----------------</span><br><span class="line">fragment UserFields on User &#123;</span><br><span class="line">  id</span><br><span class="line">  name</span><br><span class="line">  age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Query Using Fragment ----------------</span><br><span class="line">query &#123;</span><br><span class="line">  user1: user(id: &quot;1&quot;) &#123;</span><br><span class="line">    ...UserFields</span><br><span class="line">  &#125;</span><br><span class="line">  user2: user(id: &quot;2&quot;) &#123;</span><br><span class="line">    ...UserFields</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Result JSON -------------------------</span><br><span class="line">&#123;</span><br><span class="line">  &quot;data&quot;: &#123;</span><br><span class="line">    &quot;user1&quot;: &#123;</span><br><span class="line">      &quot;id&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Alice&quot;,</span><br><span class="line">      &quot;age&quot;: 30</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;user2&quot;: &#123;</span><br><span class="line">      &quot;id&quot;: &quot;2&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Bob&quot;,</span><br><span class="line">      &quot;age&quot;: 25</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="嵌套片段"><a href="#嵌套片段" class="headerlink" title="嵌套片段"></a><p style="font-size:14px">嵌套片段</p></h5><ul><li>通过在一个片段内部引用另一个片段，实现复杂对象字段的分层复用</li><li>适用场景: 对象包含子对象，需要分别维护子对象字段集合</li><li>示例代码（片段定义 -&gt; 查询使用 -&gt; 返回结果）</li></ul><figure class="highlight text"><table><tr><td class="code"><pre><span class="line"># Fragment Definitions -----------------</span><br><span class="line">fragment AddressFields on Address &#123;</span><br><span class="line">  street</span><br><span class="line">  city</span><br><span class="line">  country</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fragment UserFields on User &#123;</span><br><span class="line">  id</span><br><span class="line">  name</span><br><span class="line">  age</span><br><span class="line">  address &#123;</span><br><span class="line">    ...AddressFields</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Query Using Nested Fragment ----------</span><br><span class="line">query &#123;</span><br><span class="line">  user(id: &quot;1&quot;) &#123;</span><br><span class="line">    ...UserFields</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Result JSON --------------------------</span><br><span class="line">&#123;</span><br><span class="line">  &quot;data&quot;: &#123;</span><br><span class="line">    &quot;user&quot;: &#123;</span><br><span class="line">      &quot;id&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Alice&quot;,</span><br><span class="line">      &quot;age&quot;: 30,</span><br><span class="line">      &quot;address&quot;: &#123;</span><br><span class="line">        &quot;street&quot;: &quot;123 Main St&quot;,</span><br><span class="line">        &quot;city&quot;: &quot;New York&quot;,</span><br><span class="line">        &quot;country&quot;: &quot;USA&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="内联片段"><a href="#内联片段" class="headerlink" title="内联片段"></a><p style="font-size:14px">内联片段</p></h5><ul><li>用途: 针对接口或联合类型中不同具体实现返回不同字段集合</li><li>使用场景<ul><li>接口&#x2F;联合类型多态数据</li><li>需要根据实际类型选择附加字段</li></ul></li><li>语法: <code>... on TypeName &#123; fields &#125;</code></li><li>示例代码（语法 -&gt; Schema -&gt; 查询使用 -&gt; 返回结果）</li></ul><figure class="highlight text"><table><tr><td class="code"><pre><span class="line"># Inline Fragment Syntax ---------------</span><br><span class="line">... on TypeName &#123;</span><br><span class="line">  field1</span><br><span class="line">  field2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Schema --------------------------------</span><br><span class="line">interface Person &#123;</span><br><span class="line">  id: ID!</span><br><span class="line">  name: String!</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Employee implements Person &#123;</span><br><span class="line">  id: ID!</span><br><span class="line">  name: String!</span><br><span class="line">  salary: Int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Customer implements Person &#123;</span><br><span class="line">  id: ID!</span><br><span class="line">  name: String!</span><br><span class="line">  purchaseHistory: [String]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Query &#123;</span><br><span class="line">  persons: [Person]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Query Using Inline Fragments ---------</span><br><span class="line">query &#123;</span><br><span class="line">  persons &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    ... on Employee &#123;</span><br><span class="line">      salary</span><br><span class="line">    &#125;</span><br><span class="line">    ... on Customer &#123;</span><br><span class="line">      purchaseHistory</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Result JSON --------------------------</span><br><span class="line">&#123;</span><br><span class="line">  &quot;data&quot;: &#123;</span><br><span class="line">    &quot;persons&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;id&quot;: &quot;1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;Alice&quot;,</span><br><span class="line">        &quot;salary&quot;: 50000</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;id&quot;: &quot;2&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;Bob&quot;,</span><br><span class="line">        &quot;purchaseHistory&quot;: [&quot;item1&quot;, &quot;item2&quot;]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="6-操作名称"><a href="#6-操作名称" class="headerlink" title="6. 操作名称"></a>6. 操作名称</h4><p>在<code>GraphQL</code>中，操作名称 (<code>Operation Name</code>) 是一个可选的标识，用于明确标注特定的查询 (<code>Query</code>)、变更 (<code>Mutation</code>) 或订阅 (<code>Subscription</code>) 操作的名称。它有助于提高可读性、调试效率，以及在某些工具中实现特定功能</p><h5 id="操作名称特点"><a href="#操作名称特点" class="headerlink" title="操作名称特点"></a><p style="font-size:14px">操作名称特点</p></h5><ul><li>操作名称的位置<ul><li>紧跟在操作类型（如<code>query</code>、<code>mutation</code>或<code>subscription</code>）之后</li></ul></li><li>命名规则<ul><li>名称只能包含字母、数字和下划线<code>(_)</code></li><li>名称不能以数字开头</li></ul></li><li>用途<ul><li>提供查询的上下文，明确查询意图</li><li>在调试、日志记录和工具（如<code>Apollo Client</code>）中，用于识别特定的操作</li><li>当一个请求中包含多个操作时，必须使用操作名称</li></ul></li></ul><h5 id="操作名称示例"><a href="#操作名称示例" class="headerlink" title="操作名称示例"></a><p style="font-size:14px">操作名称示例</p></h5><ul><li>查询示例: <code>GetUser</code>是操作名称，用于标识此查询操作</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">query GetUser &#123;</span><br><span class="line">  user(id: &quot;1&quot;) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>变更示例: <code>CreateUser</code>是操作名称，表明此变更的目的为创建用户</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mutation CreateUser &#123;</span><br><span class="line">  createUser(name: &quot;Alice&quot;, age: 30) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>多操作示例: 当一个请求中包含多个操作时，必须使用操作名称进行区分</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">query GetUser &#123;</span><br><span class="line">  user(id: &quot;1&quot;) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mutation UpdateUser &#123;</span><br><span class="line">  updateUser(id: &quot;1&quot;, name: &quot;Alice&quot;) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>匿名操作: 如果操作名称被省略，该操作称为匿名操作, 但在一个请求中不能包含多个匿名操作，因为没有操作名称用于区分</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">query &#123;</span><br><span class="line">  user(id: &quot;1&quot;) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="7-操作类型"><a href="#7-操作类型" class="headerlink" title="7. 操作类型"></a>7. 操作类型</h4><p>在<code>GraphQL</code>中，操作类型 (<code>Operation Type</code>) 是指客户端可以在<code>API</code>请求中执行的三种操作: 查询 (<code>Query</code>)、变更 (<code>Mutation</code>) 和 订阅 (<code>Subscription</code>)。每种操作类型对应不同的用途，分别用于读取数据、修改数据和监听实时数据更新</p><h5 id="操作类型介绍"><a href="#操作类型介绍" class="headerlink" title="操作类型介绍"></a><p style="font-size:14px">操作类型介绍</p></h5><ul><li>查询 <code>Query</code><ul><li>用途: 用于读取和获取数据</li><li>特点: 不会对服务器数据产生任何修改，仅返回请求的数据 (类似于<code>REST API</code>的<code>GET</code>请求)</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">query &#123;</span><br><span class="line">  user(id: &quot;1&quot;) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- 查询 user 数据，根据参数 id: &quot;1&quot; 获取特定用户的信息 --&gt;</span><br><span class="line">&lt;!-- 返回的字段包括 id、name 和 age --&gt;</span><br></pre></td></tr></table></figure><ul><li>变更 <code>Mutation</code><ul><li>用途: 用于修改服务器上的数据，包括创建、更新或删除操作</li><li>特点: 与查询不同，变更操作会改变服务器的数据状态 (类似于<code>REST API</code>的<code>POST</code>、<code>PUT</code>、<code>PATCH</code>和 <code>DELETE</code>请求)</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mutation &#123;</span><br><span class="line">  createUser(name: &quot;Alice&quot;, age: 30) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- 调用 createUser 变更操作，创建一个新用户 --&gt;</span><br><span class="line">&lt;!-- 参数 name 和 age 提供新用户的基本信息 --&gt;</span><br><span class="line">&lt;!-- 返回结果包括新用户的 id 和 name --&gt;</span><br></pre></td></tr></table></figure><ul><li>订阅 <code>Subscription</code><ul><li>用途: 用于监听服务器上的事件，并在事件发生时实时接收更新</li><li>特点: 用于实时数据更新场景，如实时聊天、股票行情等。订阅操作会保持一个持久的连接（通常使用<code>WebSocket</code>），当事件发生时，服务器会主动推送更新给客户端</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">subscription &#123;</span><br><span class="line">  userAdded &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- 订阅 userAdded 事件，当有新用户被添加时，服务器会推送更新数据 --&gt;</span><br><span class="line">&lt;!-- 返回结果包含新用户的 id、name 和 age --&gt;</span><br></pre></td></tr></table></figure><h5 id="三种操作类型的比较"><a href="#三种操作类型的比较" class="headerlink" title="三种操作类型的比较"></a><p style="font-size:14px">三种操作类型的比较</p></h5><table><thead><tr><th><strong>操作类型</strong></th><th><strong>用途</strong></th><th><strong>是否修改数据</strong></th><th><strong>使用场景</strong></th></tr></thead><tbody><tr><td><strong>查询</strong></td><td>读取和获取数据</td><td>否</td><td>获取用户、产品列表、详情页数据</td></tr><tr><td><strong>变更</strong></td><td>修改服务器数据</td><td>是</td><td>创建、更新、删除资源</td></tr><tr><td><strong>订阅</strong></td><td>监听事件并实时接收数据更新</td><td>否</td><td>实时聊天、通知、数据流</td></tr></tbody></table><hr><h4 id="8-查询Query"><a href="#8-查询Query" class="headerlink" title="8. 查询Query"></a>8. 查询<code>Query</code></h4><p>查询 (<code>Query</code>) 是<code>GraphQL</code>中的一种操作类型，用于从服务器获取数据。它与传统<code>REST API</code>的<code>GET</code>请求类似，但在灵活性和强大性方面超越了后者</p><h5 id="查询的定义"><a href="#查询的定义" class="headerlink" title="查询的定义"></a><p style="font-size:14px">查询的定义</p></h5><ul><li>在<code>GraphQL</code>中，查询类型通常在<code>schema</code>中定义为<code>Query</code>类型。<code>Query</code>类型描述了所有可执行的查询操作</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">type Query &#123;</span><br><span class="line">  user(id: ID!): User</span><br><span class="line">  users: [User]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type User &#123;</span><br><span class="line">  id: ID!</span><br><span class="line">  name: String!</span><br><span class="line">  age: Int</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="查询解析器Resolver"><a href="#查询解析器Resolver" class="headerlink" title="查询解析器Resolver"></a><p style="font-size:14px">查询解析器<code>Resolver</code></p></h5><ul><li>解析器负责实现字段的具体逻辑，定义如何获取数据。以下是查询解析器的示例</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> users = [</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&#x27;1&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&#x27;2&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;Bob&#x27;</span>, <span class="attr">age</span>: <span class="number">25</span> &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> resolvers = &#123;</span><br><span class="line">  <span class="title class_">Query</span>: &#123;</span><br><span class="line">    <span class="attr">user</span>: <span class="function">(<span class="params">parent, args, context, info</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> users.<span class="title function_">find</span>(<span class="function"><span class="params">user</span> =&gt;</span> user.<span class="property">id</span> === args.<span class="property">id</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">users</span>: <span class="function">() =&gt;</span> users,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><code>user</code>: 根据传入的<code>id</code>参数，从<code>users</code>列表中查找并返回对应用户</li><li><code>users</code>: 直接返回所有用户</li></ul><h5 id="查询的特点"><a href="#查询的特点" class="headerlink" title="查询的特点"></a><p style="font-size:14px">查询的特点</p></h5><ul><li>精确的数据获取: 客户端可以指定所需字段，避免传输多余数据</li><li>示例代码（精确字段查询 -&gt; 多资源单请求 -&gt; 各自结果）</li></ul><figure class="highlight text"><table><tr><td class="code"><pre><span class="line"># Query (Precise Fields) ---------------</span><br><span class="line">query &#123;</span><br><span class="line">  user(id: &quot;1&quot;) &#123;</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Result JSON (Precise Fields) ---------</span><br><span class="line">&#123;</span><br><span class="line">  &quot;data&quot;: &#123;</span><br><span class="line">    &quot;user&quot;: &#123;</span><br><span class="line">      &quot;name&quot;: &quot;Alice&quot;,</span><br><span class="line">      &quot;age&quot;: 30</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Query (Multiple Resources Single Request)</span><br><span class="line">query &#123;</span><br><span class="line">  user(id: &quot;1&quot;) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">  &#125;</span><br><span class="line">  users &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Result JSON (Multiple Resources) -----</span><br><span class="line">&#123;</span><br><span class="line">  &quot;data&quot;: &#123;</span><br><span class="line">    &quot;user&quot;: &#123;</span><br><span class="line">      &quot;id&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Alice&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;users&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;id&quot;: &quot;1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;Alice&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;id&quot;: &quot;2&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;Bob&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="9-变更Mutations"><a href="#9-变更Mutations" class="headerlink" title="9. 变更Mutations"></a>9. 变更<code>Mutations</code></h4><p>变更 (<code>Mutations</code>) 是<code>GraphQL</code>中的一种操作类型，专门用于对服务器端的数据进行修改操作。与查询 (<code>Query</code>) 仅用于读取数据不同，变更支持创建、更新或删除数据。每个变更操作都可以定义所需的输入参数和返回结果的结构</p><h5 id="变更的定义"><a href="#变更的定义" class="headerlink" title="变更的定义"></a><p style="font-size:14px">变更的定义</p></h5><ul><li>在<code>GraphQL</code>的<code>schema</code>中，变更类型通常定义在<code>Mutation</code>类型中，用来描述所有支持的数据修改操作</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">type Mutation &#123;</span><br><span class="line">  createUser(name: String!, age: Int!): User</span><br><span class="line">  updateUser(id: ID!, name: String, age: Int): User</span><br><span class="line">  deleteUser(id: ID!): Boolean</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type User &#123;</span><br><span class="line">  id: ID!</span><br><span class="line">  name: String!</span><br><span class="line">  age: Int</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>createUser</code>: 接收<code>name</code>和<code>age</code>参数，返回新创建的<code>User</code>对象</li><li><code>updateUser</code>: 接收<code>id</code>（必需）、<code>name</code>和<code>age</code>参数，用于更新用户信息，返回更新后的<code>User</code></li><li><code>deleteUser</code>: 接收<code>id</code>参数，用于删除指定用户，返回布尔值表示操作是否成功</li></ul><h5 id="变更的解析器"><a href="#变更的解析器" class="headerlink" title="变更的解析器"></a><p style="font-size:14px">变更的解析器</p></h5><ul><li>解析器定义了如何执行变更操作，通常与数据库或其他数据存储交互</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="attr">v4</span>: uuidv4 &#125; = <span class="built_in">require</span>(<span class="string">&#x27;uuid&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> users = [</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&#x27;1&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&#x27;2&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;Bob&#x27;</span>, <span class="attr">age</span>: <span class="number">25</span> &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> resolvers = &#123;</span><br><span class="line">  <span class="title class_">Mutation</span>: &#123;</span><br><span class="line">    <span class="attr">createUser</span>: <span class="function">(<span class="params">parent, args, context, info</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> newUser = &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="title function_">uuidv4</span>(), <span class="comment">// 生成唯一 ID</span></span><br><span class="line">        <span class="attr">name</span>: args.<span class="property">name</span>,</span><br><span class="line">        <span class="attr">age</span>: args.<span class="property">age</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">      users.<span class="title function_">push</span>(newUser); <span class="comment">// 添加到用户列表</span></span><br><span class="line">      <span class="keyword">return</span> newUser;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">updateUser</span>: <span class="function">(<span class="params">parent, args, context, info</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> user = users.<span class="title function_">find</span>(<span class="function"><span class="params">user</span> =&gt;</span> user.<span class="property">id</span> === args.<span class="property">id</span>);</span><br><span class="line">      <span class="keyword">if</span> (!user) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;User not found&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (args.<span class="property">name</span> !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">        user.<span class="property">name</span> = args.<span class="property">name</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (args.<span class="property">age</span> !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">        user.<span class="property">age</span> = args.<span class="property">age</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> user;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">deleteUser</span>: <span class="function">(<span class="params">parent, args, context, info</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> userIndex = users.<span class="title function_">findIndex</span>(<span class="function"><span class="params">user</span> =&gt;</span> user.<span class="property">id</span> === args.<span class="property">id</span>);</span><br><span class="line">      <span class="keyword">if</span> (userIndex === -<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;User not found&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      users.<span class="title function_">splice</span>(userIndex, <span class="number">1</span>); <span class="comment">// 从列表中移除用户</span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h5 id="变更的使用"><a href="#变更的使用" class="headerlink" title="变更的使用"></a><p style="font-size:14px">变更的使用</p></h5><p>客户端可以通过以下查询发送变更请求</p><ul><li>示例代码（创建用户 -&gt; 更新用户 -&gt; 删除用户 -&gt; 各自结果）</li></ul><figure class="highlight text"><table><tr><td class="code"><pre><span class="line"># Create User Mutation -----------------</span><br><span class="line">mutation &#123;</span><br><span class="line">  createUser(name: &quot;Alice&quot;, age: 30) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Result JSON (Create) -----------------</span><br><span class="line">&#123;</span><br><span class="line">  &quot;data&quot;: &#123;</span><br><span class="line">    &quot;createUser&quot;: &#123;</span><br><span class="line">      &quot;id&quot;: &quot;c81e728d-59f2-4d16-9f02-fcad84756789&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Alice&quot;,</span><br><span class="line">      &quot;age&quot;: 30</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Update User Mutation -----------------</span><br><span class="line">mutation &#123;</span><br><span class="line">  updateUser(id: &quot;1&quot;, name: &quot;Alice Updated&quot;) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Result JSON (Update) -----------------</span><br><span class="line">&#123;</span><br><span class="line">  &quot;data&quot;: &#123;</span><br><span class="line">    &quot;updateUser&quot;: &#123;</span><br><span class="line">      &quot;id&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Alice Updated&quot;,</span><br><span class="line">      &quot;age&quot;: 30</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Delete User Mutation -----------------</span><br><span class="line">mutation &#123;</span><br><span class="line">  deleteUser(id: &quot;2&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Result JSON (Delete) -----------------</span><br><span class="line">&#123;</span><br><span class="line">  &quot;data&quot;: &#123;</span><br><span class="line">    &quot;deleteUser&quot;: true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h4 id="10-订阅Subscription"><a href="#10-订阅Subscription" class="headerlink" title="10. 订阅Subscription"></a>10. 订阅<code>Subscription</code></h4><p>订阅 (<code>Subscription</code>) 是<code>GraphQL</code>中的一种操作类型，允许客户端订阅服务器上的事件，并在事件发生时实时接收更新数据。这种机制特别适合实时更新场景，如聊天消息、通知、股票价格等</p><h5 id="订阅的工作原理"><a href="#订阅的工作原理" class="headerlink" title="订阅的工作原理"></a><p style="font-size:14px">订阅的工作原理</p></h5><ul><li>建立订阅连接: 客户端发送订阅请求到服务器，指定要订阅的事件或数据</li><li>保持连接: 服务器与客户端之间通过<code>WebSocket</code>或其他双向通信协议维持持久连接</li><li>事件触发: 当服务器端的事件发生变化（如新增或更新数据）时，触发对应的订阅逻辑</li><li>数据推送: 服务器将更新的数据通过连接推送到订阅的客户端</li></ul><h5 id="订阅示例"><a href="#订阅示例" class="headerlink" title="订阅示例"></a><p style="font-size:14px">订阅示例</p></h5><ul><li><code>Schema</code>定义</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">type User &#123;</span><br><span class="line">  id: ID!</span><br><span class="line">  name: String!</span><br><span class="line">  age: Int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Subscription &#123;</span><br><span class="line">  userAdded: User</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Mutation &#123;</span><br><span class="line">  createUser(name: String!, age: Int!): User</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>Resolvers</code>实现</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">PubSub</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;graphql-subscriptions&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> pubsub = <span class="keyword">new</span> <span class="title class_">PubSub</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> resolvers = &#123;</span><br><span class="line">  <span class="title class_">Subscription</span>: &#123;</span><br><span class="line">    <span class="attr">userAdded</span>: &#123;</span><br><span class="line">      <span class="comment">// 定义订阅器，监听 USER_ADDED 事件</span></span><br><span class="line">      <span class="attr">subscribe</span>: <span class="function">() =&gt;</span> pubsub.<span class="title function_">asyncIterator</span>([<span class="string">&#x27;USER_ADDED&#x27;</span>]),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title class_">Mutation</span>: &#123;</span><br><span class="line">    <span class="attr">createUser</span>: <span class="function">(<span class="params">parent, args, context, info</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> newUser = &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="title function_">generateUniqueId</span>(),</span><br><span class="line">        <span class="attr">name</span>: args.<span class="property">name</span>,</span><br><span class="line">        <span class="attr">age</span>: args.<span class="property">age</span>,</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 保存用户数据（模拟数据库操作）</span></span><br><span class="line">      <span class="title function_">saveUserToDatabase</span>(newUser);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 触发 USER_ADDED 事件</span></span><br><span class="line">      pubsub.<span class="title function_">publish</span>(<span class="string">&#x27;USER_ADDED&#x27;</span>, &#123; <span class="attr">userAdded</span>: newUser &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> newUser;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>客户端订阅示例</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">subscription &#123;</span><br><span class="line">  userAdded &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>当有新用户通过<code>createUser</code>变更操作添加时，服务器会触发<code>userAdded</code>事件，客户端将接收到用户信息</li></ul><h5 id="Apollo-Client订阅"><a href="#Apollo-Client订阅" class="headerlink" title="Apollo Client订阅"></a><p style="font-size:14px"><code>Apollo Client</code>订阅</p></h5><ul><li>配置<code>Apollo Client</code>: 创建一个支持查询、变更和订阅的客户端</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ApolloClient</span>, <span class="title class_">InMemoryCache</span>, split &#125; <span class="keyword">from</span> <span class="string">&#x27;@apollo/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">WebSocketLink</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@apollo/client/link/ws&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">HttpLink</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@apollo/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getMainDefinition &#125; <span class="keyword">from</span> <span class="string">&#x27;@apollo/client/utilities&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 HTTP 链接用于查询和变更</span></span><br><span class="line"><span class="keyword">const</span> httpLink = <span class="keyword">new</span> <span class="title class_">HttpLink</span>(&#123; <span class="attr">uri</span>: <span class="string">&#x27;http://localhost:4000/graphql&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 WebSocket 链接用于订阅</span></span><br><span class="line"><span class="keyword">const</span> wsLink = <span class="keyword">new</span> <span class="title class_">WebSocketLink</span>(&#123;</span><br><span class="line">  <span class="attr">uri</span>: <span class="string">&#x27;ws://localhost:4000/graphql&#x27;</span>,</span><br><span class="line">  <span class="attr">options</span>: &#123;</span><br><span class="line">    <span class="attr">reconnect</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 split 根据操作类型分别选择链接</span></span><br><span class="line"><span class="keyword">const</span> splitLink = <span class="title function_">split</span>(</span><br><span class="line">  <span class="function">(<span class="params">&#123; query &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> definition = <span class="title function_">getMainDefinition</span>(query);</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      definition.<span class="property">kind</span> === <span class="string">&#x27;OperationDefinition&#x27;</span> &amp;&amp;</span><br><span class="line">      definition.<span class="property">operation</span> === <span class="string">&#x27;subscription&#x27;</span></span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">  wsLink,</span><br><span class="line">  httpLink,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 Apollo 客户端</span></span><br><span class="line"><span class="keyword">const</span> client = <span class="keyword">new</span> <span class="title class_">ApolloClient</span>(&#123;</span><br><span class="line">  <span class="attr">link</span>: splitLink,</span><br><span class="line">  <span class="attr">cache</span>: <span class="keyword">new</span> <span class="title class_">InMemoryCache</span>(),</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>订阅操作: 使用<code>Apollo Client</code>的<code>useSubscription Hook</code>实现订阅</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; gql, useSubscription &#125; <span class="keyword">from</span> <span class="string">&#x27;@apollo/client&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">USER_ADDED_SUBSCRIPTION</span> = gql<span class="string">`</span></span><br><span class="line"><span class="string">  subscription OnUserAdded &#123;</span></span><br><span class="line"><span class="string">    userAdded &#123;</span></span><br><span class="line"><span class="string">      id</span></span><br><span class="line"><span class="string">      name</span></span><br><span class="line"><span class="string">      age</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">UserList</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; data, loading, error &#125; = <span class="title function_">useSubscription</span>(<span class="variable constant_">USER_ADDED_SUBSCRIPTION</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (loading) <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line">  <span class="keyword">if</span> (error) <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Error: &#123;error.message&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>New User Added:<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>ID: &#123;data.userAdded.id&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Name: &#123;data.userAdded.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Age: &#123;data.userAdded.age&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">UserList</span>;</span><br></pre></td></tr></table></figure><ul><li>总而言之，<code>GraphQL</code>的<code>Subscription</code>依赖于<code>WebSocket</code>来实现。<code>WebSocket</code>提供了双向持久连接的能力，使得服务器能够在事件发生时立即向客户端推送数据，而<code>Subscription</code>则定义了这些事件和数据的结构。因此，<code>Subscription</code>不是替代<code>WebSocket</code>，而是利用<code>WebSocket</code>来实现特定的功能和需求</li></ul><hr><h3 id="GraphQL进阶"><a href="#GraphQL进阶" class="headerlink" title="GraphQL进阶"></a><code>GraphQL</code>进阶</h3><h4 id="11-变量-Variables"><a href="#11-变量-Variables" class="headerlink" title="11. 变量 Variables"></a>11. 变量 Variables</h4><p>在<code>GraphQL</code>中，变量 (<code>Variables</code>) 是一种机制，用于动态传递参数到查询 (<code>Query</code>)、变更 (<code>Mutation</code>) 或订阅 (<code>Subscription</code>) 中。通过使用变量，可以使查询更加灵活、可重用，并且避免将用户输入直接嵌入到查询字符串中，从而提升安全性和可读性</p><h5 id="变量的定义与使用"><a href="#变量的定义与使用" class="headerlink" title="变量的定义与使用"></a><p style="font-size:14px">变量的定义与使用</p></h5><ul><li>查询中的变量: 变量需要在查询语句中定义，并在执行查询时传入实际的值</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">query GetUser($id: ID!) &#123;</span><br><span class="line">  user(id: $id) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- $id 是一个变量，表示用户的 ID --&gt;</span><br><span class="line">&lt;!-- 变量的类型为 ID!，! 表示这是一个必需字段 --&gt;</span><br></pre></td></tr></table></figure><ul><li>变量在<code>React</code>中的使用: 使用<code>Apollo Client</code>的<code>useQuery Hook</code>动态传递变量值</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; gql, useQuery &#125; <span class="keyword">from</span> <span class="string">&#x27;@apollo/client&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义查询和变量</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">GET_USER</span> = gql<span class="string">`</span></span><br><span class="line"><span class="string">  query GetUser($id: ID!) &#123;</span></span><br><span class="line"><span class="string">    user(id: $id) &#123;</span></span><br><span class="line"><span class="string">      id</span></span><br><span class="line"><span class="string">      name</span></span><br><span class="line"><span class="string">      age</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">User</span>(<span class="params">&#123; userId &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; loading, error, data &#125; = <span class="title function_">useQuery</span>(<span class="variable constant_">GET_USER</span>, &#123;</span><br><span class="line">    <span class="attr">variables</span>: &#123; <span class="attr">id</span>: userId &#125;, <span class="comment">// 动态传递变量值</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (loading) <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line">  <span class="keyword">if</span> (error) <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Error: &#123;error.message&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>User Details<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>ID: &#123;data.user.id&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Name: &#123;data.user.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Age: &#123;data.user.age&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">User</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 变量`$id`的值由组件的`props`动态传递</span></span><br><span class="line"><span class="comment">// 查询使用`useQuery Hook`，并通过`variables`选项传递实际的变量值</span></span><br></pre></td></tr></table></figure><ul><li>变更中的变量: 在变更操作中，变量同样可以动态传递参数</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mutation CreateUser($name: String!, $age: Int!) &#123;</span><br><span class="line">  createUser(name: $name, age: $age) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>Apollo Client</code>示例</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; gql, useMutation &#125; <span class="keyword">from</span> <span class="string">&#x27;@apollo/client&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CREATE_USER</span> = gql<span class="string">`</span></span><br><span class="line"><span class="string">  mutation CreateUser($name: String!, $age: Int!) &#123;</span></span><br><span class="line"><span class="string">    createUser(name: $name, age: $age) &#123;</span></span><br><span class="line"><span class="string">      id</span></span><br><span class="line"><span class="string">      name</span></span><br><span class="line"><span class="string">      age</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">CreateUserForm</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [createUser, &#123; data, loading, error &#125;] = <span class="title function_">useMutation</span>(<span class="variable constant_">CREATE_USER</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleSubmit</span> = <span class="keyword">async</span> (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">    <span class="keyword">const</span> name = e.<span class="property">target</span>.<span class="property">name</span>.<span class="property">value</span>;</span><br><span class="line">    <span class="keyword">const</span> age = <span class="built_in">parseInt</span>(e.<span class="property">target</span>.<span class="property">age</span>.<span class="property">value</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">createUser</span>(&#123; <span class="attr">variables</span>: &#123; name, age &#125; &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (loading) <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Submitting...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line">  <span class="keyword">if</span> (error) <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Error: &#123;error.message&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">form</span> <span class="attr">onSubmit</span>=<span class="string">&#123;handleSubmit&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Name&quot;</span> <span class="attr">required</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Age&quot;</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">required</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>Create User<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;data &amp;&amp; <span class="tag">&lt;<span class="name">p</span>&gt;</span>Created User: &#123;data.createUser.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">CreateUserForm</span>;</span><br></pre></td></tr></table></figure><hr><h4 id="12-指令-Directives"><a href="#12-指令-Directives" class="headerlink" title="12. 指令 Directives"></a>12. 指令 Directives</h4><p>指令 (<code>Directives</code>) 是<code>GraphQL</code>中的一种强大功能，用于动态影响查询、变更 (<code>Mutation</code>) 或订阅 (<code>Subscription</code>) 的执行行为。指令可以应用于字段、片段等，帮助客户端或服务器灵活调整查询结果的生成逻辑。例如，可以根据条件决定是否包含某字段或动态修改返回结果</p><h5 id="内置指令"><a href="#内置指令" class="headerlink" title="内置指令"></a><p style="font-size:14px">内置指令</p></h5><p><code>GraphQL</code>规范中定义了两个常用的内置指令: <code>@include</code>和<code>@skip</code></p><ul><li><code>@include</code>: 条件包含<ul><li>用于根据条件动态包含字段或片段</li><li>接受一个名为<code>if</code>的参数，该参数的值为布尔类型</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">query GetUser($withAge: Boolean!) &#123;</span><br><span class="line">  user(id: &quot;1&quot;) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age @include(if: $withAge)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- 如果变量 $withAge 为 true，则返回结果中包含 age 字段 --&gt;</span><br><span class="line">&lt;!-- 如果 $withAge 为 false，则排除 age 字段 --&gt;</span><br></pre></td></tr></table></figure><ul><li><code>@skip</code>: 条件跳过<ul><li>用于根据条件跳过字段或片段</li><li>同样接受一个名为<code>if</code>的布尔参数</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">query GetUser($withoutAge: Boolean!) &#123;</span><br><span class="line">  user(id: &quot;1&quot;) &#123;</span><br><span class="line">    id</span><br><span class="line">    name</span><br><span class="line">    age @skip(if: $withoutAge)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- 如果变量 $withoutAge 为 true，则跳过 age 字段 --&gt;</span><br><span class="line">&lt;!-- 如果 $withoutAge 为 false，则包含 age 字段 --&gt;</span><br></pre></td></tr></table></figure><h5 id="自定义指令"><a href="#自定义指令" class="headerlink" title="自定义指令"></a><p style="font-size:14px">自定义指令</p></h5><p>除了内置指令，<code>GraphQL</code>还支持自定义指令。这些指令可以用于更复杂的场景，比如数据验证、字段格式化等。自定义指令需要在<code>schema</code>中声明，并提供对应的实现逻辑</p><ul><li>自定义指令声明</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">directive @upper on FIELD_DEFINITION</span><br><span class="line"></span><br><span class="line">type Query &#123;</span><br><span class="line">  greeting: String @upper</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- @upper 是一个自定义指令，应用在字段定义上 --&gt;</span><br><span class="line">&lt;!-- on FIELD_DEFINITION 指定了该指令适用于字段定义 --&gt;</span><br></pre></td></tr></table></figure><ul><li>自定义指令的实现: 使用<code>graphql-tools</code>创建一个<code>@upper</code>指令，将字符串字段的返回值转换为大写</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">SchemaDirectiveVisitor</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;graphql-tools&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; defaultFieldResolver &#125; = <span class="built_in">require</span>(<span class="string">&#x27;graphql&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UpperCaseDirective</span> <span class="keyword">extends</span> <span class="title class_ inherited__">SchemaDirectiveVisitor</span> &#123;</span><br><span class="line">  <span class="title function_">visitFieldDefinition</span>(<span class="params">field</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; resolve = defaultFieldResolver &#125; = field;</span><br><span class="line"></span><br><span class="line">    field.<span class="property">resolve</span> = <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params">...args</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> result = <span class="keyword">await</span> resolve.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args);</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> result === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> result.<span class="title function_">toUpperCase</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">UpperCaseDirective</span>;</span><br></pre></td></tr></table></figure><ul><li>整合指令到<code>Schema</code>: 自定义指令<code>@upper</code>应用于<code>greeting</code>字段，返回的值将自动转换为大写</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; gql &#125; = <span class="built_in">require</span>(<span class="string">&#x27;apollo-server&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">UpperCaseDirective</span> = <span class="built_in">require</span>(<span class="string">&#x27;./UpperCaseDirective&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> typeDefs = gql<span class="string">`</span></span><br><span class="line"><span class="string">  directive @upper on FIELD_DEFINITION</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  type Query &#123;</span></span><br><span class="line"><span class="string">    greeting: String @upper</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> resolvers = &#123;</span><br><span class="line">  <span class="title class_">Query</span>: &#123;</span><br><span class="line">    <span class="attr">greeting</span>: <span class="function">() =&gt;</span> <span class="string">&quot;hello world&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; makeExecutableSchema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;graphql-tools&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> schema = <span class="title function_">makeExecutableSchema</span>(&#123;</span><br><span class="line">  typeDefs,</span><br><span class="line">  resolvers,</span><br><span class="line">  <span class="attr">schemaDirectives</span>: &#123;</span><br><span class="line">    <span class="attr">upper</span>: <span class="title class_">UpperCaseDirective</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = schema;</span><br></pre></td></tr></table></figure><ul><li>客户端使用示例</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">query &#123;</span><br><span class="line">  greeting</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;greeting&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HELLO WORLD&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/GraphQL/">GraphQL</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/88b435e5.html" title="GCP Cloud Digital Leader"><img class="cover" src="https://raw.githubusercontent.com/Hongda-Lin/ImageStore/master/img700px-Dot_scenario_s2_ep1_ch1.png" onerror='onerror=null,src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/404.GIF"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">GCP Cloud Digital Leader</div></div></a></div><div class="next-post pull-right"><a href="/posts/29dadae9.html" title="PostgreSQL 学习笔记"><img class="cover" src="https://raw.githubusercontent.com/Hongda-Lin/ImageStore/master/img700px-Dot_scenario_s1_ep4.png" onerror='onerror=null,src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/404.GIF"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">PostgreSQL 学习笔记</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/德狗子.GIF" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/404.GIF"' alt="avatar"></div><div class="author-info__name">鴻達</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">31</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">16</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Hongda-OSU" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://www.linkedin.com/in/hongda-lin" target="_blank" title="Linkedin"><i class="fab fa-linkedin"></i></a><a class="social-icon" href="https://hongdalin.me" target="_blank" title="Portfolio"><i class="iconfont icon-guanfangwangzhan"></i></a></div></div><script src="https://npm.elemecdn.com/ethan4116-blog/lib/js/other/two-people/twopeople1.js"></script><script src="https://npm.elemecdn.com/ethan4116-blog/lib/js/other/two-people/zdog.dist.js"></script><script id="rendered-js" src="https://npm.elemecdn.com/ethan4116-blog/lib/js/other/two-people/twopeople.js"></script><style>.card-widget.card-announcement{margin:0;align-items:center;justify-content:center;text-align:center}canvas{display:block;margin:0 auto;cursor:move}</style><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GraphQL%E5%9F%BA%E7%A1%80"><span class="toc-text">GraphQL基础</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BB%80%E4%B9%88%E6%98%AFGraphQL"><span class="toc-text">1. 什么是GraphQL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8GraphQL"><span class="toc-text">为什么使用GraphQL</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%8EREST%E7%9A%84%E5%AF%B9%E6%AF%94"><span class="toc-text">与REST的对比</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AD%97%E6%AE%B5Fields"><span class="toc-text">2. 字段Fields</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AD%97%E6%AE%B5%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%AE%9A%E4%B9%89"><span class="toc-text">字段的基本定义</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%9F%A5%E8%AF%A2%E7%A4%BA%E4%BE%8B"><span class="toc-text">客户端查询示例</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFSchema"><span class="toc-text">什么是Schema</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90%E5%99%A8Resolver"><span class="toc-text">解析器Resolver</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%8F%82%E6%95%B0Arguments"><span class="toc-text">3. 参数Arguments</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-text">参数的定义</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90%E5%99%A8%E4%B8%AD%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-text">解析器中的参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%9F%A5%E8%AF%A2"><span class="toc-text">客户端查询</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Mutation%E4%B8%AD%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-text">Mutation中的参数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GraphQL%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD"><span class="toc-text">GraphQL核心功能</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%88%AB%E5%90%8DAliases"><span class="toc-text">4. 别名Aliases</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%81%BF%E5%85%8D%E5%91%BD%E5%90%8D%E5%86%B2%E7%AA%81"><span class="toc-text">避免命名冲突</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%93%8D%E5%BA%94%E6%A0%BC%E5%BC%8F"><span class="toc-text">定义响应格式</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E7%89%87%E6%AE%B5Fragments"><span class="toc-text">5. 片段Fragments</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%89%87%E6%AE%B5%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="toc-text">片段的语法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%89%87%E6%AE%B5%E7%9A%84%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-text">片段的使用示例</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B5%8C%E5%A5%97%E7%89%87%E6%AE%B5"><span class="toc-text">嵌套片段</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%86%85%E8%81%94%E7%89%87%E6%AE%B5"><span class="toc-text">内联片段</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E6%93%8D%E4%BD%9C%E5%90%8D%E7%A7%B0"><span class="toc-text">6. 操作名称</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%90%8D%E7%A7%B0%E7%89%B9%E7%82%B9"><span class="toc-text">操作名称特点</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%90%8D%E7%A7%B0%E7%A4%BA%E4%BE%8B"><span class="toc-text">操作名称示例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E6%93%8D%E4%BD%9C%E7%B1%BB%E5%9E%8B"><span class="toc-text">7. 操作类型</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%B1%BB%E5%9E%8B%E4%BB%8B%E7%BB%8D"><span class="toc-text">操作类型介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E6%93%8D%E4%BD%9C%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-text">三种操作类型的比较</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E6%9F%A5%E8%AF%A2Query"><span class="toc-text">8. 查询Query</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-text">查询的定义</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%A7%A3%E6%9E%90%E5%99%A8Resolver"><span class="toc-text">查询解析器Resolver</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-text">查询的特点</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E5%8F%98%E6%9B%B4Mutations"><span class="toc-text">9. 变更Mutations</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%98%E6%9B%B4%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-text">变更的定义</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%98%E6%9B%B4%E7%9A%84%E8%A7%A3%E6%9E%90%E5%99%A8"><span class="toc-text">变更的解析器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%98%E6%9B%B4%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">变更的使用</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-%E8%AE%A2%E9%98%85Subscription"><span class="toc-text">10. 订阅Subscription</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%A2%E9%98%85%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-text">订阅的工作原理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%A2%E9%98%85%E7%A4%BA%E4%BE%8B"><span class="toc-text">订阅示例</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Apollo-Client%E8%AE%A2%E9%98%85"><span class="toc-text">Apollo Client订阅</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GraphQL%E8%BF%9B%E9%98%B6"><span class="toc-text">GraphQL进阶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#11-%E5%8F%98%E9%87%8F-Variables"><span class="toc-text">11. 变量 Variables</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E5%AE%9A%E4%B9%89%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-text">变量的定义与使用</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-%E6%8C%87%E4%BB%A4-Directives"><span class="toc-text">12. 指令 Directives</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E6%8C%87%E4%BB%A4"><span class="toc-text">内置指令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4"><span class="toc-text">自定义指令</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/c888933a.html" title="Web 拦截"><img src="https://raw.githubusercontent.com/Hongda-Lin/ImageStore/master/image/1100px-Event_top_01.png" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/404.GIF"' alt="Web 拦截"></a><div class="content"><a class="title" href="/posts/c888933a.html" title="Web 拦截">Web 拦截</a><time datetime="2025-06-15T17:03:05.000Z" title="发表于 2025-06-15 12:03:05">2025-06-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/50096d59.html" title="AWS MLA-C01"><img src="https://raw.githubusercontent.com/Hongda-Lin/ImageStore/master/image/700px-卡冈图雅-像素.png" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/404.GIF"' alt="AWS MLA-C01"></a><div class="content"><a class="title" href="/posts/50096d59.html" title="AWS MLA-C01">AWS MLA-C01</a><time datetime="2025-06-14T17:03:05.000Z" title="发表于 2025-06-14 12:03:05">2025-06-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/998b6089.html" title="JS &amp; Python 小技巧"><img src="https://raw.githubusercontent.com/Hongda-Lin/ImageStore/master/image/700px-荷赛拉大战-机械淘淘宣传图.png" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/404.GIF"' alt="JS &amp; Python 小技巧"></a><div class="content"><a class="title" href="/posts/998b6089.html" title="JS &amp; Python 小技巧">JS &amp; Python 小技巧</a><time datetime="2025-06-14T17:03:05.000Z" title="发表于 2025-06-14 12:03:05">2025-06-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/3f28c94.html" title="GCP 实操练习"><img src="https://raw.githubusercontent.com/Hongda-Lin/ImageStore/master/imgf46582az111imog7tayrkhdegi73sg9.png" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/404.GIF"' alt="GCP 实操练习"></a><div class="content"><a class="title" href="/posts/3f28c94.html" title="GCP 实操练习">GCP 实操练习</a><time datetime="2025-06-13T17:03:05.000Z" title="发表于 2025-06-13 12:03:05">2025-06-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/733301f0.html" title="System Design 101"><img src="https://raw.githubusercontent.com/Hongda-Lin/ImageStore/master/img5r931hxtc55u09sm6oxjl3b0bp0v1z6.png" onerror='this.onerror=null,this.src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/404.GIF"' alt="System Design 101"></a><div class="content"><a class="title" href="/posts/733301f0.html" title="System Design 101">System Design 101</a><time datetime="2025-06-13T17:03:05.000Z" title="发表于 2025-06-13 12:03:05">2025-06-13</time></div></div></div></div></div></div></main><footer id="footer" style="background:rgba(0,0,0,.25)"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2025 &nbsp;<i id="heartbeat" class="fa fas fa-heartbeat"></i> &nbsp;鴻達</div><div class="footer_custom_text"><p class="badge"><a style="margin-inline:5px" target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-informational?style=flat&logo=hexo"></a><a style="margin-inline:5px" target="_blank" href="https://domains.google/"><img src="https://img.shields.io/badge/Hosted-Google-ff69b4?style=flat&logo=googledomains"></a><a style="margin-inline:5px" target="_blank" href="https://gulpjs.com/"><img src="https://img.shields.io/badge/Compress-gulp-critical?style=flat&logo=gulp"></a><a style="margin-inline:5px" target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr"></a><a style="margin-inline:5px" target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-black?style=flat&logo=GitHub"></a><a style="margin-inline:5px" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris"></a></p></div></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js").then((()=>{pangu.autoSpacingPage()}))}function panguInit(){GLOBAL_CONFIG_SITE.isPost&&panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script defer src="/js/util.js"></script><script defer src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script disable-devtool-auto src="https://cdn.jsdelivr.net/npm/disable-devtool"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(window.tocScrollFn&&window.removeEventListener("scroll",window.tocScrollFn),window.scrollCollect&&window.removeEventListener("scroll",scrollCollect),document.getElementById("rightside").style.cssText="opacity: ''; transform: ''",window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>