<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>éŸ³ä¹ ğŸ‘¾</title>
      <link href="/posts/b7fb4495.html"/>
      <url>/posts/b7fb4495.html</url>
      
        <content type="html"><![CDATA[<iframe width="600" height="315" src="https://www.youtube.com/embed/UHVrBQdZ7b0?si=8TeKLhWUcuddzCQc" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CSS å­¦ä¹ ç¬”è®°</title>
      <link href="/posts/eb0c992c.html"/>
      <url>/posts/eb0c992c.html</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><blockquote></blockquote><hr><h3 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h3><blockquote><p>æ–‡ä»¶è¿˜æœªä¸Šä¼  Github</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è€ƒè¯ï¼šAWS DVA-C02</title>
      <link href="/posts/31e3742d.html"/>
      <url>/posts/31e3742d.html</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><blockquote><ul><li>å®˜ç½‘: <a href="https://aws.amazon.com/certification/certified-developer-associate/">https://aws.amazon.com/certification/certified-developer-associate/</a></li><li>ç½‘è¯¾ï¼š<a href="https://www.udemy.com/course/aws-certified-developer-associate-dva-c01/">https://www.udemy.com/course/aws-certified-developer-associate-dva-c01/</a></li><li>é¢˜åº“: <a href="https://www.udemy.com/course/aws-certified-developer-associate-practice-tests-dva-c01/">https://www.udemy.com/course/aws-certified-developer-associate-practice-tests-dva-c01/</a></li><li>é¢˜åº“: <a href="https://www.examtopics.com/exams/amazon/aws-certified-developer-associate-dva-c02/view/">https://www.examtopics.com/exams/amazon/aws-certified-developer-associate-dva-c02/view/</a></li><li>å‡†å¤‡æ—¶é—´: 3 æœˆ 30 å·å‡†å¤‡, 6 æœˆ 26 å·è€ƒè¯• (å› ä¸ºä¸­é—´è¦ä¸Šè¯¾)</li></ul></blockquote><hr><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><h3 id="1-AWS-Cloud-Overview"><a href="#1-AWS-Cloud-Overview" class="headerlink" title="1. AWS Cloud Overview"></a>1. AWS Cloud Overview</h3><h4 id="AWS-Regions"><a href="#AWS-Regions" class="headerlink" title="AWS Regions"></a>AWS Regions</h4><ul><li>A Region is a cluster of data centers</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img231130.png"></p><ul><li>To reuse SSH keys in AWS Region<ul><li>Generate a public SSH key from the private SSH key. Import the key to each AWS Region</li></ul></li></ul><hr><h4 id="AWS-Availability-Zone"><a href="#AWS-Availability-Zone" class="headerlink" title="AWS Availability Zone"></a>AWS Availability Zone</h4><ul><li>ä¸€ä¸ª Region å¯ä»¥æœ‰ 3 - 6 ä¸ª AZ, æ¯ä¸ª AZ éƒ½æ˜¯åˆ†å¼€çš„</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img140727.png"></p><hr><h4 id="AWS-Edge-Locations"><a href="#AWS-Edge-Locations" class="headerlink" title="AWS Edge Locations"></a>AWS Edge Locations</h4><ul><li>Deliver content to user with low latency (ç¦»ç”¨æˆ·è¶Šè¿‘, deliver é€Ÿåº¦è¶Šå¿«)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img140903.png"></p><hr><h3 id="2-IAM"><a href="#2-IAM" class="headerlink" title="2. IAM"></a>2. IAM</h3><h4 id="AWS-IAM"><a href="#AWS-IAM" class="headerlink" title="AWS IAM"></a>AWS IAM</h4><ul><li>Root Account: Created by default, donâ€™t share with others</li><li>Users: People within the organization</li><li>Groups: Only contain Users, not other Groups (User å¯ä»¥å±äºå¤šä¸ª Group)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img145736.png"></p><ul><li>AWS éœ€è¦è‡³å°‘ 5 weeks æ¥ç”Ÿæˆ budget forecasts</li><li>æ³¨æ„, User é»˜è®¤æ— æ³• access AWS Billing and Cost Management console, å¿…é¡»è¦ grant access æ‰è¡Œ</li></ul><hr><h4 id="IAM-Permissions"><a href="#IAM-Permissions" class="headerlink" title="IAM Permissions"></a>IAM Permissions</h4><ul><li>å®šä¹‰äº† User æˆ–è€… Group çš„ Permissions<ul><li>è¦éµå®ˆ Least Privilege Principle</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img160124.png"></p><blockquote><p>As an AWS security best practice, you should not create an IAM user and pass the userâ€™s credentials to the application or embed the credentials in the application</p></blockquote><hr><h4 id="IAM-Polices"><a href="#IAM-Polices" class="headerlink" title="IAM Polices"></a>IAM Polices</h4><ul><li>Statements é‡Œé¢å¿…é¡»åŒ…å«: Effect, Principal, Action, Resource<ul><li>Inline Policy æ˜¯ assign ç»™ä¸ªäººçš„</li></ul></li><li>æ³¨æ„, The only resource-based policy IAM support is Trust policy</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175653.png"></p><blockquote><p>IAM policies define permissions for an action regardless of the method that used to perform the operation.</p></blockquote><hr><h4 id="IAM-MFA"><a href="#IAM-MFA" class="headerlink" title="IAM MFA"></a>IAM MFA</h4><ul><li>Protect Root Accounts and IAM Users</li><li>MFA options: Virtual MFA Device, U2F Sercurity Key (USB)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img180624.png"></p><hr><h4 id="IAM-CLI-amp-SDK"><a href="#IAM-CLI-amp-SDK" class="headerlink" title="IAM CLI &amp; SDK"></a>IAM CLI &amp; SDK</h4><ul><li>å¯ä»¥ç”¨ AWS Management Console, AWS CLI, AWS SDK æ¥è®¿é—® AWS<ul><li>Set the <code>DeleteOnTermination</code> attribute to False using the command line</li><li>å¦‚æœè€ƒè¯•é‡åˆ°ä¸ä¼šçš„å°±é€‰ CLI</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img193342.png"></p><hr><h4 id="IAM-Roles"><a href="#IAM-Roles" class="headerlink" title="IAM Roles"></a>IAM Roles</h4><ul><li>æˆæƒ AWS æœåŠ¡å»åšæŸäº›äº‹</li><li>å¸¸è§çš„ Role: EC2 Instance Role, Lambda Function Role ç­‰ç­‰</li><li>IAM Instance Role: ä¸º EC2 å®ä¾‹åˆ†é… temporary credentialsï¼Œä»¥ä¾¿å®ä¾‹èƒ½å¤Ÿå®‰å…¨åœ°è®¿é—®å…¶ä»– AWS æœåŠ¡</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203306.png"></p><blockquote><p>An IAM entity that defines a set of permissions for making requests to AWS services, and will be used by an AWS service</p></blockquote><hr><h4 id="IAM-Security-Tools"><a href="#IAM-Security-Tools" class="headerlink" title="IAM Security Tools"></a>IAM Security Tools</h4><ul><li>IAM Credentials Report: è¿”å›ç”¨æˆ·æ•°æ®å’Œ credentials</li><li>IAM Access Advisor: æ˜¾ç¤ºå½“å‰ç”¨æˆ·è¢«æˆæƒçš„æœåŠ¡å’Œä½¿ç”¨æ—¶é—´</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203553.png"></p><hr><h3 id="3-EC2-Fundamentals"><a href="#3-EC2-Fundamentals" class="headerlink" title="3. EC2 Fundamentals"></a>3. EC2 Fundamentals</h3><h4 id="AWS-EC2"><a href="#AWS-EC2" class="headerlink" title="AWS EC2"></a>AWS EC2</h4><ul><li>EC2 &#x3D; Elastic Compute Cloud &#x3D; IaaS , ç»‘å®š AZ</li><li>SSH åˆ° EC2 Instance çš„ Public IP (è®°ä½ 169, meta-data)<ul><li><code>http://169.254.169.254/latest/meta-data/public-ipv4</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img214749.png"></p><ul><li>User Data: EC2 å¯åŠ¨çš„æ—¶å€™è¿è¡Œçš„ä»£ç <ul><li>By default, user data runs only during boot cycle when first lauch instance</li><li>By default, scripts entered as user data are executed with root user privileges</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img214956.png"></p><ul><li>å¦‚æœè¦ monitor ä¸€ä¸ª EC2 Instance, <code>aws ec2 monitor-instances --instance-ids &#123;id&#125;</code></li></ul><hr><h4 id="EC2-Instance-Type"><a href="#EC2-Instance-Type" class="headerlink" title="EC2 Instance Type"></a>EC2 Instance Type</h4><ul><li>ä¸€å…± 7 ç§ EC2 Instance Type, ä½† 4 ç§ç”¨çš„æœ€å¤š<ul><li>General Purpose: Balanced (å¹³è¡¡çš„)</li><li>Compute Optimized: High performance (å¤„ç† Batch, è§†é¢‘å’Œ HPC)</li><li>Memory Optimized: Process data in memory (å¤„ç† cache)</li><li>Storage Optimized: Read and write data on local storage (OLTP)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img220941.png"></p><hr><h4 id="EC2-Security-Groups"><a href="#EC2-Security-Groups" class="headerlink" title="EC2 Security Groups"></a>EC2 Security Groups</h4><ul><li>Control how traffic is allowed in and out of EC2 instance<ul><li>Security groups only contain allow rules (EC2 å‡ºé—®é¢˜ä¼˜å…ˆæ£€æŸ¥ Security Group)</li></ul></li><li>å¯ä»¥ä½œä¸º Security Group çš„ Inbound Rule æœ‰ IP address, CIDR block, Security Group</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img222531.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223020.png"></p><hr><h4 id="EC2-Instance-Purchasing-Options"><a href="#EC2-Instance-Purchasing-Options" class="headerlink" title="EC2 Instance Purchasing Options"></a>EC2 Instance Purchasing Options</h4><ul><li>On-Demand Intances: Short workload, pay by second (çŸ­æœŸå†…ç´§æ€¥ä½¿ç”¨)</li><li>Reserved: 1 - 3 years (72% discount, reserve capacity in an AZ)<ul><li>Reserved Instance: Long workload (1 - 3 å¹´, discount éšå¹´ä»½å¢åŠ )</li><li>Convertible Reserved Instances (RI): Long workload with flexible instance (66% discount, ä½†æ˜¯å¯ä»¥è‡ªç”±æ”¹å˜ Instance Type)</li></ul></li><li>Saving Plans: 1 - 3 years, commitment to an amount of usage (72% discount, è¦å®šä¸€ä¸ªä½¿ç”¨ä¸Šé™, è¶…è¿‡ä¸Šé™å°±å˜æˆ On-Demand)<ul><li>è¿˜æœ‰ Compute Saving Plan, 66% discount, work with Lambda and Fargate</li></ul></li><li>Spot Instance: Short workload, can lose instance (æœ€ä¾¿å®œ, 90% discount)</li><li>Dedicated Host: The physical server is yours (æœ€è´µ, å¯ä»¥æ§åˆ¶ how Instance placed)</li><li>Dedicated Instance: Run hardware, but not lockdown to you (æœåŠ¡å™¨å¤§éƒ¨åˆ†æ˜¯ä½ çš„)</li><li>Capacity Reservation: Reserve capacity in AZ (æ¯”å¦‚ä¸€å¤©ä¸­åªæœ‰å‡ ä¸ªå°æ—¶éœ€è¦ EC2)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img224149.png"></p><ul><li>Reserved Instance æœ‰ Regional å’Œ Zonal, Zonal æä¾› capacity reservation, Regional ä¸æä¾›</li></ul><hr><h3 id="4-EC2-Instance-Storage"><a href="#4-EC2-Instance-Storage" class="headerlink" title="4. EC2 Instance Storage"></a>4. EC2 Instance Storage</h3><h4 id="AWS-EBS"><a href="#AWS-EBS" class="headerlink" title="AWS EBS"></a>AWS EBS</h4><ul><li>Block-level storage, ç±»ä¼¼ network drive, ç»‘å®š AZ, provisioned capacity<ul><li>å¯ä»¥ä»ä¸€ä¸ª EC2 Instance å–ä¸‹æ¥è£…åˆ°å¦ä¸€ä¸ªä¸Š</li><li>è®°ä½ EBS æ˜¯ç»‘å®š AZ çš„, å¾ˆé‡è¦</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img191440.png"></p><ul><li>EBS - Delete on Termination attribute<ul><li>By default, Root Volume will be deleted on termination (é‡è¦)</li><li>By default, other EBS volume will not be deleted on termination (é‡è¦)</li><li>Can be controled by AWS console &#x2F; AWS CLI</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img002840.png"></p><hr><h4 id="EBS-Snapshots"><a href="#EBS-Snapshots" class="headerlink" title="EBS Snapshots"></a>EBS Snapshots</h4><ul><li>Make a backup of EBS volume (å¤‡ä»½ EBS)<ul><li>å¯ä»¥å°†è¿™ä¸ª snapshot ç”¨åœ¨å…¶ä»– AZ æˆ–è€… Region ä¸Š</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img195715.png"></p><ul><li>EBS Snapchot Archive: ä¾¿å®œ 75%</li><li>Recycle Bin: Setup rules to retain deleted snapshots (å¯ä»¥ recover)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img195833.png"></p><hr><h4 id="AWS-AMI"><a href="#AWS-AMI" class="headerlink" title="AWS AMI"></a>AWS AMI</h4><ul><li>AMI: Amazon Machine Image, customization of an EC2 Instance<ul><li>å¯ä»¥æ›´å¥½çš„ç®¡ç†å’Œå¯åŠ¨ EC2 Instance</li></ul></li><li>Built for a specific region and can copy across regions (AMI è·¨åŸŸå¤åˆ¶)<ul><li>æ³¨æ„, AMIs are built for a specific AWS Region</li></ul></li></ul><blockquote><p>When the new AMI is copied from Region A into Region B, it automatically creates a snapshot in Region B (æ³¨æ„, è·¨åŸŸ copy AMI ä¼šäº§ç”Ÿ snapshot)</p></blockquote><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200249.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200341.png"></p><hr><h4 id="EC2-Instance-Store"><a href="#EC2-Instance-Store" class="headerlink" title="EC2 Instance Store"></a>EC2 Instance Store</h4><ul><li>Block-level storage, ç‰©ç†ç¡¬ç›˜ (Physical drive, temporary storage, å¯ä»¥å¤„ç†æ•°æ®åº“)</li><li>High random I&#x2F;O performance, good for cache at low cost (é‡è¦)</li><li>EC2 Instance Store lose when stopped (Ephemeral, æ•°æ®åœ¨ Instance Store å…³é—­æ—¶æ¶ˆå¤±)<ul><li>åæ­£è®°ä½, Instance Store ä¸èƒ½å¤ç”¨, Instance Store é‡Œçš„æ•°æ®ä¸ä¼š preserve</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203146.png"></p><hr><h4 id="EBS-Volume-Types"><a href="#EBS-Volume-Types" class="headerlink" title="EBS Volume Types"></a>EBS Volume Types</h4><ul><li>General Purpose (gp2 &#x2F; gp3): Balanced, cost-effective</li><li>Provisioned IOPS (io1 &#x2F; io2): High-performance, support Multi-Attach<ul><li>Low latency, high throughput</li><li>è®°ä½, io çš„æ¯” gp çš„è´µ, ä½†æ˜¯ io çš„ IOPS ä¹Ÿæ¯” gp é«˜</li><li>gp2 çš„ max IOPS æ˜¯ 5.3 TiB</li></ul></li><li>Hard Disk Drives (HDD): Data intensive (st1) æˆ–è€… less frequent access (sc1)<ul><li>HDD ä¸å¯ä»¥ç”¨æ¥åˆ›å»º EC2</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203437.png"></p><hr><h4 id="EBS-Multi-Attach"><a href="#EBS-Multi-Attach" class="headerlink" title="EBS Multi-Attach"></a>EBS Multi-Attach</h4><ul><li>Attach same EBS volume to multiple EC2 instance in same AZ (è®°ä½æ˜¯ç›¸åŒçš„ AZ)</li><li>Only for io1 &#x2F; io2 family (Provisioned IOPS SSD, é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203956.png"></p><hr><h4 id="EBS-RAID"><a href="#EBS-RAID" class="headerlink" title="EBS RAID"></a>EBS RAID</h4><ul><li>RAID 0 (çœ‹é‡ I&#x2F;O performance)<ul><li>Use RAID 0 when I&#x2F;O performance is more important than fault tolerance</li><li>å¯ä»¥ç”¨æ¥æé«˜ EBS volume çš„ performance</li></ul></li><li>RAID 1 (çœ‹é‡ falut tolerance)<ul><li>Use RAID 1 when fault tolerance is more important than I&#x2F;O performance</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/imgpt6-q37-i1.jpg"></p><hr><h4 id="AWS-EFS"><a href="#AWS-EFS" class="headerlink" title="AWS EFS"></a>AWS EFS</h4><ul><li>NFS (network file system), å¯ä»¥ mount åˆ°å¤šä¸ª EC2 Instance<ul><li>Scale automatically, highly availiable, no capacity planning</li></ul></li><li>EC2 Instances can access files on an EFS file system across AZs, Regions and VPCs<ul><li>é‡è¦, å¯ä»¥ä»ä¸åŒçš„ AZ, Region, VPC æ¥ access</li><li>å¯ä»¥ç”¨ VPC Security Group æˆ–è€… IAM Policy æ¥ control access to EFS</li></ul></li><li>EFS Infrequent Access (å¦‚æœé‡åˆ° POSIX compliant file storage)<ul><li>å› ä¸º EFS åªèƒ½å’Œ Linux Instance (POSIX) ä¸€èµ·ç”¨, Windows ä¸è¡Œ</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233415.png"></p><ul><li>EFS æœ‰ 2 ç§ Performance Mode (set at EFS creation time)<ul><li>General Purpose: Default (web server)</li><li>Max I&#x2F;O: High latency, throughput, parallel (big data, media process)</li></ul></li><li>EFS æœ‰ 3 ç§ Throughput Mode (é‡è¦)<ul><li>Bursting: å¾ˆå¿«</li><li>Provisioned: è®¾ç½®ä¸Šé™ (high throughput, å¤„ç†å¤§é‡æ–‡ä»¶ migrate æ—¶å€™ä½¿ç”¨)</li><li>Elastic: æ ¹æ® workload æ¥ scale</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233732.png"></p><blockquote><p>EFS å¹¶ä¸æ˜¯æ°¸è¿œæœ€è´µçš„, ä½† S3 æ°¸è¿œæ˜¯æœ€ä¾¿å®œçš„ã€‚<br>åœ¨æ€§èƒ½æ–¹é¢ï¼ŒAWS EBS ç”±äºå¯ä»¥æä¾›é«˜ IOPSï¼Œé€Ÿåº¦æœ€å¿«ã€‚ä½†æ˜¯åœ¨å…±äº«å’Œå¯å¼¹æ€§ä¼¸ç¼©çš„æ–‡ä»¶ç³»ç»Ÿæ–¹é¢ï¼ŒAWS EFS æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚</p></blockquote><hr><h3 id="5-ELB-amp-ASG"><a href="#5-ELB-amp-ASG" class="headerlink" title="5. ELB &amp; ASG"></a>5. ELB &amp; ASG</h3><h4 id="Scalability-amp-High-Availability"><a href="#Scalability-amp-High-Availability" class="headerlink" title="Scalability &amp; High Availability"></a>Scalability &amp; High Availability</h4><ul><li>Vertical (ç«–ç›´) Scale: Increase the size of the Instance (å¢åŠ å¤§å°)</li><li>Horizontal (æ°´å¹³) Scale: Increase the number of the Instance (å¢åŠ æ•°é‡)</li><li>High Availability: Running application in at least 2 AZ (Disaster recovery, é‡è¦)</li></ul><hr><h4 id="AWS-ELB"><a href="#AWS-ELB" class="headerlink" title="AWS ELB"></a>AWS ELB</h4><ul><li>Foward traffic to multiple EC2 Instances (æµé‡æ§åˆ¶)<ul><li>High availability across AZs, handle failures of downstream instances</li></ul></li><li>Health Check: å¯ä»¥çŸ¥é“ EC2 Instance æ˜¯å¦æ˜¯ Healthy çš„<ul><li>ELB åœ¨ public subnet, ASG åœ¨ private subnet (é‡è¦)</li></ul></li><li>ELB cannot distribute traffic for targets deployed in different region</li><li>ä½¿ç”¨ ELB çš„åŸå› , æœ‰ 2 ç‚¹<ul><li>Separate public traffic from private traffic</li><li>Build a highly available system</li></ul></li><li>Elastic Load Balancing use ports <code>1024-65535</code></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img141400.png"></p><ul><li>Application Load Balancer (HTTP &#x2F; HTTPS, Layer 7)</li><li>Network Load Balancer (TCP &#x2F; UDP, Layer 4)<ul><li>NLB provide static DNS and static IP, ALB only provide static DNS</li></ul></li><li>Gateway Load Balancer (Security, Layer 3, è¦ç‰¹åˆ«æ³¨æ„)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img090125.png"></p><ul><li>å¦‚æœé—®åˆ° ELB route traffic åˆ°ä¸€ä¸ª instance æˆ–è€… AZ æ›´å¤š, æœ‰ 2 ç§å¯èƒ½æ€§<ul><li>Instances of a specific capacity type arenâ€™t equally distributed across AZ</li><li>Sticky sessions are enabled for the load balancer</li></ul></li></ul><hr><h4 id="Application-Load-Balancer-ALB"><a href="#Application-Load-Balancer-ALB" class="headerlink" title="Application Load Balancer (ALB)"></a>Application Load Balancer (ALB)</h4><ul><li>Deal with Layer 7 (HTTP &#x2F; HTTPS, WebSocket)</li><li>Route base on Path <code>/Home</code> or Query <code>?Platform=Mobile</code></li><li>ALB adds an additional header called <code>X-Forwarded-For</code> contains the clientâ€™s IP</li><li>å¯ä»¥ configure ALB to redirect HTTP to HTTPS (é‡è¦)</li><li>ALB æ— æ³•è¢« assign Elstaic IP, NLB å¯ä»¥</li><li>å¦‚æœ ALB æ²¡æœ‰ register ä»»ä½• target, ä¼šé€ æˆ <code>HTTP 503: Service unavailable</code></li><li>å¯ä»¥ä½¿ç”¨ ALB access logs æ¥ analyze incoming requests for latencies and IP address</li><li>You cannot specify publicly routable IP addresses to an ALB</li><li>An ALB has three possible target types: Instance, IP, and Lambda</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192523.png"></p><ul><li>Routing tables to different target groups<ul><li>Route based on path in URL</li><li>Route based on hostname in URL</li><li>Route based on Query String, Headers, Client IP</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img142631.png"></p><blockquote><p>To forward all requests to the website so that the requests will use HTTPS, a solutions architect can create a listener rule on the ALB that redirects HTTP traffic to HTTPS. </p></blockquote><hr><h4 id="Network-Load-Balancer-NLB"><a href="#Network-Load-Balancer-NLB" class="headerlink" title="Network Load Balancer (NLB)"></a>Network Load Balancer (NLB)</h4><ul><li>Deal with Layer 4 (TCP &#x2F; UDP), å¾ˆå¿«, å¤„ç†æœ‰å¤§é‡ request çš„æƒ…å†µ (æ¯”å¦‚é“¶è¡Œå’Œæ¸¸æˆ)<ul><li>NLB best suited for use-cases involving low latency and high throughput workloads</li></ul></li><li>One static IP per AZ or use Elastic IP</li><li>NLB supports HTTP health checks as well as TCP and HTTPS</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img144359.png"></p><blockquote><p>If you specify targets using an instance ID, traffic is routed to instances using the primary private IP address specified in the primary network interface for the instance.</p></blockquote><hr><h4 id="Gateway-Load-Balancer-GWLB"><a href="#Gateway-Load-Balancer-GWLB" class="headerlink" title="Gateway Load Balancer (GWLB)"></a>Gateway Load Balancer (GWLB)</h4><ul><li>Deal with Layer 3 (Security, 3rd Party)</li><li>GWLB allows perform inline inspection of traffic from multiple spoke VPCs in a simplified and scalable fashion</li><li>Use GENEVE protocol on port 6081</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223042.png"></p><hr><h4 id="Sticky-Sessions-Session-Affinity"><a href="#Sticky-Sessions-Session-Affinity" class="headerlink" title="Sticky Sessions (Session Affinity)"></a>Sticky Sessions (Session Affinity)</h4><ul><li>Same client is always redirect to the same instance behind a load balancer</li><li>Make sure user doesnâ€™t loss session data (æ¯”å¦‚ç”¨æˆ·ç™»å½•)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223425.png"></p><ul><li>Application-based Cookies: Donâ€™t use AWSALB, AWSALBAPP, AWSALBTG</li><li>Duration-based Cookies: AWSALB for ALB, AWSELB for CLB</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223604.png"></p><hr><h4 id="Cross-Zone-Load-Balancing"><a href="#Cross-Zone-Load-Balancing" class="headerlink" title="Cross Zone Load Balancing"></a>Cross Zone Load Balancing</h4><ul><li>ELB distributes traffic evenly across all registered EC2 instances in all AZs<ul><li>æ‰€æœ‰ Instance åˆ†åˆ°çš„ traffic ä¸€å®šæ˜¯ä¸€æ ·çš„</li><li>å¦‚æœæ²¡æœ‰ enable, é‚£ä¹ˆ AZ å†…éƒ¨å°±æ˜¯å¹³å‡åˆ†</li></ul></li><li>ALB enabled by default, NLB disabled by default (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230059.png"></p><hr><h4 id="SSL-Certificates"><a href="#SSL-Certificates" class="headerlink" title="SSL Certificates"></a>SSL Certificates</h4><ul><li>Allow traffic between client and load balancer encrypted in transit (HTTPS)<ul><li>Manage SSL certificates using ACM (AWS Certificate Manager)</li></ul></li><li>å¦‚æœé—®åˆ°éœ€è¦ç®¡ç†å¾ˆå¤šä¸ª SSL æˆ–è€… TSL, é€‰æ‹© SNI (é‡è¦)</li><li>ç”¨æ¥ deploy SSL&#x2F;TLS çš„ AWS æœåŠ¡æ˜¯ AWS Certificate Manger å’Œ IAM (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230614.png"></p><ul><li>Could be used in ALB &amp; NLB, use SNI to make it work</li><li>SNI: Load multiple SSL certificates onto one web server (Server Name Indication)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230910.png"></p><blockquote><p>Server Name Indication (SNI) allows you to expose multiple HTTPS applications each with its own SSL certificate on the same listener. </p></blockquote><hr><h4 id="Deregistration-Delay-Connection-Draining"><a href="#Deregistration-Delay-Connection-Draining" class="headerlink" title="Deregistration Delay (Connection Draining)"></a>Deregistration Delay (Connection Draining)</h4><ul><li>Waiting for existing connections to complete</li><li>Connection Draining enables the load balancer to complete in-flight requests made to instances that are de-registering or unhealthy</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img231418.png"></p><hr><h4 id="AWS-ASG"><a href="#AWS-ASG" class="headerlink" title="AWS ASG"></a>AWS ASG</h4><ul><li>ASG å¯ä»¥å’Œ ELB ä¸€èµ·ç”¨, æ¥ scale in æˆ–è€… out åŸºäºæœåŠ¡å™¨å‹åŠ› (ASG æ˜¯å…è´¹çš„)</li><li>ASG å¯ä»¥ä¿è¯æœ€å°‘æˆ–æœ€å¤šæœ‰å¤šå°‘ EC2 Instance åœ¨å·¥ä½œ (min, max)<ul><li>ASG æ˜¯åœ¨ä¸€ä¸ª Region é‡Œé¢å»æ ¹æ® availiable çš„ AZ è¿›è¡Œ scale</li><li>ASG æ²¡æœ‰åŠæ³• span across multiple Regions</li></ul></li><li>å½“ä¸€ä¸ª Instance æ˜¯ unhealthy çš„æ—¶å€™, ASG ä¼š terminate è¿™ä¸ª Instance<ul><li>ASG åœ¨ä¸€ä¸ª AZ é‡Œæœ€æ—© terminate çš„æ˜¯é‚£ä¸ªæœ€æ—©è¢« launch çš„ Instance</li><li>é‡åˆ° unbalanced çš„æƒ…å†µ, ASG æ˜¯å…ˆ launch new instance ç„¶å terminate old instance</li><li>åœ¨ unhealthy çš„æƒ…å†µä¸‹æ˜¯å…ˆ terminate unhealth Instance ç„¶å create new instance</li></ul></li><li>å¦‚æœé—®åˆ°åœ¨æŸä¸ªèŠ‚æ—¥å‰å» scale, é‚£å°±æ˜¯ ASG Scheduled Action</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232350.png"></p><ul><li>å¯ä»¥å’Œ ELB ä¸€èµ·ç”¨, æ¥ scale out æˆ–è€… in åŸºäºæœåŠ¡å™¨å‹åŠ›</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232615.png"></p><ul><li>Launch Template: å¯ä»¥ä½œä¸º template æ¥ç”Ÿæˆ EC2 Instance<ul><li>Launch Template æ˜¯ç®¡è¦ç”Ÿæˆä»€ä¹ˆ Instance çš„ (eg. Spot, On-Demand)</li><li>Launch Configuration æ˜¯ç®¡ç”Ÿæˆçš„ Instance çš„ä¿¡æ¯çš„ (eg. AMI, security group)</li></ul></li><li>å¦‚æœè¦æ›´æ–° Launch Template, éœ€è¦åˆ æ‰æ—§çš„ç„¶åä½¿ç”¨æ–°çš„ (æ³¨æ„)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232823.png"></p><ul><li>å¯ä»¥å’Œ CloudWatch Alarm ä¸€èµ·æ ¹æ®æœåŠ¡å™¨å‹åŠ› scale out æˆ– scale in<ul><li>éœ€è¦ä¸€ä¸ª CloudWatch custom metric</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232959.png"></p><ul><li>ASG Scaling Cooldowns<ul><li>After a scaling activity, you are in the cooldown period (default 300 seconds)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img025149.png"></p><ul><li>ASG ä¸ terminate Instance çš„æƒ…å†µ<ul><li>The health check grace period for the instance has not expired</li><li>The instance maybe in Impaired status</li><li>The instance has failed the Elastic Load Balancing (ELB) health check status</li></ul></li></ul><hr><h4 id="Scaling-Policies"><a href="#Scaling-Policies" class="headerlink" title="Scaling Policies"></a>Scaling Policies</h4><ul><li>Target Tracking Scaling: æ ¹æ® CPU ç”¨é‡æˆ–è€… SQS é•¿åº¦æ¥ scale</li><li>Simple &#x2F; Step Scaling: å’Œ CloudWatch Alarm å…³è”</li><li>Scheduled Actions: æ¯”å¦‚åœ¨æ„Ÿæ©èŠ‚é‚£å¤©è¿›è¡Œ scale</li><li>Predictive Scaling: Forecast load and schedule scaling ahead</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233532.png"></p><ul><li>æ³¨æ„, å¯¹äº EC2 Scaling Policy æ¥è¯´, ä¸€å®šä¸å¯èƒ½è¶…è¿‡ maximum capacity (é‡è¦)</li></ul><hr><h4 id="ASG-Instance-Refresh"><a href="#ASG-Instance-Refresh" class="headerlink" title="ASG Instance Refresh"></a>ASG Instance Refresh</h4><ul><li>Update launch template and then re-creating all EC2 Instance</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img212220.png"></p><hr><h3 id="6-AWS-Fundamentals"><a href="#6-AWS-Fundamentals" class="headerlink" title="6. AWS Fundamentals"></a>6. AWS Fundamentals</h3><h4 id="AWS-RDS"><a href="#AWS-RDS" class="headerlink" title="AWS RDS"></a>AWS RDS</h4><ul><li>ä½¿ç”¨ RDS çš„å¥½å¤„ (å¯¹æ¯”å°†æ•°æ®åº“å­˜åœ¨ EC2 ä¸Š)<ul><li>Automated provisioning, auto-scaling, backup</li><li>Read Replicas (æœ€å¤š 15 ä¸ª) å’Œ Multi-AZ</li></ul></li><li>RDS Read Replica: If master database is encrypted, the replica is also encrypted<ul><li>æ³¨æ„, Read Replica æé«˜çš„æ˜¯ read, è€Œä¸æ˜¯ scale æ•°æ®åº“çš„ storage (è€Œä¸” Replica è´µ), å¤„ç†ç±»ä¼¼ report æˆ–è€… analytics çš„å°±æ˜¯ Read Replica</li><li>Read Replica ä¸æ˜¯æé«˜ High Availability, Multi-AZ æ‰æ˜¯</li><li>Cross-Region Read Replica: å¯ä»¥ä½œä¸º DB backup (Replica in different Region)</li></ul></li><li>RDS Multi-AZ: RDS create a primary DB Instance and synchronously replicates the data to a standby instance in a different AZ (High Availability)<ul><li>RDS Multi-AZ update æ˜¯ standby å’Œ primary ä¸€èµ· update (ä¼šæœ‰ downtime)</li></ul></li><li>Support MySQL, PostgreSQL, MariaDB, Oracle, MS SQL Server, and Amazon Aurora</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img161720.png"></p><ul><li>RDS - Storage Auto Scaling (é‡è¦)<ul><li>For application with unpredictable workloads</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img161952.png"></p><ul><li>RDS - Disaster Recovery<ul><li>Create a Read Replica in different region and enable Multi-AZ on Read Replica</li></ul></li><li>IAM Database Authentication: å¯ä»¥ç”¨æ¥è®¿é—® RDS</li><li>å¯ä»¥ä» RDS Read Replica è¿ç§»åˆ° Aurora Read Replica, è¿™ä¸ªåšæ³•å¯ä»¥ minimal change<ul><li>æ³¨æ„, è¿™åªé€‚ç”¨äº Read Replica çš„æƒ…å†µä¸‹, æ­£å¸¸æƒ…å†µå°±ç›´æ¥å¼€ auto scaling</li></ul></li><li>RDS OS update æ˜¯å…ˆ update standby, ç„¶åæŠŠ standby promote æˆ primary, ç„¶å update åŸæ¥çš„ primary, æœ€ååŸæ¥çš„ primary å˜æˆæ–°çš„ standby (é‡è¦)</li></ul><hr><h4 id="Read-Replicas-vs-Multi-AZ"><a href="#Read-Replicas-vs-Multi-AZ" class="headerlink" title="Read Replicas vs. Multi AZ"></a>Read Replicas vs. Multi AZ</h4><ul><li>Read Replicas: Scalability, Async Replication<ul><li>Within AZ, Cross AZ or Cross Region</li></ul></li><li>Read Replicas in Same Region is free (Replication in AZs), Cross Region is not free</li><li>You canâ€™t create encrypted Read Replicas from an unencrypted RDS DB instance.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173522.png"></p><ul><li>ç”¨ Production databse å¤„ç†æ—¥å¸¸, ç”¨ Read Replica æ¥å»ºä¸€ä¸ªå‰¯æœ¬å¤„ç†æ•°æ®åˆ†æ</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173820.png"></p><ul><li>Multi AZ: High Availability, Disaster Recovery, Sync Replication<ul><li>åœ¨ Multi-AZ çš„æƒ…å†µä¸‹, å½“ RDS æ•°æ®åº“ goes down, CNAME ä¼šæ›´æ–°æŒ‡å‘ standby</li><li>Multi AZ ä¸éœ€è¦ä½ å»æ›´æ”¹ SQL connection string</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174148.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174357.png"></p><hr><h4 id="AWS-Aurora"><a href="#AWS-Aurora" class="headerlink" title="AWS Aurora"></a>AWS Aurora</h4><ul><li>Support PostgreSQL and MySQL (ä¸éœ€è¦ç®¡ç† storage)</li><li>Aurora æ²¡æœ‰ standby database, Aurora Replica å¯ä»¥ä½œä¸º failover target</li><li>ä¸€èˆ¬æ¥è¯´, Aurora æ¯” RDS å¿«</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img183915.png"></p><ul><li>High Availiability &amp; Read Scaling (Aurora Read Replica)<ul><li>One Master Write, Multiple Read Replicas (Up to 15 Replica), ä¸€å…± 16 ä¸ª</li><li>å¦‚æœé—®åˆ°å’Œ Aurora æœ‰å…³, ä¸”å…³äºå¤„ç†ç½‘ç»œè¯·æ±‚æ¿€å¢çš„é—®é¢˜, é€‰ Aurora Replica</li><li>Replica Tier è¶Šé«˜, failover æ—¶å°±ä¼šå…ˆè¢« promote</li></ul></li><li>å¦‚æœé—®åˆ°å…³äº Aurora çš„ Auto-Scaling, é‚£å°±æ˜¯ Aurora Serverless</li><li>å¦‚æœé—®åˆ° Aurora è€Œä¸”æ˜¯ test database, é€‰æ‹© Aurora Database Cloning</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184105.png"></p><hr><h4 id="RDS-Security"><a href="#RDS-Security" class="headerlink" title="RDS Security"></a>RDS Security</h4><ul><li>At-rest encryption: AWS KMS (Key Management Service)</li><li>In-flight encryption: AWS TLS Certificates</li><li>IAM Authentication: IAM roles to connect to database (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img133048.png"></p><hr><h4 id="RDS-Proxy"><a href="#RDS-Proxy" class="headerlink" title="RDS Proxy"></a>RDS Proxy</h4><ul><li>Have a proxy for access RDS or Aurora, ç¼“è§£æ•°æ®åº“å‹åŠ›, minimize open connections<ul><li>Allow apps to pool and share DB connections (æé«˜ DB efficiency)</li><li>Reduced RDS &amp; Aurora failover time by up 66% (é‡è¦)</li><li>Enforce IAM authentication for DB</li></ul></li><li>Serverless, auto scaling, highly avaliable (Multi-AZ)</li><li>Not publicly accessible (Need to use VPC)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184531.png"></p><hr><h4 id="AWS-ElastiCache"><a href="#AWS-ElastiCache" class="headerlink" title="AWS ElastiCache"></a>AWS ElastiCache</h4><ul><li>Manage Redis or Memcached (ElastiCache å¯ä»¥è§£å†³æ•°æ®åº“é«˜é¢‘è¯»å–çš„é—®é¢˜, é‡è¦)<ul><li>ElastiCache ä¸æ”¯æŒ relational database, ä¹Ÿä¸èƒ½ç”¨ SQL queries</li></ul></li><li>Cache are in-memory database with high performance and low latency (compute-intensive)</li><li>Cache helps reduce load off of database for read intensive workload (read heavy)</li><li>Help to make application stateless (AWS è´Ÿè´£å¤§éƒ¨åˆ†å·¥ä½œ)</li><li>å¤„ç† S3 çš„æ˜¯ CloudFront, è€Œä¸æ˜¯ ElastiCache (è®°ä½)</li><li>æ”¯æŒ multi-threading çš„æ˜¯ ElastiCache for Memcached</li><li>å…³äº ElastiCache for Redis cluster çš„ 2 ä¸ªçŸ¥è¯†ç‚¹<ul><li>All the nodes in a Redis cluster must reside in the same region</li><li>While using Redis with cluster mode enabled, you cannot manually promote any of the replica nodes to primary</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184841.png"></p><ul><li>DB Cache: Get data from ElastiCache<ul><li>If not avaliable, get from RDS and store in ElastiCache</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185024.png"></p><ul><li>User Session: Write Session data into ElastiCache<ul><li>User in another instance could still be logged in</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185153.png"></p><ul><li>Redis vs Memcahed<ul><li>Redis: Read Replicas, High Availiablity, Backup and restore (éå¸¸é‡è¦)</li><li>Memcached: Not High Availiablity, No Backup, risk to lose data, Multi-threaded</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185310.png"></p><blockquote><p>The maximum number of Read Replicas you can add in an ElastiCache Redis Cluster with Cluster Mode Disabled is 5.</p></blockquote><hr><h4 id="ElastiCache-Strategies"><a href="#ElastiCache-Strategies" class="headerlink" title="ElastiCache Strategies"></a>ElastiCache Strategies</h4><ul><li>Lazy Loading &#x2F; Cache-Aside &#x2F; Lazy Population<ul><li>Pros: Only requested data is cached (é‡è¦, only requested data)</li><li>Cons: Cache miss penalty results in 3 round trips &amp; stale data (æ•°æ®å¯èƒ½ä¸æ˜¯æœ€æ–°çš„)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200816.png"></p><ul><li>Write Through (write è€—æ—¶, ä½†æ˜¯ read çš„ latency å¾ˆä½)<ul><li>Pros: Data in cache is never stale, write penalty with 2 calls (æ•°æ®ä¸€å®šæ˜¯æœ€æ–°çš„)</li><li>Cons: Missing data until data is added &#x2F; updated in the DB</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201308.png"></p><ul><li>Cache Evictions &amp; Time-to-live (TTL)<ul><li>Cache Evictions: è¿™é‡ŒæŒ‡çš„æ˜¯ç¼“å­˜è¾¾åˆ°ä¸Šé™çš„æƒ…å†µ, éœ€è¦ç”¨ TTL å»æŒ‰æ—¶æ¸…ç†ç¼“å­˜</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201512.png"></p><hr><h4 id="MemoryDB-for-Redis"><a href="#MemoryDB-for-Redis" class="headerlink" title="MemoryDB for Redis"></a>MemoryDB for Redis</h4><ul><li>Redis-compatible, durable, in-memory database service (ä¸º Redis æœåŠ¡)</li><li>Durable in-memory data storage with Multi-AZ transactional log</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201727.png"></p><hr><h3 id="7-Route-53"><a href="#7-Route-53" class="headerlink" title="7. Route 53"></a>7. Route 53</h3><h4 id="Whatâ€™s-DNS"><a href="#Whatâ€™s-DNS" class="headerlink" title="Whatâ€™s DNS"></a>Whatâ€™s DNS</h4><ul><li>Translate hostname into IP address: <code>www.google.com = 172.217.18.36</code></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img213136.png"></p><hr><h4 id="AWS-Route-53"><a href="#AWS-Route-53" class="headerlink" title="AWS Route 53"></a>AWS Route 53</h4><ul><li>User can update the DNS records (High available, scalable)</li><li>Route 53 is a Domain Registrar</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img213527.png"></p><ul><li>Route 53 Records:<ul><li>Domain Name, Record Type, Value, Routing Policy, TTL</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img213613.png"></p><ul><li>Route 53 Record Types<ul><li>A: IPv4</li><li>AAAA: IPv6</li><li>CNAME: Map hostname to another hostname</li><li>NS: Name Servers for the Hosted Zone</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img213753.png"></p><ul><li>Route 53: Hosted Zones<ul><li>Public Hosted Zones: Public domain name</li><li>Private Hosted Zones: Private domain name (VPC)</li></ul></li></ul><blockquote><p>æ³¨æ„, DNS hostnames and DNS resolution are required settings for private hosted zones</p></blockquote><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234126.png"></p><ul><li>GoDaddy + Route 53 (As DNS Service Provider)<ul><li>Create a Public Hosted Zone and update the 3rd party Registrar NS records</li></ul></li><li>Route 53 Health Check<ul><li>å¦‚æœ ELB å‡ºé—®é¢˜, å°±å»æ‰¾ Route 53 Health Check</li></ul></li></ul><hr><h4 id="Route-53-TTL"><a href="#Route-53-TTL" class="headerlink" title="Route 53 TTL"></a>Route 53 TTL</h4><ul><li>TTL: Time To Live (ç”Ÿå­˜æ—¶é—´)<ul><li>How long the value should be cached (åç«¯æ›´æ–°ä¸ä»£è¡¨ cache æ›´æ–°äº†)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232659.png"></p><hr><h4 id="CNAME-vs-Alias"><a href="#CNAME-vs-Alias" class="headerlink" title="CNAME vs Alias"></a>CNAME vs Alias</h4><ul><li>CNAME: Point a hostname to another hostname<ul><li>ä» <code>acme.example.com</code> åˆ° <code>zenith.example.org</code> æˆ–è€… <code>example.com</code> åˆ° <code>example.net</code></li></ul></li><li>Alias: Point a hostname to an AWS resource (å¯¹è±¡æ˜¯ CloudFront, S3 è¿™äº›)<ul><li>ä» <code>covid19survey.com</code> åˆ° <code>www.covid19survey.com</code></li><li>ä» <code>app.mydomain.com</code> åˆ° <code>app.amazonaws.com</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233313.png"></p><hr><h4 id="Health-Checks"><a href="#Health-Checks" class="headerlink" title="Health Checks"></a>Health Checks</h4><ul><li>Health Checks are only for public resources</li><li>Health Check æ£€æµ‹: Endpoints, å…¶ä»– Health Checks, CloudWatch Alarms (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img000106.png"></p><hr><h4 id="Routing-Policy-Simple"><a href="#Routing-Policy-Simple" class="headerlink" title="Routing Policy (Simple)"></a>Routing Policy (Simple)</h4><ul><li>Define how Route 53 responds to DNS queries (ä¸€å…± 7 ç§ Routing Policies)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234623.png"></p><ul><li>Simple: Route traffic to a single resource<ul><li>If multiple values returned, a random one is chosen by client</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234350.png"></p><hr><h4 id="Routing-Policy-Weighted"><a href="#Routing-Policy-Weighted" class="headerlink" title="Routing Policy (Weighted)"></a>Routing Policy (Weighted)</h4><ul><li>Weighted: Control the % of the request go to each resource</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234856.png"></p><hr><h4 id="Routing-Policy-Latency"><a href="#Routing-Policy-Latency" class="headerlink" title="Routing Policy (Latency)"></a>Routing Policy (Latency)</h4><ul><li>Latency: Redirect to the resource that has the least latency close to us</li><li>Latency is based on traffic between users and AWS Regions</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img235654.png"></p><hr><h4 id="Routing-Policy-Failover"><a href="#Routing-Policy-Failover" class="headerlink" title="Routing Policy (Failover)"></a>Routing Policy (Failover)</h4><ul><li>Failover: Have a Primary Instance and a Secondary Instance (é‡è¦)<ul><li>When failover, switch to Secondary Instance</li></ul></li><li>æ³¨æ„, å½“é—®åˆ° failover çš„æ—¶å€™, é€‰æ‹©çš„æ˜¯ active-passive failover routing policy<ul><li>æ²¡æœ‰ä»€ä¹ˆ active-active, åªæœ‰ active-passive</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150940.png"></p><hr><h4 id="Routing-Policy-Geolocation"><a href="#Routing-Policy-Geolocation" class="headerlink" title="Routing Policy (Geolocation)"></a>Routing Policy (Geolocation)</h4><ul><li>Geolocation: Routing based on user location<ul><li>Need to create a â€œDefaultâ€ record</li><li>Use cases: website localization, restrict content distribution ç­‰ç­‰</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151650.png"></p><hr><h4 id="Routing-Policy-Geoproximity"><a href="#Routing-Policy-Geoproximity" class="headerlink" title="Routing Policy (Geoproximity)"></a>Routing Policy (Geoproximity)</h4><ul><li>Geoproximity: Route traffic to resource based on geolocation<ul><li>But have the ability to shift more traffic to resource based on bias (é‡è¦)</li><li>å¯ä»¥åšåˆ° route more traffic or less</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img152310.png"></p><hr><h4 id="Routing-Policy-Traffic-Flow"><a href="#Routing-Policy-Traffic-Flow" class="headerlink" title="Routing Policy (Traffic Flow)"></a>Routing Policy (Traffic Flow)</h4><ul><li>Visual editor to manage complex routing decision trees<ul><li>Configuration can be saved as Traffic Flow Policy</li><li>Can be applied to different Route 53 Hosted Zone</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img224018.png"></p><hr><h4 id="Routing-Policy-IP-Based"><a href="#Routing-Policy-IP-Based" class="headerlink" title="Routing Policy (IP-Based)"></a>Routing Policy (IP-Based)</h4><ul><li>IP-Based: Routing based on clientâ€™s IP address<ul><li>Provide a list of CIDRs for your client</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img153711.png"></p><hr><h4 id="Routing-Policy-Multi-Value"><a href="#Routing-Policy-Multi-Value" class="headerlink" title="Routing Policy (Multi-Value)"></a>Routing Policy (Multi-Value)</h4><ul><li>Multi-Value: Route traffic to multiple resources<ul><li>Not a subsitute for ELB</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img153842.png"></p><hr><h3 id="8-VPC-Fundamentals"><a href="#8-VPC-Fundamentals" class="headerlink" title="8. VPC Fundamentals"></a>8. VPC Fundamentals</h3><h4 id="AWS-VPC"><a href="#AWS-VPC" class="headerlink" title="AWS VPC"></a>AWS VPC</h4><ul><li>VPC: Virtual Private Cloud, all AWS account have a default VPC</li><li>CIDR should not overlap, max CIDR size in AWS is &#x2F;16, min CIDR size in AWS is &#x2F;28</li><li>è¦è®© VPC ä½¿ç”¨ custom domain éœ€è¦ <code>enableDnsHostnames</code> å’Œ <code>enableDnsSupport</code></li><li>å¯ä»¥åˆ›å»º Shared Service VPC, è¿™æ ·æ¯ä¸ª VPC éƒ½å¯ä»¥ access åˆ°éœ€è¦çš„ services (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201530.png"></p><ul><li>Each Amazon EC2 instance that you launch into a VPC has a tenancy attribute (é‡è¦)<ul><li>å¯ä»¥åœ¨ dedicated å’Œ host ä¹‹é—´äº’ç›¸åˆ‡æ¢</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img042420.png"></p><hr><h4 id="VPC-Subnet"><a href="#VPC-Subnet" class="headerlink" title="VPC Subnet"></a>VPC Subnet</h4><ul><li>Allow you to partition your network inside the VPC (VPC å†…åˆ’åˆ†ç½‘ç»œ)<ul><li>Can have Public Subnet and Private Subnet</li></ul></li><li>AWS reserves 5 IP addresses in each subnet (first 4 &amp; last 1, é‡è¦)</li><li>Subnet is always associated with Route Table (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img013421.png"></p><hr><h4 id="Internet-Gateway-IGW-amp-Route-Table"><a href="#Internet-Gateway-IGW-amp-Route-Table" class="headerlink" title="Internet Gateway (IGW) &amp; Route Table"></a>Internet Gateway (IGW) &amp; Route Table</h4><ul><li>IGW allow resource (eg. EC2 Instance) in a VPC connect to internet (é‡è¦)<ul><li>ç›¸å½“äºè®© VPC é‡Œçš„ resource å¯ä»¥è¿ä¸Šç½‘</li><li>IGW éœ€è¦ Route Table (é‡è¦)</li></ul></li><li>å¦‚æœ IGW å‡ºé—®é¢˜<ul><li>Need to also have Route Table (é¦–å…ˆæ£€æŸ¥ Route Table, å› ä¸º IGW éœ€è¦)</li><li>æ£€æŸ¥ Security Group æ˜¯å¦å…è®¸é€šè¿‡</li></ul></li><li>å¤„ç† Network Address Translation çš„å°±æ˜¯ Internet Gateway</li><li>Internet Gateway æ— æ³•ç›´æ¥åœ¨ private subnet é‡Œé¢ä½¿ç”¨ (é‡è¦)</li><li>NAT é’ˆå¯¹çš„æ˜¯ Subnet å±‚é¢, IGW é’ˆå¯¹çš„æ˜¯ VPC å±‚é¢ (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img202043.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img193121.png"></p><hr><h4 id="NAT-Gateway-NATGW"><a href="#NAT-Gateway-NATGW" class="headerlink" title="NAT Gateway (NATGW)"></a>NAT Gateway (NATGW)</h4><ul><li>AWS managed NAT, AZ specific, use Elastic IP (é’ˆå¯¹ IPv4, Egress æ˜¯ IPv6)<ul><li>Allow EC2 Instance in Private Subnet to connect to the Internet</li><li>Requires an IGW, NATGW æ˜¯å¤„äº public subnet çš„ (æ³¨æ„)</li></ul></li><li>NAT é’ˆå¯¹çš„æ˜¯ Subnet å±‚é¢, IGW é’ˆå¯¹çš„æ˜¯ VPC å±‚é¢</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233648.png"></p><ul><li>Resilient within single AZ, Multiple-AZ need multiple NATGW <ul><li>æ¯ä¸ª AZ éƒ½è¦ä¸€ä¸ª NATGW, ç”¨æ¥ fault-tolerance (å®¹é”™èƒ½åŠ›)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203654.png"></p><hr><h4 id="NACL-amp-Security-Groups"><a href="#NACL-amp-Security-Groups" class="headerlink" title="NACL &amp; Security Groups"></a>NACL &amp; Security Groups</h4><ul><li>The request has to go over NACL before go to Subnet (Subnet level)<ul><li>NACL is stateless (inbound outbound éƒ½è¦æ£€æµ‹)</li></ul></li><li>The request has to go over Security Group before go to EC2 Instance (Instance level)<ul><li>Security Group (SG) is stateful (inbound accepted &#x3D; outbound accepted)</li></ul></li><li>åæ­£è®°ä½ NACL æ˜¯ Subnet level (stateless), Security Group æ˜¯ Instance level (stateful)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img204310.png"></p><ul><li>Network Access Control List (NACL)<ul><li>NACL control traffic from and to subnets (eg. block IP)</li><li>One NACL per subnet, each subnet have default NACL (æ³¨æ„)<ul><li>Default NACL accept every inbound and outbound</li><li>ä½†æ˜¯ custom NACL é»˜è®¤æ˜¯ deny inbound å’Œ outbound çš„ (æ³¨æ„)</li></ul></li><li>NACL Rules have number, higher precedence with lower number (è¶Šä¼˜å…ˆæ•°å­—è¶Šä½)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img204553.png"></p><hr><h4 id="VPC-Flow-Logs"><a href="#VPC-Flow-Logs" class="headerlink" title="VPC Flow Logs"></a>VPC Flow Logs</h4><ul><li>Capture information about IP traffic going into interfaces (ç›‘è§† IP æµé‡çš„)<ul><li>Monitor &amp; troubleshoot connectivity issues (ç½‘ç»œè¿æ¥é—®é¢˜)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img231819.png"></p><hr><h4 id="VPC-Peering"><a href="#VPC-Peering" class="headerlink" title="VPC Peering"></a>VPC Peering</h4><ul><li>VPC Peering: Privately connect two VPCs using AWS network (åªé€‚åˆå°‘é‡ VPC, é‡è¦)<ul><li>æ¯ä¸€å¯¹ VPC éƒ½è¦ VPC Peering, å’Œ S3 Replication ç±»ä¼¼</li></ul></li><li>Can create VPC Peering between VPCs in different AWS accounts &#x2F; regions</li><li>Need to update Route Table in each VPC subnet to make sure they can communicate<ul><li>å‡ºé—®é¢˜å°±æ£€æŸ¥ Route Table</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img205313.png"></p><hr><h4 id="VPC-Sharing"><a href="#VPC-Sharing" class="headerlink" title="VPC Sharing"></a>VPC Sharing</h4><ul><li>VPC Sharing: Allows multiple AWS accounts to create resources (eg. EC2, RDS) into shared and centrally-managed AWS VPC (é‡è¦)<ul><li>é‡åˆ° centrally managed çš„å°±æ˜¯ VPC Sharing</li><li>è€Œä¸”æ˜¯ owner éœ€è¦ share one or more subnet (æ³¨æ„)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img824817.png"></p><hr><h4 id="VPC-Endpoints-AWS-PrivateLink"><a href="#VPC-Endpoints-AWS-PrivateLink" class="headerlink" title="VPC Endpoints (AWS PrivateLink)"></a>VPC Endpoints (AWS PrivateLink)</h4><ul><li>VPC Endpoints allow private access to AWS services within a VPC (é‡è¦)<ul><li>ç”¨ Private Network è¿æ¥ AWS æœåŠ¡, å’Œ On-Premise æ²¡æœ‰å…³ç³»</li><li>Interface Endpoint æ”¯æŒå¤§éƒ¨åˆ† AWS æœåŠ¡ (ä»˜è´¹)</li><li>Gateway Endpoint åªæ”¯æŒ S3 å’Œ DynamoDB (å¾ˆå®¹æ˜“è€ƒ, å…è´¹)</li></ul></li><li>æ³¨æ„, VPC Gateway Endpoint ä¸“é—¨å¤„ç† S3 å’Œ DynamoDB (ä¸è¦å»é€‰æ‹© NAT æˆ–è€… IGW)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img205719.png"></p><ul><li>ä¸¤ç§ Types of Endpoints (Interface &#x2F; Gateway)<ul><li>Interface Endpoints: Supports most AWS services (ä»˜è´¹)</li><li>Gateway Endpoints: Must be used as a target in a route table (å…è´¹, é‡è¦)<ul><li>Only support S3 and DynamoDB (åªæ”¯æŒ S3 å’Œ DynamoDB)</li></ul></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img205939.png"></p><hr><h4 id="Site-to-Site-VPN-VPN-Connection"><a href="#Site-to-Site-VPN-VPN-Connection" class="headerlink" title="Site-to-Site VPN (VPN Connection)"></a>Site-to-Site VPN (VPN Connection)</h4><ul><li>Site-to-Site VPN: Connect AWS to Corporate Data Center over public internet (é‡ç‚¹, public internet, On-Premise to AWS)<ul><li>Need a Virtual Private Gateway (VGW) on VPC (AWS æ–¹)</li><li>Need a Customer Gateway (CGW) on DC (On-Premise æ–¹)</li></ul></li><li>å¯¹æ¯” DX, Site-to-Site VPN æ²¡æœ‰æä¾› low latency, and high throughput connection</li><li>Site-to-Site VPN æœ‰ encrypted network connectivity between On-Premise and VPC</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232320.png"></p><ul><li>éœ€è¦ VPN Gateway å’Œ Customer Gateway æ¥è¿æ¥ VPC å’Œ On-Premise</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232649.png"></p><hr><h4 id="Direct-Connect-DX"><a href="#Direct-Connect-DX" class="headerlink" title="Direct Connect (DX)"></a>Direct Connect (DX)</h4><ul><li>Provide a dedicated private connection from a remote network to VPC (é‡ç‚¹, private internet, On-Premise to AWS)<ul><li>éœ€è¦è®¾ç½® VGW, å¦‚æœç»™ DX æ‰¾ backup, é‚£ä¹ˆå°±é€‰æ‹© Site-to-Site VPN (è¿™ä¸¤ä¸ªæœåŠ¡ç±»ä¼¼)</li><li>å¯¹æ¯” Site-to-Site VPN, DX provide low latency, and high throughput connection</li><li>DX ä¸æ”¯æŒ encrypted network connectivity, Site-to-Site VPN å¯ä»¥, ä½†æ˜¯å¦‚æœéœ€è¦ encrypt DX connection å¯ä»¥å’Œ AWS VPN ä¸€èµ·ç”¨ (æ³¨æ„)</li><li>DX çš„ set up æ—¶é—´å¾ˆé•¿ (æ‰€ä»¥ DX ä¸ç®—ä»€ä¹ˆ quick solution)</li></ul></li><li>All private, no public network involve (æ³¨æ„, å¦‚æœé—®åˆ° all Private å°±æ˜¯ DX)<ul><li>Direct Connect does not involve the Internet</li></ul></li><li>å¯ä»¥ access public resources (S3) å’Œ private resources (EC2)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233024.png"></p><ul><li>ä¸¤ç§ Connection Type (å¸¦å®½é€‰é¡¹, Dedicated æœ€å¿«)<ul><li>Dedicated Connections: 1Gbps åˆ° 100Gbps</li><li>Hosted Connections: 50Mbps åˆ° 10 Gbps</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img004140.png"></p><ul><li>Direct Connect Gateway (è¿æ¥è®¸å¤š VPC åœ¨ä¸åŒçš„ Region)<ul><li>Direct Connection to one or more VPC in many different regions</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233531.png"></p><ul><li>PrivateLink vs DX<ul><li><p>AWS PrivateLink provides a connection between VPCs (Virtual Private Clouds) and AWS services while bypassing the public Internet. It is a private network connection that securely transfers data without leaving the AWS network</p></li><li><p>AWS Direct Connect is a dedicated, private connection between the customerâ€™s on-premises infrastructure at a data center and an AWS location. The main features of the connection are ultra-fast data transfer rates, low latency, and improved security since it bypasses the public Internet</p></li></ul></li></ul><hr><h3 id="9-S3"><a href="#9-S3" class="headerlink" title="9. S3"></a>9. S3</h3><h4 id="AWS-S3"><a href="#AWS-S3" class="headerlink" title="AWS S3"></a>AWS S3</h4><ul><li>S3 Buckets (S3 æ˜¯ Global çš„, ä½†æ˜¯ Bucket æ˜¯ Regional çš„)<ul><li>Store objects (files) in â€œbucketsâ€</li><li>Buckets must have globally unique name (åå­—å¿…é¡»ç‹¬ç‰¹)</li><li>Buckets are defined at region level</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img171839.png"></p><ul><li>Objects (files) have a key, max object size is 5TB</li><li>å¦‚æœä¸Šä¼ è¶…è¿‡ 5 GB, å°±è¦ç”¨ Multi-Part Upload (è¿˜æœ‰ S3 Transfer Acceleration)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img172025.png"></p><ul><li>S3 sync command: Uses the <code>CopyObject</code> APIs to copy objects between S3 buckets</li><li>S3 always return the lastest version of the object (é‡è¦)</li><li>S3 æ²¡åŠæ³•åŠ å¯† metadata</li><li>S3 æ˜¯ serverless çš„</li><li>å¦‚æœé‡åˆ°éœ€è¦å¤„ç† static content çš„, å°±ä¸€å®šæ˜¯ S3 + CloudFront (é‡è¦)</li><li>å¦‚æœé—®åˆ° S3 è€Œä¸”æ˜¯å…³äºå›¾ç‰‡ä¸Šä¼ , é€‰æ‹© S3 Event Notification, ä¸æ˜¯ EventBridge (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/imglifecycle-transitions-v2.png"></p><ul><li>å¦‚æœå‘ç° S3 çš„ä¼ è¾“åŠŸèƒ½å‡ºé—®é¢˜, é‚£ä¹ˆå°±ç»™ S3 bucket åŠ ä¸Š prefix (é‡è¦)</li><li>æ³¨æ„, S3 å’Œ database æ˜¯ä¸æ²¾è¾¹çš„, S3 ä¸æ˜¯æ•°æ®åº“</li><li>å¦‚æœè¦ control access to data stored on AWS S3, å¯ä»¥ç”¨ä¸‹é¢ 2 ç‚¹<ul><li>Query String Authentication, Access Control List (ACLs)</li><li>Bucket policies, Identity and Access Management (IAM) policies</li></ul></li><li>In order to get object access log, the object owner also need to be bucket owner</li><li>S3 Object Ownership is a S3 bucket setting that control ownership of new objects that are uploaded to a bucket (é‡è¦)</li></ul><blockquote><p>By default, an Amazon S3 object is owned by the AWS account that uploaded it. This is true even when the bucket is owned by another account (é‡è¦)</p></blockquote><hr><h4 id="S3-Bucket-Policy"><a href="#S3-Bucket-Policy" class="headerlink" title="S3 Bucket Policy"></a>S3 Bucket Policy</h4><ul><li>User-Based Security<ul><li>IAM Policies: Which API calls should be allowed for a user from IAM (é‡è¦)</li></ul></li><li>Resource-Based Security<ul><li>Bucket Policies: Bucket rules (æ¯”å¦‚è®© object public)</li></ul></li><li>æ³¨æ„, IAM Policy çš„ precedence æ˜¯æ¯” S3 Bucket Policy è¦ä¼˜å…ˆçš„</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173050.png"></p><ul><li>S3 Bucket Policies (JSON based policies)<ul><li>Resoruces: buckets and objects</li><li>Effect: Allow &#x2F; Deny</li><li>Actions: API to Allow or Deny</li><li>Principal: The account or user to apply the policy to</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173325.png"></p><hr><h4 id="S3-Website"><a href="#S3-Website" class="headerlink" title="S3 Website"></a>S3 Website</h4><ul><li>Host åœ¨ S3 ä¸Šé¢çš„ç½‘ç«™ä¸€èˆ¬æ˜¯ä»¥ä¸‹ä¸¤ç§åç¼€ (dash Region æˆ–è€… dot Region)<ul><li>s3-website-Region: <code>http://bucket-name.s3-website-Region.amazonaws.com</code></li><li>s3-website.Region: <code>http://bucket-name.s3-website.Region.amazonaws.com</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img043622.png"></p><hr><h4 id="S3-Versioning"><a href="#S3-Versioning" class="headerlink" title="S3 Versioning"></a>S3 Versioning</h4><ul><li>Enabled at the bucket level (Default is null)</li><li>Best pratice to version the buckets (å¯ä»¥ roll back, å¯ä»¥é˜²æ­¢è¯¯åˆ , é‡è¦)<ul><li>å¯ä»¥é˜²æ­¢ accidental deletion of objects</li></ul></li><li>Once version-enable a bucket, it can never return to an unversioned state (é‡è¦)</li><li>Versioning æ˜¯é’ˆå¯¹è¿™ä¸ª bucket é‡Œé¢çš„æ‰€æœ‰ object, æ‰€ä»¥ä¸èƒ½æŒ‡å®š folder æ¥ versioning</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174246.png"></p><hr><h4 id="S3-Replication-CRR-amp-SRR"><a href="#S3-Replication-CRR-amp-SRR" class="headerlink" title="S3 Replication (CRR &amp; SRR)"></a>S3 Replication (CRR &amp; SRR)</h4><ul><li>CRR: Cross Region Replication (compliance, lower latency access)</li><li>SRR: Same Region Replication (create test environment)<ul><li>Must enable Versioning</li><li>The Copying is asynchronous</li><li>Must give IAM permissions to S3</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174840.png"></p><ul><li>Only new objects are replicated, existing objects need S3 Batch Replication<ul><li>ä¹Ÿå°±æ˜¯è¯´åªæœ‰æ–°çš„ object ä¼šè¢« Replicate, è€çš„ object è¦ S3 Batch Replication</li></ul></li><li>No â€œchainingâ€ in replication<ul><li>æ¯”å¦‚æŠŠ A å¤åˆ¶åˆ° B å’Œ C, éœ€è¦ A å¤åˆ¶åˆ° B å’Œ A å¤åˆ¶åˆ° C</li></ul></li><li>S3 lifecycle actions are not replicated with S3 Replication</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175004.png"></p><hr><h4 id="S3-Storage-Classes"><a href="#S3-Storage-Classes" class="headerlink" title="S3 Storage Classes"></a>S3 Storage Classes</h4><ul><li>ä¸€å…± 7 ç§ Storage Class: General + 2 IA + 3 Glacier + Intelligent</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175742.png"></p><ul><li>S3 Standard - General Purpose<ul><li>Used for frequently accessed data (æœ€å¸¸è§)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175932.png"></p><ul><li>S3 Infrequent Access (Standard IA &amp; One Zone IA)<ul><li>For data is less frequent access but require rapid access when needed (é‡è¦)</li><li>Lower cost than Standard </li><li>ä» Standard è½¬åˆ° One Zone IA æœ€å°‘è¦ 30 å¤©</li><li>One Zone IA ä¸æ˜¯ High Availability çš„é€‰æ‹© (æ³¨æ„, å› ä¸º AZ ä¼š down)</li><li>å¦‚æœé‡åˆ° access is always required å°±ä¸èƒ½é€‰ One Zone IA, å› ä¸º AZ å¯èƒ½ä¼š down</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img180147.png"></p><ul><li>S3 Glacier Storage Classes (Archive ä¸“ç”¨)<ul><li>Low-cost object storage for archiving &#x2F; backup</li><li>Price: storage + retrieval</li><li>S3 Glacier Instant Retrieval: Glacier é‡Œæœ€å¿«ä½†ä¹Ÿæœ€è´µ</li><li>S3 Glacier Flexible Retrieval: ä¸‰ç§æ¨¡å¼ (Expedited åŠ æ€¥, Standard, Bulk æ‰¹é‡)</li><li>S3 Glacier Deep Archive: å­˜çš„æ—¶é—´æœ€ä¹…, ä¸¤ç§æ¨¡å¼ (Standard, Bulk), 48 å°æ—¶ retrieval</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img180642.png"></p><ul><li>S3 Intelligent Tiering<ul><li>Move objects automatically between Access Tiers based on usage</li><li>å°±æ˜¯è‡ªåŠ¨å¸®ä½ æŠŠ Object ç§»åˆ°ä¸åŒçš„ Storage Class é‡Œ</li><li>Intelligent Tier æ˜¯åœ¨ Standard å’Œ Standard IA ä¸‹é¢çš„, ä¸èƒ½ä»ä¸‹å¾€ä¸Šè½¬ç§»</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img180806.png"></p><hr><h3 id="10-AWS-CLI-SDK-IAM-Roles-amp-Policies"><a href="#10-AWS-CLI-SDK-IAM-Roles-amp-Policies" class="headerlink" title="10. AWS CLI, SDK, IAM Roles &amp; Policies"></a>10. AWS CLI, SDK, IAM Roles &amp; Policies</h3><h4 id="EC2-Instance-Metadata-IMDS"><a href="#EC2-Instance-Metadata-IMDS" class="headerlink" title="EC2 Instance Metadata (IMDS)"></a>EC2 Instance Metadata (IMDS)</h4><ul><li>Allow EC2 Instance to â€œlearn about themselvesâ€ without using an IAM Role</li><li>AWS CLI ç”¨ Instance Metadata å»æ‹¿ temporary credentials (åœ¨ Python ç¯å¢ƒä¸‹)<ul><li>Metadata &#x3D; info about the EC2 Instance (æ²¡æ³•æ‹¿åˆ° IAM Policy)</li><li>Userdata &#x3D; launch script of the EC2 Instance</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150522.png"></p><ul><li>IMDSv2 vs. IMDSv1<ul><li>IMDSv1 access <code>http://169.254.169.254/latest/meta-data</code> (ä¸æ¨è)</li><li>IMDSv2 is more secure and done in two steps</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150716.png"></p><hr><h4 id="MFA-with-CLI"><a href="#MFA-with-CLI" class="headerlink" title="MFA with CLI"></a>MFA with CLI</h4><ul><li>To use MFA with CLI, you must create a temporary session<ul><li>Run the <code>STS GetSession</code> API call</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151057.png"></p><ul><li>å¦‚æœæ˜¯ check IAM permission, ç”¨ <code>AWS CLI --dry-run</code></li></ul><hr><h4 id="AWS-SDK"><a href="#AWS-SDK" class="headerlink" title="AWS SDK"></a>AWS SDK</h4><ul><li>Perform actions on AWS directly from your application code</li><li>If not configure a default region, <code>us-east-1</code> will be chosen by default</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151356.png"></p><hr><h4 id="AWS-Limits-Quotas"><a href="#AWS-Limits-Quotas" class="headerlink" title="AWS Limits (Quotas)"></a>AWS Limits (Quotas)</h4><ul><li>API Rate Limits<ul><li>For Intermittent Errors: implement Exponential Backoff</li><li>For Consistent Errors: request an API throttling limit increase (é€šè¿‡ AWS ç”³è¯·)</li></ul></li><li>Service Quotas &#x2F; Limits<ul><li>Request a service limit increase by opening a ticket</li><li>Request a service quota increase by Service Quotas API</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151813.png"></p><ul><li>Exponential Backoff<ul><li>If get <code>ThrottlingException</code> intermittently, use exponential backoff</li><li>Itâ€™s a retry mechanism included in AWS SDK API calls</li><li>Only retry for 5XX errors</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img152100.png"></p><hr><h4 id="AWS-CLI-Credentials-Provider-Chain"><a href="#AWS-CLI-Credentials-Provider-Chain" class="headerlink" title="AWS CLI Credentials Provider Chain"></a>AWS CLI Credentials Provider Chain</h4><ul><li>The CLI will look credentials in order<ul><li><code>Command Line Options -&gt; Environment Variables -&gt; EC2 Instance Profile</code></li></ul></li><li>The credentials chain could give priority to the environment variables</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img152316.png"></p><hr><h4 id="AWS-Sigv4"><a href="#AWS-Sigv4" class="headerlink" title="AWS Sigv4"></a>AWS Sigv4</h4><ul><li>AWS SigV4 æ˜¯å¯¹ AWS è¯·æ±‚è¿›è¡Œç­¾åçš„èº«ä»½éªŒè¯æ–¹æ³•ï¼Œç¡®ä¿å®‰å…¨å’Œå®Œæ•´æ€§ (2 ç§é€‰æ‹©)<ul><li>HTTP Header: Signature in Authorization header</li><li>Query String: Signature in <code>X-Amz-Signature</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img153415.png"></p><hr><h3 id="11-Advanced-S3"><a href="#11-Advanced-S3" class="headerlink" title="11. Advanced S3"></a>11. Advanced S3</h3><h4 id="S3-Lifecycle-Rules"><a href="#S3-Lifecycle-Rules" class="headerlink" title="S3 Lifecycle Rules"></a>S3 Lifecycle Rules</h4><ul><li>Transition objects between storage classes (æ¯”å¦‚ä» IA åˆ° Glacier)<ul><li>Transition éœ€è¦ Lifecycle Rules (é‡è¦)</li></ul></li><li>æ¯”å¦‚ä» Snowball åˆ° Glacier å°±éœ€è¦ Lifecycle Rule</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img235516.png"></p><ul><li>Transition Actions: Configure objects to transition to another storage class (è½¬ç§»)</li><li>Expiration Actions: Configure objects to expire after some time (åˆ é™¤)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img235639.png"></p><ul><li>S3 Analytics: Help decide when to transition objects to the right storage class</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img000151.png"></p><hr><h4 id="S3-Event-Notifications"><a href="#S3-Event-Notifications" class="headerlink" title="S3 Event Notifications"></a>S3 Event Notifications</h4><ul><li>Automatically react to certain event happened in S3 (æ¯”å¦‚å›¾ç‰‡ä¸Šä¼ )<ul><li>Need to have IAM Permissions</li><li>S3 Event Notification çš„ destination æ˜¯ SQS, SNS, Lambda (è®°ä½)</li></ul></li><li>å¤§éƒ¨åˆ†å’Œ S3 äº‹ä»¶ç›¸å…³çš„éƒ½æ˜¯ S3 Event Notification, è€Œä¸æ˜¯ EventBridge (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img000725.png"></p><hr><h4 id="S3-Performance"><a href="#S3-Performance" class="headerlink" title="S3 Performance"></a>S3 Performance</h4><ul><li>For Upload ä¸Šä¼  (é‡è¦)<ul><li>Multi-Part Upload: å½“ä¸Šä¼ æ–‡ä»¶å¤§äº 5 GB, å¯ä»¥ parallelize uploads</li><li>S3 Transfer Acceleration: å°†æ–‡ä»¶ä¼ åˆ° AWS edge location, å¯ä»¥å’Œ Multi-Part ä¸€èµ·ç”¨</li><li>S3 Transfer Acceleration (S3TA) can speed up content transfers to and from S3</li><li>æ³¨æ„, S3 Transfer Acceleration æ²¡åŠæ³• copy object between buckets</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img001645.png"></p><ul><li>For Download ä¸‹è½½<ul><li>S3 Byte-Range Fetches: Parallelize GETs, retrieve partial data (æ‹¿éƒ¨åˆ†æ•°æ®, é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img001828.png"></p><hr><h4 id="S3-Select-amp-Glacier-Select"><a href="#S3-Select-amp-Glacier-Select" class="headerlink" title="S3 Select &amp; Glacier Select"></a>S3 Select &amp; Glacier Select</h4><ul><li>S3 Select ä½¿ç”¨ SQL æ¥åš server-side filtering, è¿‡æ»¤ä»è€Œå‡å°‘æ•°æ®é‡</li><li>Less network transfer, less CPU cost client-side</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img002050.png"></p><hr><h4 id="S3-Object-Tags-amp-Metadata"><a href="#S3-Object-Tags-amp-Metadata" class="headerlink" title="S3 Object Tags &amp; Metadata"></a>S3 Object Tags &amp; Metadata</h4><ul><li>S3 User-Defined Object Metadata: Must begin with <code>x-amz-meta-</code></li><li>S3 Object Tags: Useful for fine-grained permission or analytics purpose</li><li>You cannot search the object metadata or object tags (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img194215.png"></p><hr><h3 id="12-S3-Security"><a href="#12-S3-Security" class="headerlink" title="12. S3 Security"></a>12. S3 Security</h3><h4 id="S3-Encryption"><a href="#S3-Encryption" class="headerlink" title="S3 Encryption"></a>S3 Encryption</h4><ul><li>Server-Side Encryption (SSE-S3 å…è´¹, SSE-KMS è¦é’±, SSE-C)</li><li>Client-Side Encryption (å¦‚æœç”¨æˆ·å·²ç»æœ‰ encryption method)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223133.png"></p><ul><li>Server-Side Encryption with Amazon S3-Managed Keys (SSE-S3)<ul><li>Enabled by default for new buckets &amp; objects</li><li>SSE-S3 çš„ header æ˜¯ <code>x-amz-server-side-encryption:AES256</code></li><li>ä½¿ç”¨ SSE-S3, æ¯ä¸€ä¸ª Object éƒ½æ˜¯ç”± unique key æ¥ encrypt çš„</li><li>SSE-S3 ä½¿ç”¨ 256-bit Advanced Encryption Standard (AES-256)</li><li>SSE-S3 æ˜¯æ²¡æœ‰ automatic key rotation çš„, è¦ç”¨ SSE-KMS (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223242.png"></p><ul><li>Server-Side Encryption with KMS Keys stored in AWS KMS (SSE-KMS)<ul><li>User control + audit key usage in CloudTrail (å¯ä»¥ç®¡ç† key rotation)</li><li>SSE-KMS çš„ header æ˜¯ <code>x-amz-server-side-encryption:aws:kms</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223417.png"></p><ul><li>Server-Side Encryption with Customer-Provided Keys (SSE-C)<ul><li>ç”¨æˆ·è‡ªå·±æœ‰ keys, AWS will not store the key, HTTPS must be used (é‡è¦)</li><li>å½“é—®é¢˜ä¸­æåˆ°ç”¨æˆ·éœ€è¦ä½¿ç”¨è‡ªå·±çš„ key, ä½†æ˜¯æ‰“ç®—åœ¨ AWS ç«¯åš encryption</li><li>S3 will reject any requests made over <code>HTTP</code> when using SSE-C (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223602.png"></p><ul><li>Client-Side Encryption<ul><li>User fully manages the keys and encryption cycle</li><li>æ•°æ®åœ¨é€åˆ° AWS ä¹‹å‰å°±æ˜¯åŠ å¯†å¥½çš„</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223715.png"></p><ul><li>Encryption in Transit (SSL&#x2F;TLS)<ul><li>å¯ä»¥ç”¨ <code>aws:SecureTransport</code> æ¥ enforce (ä¸è¿‡æœ‰ SSL åŸºæœ¬ä¸Šå°±æ˜¯ HTTPS)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223811.png"></p><hr><h4 id="S3-CORS"><a href="#S3-CORS" class="headerlink" title="S3 CORS"></a>S3 CORS</h4><ul><li>CORS: Cross-Origin Resource Sharing (è·¨åŸŸé—®é¢˜)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img224630.png"></p><ul><li>S3 CORS (é‡è¦)<ul><li>A client makes a cross-origin request on S3 bucket, need the correct CORS headers</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img224951.png"></p><hr><h4 id="S3-MFA-Delete"><a href="#S3-MFA-Delete" class="headerlink" title="S3 MFA Delete"></a>S3 MFA Delete</h4><ul><li>MFA Delete: é˜²æ­¢ä¸å°å¿ƒåˆ é™¤æ–‡ä»¶, ç”¨æˆ·éœ€è¦å…ˆéªŒè¯èº«ä»½ (é‡è¦)<ul><li>To use MFA Delete: Versioning must be enabled</li></ul></li><li>Only the bucket owner (root user) can enable&#x2F;disable MFA Delete (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img225415.png"></p><hr><h4 id="S3-Access-Logs"><a href="#S3-Access-Logs" class="headerlink" title="S3 Access Logs"></a>S3 Access Logs</h4><ul><li>Any request made to S3 will be logged to another S3 bucket (æ•°æ®åˆ†æ)<ul><li>å¯ä»¥ä½œä¸º Data Analysis çš„å·¥å…·</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230251.png"></p><hr><h4 id="S3-Pre-signed-URL"><a href="#S3-Pre-signed-URL" class="headerlink" title="S3 Pre-signed URL"></a>S3 Pre-signed URL</h4><ul><li>S3 Pre-signed URL å…è®¸ä¸´æ—¶è®¿é—®ç‰¹å®š S3 å¯¹è±¡çš„ URL</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230702.png"></p><hr><h4 id="S3-Access-Points"><a href="#S3-Access-Points" class="headerlink" title="S3 Access Points"></a>S3 Access Points</h4><ul><li>Access Points simplify security management for S3 Buckets (æ ¹æ®ç”¨æˆ·å±æ€§)</li><li>Each Access Point: DNS name + Access Point Policy</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img231500.png"></p><hr><h4 id="S3-Object-Lambda"><a href="#S3-Object-Lambda" class="headerlink" title="S3 Object Lambda"></a>S3 Object Lambda</h4><ul><li>Use AWS Lambda to change object before retrieve by caller (åœ¨åˆ°è¾¾ caller ä¹‹å‰)<ul><li>ç”¨é€”: å¯ä»¥ç»™å›¾ç‰‡æ‰“æ°´å°</li></ul></li><li>éœ€è¦ S3 Access Point å’Œ S3 Object Lambda Access Points</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img231810.png"></p><hr><h3 id="13-CloudFront"><a href="#13-CloudFront" class="headerlink" title="13. CloudFront"></a>13. CloudFront</h3><h4 id="AWS-CloudFront"><a href="#AWS-CloudFront" class="headerlink" title="AWS CloudFront"></a>AWS CloudFront</h4><ul><li>Content Delivery Network (CDN), å¯ä»¥ serve static &amp; dynamic content<ul><li>Improve read performance, content is cached at the edge</li></ul></li><li>å¯ä»¥é˜²æ­¢ DDoS protection (æ­é… AWS Shield), å¯ä»¥æ ¹æ® content type æ¥ route, å¯ä»¥æŒ‡å®š primary &amp; secondary origins æ¥åš high availiability &amp; failover</li><li>CloudFront Origins: S3 Bucket (OAC) æˆ–è€… Custom Origin (HTTP)<ul><li>OAC: Origin Access Control (é‡è¦, å¦‚æœæ¶‰åŠåˆ° S3 çš„é—®é¢˜)</li></ul></li><li>å¦‚æœé—®åˆ° CloudFront è€Œä¸”éœ€è¦ encryption, é€‰æ‹© field level encryption (ä¸æ˜¯ KMS)<ul><li>Field-level encryption allows you to enable your users to securely upload sensitive information to your web servers.</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232701.png"></p><ul><li>CloudFront vs S3 Cross Region Replication<ul><li>CloudFront: ä½¿ç”¨ global edge network, æœ‰ TTL, ç”¨äº static content</li><li>S3 Cross Region Replication (CRR): æ¯ä¸ª Region éƒ½è¦è®¾ç½®, ä½†æ˜¯æ²¡æœ‰ TTL, ç”¨äº dynamic content (updated in near real-time, åªè¯»)</li><li>é—®åˆ° S3 å¹¶ä¸”æœ‰å…³ high available å’Œ low latency çš„å°±æ˜¯ S3 Cross Region Replication</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233016.png"></p><ul><li>Price Classes: ä¸åŒåœ°åŒºçš„ä»·æ ¼ä¸ä¸€æ ·<ul><li>å¯ä»¥ç”¨æ¥ cost reduction (é™ä½ä»·æ ¼)</li></ul></li><li>CloudFront å…è®¸ Proxy methods å’Œ Dynamic content è·³è¿‡ regional edge cache</li><li>é™¤äº† WAF å¯ä»¥å» block IP, è¿˜å¯ä»¥ä½¿ç”¨ OAI (origin access identity, é‡è¦)<ul><li>OAI ä¹Ÿå¯ä»¥ç”¨æ¥ secure communication between CloudFront &amp; S3</li></ul></li><li>å¯ä»¥ç”¨ CloudFront signed URLs å’Œ CloudFront signed cookies æ¥ restrict access to documents (æ¯”å¦‚ subscription)</li><li>Can configure CloudFront to require HTTPS from clients (å¯ä»¥ç”¨ CloudFront è¦æ±‚ client å¿…é¡»ä½¿ç”¨ HTTPS)</li></ul><hr><h4 id="CloudFront-Caching"><a href="#CloudFront-Caching" class="headerlink" title="CloudFront Caching"></a>CloudFront Caching</h4><ul><li>The cache lives at each CloudFront Edge Location</li><li>CloudFront identifies each object in the cache using Cache Key</li><li>å¦‚æœé‡åˆ° CloudFront å¤„ç† language é…ç½®å‡ºé—®é¢˜, é‚£ä¹ˆå¯ä»¥ç”¨ <code>Query string forwarding and caching</code> (è¿™é“é¢˜å¾ˆé•¿)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img144432.png"></p><ul><li>CloudFront Cache Key<ul><li>By default, consists of hostname + resource portion of the URL</li><li>Could add other elements to the Cache Key using CloudFront Cache Policies</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img144654.png"></p><ul><li>Cache Policy: å¯ä»¥ä½¿ç”¨ HTTP Headers, Cookies, Query Strings (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img444857.png"></p><ul><li>Origin Request Policy<ul><li>Values that you want to include in origin requests without including in the Cache Key</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img145256.png"></p><hr><h4 id="CloudFront-Cache-Invalidation"><a href="#CloudFront-Cache-Invalidation" class="headerlink" title="CloudFront Cache Invalidation"></a>CloudFront Cache Invalidation</h4><ul><li>è®© CloudFront è·³è¿‡ TTL ç«‹å³æ›´æ–°<ul><li>æ¯”å¦‚ä½ æ›´æ–°äº†åç«¯, ä½†æ˜¯ CloudFront ä¸ä¼šç«‹å³æ›´æ–°, éœ€è¦ CloudFront Invalidation æ¥è·³è¿‡ TTL æ¥ç«‹å³æ›´æ–°</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234007.png"></p><hr><h4 id="CloudFront-Cache-Behaviors"><a href="#CloudFront-Cache-Behaviors" class="headerlink" title="CloudFront Cache Behaviors"></a>CloudFront Cache Behaviors</h4><ul><li>æ ¹æ®ä¸åŒçš„ URL ç»“æ„åšä¸åŒçš„ Cache Behaviors</li><li>Maximize cache hits by separating staic and dynamic distributions</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150007.png"></p><hr><h4 id="CloudFront-Geo-Restriction"><a href="#CloudFront-Geo-Restriction" class="headerlink" title="CloudFront Geo Restriction"></a>CloudFront Geo Restriction</h4><ul><li>Allowlist &amp; Blocklist (é’ˆå¯¹ IP, å›½å®¶è¿›è¡Œè®¿é—®é™åˆ¶)<ul><li>CloudFront Geo Restriction æ²¡åŠæ³•å’Œ VPC ä¸€èµ·ä½¿ç”¨</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233638.png"></p><hr><h4 id="CloudFront-Signed-URL-x2F-Cookies"><a href="#CloudFront-Signed-URL-x2F-Cookies" class="headerlink" title="CloudFront Signed URL &#x2F; Cookies"></a>CloudFront Signed URL &#x2F; Cookies</h4><ul><li>ç±»ä¼¼ S3 Pre-Signed URL<ul><li>Signed URL: access to individual files (å•ä¸ªæ–‡ä»¶)</li><li>Signed Cookies: access to multiple files (å¤šä¸ªæ–‡ä»¶)</li></ul></li><li>Recommend to use Trusted Key Group than CloudFront Key Pair (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img484256.png"></p><ul><li>CloudFront Signed URL vs. S3 Pre-Signed URL<ul><li>Access CloudFront çš„å°±æ˜¯ CloudFront Signed URL</li><li>Access S3 çš„å°±æ˜¯ S3 Pre-Signed URL</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184528.png"></p><ul><li>ä¸ CloudFront signer æœ‰å…³çš„ 2 ä¸ªçŸ¥è¯†ç‚¹<ul><li>When create a signer, the public key is CloudFront and private key is used to sign a portion of URL</li><li>When use the root user to manage CloudFront key pairs, you can only have up to two active CloudFront key pairs per AWS account</li></ul></li><li>CloudFront Key Pair åªèƒ½ç”± root user æ¥åˆ›å»º</li></ul><hr><h4 id="CloudFront-Advanced-Concepts"><a href="#CloudFront-Advanced-Concepts" class="headerlink" title="CloudFront Advanced Concepts"></a>CloudFront Advanced Concepts</h4><ul><li>Price Classes (ä¸€å…± 3 ç§)<ul><li>Price Class All: all regions - best performance </li><li>Price Class 200: most regions, but excludes the most expensive regions</li><li>Price Class 100: only the least expensive regions</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185111.png"></p><ul><li>CloudFront - Origin Groups<ul><li>Increase high-availability and do failover</li><li>Origin Group: one primary and one secondary origin</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185430.png"></p><ul><li>CloudFront - Field Level Encryption<ul><li>Protect user sensitive information through application stack (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185545.png"></p><hr><h4 id="CloudFront-Real-Time-Logs"><a href="#CloudFront-Real-Time-Logs" class="headerlink" title="CloudFront Real Time Logs"></a>CloudFront Real Time Logs</h4><ul><li>Get real-time requests received by CloudFront sent to Kinesis Data Stream</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img195222.png"></p><hr><h4 id="AWS-Global-Accelerator"><a href="#AWS-Global-Accelerator" class="headerlink" title="AWS Global Accelerator"></a>AWS Global Accelerator</h4><ul><li>åˆ©ç”¨ AWS internal network to route application<ul><li>Provide 2 global static anycast IPs (é‡è¦)</li><li>Improve availability and performance of the applications (globally)</li></ul></li><li>Global Accelerator improves performance for applications over TCP or UDP</li><li>Global Accelerator has automatic failover </li><li>Global Accelerator is more expensive as it adds an extra layer of infrastructure (å¯¹æ¯” CloudFront ä¸æ˜¯ä¸€ä¸ª cost-effective çš„é€‰æ‹©)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234527.png"></p><ul><li>AWS Global Accelerator vs CloudFront<ul><li>CloudFront: Content is served at edge, æ¯”å¦‚å›¾ç‰‡å’Œè§†é¢‘ (cacheable), Dynamic content such as API acceleration &amp; dynamic site delivery</li><li>Global Accelerator: é€‚åˆ TCP æˆ–è€… UDP, æ¯”å¦‚æ¸¸æˆå’Œ IoT (static IP)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img000939.png"></p><blockquote><p>AWS Global Accelerator is a network service that can provide a global traffic management solution. By creating a standard accelerator in AWS Global Accelerator, you can guide user traffic to the endpoint closest to them, thereby improving the performance and availability of the application. </p></blockquote><hr><h3 id="14-ECS-ECR-amp-Fargate"><a href="#14-ECS-ECR-amp-Fargate" class="headerlink" title="14. ECS, ECR &amp; Fargate"></a>14. ECS, ECR &amp; Fargate</h3><h4 id="AWS-ECS"><a href="#AWS-ECS" class="headerlink" title="AWS ECS"></a>AWS ECS</h4><ul><li>Elastic Container Service (Manage Docker containers on AWS)</li><li>ECS æœ‰ä¸¤ç§ Launch Type: EC2 å’Œ Fargate (Fargate æ˜¯ serverless çš„)</li><li>EC2 Launch Type: Need Provision, éœ€è¦ ECS Agent (é‡ç‚¹)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img212508.png"></p><ul><li>Fargate Launch Type: Serverless, No Provision (é‡ç‚¹)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img212546.png"></p><ul><li>IAM Roles for ECS (é‡è¦, æ˜¯ IAM)<ul><li>EC2 Instance Profile: åªé’ˆå¯¹ EC2 Launch Type, used by ECS agent</li><li>ECS Task Role: æ¯ä¸ª Task éƒ½æœ‰è‡ªå·±çš„ Role (è´Ÿè´£)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img212709.png"></p><ul><li>ECS å¯ä»¥å’Œ Load Balancer ä¸€èµ·ç”¨ (ALB &#x2F; NLB)</li><li>ECS å¯ä»¥å’Œ EFS ä¸€èµ·ç”¨ (Fargate + EFS &#x3D; Serverless, ç®¡ç†æ–‡ä»¶)</li><li>å¦‚æœ terminate ECS å‡ºç° synchronization issue, é‚£ä¹ˆ ECS å½“å‰çš„çŠ¶æ€ä¸€å®šæ˜¯ <code>STOPPED</code></li><li>å¦‚æœ ECS cluster launch å‡ºé—®é¢˜, é‚£ä¹ˆå…ˆæ£€æŸ¥ <code>ecs.config</code> æœ‰æ²¡æœ‰é—®é¢˜</li></ul><blockquote><p>Amazon ECS with EC2 launch type is charged based on EC2 instances and EBS volumes used. Amazon ECS with Fargate launch type is charged based on vCPU and memory resources that the containerized application requests</p></blockquote><hr><h4 id="ECS-Auto-Scaling"><a href="#ECS-Auto-Scaling" class="headerlink" title="ECS Auto Scaling"></a>ECS Auto Scaling</h4><ul><li>Automatically increase &#x2F; decrease the number of ECS tasks<ul><li>Target Scaling: Scale based on target value for CloudWatch metric</li><li>Step Scaling: Scale based on CloudWatch Alarm (é‡è¦)</li><li>Scheduled Scaling: Scale based on specific time (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img222247.png"></p><ul><li>Auto Scaling EC2 Instances<ul><li>Accommodate ECS Service Scaling by adding underlying EC2 Instances</li><li>Auto Scaling Group Scaling &#x2F; ECS Cluster Capacity Provider</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img205104.png"></p><hr><h4 id="ECS-Rolling-Updates"><a href="#ECS-Rolling-Updates" class="headerlink" title="ECS Rolling Updates"></a>ECS Rolling Updates</h4><ul><li>Control how many tasks can be started and stopped when update from v1 to v2</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img205259.png"></p><hr><h4 id="ECS-Task-Definitions"><a href="#ECS-Task-Definitions" class="headerlink" title="ECS Task Definitions"></a>ECS Task Definitions</h4><ul><li>Task definitions are metadata in JSON form to tell ECS how to run Docker container</li><li>Environment Variable: Hardcoded, SSM Parameter Store, Secrets Manager, S3</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img210902.png"></p><ul><li>ECS Load Balancing - EC2 Launch Type<ul><li>Get a Dynamic Host Port Mapping if define only the container port in task definiton</li><li>Must allow EC2 Instanceâ€™s Security Group any port from the ALBâ€™s Security Group (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img211103.png"></p><ul><li>ECS Load Balancing - Fargate<ul><li>Each task has a unique private IP, only define the container port</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img211211.png"></p><ul><li>ECS Data Volumes (Bind Mounts)<ul><li>Share data between multiple containers in the same Task Definition</li><li>Work for both EC2 and Fargate</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img211542.png"></p><hr><h4 id="ECS-Task-Placements"><a href="#ECS-Task-Placements" class="headerlink" title="ECS Task Placements"></a>ECS Task Placements</h4><ul><li>For EC2 Launch Type, determine where to place the EC2, CPU, Memory ç­‰ç­‰</li><li>ECS Task Placement Strategies could mixed together (Binpack, Random å’Œ Spread)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img212801.png"></p><ul><li>ECS Task Placement Strategies - Binpack<ul><li>Place tasks based on the least available amount of CPU or memory</li><li>This minimize the number of instances in use (cost saving, é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img213429.png"></p><ul><li>ECS Task Placement Strategies - Random<ul><li>Place the task randomly</li><li>To enable random host port, set host <code>port = 0</code> or empty, which allow multiple containers of same type to launch on the same EC2 container instance</li><li>å¦‚æœé—®åˆ°ç¬¬ä¸€ä¸ª container è¿è¡ŒæˆåŠŸ, ä½†ç¬¬äºŒä¸ªè¿è¡Œå¤±è´¥, é‚£å°±æ˜¯ host port çš„é—®é¢˜</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img213517.png"></p><ul><li>ECS Task Placement Strategies - Spread<ul><li>Place the task evenly based on the specified value</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img213603.png"></p><ul><li>ECS Task Placement Constraints<ul><li><code>distinctInstance</code>: Place each task on a different container instance</li><li><code>memberOf</code>: Place task on instances that satisfy an expression</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img213754.png"></p><hr><h4 id="AWS-ECR"><a href="#AWS-ECR" class="headerlink" title="AWS ECR"></a>AWS ECR</h4><ul><li>Elastic Container Registry (ECR, ç®¡ç† Docker Image, ä¸æ˜¯ Docker Container)<ul><li>Store and manage Docker images on AWS</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img222836.png"></p><ul><li>How to use CLI to pull and push image to ECR<ul><li>Login Command (aws å¼€å¤´) &#x2F; Docker Commands (docker å¼€å¤´)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img214106.png"></p><hr><h4 id="AWS-CoPilot"><a href="#AWS-CoPilot" class="headerlink" title="AWS CoPilot"></a>AWS CoPilot</h4><ul><li>CLI tool to build, release, and operate production-ready containerized apps<ul><li>Run your apps on AppRunner, ECS, and Fargate</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img214226.png"></p><hr><h4 id="AWS-EKS"><a href="#AWS-EKS" class="headerlink" title="AWS EKS"></a>AWS EKS</h4><ul><li>Elastic Kubernetes Service (Manage Kubernetes clusters on AWS)<ul><li>Support 2 deployment mode: EC2 &amp; Fargate (å’Œ ECS ä¸€æ ·)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223132.png"></p><ul><li>EKS Data Volumes (éœ€è¦ StorageClass)<ul><li>Leverages a Container Storage Interface (CSI) compliant driver</li><li>æ”¯æŒ EBS, EFS, FSx</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223503.png"></p><hr><h3 id="15-Elastic-Beanstalk"><a href="#15-Elastic-Beanstalk" class="headerlink" title="15. Elastic Beanstalk"></a>15. Elastic Beanstalk</h3><h4 id="AWS-Elastic-Beanstalk"><a href="#AWS-Elastic-Beanstalk" class="headerlink" title="AWS Elastic Beanstalk"></a>AWS Elastic Beanstalk</h4><ul><li>Elastic Beanstalk is a developer centric view of deploying an application on AWS</li><li>Automatically handles capacity provisioning, load balancing, scaling ç­‰ç­‰</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150326.png"></p><ul><li>Web Server Tier vs. Worker Tier (é‡è¦)<ul><li>ä¸€ä¸ªç®¡ Web Server, å¦ä¸€ä¸ªå¤„ç† Process (SQS, SNS ç­‰ç­‰)</li></ul></li><li>å¯¹äº Worker æˆ–è€… Web environment æ¥è¯´, éœ€è¦ä¸€ä¸ª <code>cron.yaml</code> æ–‡ä»¶</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img210711.png"></p><ul><li>å¦‚æœé€‰æ‹© deploy åˆ° Elastic Beanstalk ä¸Š, å¹¶ä¸”çœé’±, é€‰æ‹© Single Instance Mode</li><li>å¦‚æœéœ€è¦ç”¨ç±»ä¼¼ Rust è¿™ç§ä¸æ”¯æŒçš„ runtime, å¯ä»¥ç”¨ Docker image å»è·‘ Elastic Beanstalk</li><li>å¦‚æœ deploy å¤±è´¥, é‚£ä¹ˆ EB ä¼š replace the failed instances with instances running in the application version from the most recent successful deployment (é‡è¦)</li><li>å¦‚æœè¦ setup HTTPS on Beanstalk, è¦åœ¨ <code>.ebextensions</code> folder å¼„ä¸€ä¸ª config æ¥ç®¡ Load Balancer</li></ul><hr><h4 id="Beanstalk-Deployment-Modes"><a href="#Beanstalk-Deployment-Modes" class="headerlink" title="Beanstalk Deployment Modes"></a>Beanstalk Deployment Modes</h4><ul><li>ä¸€å…± 6 ç§ Beanstalk Deployment Modes</li><li>è¿™é‡Œé¢ Immutable å’Œ Traffic Splitting å¯èƒ½ä¼šå¯¼è‡´ EC2 burst balance lost (é‡è¦)</li><li>æ³¨æ„, Rolling å’Œ Rolling with additional batches éƒ½ä¼šå¯¼è‡´ reduce availability</li><li>All at once (ç›´æ¥å…¨éƒ¨æ›´æ–°, ä½†ä¼šæœ‰ downtime)<ul><li>Fastest, but have downtime</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151200.png"></p><ul><li>Rolling (ä¸€æ‰¹ä¸€æ‰¹çš„æ›´æ–°)<ul><li>Update a few instances at a time (bucket), then move onto the next bucket</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151311.png"></p><ul><li>Rolling with additional batches (ç±»ä¼¼ Rolling, ä½†æ˜¯è€ç‰ˆæœ¬ä»ç„¶è¿è¡Œ, æœ‰éƒ¨åˆ†é¢å¤–è´¹ç”¨)<ul><li>Like rolling, but spins up new instances to move the batch, old application still available</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151443.png"></p><ul><li>Immutable (å’Œ quick roll back æœ‰å…³)<ul><li>Spin up new instances in a new ASG, deploys version to these instances, and then swaps all the instances when everything is healthy</li><li>å¦‚æœéœ€è¦ maintain at least the full capacity of the application and minimal impact of fail deployment, é€‰æ‹© Immutable</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151738.png"></p><ul><li>Blue Green (ä¼šå…ˆåˆ›é€ ä¸€ä¸ªæ–°çš„ environment)<ul><li>Create a new environment and switch over when ready</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151838.png"></p><ul><li>Traffic Splitting (åˆ†ä¸€éƒ¨åˆ† traffic åˆ°æ–°ç¯å¢ƒ)<ul><li>Canary testing, send a small % of traffic to new deployment</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151935.png"></p><hr><h4 id="Beanstalk-Lifecycle-Policy"><a href="#Beanstalk-Lifecycle-Policy" class="headerlink" title="Beanstalk Lifecycle Policy"></a>Beanstalk Lifecycle Policy</h4><ul><li>Elastic Beanstalk can store at most 1000 application versions</li><li>To phase out old application versions, use a lifecycle policy (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img152423.png"></p><hr><h4 id="Beanstalk-Extensions"><a href="#Beanstalk-Extensions" class="headerlink" title="Beanstalk Extensions"></a>Beanstalk Extensions</h4><ul><li>A zip file containing code must be deployed to Elastic Beanstalk<ul><li>In the <code>.ebextensions/</code> in the root directory (å¿…é¡»å­˜åœ¨ <code>.ebextensions</code> çš„æ–‡ä»¶å¤¹ä¸‹)</li><li><code>.config</code> extensions (å¿…é¡»ä»¥ <code>.config</code> ä¸ºæ–‡ä»¶åç¼€)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img155315.png"></p><hr><h4 id="Beanstalk-with-CloudFormation"><a href="#Beanstalk-with-CloudFormation" class="headerlink" title="Beanstalk with CloudFormation"></a>Beanstalk with CloudFormation</h4><ul><li>Under the hood, Elastic Beanstalk relies on CloudFormation</li><li>CloudFormation is used to provision other AWS services</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img161346.png"></p><hr><h4 id="Beanstalk-Cloning"><a href="#Beanstalk-Cloning" class="headerlink" title="Beanstalk Cloning"></a>Beanstalk Cloning</h4><ul><li>Clone an environment with the exact same configuration</li><li>Useful for deploying a <code>test</code> version of your application</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img161531.png"></p><hr><h3 id="16-AWS-CloudFormation"><a href="#16-AWS-CloudFormation" class="headerlink" title="16. AWS CloudFormation"></a>16. AWS CloudFormation</h3><h4 id="AWS-CloudFormation"><a href="#AWS-CloudFormation" class="headerlink" title="AWS CloudFormation"></a>AWS CloudFormation</h4><ul><li>A declarative way of outlining AWS Infrastructure (ç›¸å½“äºæœ‰ä¸€ä¸ªæ¨¡æ¿å¸®ä½ ç”Ÿæˆä½ æƒ³è¦çš„)<ul><li>éœ€è¦ä»€ä¹ˆ (eg. EC2 Instance, S3), CloudFormation ç»™ä½  create ä»€ä¹ˆ</li><li>CloudFormation æ˜¯ IaaS (Infrastructure as a Service)</li></ul></li><li>Can leverage existing templates on the web (å¯ä»¥ç”¨ç½‘ä¸Šå·²ç»æœ‰çš„ template)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img003448.png"></p><ul><li>Templates must be uploaded in S3 and referenced in CloudFormation (é‡è¦)</li><li>To update a template, need to re-upload a new version of the template (é‡è¦)<ul><li>ä¸€èˆ¬æ¥è¯´, å…ˆåœ¨æœ¬åœ°æ›´æ–° CloudFormation template, ç„¶åä¸Šä¼ åˆ° S3 å¹¶åœ¨ CloudFormation console é‡Œé¢åº”ç”¨</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img193232.png"></p><ul><li>Deploying CloudFormation Templates (2 ç§æ–¹æ³•)<ul><li>Manual way: Edit templates in Applcation Composer or code editor</li><li>Automated way: Edit templates in a YAML file</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img193404.png"></p><ul><li>æ³¨æ„, ä¾èµ– CloudFormation æ¥ provision resource çš„æ˜¯ Elastic Beanstalk å’Œ SAM</li><li>CloudFormation ç”¨æ¥ upload Lambda å’Œ CloudFormation template çš„æ˜¯ <code>cloudformation package and cloudformation deploy</code></li><li>å¦‚æœè¦ declare Lambda function in CloudFormation<ul><li>Write the AWS Lambda code inline in CloudFormation in the <code>AWS::Lambda::Function</code> block as long as there are no third-party dependencies</li><li>Upload all the code as a zip to S3 and refer the object in <code>AWS::Lambda::Function</code> block</li></ul></li></ul><hr><h4 id="CloudFormation-Resources"><a href="#CloudFormation-Resources" class="headerlink" title="CloudFormation Resources"></a>CloudFormation Resources</h4><ul><li>Resources represent different AWS Components that will be created and configured<ul><li>ä¸éœ€è¦å®šä¹‰ <code>Resource</code> ç”Ÿæˆçš„ order</li><li><code>Resource</code> æ˜¯ mandatory çš„ (é‡è¦)</li></ul></li><li>å½¢å¼ <code>service-provider::service-name::data-type-name</code></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img194109.png"></p><hr><h4 id="CloudFormation-Parameters"><a href="#CloudFormation-Parameters" class="headerlink" title="CloudFormation Parameters"></a>CloudFormation Parameters</h4><ul><li>Parameters are a way to provide inputs to AWS CloudFormation Template<ul><li>Can reuse the templates, also donâ€™t need to re-upload the template</li><li>Parameter type æœ‰ <code>AWS::EC2::KeyPair::KeyName, CommaDelimitedList, String</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img194424.png"></p><ul><li>Parameters Settings (è®°ä¸‹é¢ 2 ä¸ª)<ul><li><code>AllowedValues</code>: ç»™ç”¨æˆ·é€‰é¡¹, æ¯”å¦‚é€‰æ‹© <code>t2.micro</code>, <code>t2.small</code>, <code>t2.medium</code></li><li><code>NoEcho</code>: æŠŠ password è¿™ç§ secret çš„ä¸œè¥¿ä» log é‡Œé¢ç§»é™¤</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img194757.png"></p><ul><li>Pseudo Parameters<ul><li>Can be used anytime and enabled by default</li><li><code>AccountId, Region, StackId, StackName, NotificationARNs, NoValue</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223040.png"></p><hr><h4 id="CloudFormation-Mappings"><a href="#CloudFormation-Mappings" class="headerlink" title="CloudFormation Mappings"></a>CloudFormation Mappings</h4><ul><li>Mappings are fixed variables within CloudFormation template<ul><li>Used to differentiate between environments (dev vs. prod), regions, AMI ç­‰ç­‰</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img212000.png"></p><hr><h4 id="CloudFormation-Outputs-amp-Exports"><a href="#CloudFormation-Outputs-amp-Exports" class="headerlink" title="CloudFormation Outputs &amp; Exports"></a>CloudFormation Outputs &amp; Exports</h4><ul><li>Outputs declares optional ouputs values that can import into other stacks (é‡è¦)<ul><li>Outputs å¯ä»¥ç”³æ˜èµ„æºè®©æˆ‘ä»¬å¯ä»¥åœ¨å…¶ä»– Stack é‡Œé¢ç”¨ (å‰ææ˜¯å…ˆ export å®ƒä»¬)</li><li>Exported output name åœ¨ Region å†…å¿…é¡»æ˜¯ unique çš„ (é‡è¦)</li></ul></li><li>å¦‚æœæˆ‘ä»¬è¦åœ¨ç¬¬äºŒä¸ª template é‡Œé¢å» leverage å‰ä¸€ä¸ª template çš„èµ„æº, è¦ç”¨åˆ° <code>Fn::ImportValue</code> (é‡è¦)</li><li>æ³¨æ„, <code>ImportValue</code> æ˜¯ç”¨æ¥ reference value from other stack, <code>Export</code> æ‰æ˜¯ç”¨æ¥ export value to other stacks çš„</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img212344.png"></p><ul><li>æ³¨æ„, å¯¹äº CloudFormation æ¥è¯´, All of the imports must be removed before you can delete the exporting stack or modify the output value, æ‰€ä»¥å¦‚æœé‡åˆ° Stack B, C éœ€è¦ reference Stack A, é‚£ä¹ˆ Stack A ä¸€å®šæ˜¯æœ€åè¢«åˆ é™¤çš„</li></ul><hr><h4 id="CloudFormation-Conditions"><a href="#CloudFormation-Conditions" class="headerlink" title="CloudFormation Conditions"></a>CloudFormation Conditions</h4><ul><li>Conditions are used to control the creation of resources or outputs based on a condition<ul><li>å¸¸è§çš„æœ‰ Environment, AWS Region, Parameter value</li></ul></li><li>å¯ä»¥å’Œ <code>Conditions</code> associate æœ‰ <code>Resources, Conditions, Outputs</code></li><li>åœ¨ CloudFormation template é‡Œé¢ä»£è¡¨ invalid section çš„æ˜¯ <code>Dependencies</code></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img212731.png"></p><hr><h4 id="CloudFormation-Intrinsic-Functions"><a href="#CloudFormation-Intrinsic-Functions" class="headerlink" title="CloudFormation Intrinsic Functions"></a>CloudFormation Intrinsic Functions</h4><ul><li><code>Fn::Ref</code>: Reference Rarameters or Resources (åªèƒ½åœ¨ Parameter æˆ–è€… Resource é‡Œç”¨)</li><li><code>Fn::GetAtt</code>: Get an attribute from your resource</li><li><code>Fn::FindInMap</code>: Return a named value from a specific key (æ³¨æ„, å°± 3 å‚æ•°)</li><li><code>Fn::ImportValue</code>: Import values that are exported in other stacks</li><li><code>Fn::Base64</code>: Convert String to itâ€™s Base64 representation</li><li>Condition Functions: <code>Fn::And/Equals/If/Not/Or</code></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img214211.png"></p><hr><h4 id="CloudFormation-Rollbacks"><a href="#CloudFormation-Rollbacks" class="headerlink" title="CloudFormation Rollbacks"></a>CloudFormation Rollbacks</h4><ul><li>Stack Creation Fails å’Œ Stack Update Fails éƒ½ä¼šå» rollback, ä½† rollback ä¹Ÿå¯èƒ½å¤±è´¥</li><li>Rollback ä¹‹åå¦‚æœéœ€è¦é‡æ–°æ›´æ–° Stack, è¦å…ˆåˆ é™¤ä¹‹å‰çš„ Stack, ç„¶å create æ–°çš„ Stack</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img215108.png"></p><hr><h4 id="CloudFormation-Service-Role"><a href="#CloudFormation-Service-Role" class="headerlink" title="CloudFormation Service Role"></a>CloudFormation Service Role</h4><ul><li>IAM role that allow CloudFormation to <code>create/update/delete</code> stack resources<ul><li>å¯ä»¥ç”¨ Stack Servie Role å»ç»™ developer permission å»ç®¡ç† resources (é‡è¦)</li></ul></li><li>Achieve least privilege principle, must have <code>iam::PassRole</code> permission</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img215347.png"></p><hr><h4 id="CloudFormation-DeletionPolicy"><a href="#CloudFormation-DeletionPolicy" class="headerlink" title="CloudFormation DeletionPolicy"></a>CloudFormation DeletionPolicy</h4><ul><li>DeletionPolicy &#x3D; Delete (é»˜è®¤)<ul><li>Control what happens when the CloudFormation template is deleted or when a resource is removed from a CloudFormation template</li></ul></li><li>Delete wonâ€™t work on S3 if bucket is not empty</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img220014.png"></p><ul><li>DeletionPolicy &#x3D; Retain (ç›¸å½“äºç”³æ˜ä»€ä¹ˆè¦è¢«ä¿å­˜)<ul><li>Specify on resources to preserve in case of CloudFormation deletes</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img220147.png"></p><ul><li>DeletionPolicy &#x3D; Snapshot (ä¼šåœ¨åˆ é™¤å‰ç”Ÿæˆä¸€ä¸ªå¤‡ä»½)<ul><li>Create one final snapshot before deleting the resource</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img220302.png"></p><hr><h4 id="CloudFormation-Stack-Policy"><a href="#CloudFormation-Stack-Policy" class="headerlink" title="CloudFormation Stack Policy"></a>CloudFormation Stack Policy</h4><ul><li>A Stack Policy is a JSON document that defines the update actions that are allowed on specific resources during Stack updates</li><li>Protect resources from unintentional updates (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img220535.png"></p><hr><h4 id="CloudFormation-Termination-Protection"><a href="#CloudFormation-Termination-Protection" class="headerlink" title="CloudFormation Termination Protection"></a>CloudFormation Termination Protection</h4><ul><li>To prevent accidental deletes of CloudFormation Stacks, use <code>TerminationProtection</code></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img220655.png"></p><hr><h4 id="CloudFormation-Custom-Resources"><a href="#CloudFormation-Custom-Resources" class="headerlink" title="CloudFormation Custom Resources"></a>CloudFormation Custom Resources</h4><ul><li>Used to define resources that are not supported or outside CloudFormation</li><li>Defined in template with <code>Custom::MyCustomResourceTypeName</code></li><li>å¯ä»¥å¤„ç†ä¹‹å‰æåˆ°çš„ S3 bucket æ— æ³•åˆ é™¤çš„é—®é¢˜</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img221103.png"></p><hr><h4 id="CloudFormation-StackSets"><a href="#CloudFormation-StackSets" class="headerlink" title="CloudFormation StackSets"></a>CloudFormation StackSets</h4><ul><li>Create, update, delete stacks across multiple accounts and regions<ul><li>æ³¨æ„, StackSets æ˜¯ç»™å¤šä¸ªè´¦æˆ·, æˆ–è€…å¤šä¸ª Region å»åˆ›é€  CloudFormation stack</li><li>åªæœ‰ Administrator æ‰å¯ä»¥åˆ›å»º StackSets</li></ul></li><li>When update a stack set, all associated stack instance will be updated (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img221509.png"></p><hr><h3 id="17-SQS-SNS-Kinesis"><a href="#17-SQS-SNS-Kinesis" class="headerlink" title="17. SQS, SNS, Kinesis"></a>17. SQS, SNS, Kinesis</h3><h4 id="AWS-SQS"><a href="#AWS-SQS" class="headerlink" title="AWS SQS"></a>AWS SQS</h4><ul><li>ç”¨æ¥ decouple applications (æ¯”å¦‚å¤„ç†è§†é¢‘, å±äºå¤šå¯¹å¤šæ¨¡å‹)</li><li>SQS scale automatically (unlimited throughput, unlimited message, can retry)</li><li>SQS æœ€å¤šåªèƒ½ä¿å­˜ message 14 å¤©, SQS ä¸€ä¸ª message æœ€å¤§åªæœ‰ 256 KB</li><li>Standard SQS å…è®¸å°† S3 ä½œä¸º event notification destination, SQS FIFO åˆ™ä¸è¡Œ</li><li>å¤„ç† parallel é€‰ SQS è€Œä¸æ˜¯ SNS</li><li>å¤„ç† decouple microservice (ä½†æ˜¯æ²¡æœ‰ 3rd party çš„) å°±æ˜¯ SQS</li><li>å¤„ç† high-throughput request-reponse message pattern çš„, é€‰æ‹© Temporary Queue</li><li>é‡åˆ°è¦å¤„ç† workflows that take a long time to complete, é€‰æ‹© Dedicated worker environment</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img231916.png"></p><ul><li>SQS - Producing Messages<ul><li>Message is persisted in SQS until a consumer delete it (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232217.png"></p><ul><li>SQS - Consuming Messages<ul><li>å¯ä»¥æœ‰å¾ˆå¤š consumer æ¥åŒæ—¶ parallel å¤„ç† messages (é‡è¦)</li><li>Consumer delete messages after processing them (å¤„ç†å®Œå°±åˆ æ‰)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232414.png"></p><ul><li>å½“é‡åˆ° SQS è€Œä¸”éœ€è¦ priority çš„æ—¶å€™, Create two Amazon SQS standard queues, Set up Amazon EC2 instances to prioritize polling</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/imgpt6-q32-i1.jpg"></p><ul><li>å…³äº SQS <code>CreateQueue</code> API çš„ 2 ä¸ªçŸ¥è¯†ç‚¹</li><li>The visibility timeout value of the queue is in seconds, default is 30 seconds</li><li>You canâ€™t change the queue type after create it</li><li>å¦‚æœé‡åˆ° <code>ApproximateNumberOfMessagesVisible</code> è¿™ä¸ªé—®é¢˜, å¯ä»¥ç”¨ backlog per instance metric with target tracking scaling policy æ¥è§£å†³</li></ul><hr><h4 id="SQS-Message-Visibility-Timeout"><a href="#SQS-Message-Visibility-Timeout" class="headerlink" title="SQS Message Visibility Timeout"></a>SQS Message Visibility Timeout</h4><ul><li>Visibility Timeout is high: Consumer crash, re-process take time</li><li>Visibility Timeout is low: Get duplicate (é˜²æ­¢ read duplicate, å¢åŠ  timeout, é‡è¦)</li><li>Use the <code>ChangeMessageVisibility</code> API call to increase the visibility timeout</li><li>é¢˜ç›®å¤§éƒ¨åˆ†é’ˆå¯¹çš„éƒ½æ˜¯ Visibility Timeout low çš„æƒ…å†µ</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img020440.png"></p><hr><h4 id="SQS-Dead-Letter-Queues-DLQ"><a href="#SQS-Dead-Letter-Queues-DLQ" class="headerlink" title="SQS Dead Letter Queues (DLQ)"></a>SQS Dead Letter Queues (DLQ)</h4><ul><li>Fail to process message within Visibility Timeout, message goes back to queue<ul><li>é—®é¢˜åœ¨äºè¿™ä¸ª message å¯èƒ½æœ¬èº«å°±æ˜¯æ— æ³•å¤„ç†çš„</li><li>é‡åˆ° SQS message process failure, é€‰æ‹© DLQ æ¥è§£å†³ (é‡è¦)</li></ul></li><li>Set a threshold of how many times a message can go back to queue<ul><li>After <code>MaximumReceives</code> threshold exceeded, message goes to DLQ</li><li>DLQ å¾ˆé€‚åˆç”¨æ¥åš Debug</li></ul></li><li>DLQ of a FIFO queue must also be a FIFO queue, same with Standard (å½¢å¼å¾—ç›¸åŒ)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img164418.png"></p><ul><li>DLQ - Redrive to Source (ç›¸å½“äºä» DLQ ä¿®å¤å®Œè¿”å›åŸæ¥çš„ Queue)<ul><li>Feature to help consume messages in DLQ to understand what is wrong</li><li>When the code is fixed, we can redrive the message from DLQ to source queue</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img164607.png"></p><hr><h4 id="SQS-Delay-Queues"><a href="#SQS-Delay-Queues" class="headerlink" title="SQS Delay Queues"></a>SQS Delay Queues</h4><ul><li>Delay a message up to 15 minutes (ä½¿ç”¨ <code>DelaySeconds</code> å‚æ•°)</li><li>é‡åˆ°éœ€è¦ SQS å» postpone the delivery of new messages, é‚£ä¹ˆå°±æ˜¯ Delay Queue</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img164931.png"></p><hr><h4 id="SQS-Long-Polling"><a href="#SQS-Long-Polling" class="headerlink" title="SQS Long Polling"></a>SQS Long Polling</h4><ul><li>Decrease latency &amp; decrease API call (å‡å°‘ API è¯·æ±‚, æ›´å¥½çš„ performance, é‡è¦)<ul><li>Minimize the cost of using SQS (çœé’±)</li><li>Long Polling ä¸èƒ½å¤„ç† SQS duplicate, è¿˜æ˜¯è¦ç”¨ Visibility Timeout</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img003255.png"></p><hr><h4 id="SQS-Extended-Client"><a href="#SQS-Extended-Client" class="headerlink" title="SQS Extended Client"></a>SQS Extended Client</h4><ul><li>Handle send message greater than 256 KB (é‡è¦)<ul><li>è¿™è¯æ˜ SQS çš„ message ä¹Ÿæ˜¯æœ‰ size çš„é™åˆ¶</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img165310.png"></p><hr><h4 id="SQS-FIFO-Queues"><a href="#SQS-FIFO-Queues" class="headerlink" title="SQS FIFO Queues"></a>SQS FIFO Queues</h4><ul><li>æŒ‰ order ä¼ é€’ message (SNS ä¹Ÿå¯ä»¥åšåˆ°)<ul><li>By default, FIFO queues support up to 300 messages per second (é‡è¦)</li></ul></li><li>å¦‚æœæ²¡æœ‰ GroupID, é‚£åªèƒ½æœ‰ 1 ä¸ª consumer, å¦‚æœæœ‰ GroupID, å¯ä»¥æœ‰å¤šä¸ª consumer (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img003507.png"></p><ul><li>æŠŠ SQS è½¬æˆ FIFO queue<ul><li>Delete the existing SQS and recreate it as FIFO queue</li><li>Make sure the name of the FIFO queue ends with .fifo suffix</li><li>Make sure the throughput for the FIFO queue not exceed 3000 meesage &#x2F; second</li></ul></li></ul><hr><h4 id="SQS-FIFO-Queues-Advanced"><a href="#SQS-FIFO-Queues-Advanced" class="headerlink" title="SQS FIFO Queues Advanced"></a>SQS FIFO Queues Advanced</h4><ul><li>De-duplication: (ä½¿ç”¨ <code>MessageDeduplicationID</code>)<ul><li>Send 2 same message within 5 minutes interval, the second will be refused</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img170023.png"></p><ul><li>Message Grouping (ä½¿ç”¨ <code>MessageGroupID</code>)<ul><li>Same <code>MessageGroupID</code> in the entire FIFO queue, then only have 1 consumer</li><li>Different MessageGroupID for a subset of message, have different consumers</li><li>å¯¹äº FIFO queues æ¥è¯´, <code>MessageGroupID</code> å¯ä»¥ä¿è¯ same message group æ˜¯æœ‰ order çš„</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img170254.png"></p><hr><h4 id="AWS-SNS"><a href="#AWS-SNS" class="headerlink" title="AWS SNS"></a>AWS SNS</h4><ul><li>Send one message to many receivers (å¯ä»¥ç»™ç”¨æˆ·å‘ email)<ul><li>Publisher &amp; Subscriber æ¨¡å‹ (å±äºä¸€å¯¹å¤šæ¨¡å‹)</li><li>Subscriber: SQS, Lambda, Kinesis Data Firehose, HTTPS endpoints, Email</li></ul></li><li>SNS Message Filtering: Could filter message based on topic (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img010634.png"></p><hr><h4 id="Fan-Out-Pattern"><a href="#Fan-Out-Pattern" class="headerlink" title="Fan Out Pattern"></a>Fan Out Pattern</h4><ul><li>Push once in SNS, receive in all SQS (ç”± SNS ä¼ é€’ message ç»™ SQS æ¥æ¥æ”¶, é‡è¦)<ul><li>Fully decoupled, no data loss (é‡è¦, å› ä¸ºå®ƒ decouple)</li><li>å¯ä»¥ç”¨äº message filtering (ä¿¡æ¯è¿‡æ»¤, æ ¹æ®ä¸åŒçš„ filter policy)</li></ul></li><li>Kinesis ä¹Ÿå¯ä»¥ä½¿ç”¨ Fan Out Pattern (ä½¿ç”¨ Shard)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img011026.png"></p><hr><h4 id="AWS-Kinesis"><a href="#AWS-Kinesis" class="headerlink" title="AWS Kinesis"></a>AWS Kinesis</h4><ul><li>Process, ingest, buffer streaming data in real-time (å¤„ç†å®æ—¶æ•°æ®)</li><li>Kinesis Data Streams: Capture, process, store data streams</li><li>Kinesis Data Firehose: Load data streams into AWS data stores (S3, Redshift)</li><li>Kinesis Data Analytics: Analyze data streams with SQL or Apache Flink</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150053.png"></p><blockquote><p>Kinesis Agent cannot write to Amazon Kinesis Firehose for which the delivery stream source is already set as Amazon Kinesis Data Streams</p></blockquote><ul><li>Kinesis Agent is a stand-alone Java software application that offers an easy way to collect and send data to Kinesis Data Streams</li></ul><hr><h4 id="Kinesis-Data-Streams"><a href="#Kinesis-Data-Streams" class="headerlink" title="Kinesis Data Streams"></a>Kinesis Data Streams</h4><ul><li>Have the ability to reprocess &amp; replay stream data (å¤„ç†æ•°æ®, é‡è¦)<ul><li>å¤„ç† real-time data stream, æ¯”å¦‚ clickstreams, transactions, media (é‡‘èæ•°æ®)</li><li>Consumer æœ‰ Lambda, Kinesis Firehose, Kinesis Data Analytics</li><li>Kinesis Data Streams æœ‰åŠ©äºæ¯ç§’ä»å¤šä¸ªæ¥æºè¿ç»­æ”¶é›†æ•° GB çš„æ•°æ®</li><li>Kinesis Data Streams æœ€å¤šä¿å­˜æ•°æ® 1 å¹´</li></ul></li><li>Once data is inserted in Kinesis, it canâ€™t be deleted (æ²¡æ³•åˆ é™¤)</li><li>å¦‚æœé—®åˆ° Kinesis Data Stream åŠ ä¸Š SQL, é‚£ä¹ˆç­”æ¡ˆé‡Œä¸€å®šæœ‰ Kinesis Data Analytics</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img014850.png"></p><ul><li>Data share the same partition goes the same shard (æœ‰é¡ºåºçš„)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151123.png"></p><ul><li>Capacity Mode (ä¸€å…± 2 ç§)<ul><li>Provisioned mode: Choose a number of shards provisioned (è®¾ç½®ä¸Šé™)</li><li>On-demand mode: No need to provision or manage capacity (è‡ªåŠ¨ scale)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151507.png"></p><hr><h4 id="Kinesis-Producers"><a href="#Kinesis-Producers" class="headerlink" title="Kinesis Producers"></a>Kinesis Producers</h4><ul><li>Put data records into data streams</li><li>Producers: AWS SDK, Kinesis Producer Library (KPL), Kinesis Agent</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img172002.png"></p><ul><li>Use Hash function to determine which message should go to which Shard</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img172126.png"></p><ul><li>å¦‚æœé‡åˆ° <code>ProvisionedThroughputExceededException</code> é—®é¢˜<ul><li>Over producing to a shard, get <code>ProvisionedThroughputExceededException</code></li><li>è§£å†³æ–¹æ¡ˆ 1: Use highly distributed partition key </li><li>è§£å†³æ–¹æ¡ˆ 2: Use error retry and exponential backoff mechanism</li><li>è§£å†³æ–¹æ¡ˆ 3: Increase shards</li><li>è§£å†³æ–¹æ¡ˆ 4: Decrease the frequency or size of the requests</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img172335.png"></p><hr><h4 id="Kinesis-Consumers"><a href="#Kinesis-Consumers" class="headerlink" title="Kinesis Consumers"></a>Kinesis Consumers</h4><ul><li>Get data records from data streams and process them</li><li>Consumers: Lambda, Kinesis Data Analytics, Kinesis Data Firehose, KCL ç­‰ç­‰</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190504.png"></p><ul><li>Kinesis Consumers - Custom Consumer (é‡è¦)<ul><li>Shared Fan-out Consumer: pull, low number of consuming applications, çœé’±</li><li>Enhanced Fan-out Consumer: push, multiple consuming application, è´µ</li><li>Enhanced Fan-out Consumer å¯ä»¥ increase read throughput (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img202712.png"></p><ul><li>Kinesis Consumers - AWS Lambda (é‡è¦)<ul><li>Supports Classic &amp; Enhanced fan-out consumers</li><li>Read records in batches, can configure batch size and window</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203145.png"></p><hr><h4 id="Kinesis-Client-Library-KCL"><a href="#Kinesis-Client-Library-KCL" class="headerlink" title="Kinesis Client Library (KCL)"></a>Kinesis Client Library (KCL)</h4><ul><li>A Java library that helps read record from a Kinesis Data Stream</li><li>When using Kinesis Client Library, each shard is to be read-only by one KCL instance</li><li>Progress is checkpointed into DynamoDB (need IAM access)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img205645.png"></p><hr><h4 id="Kinesis-Operations"><a href="#Kinesis-Operations" class="headerlink" title="Kinesis Operations"></a>Kinesis Operations</h4><ul><li>Shard Splitting: Deal with <code>hot shard</code><ul><li>Used to increase the Stream capacity, divide a <code>hot shard</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img205913.png"></p><ul><li>Merging Shards: Group two shards with low traffic<ul><li>Decrease the Stream capacity and save costs</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img210015.png"></p><hr><h4 id="Kinesis-Data-Firehose"><a href="#Kinesis-Data-Firehose" class="headerlink" title="Kinesis Data Firehose"></a>Kinesis Data Firehose</h4><ul><li>Kinesis Data Firehose load streaming data into data stores and analytics tools<ul><li>Managed service, auto scaling, serverless, support data transformation</li><li>Kinesis Data Firehose æä¾›å°†æ•°æ®æµä¼ è¿›æ•°æ®å­˜å‚¨æˆ–è€…æ•°æ®åˆ†æçš„åŠŸèƒ½</li></ul></li><li>Near Real Time, è€Œä¸” Firehose åªæ”¯æŒä¸€ä¸ª consumer (dump data in a single data repo)<ul><li>ä½†æ˜¯ä¸è¦è¢« Near Real Time å¿½æ‚ , è¦æ ¹æ®é¢˜ç›®é€‰æ‹© Data Stream æˆ–è€… Data Firehose</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img015040.png"></p><ul><li>Firehose çš„å¯¹è±¡æ˜¯ S3, Redshift è¿™ç§ (Serverless, ä¸“é—¨å¤„ç† log æ•°æ®)<ul><li>Firehose ä¸æ”¯æŒ DynamoDB çš„</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151812.png"></p><ul><li>Kinesis Data Streams vs Firehose<ul><li>Data Streams: Write custom code, real-time, have data storage, have replay</li><li>Firehose: Fully managed, near real-time, no data storage, no replay</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img152247.png"></p><hr><h4 id="Kinesis-Data-Analytics"><a href="#Kinesis-Data-Analytics" class="headerlink" title="Kinesis Data Analytics"></a>Kinesis Data Analytics</h4><ul><li>Real-time analytics on Kinesis Data Streams &amp; Firehose using SQL (é‡è¦)<ul><li>Fully managed, auto-scaling, serverless</li><li>ä»¥ Kinesis Data Streams &amp; Firehose ä½œä¸ºç›®æ ‡ä½¿ç”¨ SQL è¿›è¡Œæ•°æ®åˆ†æ</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img225813.png"></p><ul><li>Amazon Managed Service for Apache Flink<ul><li>Use Flink to process and analyze streaming data</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img225906.png"></p><hr><h4 id="Data-ordering-for-Kinesis"><a href="#Data-ordering-for-Kinesis" class="headerlink" title="Data ordering for Kinesis"></a>Data ordering for Kinesis</h4><ul><li>Ordering data into Kinesis<ul><li>Same key (Partition) will always go to the same shard (æœ‰é¡ºåº)</li><li>é€‚ç”¨äºéœ€è¦å¤„ç†å¤§é‡ data çš„æƒ…å†µ</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img154939.png"></p><ul><li>Ordering data into SQS<ul><li>ç›¸æ¯”ä¹‹ä¸‹ SQS åªæœ‰ FIFO (GroupID), ä¸ç„¶å°±æ²¡æœ‰ ordering</li><li>é€‚ç”¨äºéœ€è¦ dynamic number of consumers çš„æƒ…å†µ</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img210807.png"></p><hr><h3 id="18-AWS-Mointoring-amp-Audit"><a href="#18-AWS-Mointoring-amp-Audit" class="headerlink" title="18. AWS Mointoring &amp; Audit"></a>18. AWS Mointoring &amp; Audit</h3><h4 id="CloudWatch-Metrics"><a href="#CloudWatch-Metrics" class="headerlink" title="CloudWatch Metrics"></a>CloudWatch Metrics</h4><ul><li>CloudWatch Metrics ç”¨äºæ”¶é›†ã€å­˜å‚¨å’Œåˆ†æ AWS èµ„æºå’Œåº”ç”¨ç¨‹åºçš„æ€§èƒ½æŒ‡æ ‡</li><li>å¯ä»¥ç”¨ <code>PutMetricData</code> æ¥ push custom metric data åˆ° CloudWatch é‡Œ</li><li>è®°ä½, å¦‚æœæ˜¯å¤„ç†ç¬¬ä¸‰æ–¹çš„ API, ç”¨çš„ä¸€å®šæ˜¯ CloudWatch custom metrics (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img010357.png"></p><ul><li>CloudWatch - EC2 Detailed Monitoring (é‡è¦)<ul><li>With detailed monitoring, you get data every 1 minute</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img033959.png"></p><hr><h4 id="CloudWatch-Custom-Metrics"><a href="#CloudWatch-Custom-Metrics" class="headerlink" title="CloudWatch Custom Metrics"></a>CloudWatch Custom Metrics</h4><ul><li>Define your own custom metrics to CloudWatch</li><li>High-Resolution Custom Metrics can have a minimum resolution of 1 second (é‡è¦)</li><li>Accepts metric data points two weeks in the past and two hours in the future</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img010630.png"></p><hr><h4 id="CloudWatch-Logs"><a href="#CloudWatch-Logs" class="headerlink" title="CloudWatch Logs"></a>CloudWatch Logs</h4><ul><li>A place to store application logs in AWS (S3, Kinesis, Lambda, OpenSearch)<ul><li>CloudWatch Logs å¯ä»¥è‡ªå·±å®šä¹‰ expire çš„æ—¶é—´, é»˜è®¤æ˜¯ never expire</li><li>Log Retention Policy defined at Log Groups level (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img010815.png"></p><ul><li>CloudWatch Logs Insights (query engine)<ul><li>Search and analyze log data stored in CloudWatch Logs (æŸ¥è¯¢)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150531.png"></p><ul><li>CloudWatch Logs Subscriptions<ul><li>Get a real-time log events from CloudWatch Logs for processing and analysis</li><li>Subscription Filter: Filter which logs are events delivered to destination (é‡è¦)</li><li>Cross-Account Subscription: Send log events to resources in different AWS account</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150643.png"></p><hr><h4 id="CloudWatch-Agent"><a href="#CloudWatch-Agent" class="headerlink" title="CloudWatch Agent"></a>CloudWatch Agent</h4><ul><li>CloudWatch Logs Agent: Old version, only send to CloudWatch Logs</li><li>CloudWatch Unified Agent: å¯ä»¥ä¼ é€’æ›´å¤šä¿¡æ¯, æ¯”å¦‚ CPU, RAM ç­‰ç­‰<ul><li>CloudWatch Unified Agent å¯ä»¥æŠŠ EC2 çš„ log ä¼ é€’ç»™ CloudWatch (é‡è¦)</li></ul></li><li>å¯ä»¥æŠŠ CloudWatch Agent è£…åœ¨ on-premise ä¸Šæ¥æ”¶é›†ä¿¡æ¯</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151251.png"></p><hr><h4 id="CloudWatch-Logs-Metric-Filter"><a href="#CloudWatch-Logs-Metric-Filter" class="headerlink" title="CloudWatch Logs Metric Filter"></a>CloudWatch Logs Metric Filter</h4><ul><li>CloudWatch Logs Metric Filter ç”¨äºä»æ—¥å¿—æ•°æ®ä¸­æå–æŒ‡æ ‡ï¼Œä»¥ç›‘æ§ç‰¹å®šäº‹ä»¶å’Œæ¨¡å¼</li><li>Filters only publish the metric data points for events that happen after the filter was created (åªæœ‰ filter ç”Ÿæˆåçš„ event æ‰ä¼šè¢« filter)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img011918.png"></p><hr><h4 id="CloudWatch-Alarms"><a href="#CloudWatch-Alarms" class="headerlink" title="CloudWatch Alarms"></a>CloudWatch Alarms</h4><ul><li>CloudWatch Alarms are used to trigger notifications for any metric </li><li>CloudWatch Alarms ä¸»è¦å¯¹è±¡æ˜¯ EC2, ASG, SNS (é‡è¦)</li><li>High resolution custom metrics çš„æƒ…å†µä¸‹ triggered æœ€å¿«æ˜¯ 10 ç§’ (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img012137.png"></p><ul><li>Composite Alarms (ç›‘è§†å½“å‰æ‰€æœ‰ Alarm çš„æƒ…å†µ)<ul><li>Composite Alarams are mointoring the states of multiple other alarms</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151615.png"></p><ul><li>å¯ä»¥ç”¨ <code>set-alarm-state</code> CLI æ¥æ§åˆ¶ CloudWatch Alarms, è¿™æ ·æ˜¯ cost-effective çš„</li></ul><hr><h4 id="CloudWatch-Syntheics"><a href="#CloudWatch-Syntheics" class="headerlink" title="CloudWatch Syntheics"></a>CloudWatch Syntheics</h4><ul><li>Configurable script that monitor your APIs, URLs, Websites<ul><li>Can run once or on a regular schedule</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img012521.png"></p><hr><h4 id="AWS-EventBridge"><a href="#AWS-EventBridge" class="headerlink" title="AWS EventBridge"></a>AWS EventBridge</h4><ul><li>Schedule CRON jobs <code>CRON means jobs on a repeating schedule</code></li><li>React to events from SaaS application (AWS services)<ul><li>å¦‚æœæåˆ° 3rd party application, è€ƒè™‘ EventBridge</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185605.png"></p><ul><li>Event Bus<ul><li>å¯ä»¥ archive rvents å¹¶ä¸” replay archived events, good for debugging</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190403.png"></p><ul><li>Schema Registry: Generate code in advance for how data is structured in event bus<ul><li>Analyze events in Event Bus and infer schema</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190004.png"></p><ul><li>Resource-based Policy<ul><li>Manage permissions (allow &#x2F; deny) for a specific Event Bus</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190215.png"></p><hr><h4 id="AWS-X-Ray"><a href="#AWS-X-Ray" class="headerlink" title="AWS X-Ray"></a>AWS X-Ray</h4><ul><li>Automated Trace Analysis &amp; Central Service Map Visulization<ul><li>AWS X-Ray æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼è·Ÿè¸ªç³»ç»Ÿï¼Œç”¨äºåˆ†æå’Œè°ƒè¯•ç”Ÿäº§å’Œåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„æ€§èƒ½é—®é¢˜</li><li>X-Ray å¯ä»¥ cross-account tracing and visualization (é‡è¦, tracing å’Œ visualization)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img020641.png"></p><ul><li>How to enable X-Ray (ä¸¤ç§æ–¹æ³•)<ul><li>Import the AWS X-Ray SDK in your code</li><li>Install the X-Ray daemon or enable X-Ray AWS Integration</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img021009.png"></p><ul><li>X-Ray Troubleshooting (EC2 è¦åœ¨ Instance ä¸Šè·‘ X-Ray Daemon)<ul><li>EC2: IAM Role has proper permission å’Œ Instace running X-Ray Daemon (é‡è¦)</li><li>Lambda: IAM Role <code>RayWriteOnlyAccess</code> å’Œ Enable Lambda X-Ray Active Tracing</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img021323.png"></p><ul><li>å¦‚æœè¦åœ¨ Farget deployed çš„ Docker ä¸Šè·‘ X-Ray daemon<ul><li>Deploy the X-Ray daemon agent as a sidecar container</li><li>Provide the correct IAM task role to the X-Ray container</li></ul></li><li>å¦‚æœè¦éªŒè¯ X-Ray daemon åœ¨ ECS ä¸Šè·‘, ç”¨ <code>AWS_XRAY_DAEMON_ADDRESS</code></li></ul><hr><h4 id="X-Ray-Advance"><a href="#X-Ray-Advance" class="headerlink" title="X-Ray Advance"></a>X-Ray Advance</h4><ul><li>Instrumentation: Measure of productâ€™s performance and write trace information<ul><li>æ£€æµ‹åº”ç”¨ç¨‹åºæ¶‰åŠå‘é€ä¼ å…¥å’Œä¼ å‡ºè¯·æ±‚ä»¥åŠåº”ç”¨ç¨‹åºå†…å…¶ä»–äº‹ä»¶çš„è·Ÿè¸ªæ•°æ®</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img021538.png"></p><ul><li>X-Ray Concepts (è®°ä¸‹é¢ 2 ä¸ª)<ul><li><code>Sampling</code>: Decrease the amount of requests sent to X-Ray, reduce cost (çœé’±)</li><li><code>Annotations</code>: Index traces and use with filters (é‡è¦, æœ‰ filter)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img021924.png"></p><ul><li>X-Ray Sampling Rules (å¯ä»¥æ§åˆ¶ record data çš„æ•°é‡, é‡è¦)<ul><li>With sampling rules, you control the amount of data that you record</li><li>X-Ray records first request each second, and five percent for additional requests</li><li>ä¸Šé¢é‡è¦çš„ç‚¹: first request <code>each second</code>, addition requests <code>5 percent</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img022256.png"></p><hr><h4 id="X-Ray-APIs"><a href="#X-Ray-APIs" class="headerlink" title="X-Ray APIs"></a>X-Ray APIs</h4><ul><li>X-Ray Write APIs<ul><li><code>PutTraceSegments</code>: Upload segment documents to AWS X-Ray</li><li><code>PutTelemetryRecords</code>: Used by AWS X-Ray daemon to upload telemetry</li><li><code>GetSamplingRules</code>: Retrieve all sampling rules</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img022650.png"></p><ul><li>X-Ray Read APIs: å…¨éƒ½éƒ½å¸¦æœ‰ <code>Get</code><ul><li><code>GetServiceGraph</code>: Main graph</li><li><code>BatchGetTrace</code>: Retrieve a list of traces specified by ID</li><li><code>GetTraceSummaries</code>: Retrieve IDs and annotations for trace in a time frame</li><li><code>GetTraceGraph</code>: Retrieve a service graph for one or more trace IDs</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img022934.png"></p><hr><h4 id="X-Ray-with-Beanstalk"><a href="#X-Ray-with-Beanstalk" class="headerlink" title="X-Ray with Beanstalk"></a>X-Ray with Beanstalk</h4><ul><li>å¯ä»¥åœ¨ Elastic Beanstalk ä½¿ç”¨ X-Ray daemon (ç”¨ console æˆ–è€… config file)<ul><li>éœ€è¦ <code>.ebextensions/xray-daemon.config</code> æ–‡ä»¶</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img023148.png"></p><hr><h4 id="AWS-Distro-for-OpenTelemetry"><a href="#AWS-Distro-for-OpenTelemetry" class="headerlink" title="AWS Distro for OpenTelemetry"></a>AWS Distro for OpenTelemetry</h4><ul><li>AWS supported distribution of open-source project OpenTelemetry</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img023636.png"></p><hr><h4 id="AWS-CloudTrail"><a href="#AWS-CloudTrail" class="headerlink" title="AWS CloudTrail"></a>AWS CloudTrail</h4><ul><li>AWS CloudTrail æ˜¯ä¸€é¡¹æ—¥å¿—è®°å½•æœåŠ¡ï¼Œè®°å½•å’Œç›‘æ§ AWS è´¦æˆ·ä¸­çš„ API è°ƒç”¨å’Œç›¸å…³æ´»åŠ¨</li><li>CloudTrail æ˜¯ Global Service, å¦‚æœä¸œè¥¿è¢«è¯¯åˆ , ç¬¬ä¸€æ—¶é—´çœ‹ CloudTrail</li><li>CloudTrail å¯ä»¥å’Œ EventBridge ä¸€èµ·ç”¨å» Intercept API Calls</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img023929.png"></p><ul><li>CloudTrail Events (ä¸€å…± 3 ç§)<ul><li>Management Events: Performed on resources in AWS account</li><li>Data Events: S3 object-level activity</li><li>CloudTrail Insigths Events: Detect unusual activity (å®‰å…¨)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img023847.png"></p><ul><li>CloudTrail Insights (é‡è¦, ç›‘æ§ unusual activity)<ul><li>CloudTrail Insights to detect unusual activity in account</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192157.png"></p><ul><li>CloudTrail Event Retention (é‡è¦, å’Œ S3, Athena æœ‰å…³)<ul><li>Keep events to S3 after they stored 90 days and use Athena to analyze</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img163847.png"></p><hr><h3 id="19-Lambda"><a href="#19-Lambda" class="headerlink" title="19. Lambda"></a>19. Lambda</h3><h4 id="AWS-Lambda"><a href="#AWS-Lambda" class="headerlink" title="AWS Lambda"></a>AWS Lambda</h4><ul><li>Virtual functions, serverless, limited by time (short execution of 15 min)<ul><li>Run on-demand, scaling is automated</li></ul></li><li>Could be Event-Driven, could handle CRON job<ul><li>Use EventBridge to trigger Lambda every hour</li></ul></li><li>Lambda æ˜¯æœ‰ account quota (é…é¢é™åˆ¶) çš„, éœ€è¦è”ç³» AWS æ¥æé«˜ä¸Šé™</li><li>Lambda environment variable æœ€å¤§é™åˆ¶æ˜¯ 4KB, æ²¡æœ‰æ•°é‡çš„é™åˆ¶</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img162057.png"></p><ul><li>å¯ä»¥ç”¨ Lambda å» connect private subnets in a VPC in your account (é‡è¦)</li><li>å¤§éƒ¨åˆ†é¢˜ç›®éƒ½æ˜¯é€šè¿‡å¢åŠ  memory æ¥ improve CPU-bound Lambda function peformance (é‡è¦)</li><li>API caching æ˜¯ç”¨æ¥ reduce calls çš„, è¦ faster initialization é€‰æ‹© provisioned concurrency</li></ul><hr><h4 id="Lambda-Synchronous-Invocations"><a href="#Lambda-Synchronous-Invocations" class="headerlink" title="Lambda Synchronous Invocations"></a>Lambda Synchronous Invocations</h4><ul><li>Synchronous: CLI, SDK, API Gateway, Application Load Balancer <ul><li>Results is returned right away</li><li>Error handling must happen client side</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img164039.png"></p><hr><h4 id="Lambda-with-ALB"><a href="#Lambda-with-ALB" class="headerlink" title="Lambda with ALB"></a>Lambda with ALB</h4><ul><li>Expose a Lambda function as an HTTPs endpoint, use ALB or API Gateway<ul><li>The Lambda function must be registered in a Target Group (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img163555.png"></p><ul><li>ALB Multi-Header Values<ul><li>HTTP headers and query string parameters are shown as arrays</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img163757.png"></p><hr><h4 id="Lambda-Asynchronous-Invocations"><a href="#Lambda-Asynchronous-Invocations" class="headerlink" title="Lambda Asynchronous Invocations"></a>Lambda Asynchronous Invocations</h4><ul><li>Asynchronous: S3, SNS, CloudWatch, EventBridge<ul><li>The events are placed in a Event Queue</li><li>Lambda attemps to retry on errors (3 tries total)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img164249.png"></p><hr><h4 id="Lambda-Event-Source-Mapping"><a href="#Lambda-Event-Source-Mapping" class="headerlink" title="Lambda Event Source Mapping"></a>Lambda Event Source Mapping</h4><ul><li>Work with Kinesis Data Streams, SQS (FIFO), DynamoDB Streams (é‡è¦)<ul><li>Lambda function is invoked synchronously, æ‰€ä»¥ SNS å°±ä¸èƒ½ç”¨ Event Source Mapping</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img165403.png"></p><ul><li>Streasm &amp; Lambda (Kinesis &amp; DynamoDB)<ul><li>An event source mapping creates an iterator for each shard, process items in order</li><li>Low traffic: Use batch window </li><li>High traffic: Multiple batches in parallel</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img165631.png"></p><ul><li>Streasm &amp; Lambda Error Handling<ul><li>By default, if function returns an error, the entire batch is reprocessed until the function succeeds, or the items in the batch expire</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img165758.png"></p><ul><li>Queue &amp; Lambda (SQS &amp; FIFO)<ul><li>Event Source Mapping will poll SQS (Long Polling)</li><li>If use FIFO queues, Lambda will scale up to the number of active message groups</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img165931.png"></p><hr><h4 id="Lambda-Event-and-Context-Objects"><a href="#Lambda-Event-and-Context-Objects" class="headerlink" title="Lambda Event and Context Objects"></a>Lambda Event and Context Objects</h4><ul><li>ç®€å•æ¥è¯´å°±æ˜¯ lambda_hander é‡Œé¢çš„å‚æ•° event å’Œ context</li><li><code>event</code>: JSON document contains data for the function to process</li><li><code>context</code>: Provides information about the invocation, function, runtime environment</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img170535.png"></p><hr><h4 id="Lambda-Destinations"><a href="#Lambda-Destinations" class="headerlink" title="Lambda Destinations"></a>Lambda Destinations</h4><ul><li>Can configure to send result to a destination (é‡è¦)<ul><li>Asynchronous invocations: Define destinations for successful and failed event</li><li>Event Source Mapping: For discarded event batches</li></ul></li><li>æ³¨æ„, Lambda Destionation å¯ä»¥æ˜¯ DLQ, è¿™æ ·å¯ä»¥ç›´æ¥ç”¨ SQS (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img170912.png"></p><hr><h4 id="Lambda-Permissions"><a href="#Lambda-Permissions" class="headerlink" title="Lambda Permissions"></a>Lambda Permissions</h4><ul><li>Lambda Execution Role (é‡è¦, å¤§éƒ¨åˆ† Lambda çš„é—®é¢˜éƒ½å’Œ Execution Role æœ‰å…³)<ul><li>Grant Lambda function permissions to AWS services (IAM Role)</li><li>Best practice: Create one Lambda Execution Role per function</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img171158.png"></p><ul><li>Lambda Resource Based Policies<ul><li>Use resource-based policies to give other accounts and AWS services permission to use your Lambda resources (æ„Ÿè§‰ Resource Base Policy éƒ½æ˜¯ç»™è·¨è´¦å·æƒé™çš„)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img171329.png"></p><hr><h4 id="Lambda-Environment-Variables"><a href="#Lambda-Environment-Variables" class="headerlink" title="Lambda Environment Variables"></a>Lambda Environment Variables</h4><ul><li>å­˜ secrets å’Œ api keys çš„</li><li>å¯ä»¥ç”¨æ¥ inject dynamic variables into Lambda function (é‡è¦)</li><li>æ³¨æ„, åƒ token è¿™ç§å°±ä¸èƒ½æ”¾åœ¨ Environment Variable, è¦åœ¨ deployment package <code>.zip</code> é‡Œ</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173203.png"></p><hr><h4 id="Lambda-Logging-amp-Monitoring"><a href="#Lambda-Logging-amp-Monitoring" class="headerlink" title="Lambda Logging &amp; Monitoring"></a>Lambda Logging &amp; Monitoring</h4><ul><li>Lambda execution logs are stored in AWS CloudWatch Logs</li><li>Lambda metrices are displayed in AWS CloudWatch Metrices</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173409.png"></p><ul><li>Lambda Tracing with X-Ray<ul><li>Enable in Lambda configuration (Active Tracing)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173520.png"></p><hr><h4 id="CloudFront-Functions-amp-Lambda-Edge"><a href="#CloudFront-Functions-amp-Lambda-Edge" class="headerlink" title="CloudFront Functions &amp; Lambda@Edge"></a>CloudFront Functions &amp; Lambda@Edge</h4><ul><li>Execute logic at the edge (Edge Function, serverless)</li><li>ä¸¤ç§æ–¹æ³•: CloudFront Functions, Lambda@Edge (å®ƒä»¬æ”¯æŒçš„è¯­è¨€ä¸åŒ)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173715.png"></p><ul><li>CloudFront Functions<ul><li>For high-scale, latency-sensitive CDN customizations (millions çº§åˆ«çš„)</li><li>Used to change Viewer requestes and responses, short execution time</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173900.png"></p><ul><li>Lambda@Edge<ul><li>Scales to 1000s of requests&#x2F;second (thousands çº§åˆ«çš„)</li><li>Used to change Viewer requestes and responses, longer execution time</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img214545.png"></p><hr><h4 id="Lambda-in-VPC"><a href="#Lambda-in-VPC" class="headerlink" title="Lambda in VPC"></a>Lambda in VPC</h4><ul><li>æ­£å¸¸æƒ…å†µä¸‹, Lambda æ— æ³•è®¿é—® VPC (æ‰€ä»¥è¦ Lambda in VPC)</li><li>éœ€è¦ VPC ID, Subnet å’Œ Security Groups, Lambda will create an ENI</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174359.png"></p><ul><li>Lambda in VPC - Internet Access (2 ç§æ–¹æ³•)<ul><li>Lambda function in your VPC does not have internet access</li><li>Deploying a Lambda function in public subnet does not give internet access</li></ul></li><li>Need to deploy Lambda function in private subnet and give a NAT Gateway &#x2F; Instance</li><li>Also can use VPC endpoints to privately access AWS services without NAT</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174704.png"></p><hr><h4 id="Lambda-Function-Performance"><a href="#Lambda-Function-Performance" class="headerlink" title="Lambda Function Performance"></a>Lambda Function Performance</h4><ul><li>Lambda Function Configuration<ul><li>RAM: If application is CPU-bound (computation heavy), increase RAM</li><li>Timeout: Default 3 seconds, maximum is 900 seconds (15 minutes)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174946.png"></p><ul><li>Lambda Execution Context<ul><li>The execution context is a temporary runtime environment that initializes any external dependencies of your lambda code</li><li>The execution context includes the <code>/tmp</code> directory (é‡è¦)</li><li><code>/tmp</code> directory çš„æœ€å¤§å®¹é‡æ˜¯ <code>10240</code> MB, default æ˜¯ <code>512</code> MB</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175158.png"></p><ul><li>Initialize outside the handler (é‡è¦)<ul><li>é˜²æ­¢ DB connection è¢«å¤šæ¬¡å»ºç«‹</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175513.png"></p><hr><h4 id="Lambda-Layers"><a href="#Lambda-Layers" class="headerlink" title="Lambda Layers"></a>Lambda Layers</h4><ul><li>Create Custom Runtime &amp; Externalize Dependencies to re-use them</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192245.png"></p><hr><h4 id="Lambda-File-Systems-Mounting"><a href="#Lambda-File-Systems-Mounting" class="headerlink" title="Lambda File Systems Mounting"></a>Lambda File Systems Mounting</h4><ul><li>Lambda functions can access EFS file systems if they are running in a VPC<ul><li>Leaverage EFS Access Points</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192513.png"></p><hr><h4 id="Lambda-Concurrency"><a href="#Lambda-Concurrency" class="headerlink" title="Lambda Concurrency"></a>Lambda Concurrency</h4><ul><li>Can set a <code>reserved concurrency</code> to limit the number of concurrent execution</li><li>Each invocation over the concurrency limit will trigger a <code>Throttle</code><ul><li>If need a higher limit, open a support ticket</li></ul></li><li>å¯¹äºå¤„ç† Asynchronous çš„æƒ…å†µ, Lambda ä¼šæŠŠ event è¿”å›åˆ° queue é‡Œ</li><li>å¯ä»¥ configure Auto Scaling to manage Lambda provisioned concurrency on a schedule<ul><li>æ¯”å¦‚è¦åº”å¯¹åœ£è¯èŠ‚è¿™ç§æƒ…å†µ</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img193032.png"></p><ul><li>Cold Starts &amp; Provisioned Concurrency<ul><li>Cold Start: First request served by new instances has higher latency than rest</li><li>Provisioned Concurrency: Allocate concurrency before the function is invoked</li><li>Provisioned Concurrency è§£å†³äº† Cold Start çš„é—®é¢˜ (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img224130.png"></p><hr><h4 id="Lambda-External-Dependencies"><a href="#Lambda-External-Dependencies" class="headerlink" title="Lambda External Dependencies"></a>Lambda External Dependencies</h4><ul><li>If Lambda function depends on external libraries<ul><li>You need to install the packages alongside your code and zip together</li></ul></li><li>æ³¨æ„, è¿™é‡Œæ˜¯æŠŠ functions å’Œ dependencies zip åœ¨ä¸€èµ·, è€Œä¸æ˜¯åˆ†å¼€ zip (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img224459.png"></p><hr><h4 id="Lambda-Container-Image"><a href="#Lambda-Container-Image" class="headerlink" title="Lambda Container Image"></a>Lambda Container Image</h4><ul><li>Deploy Lambda function as container images (ä¹Ÿå°±æ˜¯è¯´ Lambda å’Œ Docker æ˜¯å¯ä»¥ä¸€èµ·ç”¨çš„)</li><li>Pack complex dependencies, large dependencies in a container</li><li>To deploy a container image to Lambda, the container image must implement Lambda Runtime API</li><li>AWS Lambda service does not support Lambda functions that use multi-architecture container image</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img000324.png"></p><hr><h4 id="Lambda-Versions-and-Aliases"><a href="#Lambda-Versions-and-Aliases" class="headerlink" title="Lambda Versions and Aliases"></a>Lambda Versions and Aliases</h4><ul><li>Lambda Versions (é‡è¦)<ul><li>When work on a Lambda function, work on $LATEST</li><li>When publish a Lambda function, create a version</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img000644.png"></p><ul><li>Lambda Aliases (é‡è¦)<ul><li>Aliases are <code>pointers</code> to Lambda function versions</li><li>Aliases enable Canary deployment by assigning weights to Lambda functions</li><li>Aliases cannot reference aliases</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img000912.png"></p><hr><h4 id="Lambda-with-CodeDeploy"><a href="#Lambda-with-CodeDeploy" class="headerlink" title="Lambda with CodeDeploy"></a>Lambda with CodeDeploy</h4><ul><li>CodeDeploy can help automate traffic shift for Lambda aliases<ul><li>Linear: Grow traffic every <code>N minutes</code> until <code>100%</code></li><li>Canary: Try <code>X</code> percent then <code>100%</code></li><li>AllAtOnce: Immediate</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img001338.png"></p><hr><h4 id="Lambda-Function-URL"><a href="#Lambda-Function-URL" class="headerlink" title="Lambda Function URL"></a>Lambda Function URL</h4><ul><li>Dedicated HTTPS endpoint for Lambda function (ä¸ç”¨ API Gateway çš„åšæ³•)<ul><li>å½¢å¼ <code>https://&lt;url-id&gt;.lambda-url.&lt;region&gt;.on.aws</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img001532.png"></p><hr><h4 id="Lambda-with-CodeGuru"><a href="#Lambda-with-CodeGuru" class="headerlink" title="Lambda with CodeGuru"></a>Lambda with CodeGuru</h4><ul><li>Gain insights into runtime performance of your Lambda function</li><li>CodeGuru creates a Profiler Group for your Lambda function</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img001843.png"></p><hr><h3 id="20-DynamoDB"><a href="#20-DynamoDB" class="headerlink" title="20. DynamoDB"></a>20. DynamoDB</h3><h4 id="AWS-DynamoDB"><a href="#AWS-DynamoDB" class="headerlink" title="AWS DynamoDB"></a>AWS DynamoDB</h4><ul><li>NoSQL database, with replication across multiple AZs, auto scaling, no provision</li><li>ä¸¤ç§ Class: Standard &amp; Infrequent Access (IA)</li><li>å¦‚æœé—®åˆ° DynamoDB è€Œä¸”æ˜¯å¤„ç† Email çš„, å°±æ˜¯ DynamoDB Stream</li><li>å¦‚æœé—®åˆ° DynamoDB è€Œä¸”æ˜¯å¤„ç† unpredictable æ•°æ®çš„æ—¶å€™, é€‰æ‹© On-Demand table</li><li>By default, DynamoDB tables are encrypted with AWS owned key (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img012414.png"></p><ul><li>Each table has a Primary Key, must be decided at creation time (2 ç§é€‰æ‹©)<ul><li>Partition Key (HASH): Partition Key must be unique for each item</li><li>Partition Key + Sort Key (HASH + RANGE): The combination must be unique</li></ul></li><li>Item çš„æœ€å¤§å¤§å°æ˜¯ 400 KB</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img012627.png"></p><ul><li>DynamoDB æœ‰ 2 ç§ backup æ–¹æ³•, On-demand å’Œ Point-in-time recovery, ä½†å®ƒä»¬åªèƒ½æŠŠæ•°æ®å†™åˆ° S3 é‡Œ, æ²¡åŠæ³•ä» backup é‡Œé¢å» access S3 buckets</li><li>ä¸è¦ç”¨ DynamoDB å»ä¿å­˜å›¾ç‰‡, å› ä¸º DynamoDB æœ€å¤§ item å¤§å°æ˜¯ 400 KB</li><li>å¦‚æœè¦ç»™ DynamoDB ready-only access, ç”¨ IAM Role <code>AmazonDynamoDBReadOnlyAccess</code></li></ul><hr><h4 id="DynamoDB-WCU-amp-RCU"><a href="#DynamoDB-WCU-amp-RCU" class="headerlink" title="DynamoDB WCU &amp; RCU"></a>DynamoDB WCU &amp; RCU</h4><ul><li>Read &#x2F; Write Capacity Mode (2 ç§ Mode)<ul><li>Provisioned Mode: è‡ªå·±å®šä¹‰éœ€è¦å¤šå°‘ RCU å’Œ WCU (é»˜è®¤)</li><li>On-Demand Mode: è‡ªåŠ¨ scale éœ€è¦çš„ RCU å’Œ WCU (è´µ)</li></ul></li><li>RCU å’Œ WCU æ²¡æœ‰å…³è”å—, å¯ä»¥åªåŠ  RCU ä¸åŠ  WCU</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img014420.png"></p><ul><li>R&#x2F;W Capacity Modes - Provisioned<ul><li>Read Capacity Units (RCU): throughput for reads</li><li>Write Capacity Units (WCU): throughput for writes</li><li>Throughput can be exceeded temporarily using <code>Burst Capacity</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img014716.png"></p><ul><li>Write Capacity Units (WCU)<ul><li>One Write Capacity Unit represents <code>one write per second</code> for an item up to <code>1KB</code></li><li>éå¸¸é‡è¦, è®°ä½ WCU æ˜¯ 1 æ¯” 1 çš„, size éœ€è¦ round up åˆ°æ•´æ•°</li><li>ä¾‹å­: 6 items with item size 4.5KB: <code>6 * 5 / 1 = 30 WCU</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img014951.png"></p><ul><li>Strongly Consistent Read vs. Eventually Consistent Read (é‡è¦)<ul><li>Eventually Consistent Read: might get stale data because of duplication (é»˜è®¤)</li><li>Strongly Consistent Read: will always get the correct data (è´µ)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img015146.png"></p><ul><li>Read Capacity Units (RCU)<ul><li>One Read Capacity Unit represents one Strongly Consistent Read per second, or two Eventually Consistent Read per second, for an item up to 4 KB in size (é‡è¦)</li><li>éå¸¸é‡è¦, å¯¹äº Strongly Consistent Read æ¥è¯´æ˜¯ 1 æ¯” 4 çš„, size è¦ round up åˆ° 4 çš„å€æ•°</li><li>éå¸¸é‡è¦, å¯¹äº Eventually Consistent Read æ¥è¯´æ˜¯ 2 æ¯” 4 çš„, size è¦ round up åˆ° 4 çš„å€æ•°</li><li>ä¾‹å­: 10 Strongly Consistent Reads with item size 4 KB: <code>10 * 4 / 4 = 10 RCU</code></li><li>ä¾‹å­: 16 Eventually Consistent Reads with item size 12 KB: <code>16 /2 * 12 / 4 = 24 RCU</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img015532.png"></p><ul><li>DynamoDB - Partitions Internal<ul><li>Data is stored in partitions, use Partition Key to know which partition should go</li><li>WCUs and RCUs are spread evenly across partitions</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img015726.png"></p><ul><li>DynamoDB - Throttling (é‡è¦)<ul><li>Exceeded provisioned RCUs or WCUs, get <code>ProvisionedThroughputExceededException</code></li><li>åŸå› : Hot Keys, Hot Paritions, Very large items (é‡è¦)</li><li>è§£å†³æ–¹æ¡ˆ: Exponential backoff, Distribute partition keys, use DynamoDB DAX (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img015936.png"></p><ul><li>R&#x2F;W Capacity Modes - On-Demand<ul><li>Read &#x2F; writes automatically scale up &#x2F; down with workloads</li><li>Read Request Units (RRU): throughput for reads (same as RCU)</li><li>Write Request Units (WRU): throughput for writes (same as WCU)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img020318.png"></p><hr><h4 id="DynamoDB-Basic-Operations"><a href="#DynamoDB-Basic-Operations" class="headerlink" title="DynamoDB Basic Operations"></a>DynamoDB Basic Operations</h4><ul><li>æ³¨æ„, DynamoDB <code>UpdateItem</code> æ˜¯æ›´æ–° attribute æˆ–è€…æ–°åˆ›å»ºä¸€ä¸ª (å¦‚æœä¸å­˜åœ¨)</li><li>Writing Data<ul><li><code>PutItem</code>: Create a new item or fully replace an old item</li><li><code>UpdateItem</code>: Edit an existing itemâ€™s attributes or add new items if not exist (æ³¨æ„)</li><li><code>Conditional Writes:</code> Accept a <code>write/update/delete</code> only if condition met</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img020700.png"></p><ul><li>Reading Data<ul><li><code>GetItem</code>: Read based on Primary key</li><li><code>Query</code>: Return items based on <code>KeyConditionExpression</code>, <code>FilterExpression</code></li><li><code>Scan</code>: Scan the entire table and then filter out data (å¯ä»¥ parallel, é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img020844.png"></p><ul><li>Deleting Data<ul><li><code>DeleteItem</code>: Delete an individual item</li><li><code>DeleteTable</code>: Delete the whole table and all its items</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img021027.png"></p><ul><li>DynamoDB Batch Operations<ul><li>Allow yout to save in latency by reducing the number of API cals</li><li><code>BatchWriteItem</code> å’Œ <code>BatchGetItem</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img021208.png"></p><ul><li>Table Cleanup (2 ç§æ–¹æ³•)<ul><li><code>Scan + DeleteItem</code> æˆ–è€… <code>Drop Table + Recreate Table</code></li></ul></li><li>Copying a DynamoDB Table (3 ç§æ–¹æ³•)<ul><li>AWS Data Pipeline æˆ–è€… Backup + Restore æˆ–è€… <code>Scan + PutItem or BatchWriteItem</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img033405.png"></p><hr><h4 id="DynamoDB-Conditional-Writes"><a href="#DynamoDB-Conditional-Writes" class="headerlink" title="DynamoDB Conditional Writes"></a>DynamoDB Conditional Writes</h4><ul><li>For <code>PutItem, UpdateItem, DeleteItem, BatchWriteItem</code></li><li>Specify a conditional expression to determine which item should be modified</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img022327.png"></p><hr><h4 id="DynamoDB-Indexes"><a href="#DynamoDB-Indexes" class="headerlink" title="DynamoDB Indexes"></a>DynamoDB Indexes</h4><ul><li>Local Secondary Index (LSI, é‡è¦)<ul><li>Alternative Sort Key for your table (æ³¨æ„è¿™é‡Œæ˜¯ Partition Key)</li><li>Must be defined at table creation time (é‡è¦)</li><li>Attribute Projections: Contain some or all attributes of the base table</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img025528.png"></p><ul><li>Global Secondary Index (GSI, é‡è¦)<ul><li>Alternative Primary Key from the base table (æ³¨æ„è¿™é‡Œæ˜¯ Primary Key)</li><li>Must provision RCUs &amp; WCUs for the index</li><li>Can be added or modified after table creation</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img025824.png"></p><ul><li>Indexes and Throttling<ul><li>GSI: If writes are throttled on the GSI, then the main table will be throttled</li><li>LSI: Use WCUs and RCUs of the main table, no throttling consideration</li><li>é‡è¦, æ˜¯ GSI ä¼šé€ æˆ throttling, LSI ä¸ç”¨è€ƒè™‘ throttling</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img025950.png"></p><hr><h4 id="DynamoDB-PartiQL"><a href="#DynamoDB-PartiQL" class="headerlink" title="DynamoDB PartiQL"></a>DynamoDB PartiQL</h4><ul><li>Use a SQL-like syntax to manipulate DynamoDB tables (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img030113.png"></p><hr><h4 id="DynamoDB-Optimistic-Locking"><a href="#DynamoDB-Optimistic-Locking" class="headerlink" title="DynamoDB Optimistic Locking"></a>DynamoDB Optimistic Locking</h4><ul><li>A strategy to ensure an item hasnâ€™t changed before update or delete it (é‡è¦)</li><li>DynamoDB Optimistic Locking æ˜¯ Concurrency Model, è€Œä¸”å®ƒç”¨ Conditional Writes (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img030304.png"></p><hr><h4 id="DynamoDB-DAX"><a href="#DynamoDB-DAX" class="headerlink" title="DynamoDB DAX"></a>DynamoDB DAX</h4><ul><li>DynamoDB Accelerator (DAX, å¯ä»¥å¤„ç† cache, ä½†æ˜¯ DAX ä¸æ˜¯ relational çš„)<ul><li>Help solve read congestion by caching (microseconds latency, ç¼“å­˜)</li><li>DAX ä¸æ”¯æŒ SQL query caching</li><li>å¯ä»¥æé«˜ DynamoDB çš„ performance (æé«˜çš„æ˜¯ read è€Œä¸æ˜¯ write, é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233440.png"></p><hr><h4 id="DynamoDB-Stream"><a href="#DynamoDB-Stream" class="headerlink" title="DynamoDB Stream"></a>DynamoDB Stream</h4><ul><li>DynamoDB Stream: ç›®æ ‡æ˜¯ Lambda å’Œ Kinesis Data Streams, æ²¡æœ‰ SQS (æ³¨æ„)<ul><li>Ordered stream of item-level modifications in table (é‡è¦)</li><li>ç”¨æ¥å¤„ç† Stream çš„, å¯ä»¥ Invoke Lambda function (æ¯”å¦‚å‘é‚®ä»¶)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img030626.png"></p><ul><li>DynamoDB Streams are made of shards, like Kinesis Data Streams</li><li>Records are not retroactively populated in a stream after enabling it</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img030940.png"></p><hr><h4 id="DynamoDB-TTL"><a href="#DynamoDB-TTL" class="headerlink" title="DynamoDB TTL"></a>DynamoDB TTL</h4><ul><li>Automatic delete items after an expiry timestamp (å®šæ—¶åˆ é™¤ DynamoDB é‡Œçš„ item)</li><li>Expired items deleted within 48 hours of expiration</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img031135.png"></p><hr><h4 id="DynamoDB-CLI"><a href="#DynamoDB-CLI" class="headerlink" title="DynamoDB CLI"></a>DynamoDB CLI</h4><ul><li><code>projection-expression</code>: Select a subset of attribute to retrieve (subset of attribute)</li><li><code>filter-expression</code>: Filter items to retrieve a subset of the items (subset of items)</li><li>Minimize the items returned in CLI: <code>max-items &amp; starting-token</code></li><li>æ³¨æ„, å¦‚æœé—®åˆ°å’Œ attribute æœ‰å…³çš„å°±æ˜¯ <code>projection-expression</code></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img031324.png"></p><hr><h4 id="DynamoDB-Transcations"><a href="#DynamoDB-Transcations" class="headerlink" title="DynamoDB Transcations"></a>DynamoDB Transcations</h4><ul><li>Coordinated operations to multiple items across one or more tables (é‡‘è, æ¸¸æˆ)</li><li>Provides Atomcity, Consistency, Isolation, and Durability (ACID)</li><li>Consume 2 times of WCUs &amp; RCUs (æ³¨æ„, DynamoDB Transcation æ¶ˆè€— 2 å€ WCU å’Œ RCU)</li><li>Two operations: <code>TransactGetItems</code> å’Œ <code>TransactWriteItems</code></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img031646.png"></p><ul><li>DynamoDB Transactions Capacity Computation<ul><li>3 Transcational writes with item size 5 KB: need 3 * 5 &#x2F; 1 * 2 &#x3D; 30 WCUs</li><li>5 Transcation reads with items size 5 KB: need 5 * 8 &#x2F; 4 * 2 &#x3D; 20 RCUs</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img032052.png"></p><hr><h4 id="DynamoDB-Session-State"><a href="#DynamoDB-Session-State" class="headerlink" title="DynamoDB Session State"></a>DynamoDB Session State</h4><ul><li>To use DynamoDB to store the session state</li><li>ElastiCache is in-memory, DynamoDB is serverless (both are key&#x2F;value pair)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img032422.png"></p><hr><h4 id="DynamoDB-Write-Sharding"><a href="#DynamoDB-Write-Sharding" class="headerlink" title="DynamoDB Write Sharding"></a>DynamoDB Write Sharding</h4><ul><li>A strategy that allow better distribution of items evenly across partitions <ul><li>To solve the issue of <code>Hot Partition</code></li></ul></li><li>Add a suffix to Partition Key value</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img032640.png"></p><hr><h4 id="DynamoDB-Other-Features"><a href="#DynamoDB-Other-Features" class="headerlink" title="DynamoDB Other Features"></a>DynamoDB Other Features</h4><ul><li>Backup and Restore: Point-in-time recovery (PITR) like RDS</li><li>Global Tables: Multi-region, fully replicated, high performance</li><li>DynamoDB Local: Develop and test app locally with out accessing internet</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img033717.png"></p><ul><li>DynamoDB Fine-Grained Access Control<ul><li>Assign IAM Role to users with a Condition to limit their API access DynamoDB</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img033855.png"></p><hr><h3 id="21-API-Gateway"><a href="#21-API-Gateway" class="headerlink" title="21. API Gateway"></a>21. API Gateway</h3><h4 id="AWS-API-Gateway"><a href="#AWS-API-Gateway" class="headerlink" title="AWS API Gateway"></a>AWS API Gateway</h4><ul><li>Invoke Lambda function, expose REST API (stateless client-server communication)</li><li>Lambda + API Gateway &#x3D; No infrastructure to manage</li><li>API Gateway å¯ä»¥é˜²æ­¢ API overwhelmed by too many requests (é˜²æŠ–)</li><li>API Gateway Caching (å¯ä»¥ improve latency, é‡è¦)<ul><li>With caching, you can reduce the number of calls made to your endpoint and also improve the latency of requests to your API</li></ul></li><li>æ³¨æ„, API Gateway ä¸ support STS, å¯ä»¥ç”¨ Congito User Pool, IAM permissions with sigv4 å’Œ Lambda Authorizer</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img164125.png"></p><ul><li>API Gateway Endpoint Types<ul><li>Edge-Optimized (é»˜è®¤): For global clients, API Gateway live in one region</li><li>Regional: For client in same region</li><li>Private: Can only be accessed from VPC using ENI</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img164338.png"></p><ul><li>API Gateway å¯ä»¥ç”¨ Cognito User Pools, AWS IAM roles and policies å’Œ Lambda Authorizer æ¥è¿›è¡Œ authenticate</li></ul><hr><h4 id="API-Gateway-Stages"><a href="#API-Gateway-Stages" class="headerlink" title="API Gateway Stages"></a>API Gateway Stages</h4><ul><li>Making changes in the API Gateway does not mean theyâ€™re effective (é‡è¦)<ul><li>You need to make a â€œdeploymentâ€ for them to be in effect</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173311.png"></p><ul><li>API Gateway - Stage Variables<ul><li>Stage variables are like environment variables for API Gateway</li><li>Use case: Create a stage variable to indicate the Lambda alias (é‡è¦)</li><li>å¦‚æœè¦æŠŠ test promote æˆ prod, è€Œä¸”å½“å‰ prod å­˜åœ¨, ç›´æ¥ update stage variable å°±è¡Œ</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190149.png"></p><hr><h4 id="API-Gateway-Canary-Deployment"><a href="#API-Gateway-Canary-Deployment" class="headerlink" title="API Gateway Canary Deployment"></a>API Gateway Canary Deployment</h4><ul><li>Choose the <code>%</code> of traffic the canary channel receives<ul><li>Canary deployment: é€æ­¥å‘å¸ƒæ–°ç‰ˆæœ¬ï¼Œå…ˆå°è§„æ¨¡æµ‹è¯•ï¼Œå†å…¨é¢æ¨å¹¿çš„ç­–ç•¥</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190857.png"></p><hr><h4 id="API-Gateway-Integration-Tyeps"><a href="#API-Gateway-Integration-Tyeps" class="headerlink" title="API Gateway Integration Tyeps"></a>API Gateway Integration Tyeps</h4><ul><li><code>MOCK</code><ul><li>API Gateway returns a response without sending the request to backend</li></ul></li><li><code>HTTP / AWS</code><ul><li>Configure both the integration request and integration response</li><li>Set up data mapping using mapping templates for request &amp; response</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img191239.png"></p><ul><li><code>AWS_PROXY</code> (Lambda Proxy)<ul><li>Incoming request from the client is the input to Lambda</li><li>No mapping template, headers, query string parameters are passed as arguments</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img191413.png"></p><ul><li><code>HTTP_PROXY</code><ul><li>No mapping template, the HTTP request is passed to the backend</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img191520.png"></p><hr><h4 id="API-Gateway-Mapping-Templates"><a href="#API-Gateway-Mapping-Templates" class="headerlink" title="API Gateway Mapping Templates"></a>API Gateway Mapping Templates</h4><ul><li>Mapping templates can be used to modify request &#x2F; responses<ul><li>å¯ä»¥ç”¨æ¥å±è”½ output data ä¸­çš„æŸäº›å­—æ®µ</li></ul></li><li>Modify query string parameters, modify body content, add headers</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img191718.png"></p><hr><h4 id="API-Gateway-OpenAPI"><a href="#API-Gateway-OpenAPI" class="headerlink" title="API Gateway OpenAPI"></a>API Gateway OpenAPI</h4><ul><li>Common way to define REST APIs, using API defintion as code</li><li>Request Validation: reduce unnecessary calls to the backend</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201259.png"></p><hr><h4 id="API-Gateway-Caching"><a href="#API-Gateway-Caching" class="headerlink" title="API Gateway Caching"></a>API Gateway Caching</h4><ul><li>Caching reduces the number of calls made to the backend</li><li>Caches are defined per <code>stage</code>, default TTL is <code>300</code> sec, max TTL is <code>3600</code> sec (é‡è¦)</li><li>Client can invalidate the cache with header: <code>Cache-Control:max-age=0</code> (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201709.png"></p><hr><h4 id="API-Gateway-Usage-Plans-amp-API-Keys"><a href="#API-Gateway-Usage-Plans-amp-API-Keys" class="headerlink" title="API Gateway Usage Plans &amp; API Keys"></a>API Gateway Usage Plans &amp; API Keys</h4><ul><li>Make an API availiable as an offering to your customers (é‡è¦)</li><li>Usage Plan: who can access, how much and how fast can access, use API keys to identify</li><li>API Keys: use with usage plans to control access</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img202109.png"></p><ul><li>To configure a usage plan<ul><li>Create one or more APIs, configure methods to require API key, deploy API to stage</li><li>Generate or import API keys to distribute to application developer</li><li>Create the usage plan with desired throttle and quota limits</li><li>Associate API stages and API keys with the usage plan</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img202324.png"></p><hr><h4 id="API-Gateway-Monitoring"><a href="#API-Gateway-Monitoring" class="headerlink" title="API Gateway Monitoring"></a>API Gateway Monitoring</h4><ul><li><code>CacheHitCount &amp; CacheMissCount</code>: efficiency of the cache </li><li><code>IntegrationLatency</code>: ç”¨æ¥æµ‹ timeout issue </li><li><code>4XX</code> means Client errors, <code>5XX </code>means Server errors, <code>429</code> æ˜¯ too many requests</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img202658.png"></p><hr><h4 id="API-Gateway-CORS"><a href="#API-Gateway-CORS" class="headerlink" title="API Gateway CORS"></a>API Gateway CORS</h4><ul><li>CORS must be enabled when you receive API calls from another domain</li><li>CORS ä¹Ÿå¯ä»¥ç”¨æ¥é™åˆ¶ä¸€äº› domain æ¥é˜²æ­¢å®ƒä»¬ access API</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img202855.png"></p><hr><h4 id="API-Gateway-Security"><a href="#API-Gateway-Security" class="headerlink" title="API Gateway Security"></a>API Gateway Security</h4><ul><li>IAM Permissions (for within your AWS account)<ul><li>Authentication is IAM, Authorization is IAM Policy</li><li>Create an IAM policy authorization and attch to User or Role</li><li>If need Cross Account Access, use Resource Policies</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203055.png"></p><ul><li>Cognito User Pools (for your own user pool, é‡è¦)<ul><li>Authentication is Cognito User Pools, Authorization is API Gateway Methods</li><li>API Gateway verifies identity automatically from AWS Cognito</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203446.png"></p><ul><li>Lambda Authorizer (use 3rd party tokens, é‡è¦)<ul><li>Authentication is External, Authorization is Lambda function</li><li>Token-based authorizer, JWT or Oauth</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203612.png"></p><hr><h4 id="API-Gateway-WebSocket-API"><a href="#API-Gateway-WebSocket-API" class="headerlink" title="API Gateway WebSocket API"></a>API Gateway WebSocket API</h4><ul><li>WebSocket APIs are often used in real time applications such as chat or trading<ul><li>WebSocket is two ways commmunication</li></ul></li><li>å½¢å¼ <code>wss://[uniqueid].execute-api.[region].amazonaws.com/[stage-name]</code></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img204056.png"></p><ul><li>WebSocket API - Routing<ul><li>Request a route selection expression to select the field on JSON to route from</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img204735.png"></p><hr><h3 id="22-AWS-CICD"><a href="#22-AWS-CICD" class="headerlink" title="22. AWS CICD"></a>22. AWS CICD</h3><h4 id="AWS-CodeCommit"><a href="#AWS-CodeCommit" class="headerlink" title="AWS CodeCommit"></a>AWS CodeCommit</h4><ul><li>A version control tool that helps to understand the changes happened to the code</li><li>CodeCommit is a Private Git repository (å°±æ˜¯ä¸ª Github, ä½†æ˜¯ç§äººçš„)</li><li>å¦‚æœé—®åˆ° migrate repository åˆ° CodeCommit ä½¿ç”¨ HTTPS, é‚£ä¹ˆç”¨åˆ°çš„æ˜¯ Git credentials generated from IAM (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img213239.png"></p><ul><li>CodeCommit å¯ä»¥ä½¿ç”¨ Git credentials, SSH Keys, AWS Access Keys</li><li>Data in AWS CodeCommit repositories is encrypted in transit and at rest</li></ul><hr><h4 id="AWS-CodePipeline"><a href="#AWS-CodePipeline" class="headerlink" title="AWS CodePipeline"></a>AWS CodePipeline</h4><ul><li>CodePipeline æ˜¯ä¸€ç§è‡ªåŠ¨åŒ– CICD æœåŠ¡, ç”¨äºæ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²åº”ç”¨ç¨‹åºå’ŒåŸºç¡€è®¾æ–½<ul><li>å¦‚æœçœ‹åˆ° orchestrate CICD, å°±æ˜¯ CodePipeline</li></ul></li><li>å¯ä»¥ create one CodePipline for entire flow and add a manual approval step</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img215659.png"></p><ul><li>Each pipeline stage can create artifacts</li><li>Artifaces stored in an S3 bucket and passed on to the next stage</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img215817.png"></p><hr><h4 id="AWS-CodeBuild"><a href="#AWS-CodeBuild" class="headerlink" title="AWS CodeBuild"></a>AWS CodeBuild</h4><ul><li>CodeBuild æ˜¯ä¸€ç§å®Œå…¨æ‰˜ç®¡çš„æŒç»­é›†æˆæœåŠ¡, ç”¨äºè‡ªåŠ¨åŒ–æ„å»ºã€æµ‹è¯•å’Œç”Ÿæˆè½¯ä»¶åŒ…</li><li>CodeBuild ç®—æ˜¯ Jenkins çš„æ›¿ä»£å“</li><li>Build instructions: Code file <code>buildspec.yml</code> (é‡è¦) or insert manually in Console</li><li>Automated tests on application before the deployment process (é‡åˆ°éœ€è¦ test çš„å°±æ˜¯ CodeBuild, é‡è¦)</li><li>CodeBuild scales automatically, æ‰€ä»¥é‡åˆ°ä»€ä¹ˆ scaling å’Œ run build parallel éƒ½ä¸ç”¨æ‹…å¿ƒ</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img220508.png"></p><ul><li><code>buildspec.yml</code> file must be at the root of your code (é‡è¦)</li><li>è®°ä½, CodeBuild å¯ä»¥ç”¨ KMS key æ¥åŠ å¯† build artifacts (é‡è¦)</li><li>å¯ä»¥ä½¿ç”¨ CodeBuild timeouts å»é˜²æ­¢è¿‡é•¿çš„ building process</li><li>We bundle dependencies in the source code during the build stage of CodeBuild</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img220651.png"></p><hr><h4 id="AWS-CodeDeploy"><a href="#AWS-CodeDeploy" class="headerlink" title="AWS CodeDeploy"></a>AWS CodeDeploy</h4><ul><li>CodeDeploy æ˜¯ä¸€ç§è‡ªåŠ¨åŒ–éƒ¨ç½²æœåŠ¡, ç”¨äºåœ¨å„ç§è®¡ç®—ç¯å¢ƒä¸­éƒ¨ç½²åº”ç”¨ç¨‹åºä»£ç </li><li>Automated rollback in case failed deployment (å¯ä»¥è‡ªåŠ¨ roll back å¦‚æœéƒ¨ç½²å¤±è´¥)<ul><li>If a rollback happens, CodeDeploy redeploys the last good revision</li></ul></li><li>A file named <code>appspec.yml</code> defines how the deployment happens</li><li>å¦‚æœé—®åˆ° CodeDeploy å’Œ EC2, é‚£ä¹ˆå°±åªæœ‰ <code>in-place</code> å’Œ <code>blue/green</code><ul><li><code>blue/green</code> å¯ä»¥ re-route traffic from original environment to new environment</li></ul></li><li>å¦‚æœé‡åˆ°è¦ archive number of applicaiton revision, ç”¨ CodeDeploy Agent</li><li>å¦‚æœ CodeDeploy å¤±è´¥å¹¶ä¸” rollback, A new deployment of the last known working version of the application is deployed with a new deployment ID</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img220850.png"></p><ul><li>CodeDeploy - EC2 &#x2F; On-premises Platform (éœ€è¦ Agent)<ul><li>Perform <code>in-place</code> deployment or <code>blue/green</code> deployments (éå¸¸é‡è¦)</li><li>Must run the CodeDeploy Agent on the target instances (é‡è¦)</li><li>Order of Lifecycle Events: <code>ApplicationStop, DownloadBundle, BeforeInstall, Install, AfterInstall, ApplicationStart, ValidateService</code></li><li>å››ç§ deployment speed: <code>AllAtOnce, HalfAtATime, OneAtATime, Custom</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img221100.png"></p><ul><li>CodeDeploy - Lambda Platform<ul><li>Automate traffic shift for Lambda aliases</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img221326.png"></p><ul><li>CodeDeploy - ECS Platform<ul><li>Automate the deployment of a new ECS Task Definition</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img221501.png"></p><hr><h4 id="AWS-CodeStar-CodeCatalyst"><a href="#AWS-CodeStar-CodeCatalyst" class="headerlink" title="AWS CodeStar (CodeCatalyst)"></a>AWS CodeStar (CodeCatalyst)</h4><ul><li>Quickly create <code>CICD-ready</code> projects for EC2, Lambda, Elastic Beanstalk</li><li>One dashboard to view all your componenets (é‡è¦, å’Œ dashboard æœ‰å…³)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img224413.png"></p><hr><h4 id="AWS-CodeArtifact"><a href="#AWS-CodeArtifact" class="headerlink" title="AWS CodeArtifact"></a>AWS CodeArtifact</h4><ul><li>CodeArtifact is a secure and cost-effective artifact management for software development (ç±»ä¼¼ npm)</li><li>Developers and CodeBuild can retrieve dependencies straight from CodeArtifact</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img221957.png"></p><ul><li>CodeArtifact Resource Policy (Resource Policy å°±æ˜¯å…è®¸åˆ«äººè®¿é—®)<ul><li>Authorize another account to access CodeArtifact</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img222141.png"></p><hr><h4 id="AWS-CodeGuru"><a href="#AWS-CodeGuru" class="headerlink" title="AWS CodeGuru"></a>AWS CodeGuru</h4><ul><li>An ML-powered service for code reviews and performance recommendations (é‡è¦)</li><li>CodeGuru Reviewer: Automated code reviews for static code analysis (development)</li><li>CodeGuru Profiler: Recommendations about application performance (production)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img222415.png"></p><hr><h4 id="AWS-Cloud9"><a href="#AWS-Cloud9" class="headerlink" title="AWS Cloud9"></a>AWS Cloud9</h4><ul><li>Cloud-based IDE, ç±»ä¼¼ VSCode</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img222601.png"></p><hr><h3 id="23-AWS-Serverless-Application-Model-SAM"><a href="#23-AWS-Serverless-Application-Model-SAM" class="headerlink" title="23. AWS Serverless Application Model (SAM)"></a>23. AWS Serverless Application Model (SAM)</h3><h4 id="AWS-SAM"><a href="#AWS-SAM" class="headerlink" title="AWS SAM"></a>AWS SAM</h4><ul><li>SAM &#x3D; Serverless Application Model</li><li>A framework for developing and deploying serverless applications</li><li>å¯ä»¥å°† AWS SAM æ¨¡æ¿ç›´æ¥éƒ¨ç½²åˆ° AWS CloudFormation</li><li>ä½¿ç”¨ AWS Serverless Application Repository (SAR) æ¥å…±äº« SAM å’Œå…¶ä»– AWS è´¦æˆ· (é‡è¦)<ul><li>å¦‚æœæƒ³æ‰¾ pre-built serverless applications å°±ç”¨ SAR</li></ul></li><li>Develop the SAM template locally &#x3D;&gt; upload the template to S3 &#x3D;&gt; deploy your application to the cloud (æ³¨æ„)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img153636.png"></p><ul><li>SAM Recipe<ul><li><code>Transform</code> Header for SAM template: <code>AWS::Serverless-2016-10-31</code></li><li>æ³¨æ„, <code>Transform</code> å¯¹äº SAM æ¥è¯´æ˜¯ mandatory çš„</li><li>SAM supports the following resource types: <code>Function, Api, SimpleTable</code> (é‡è¦)</li><li>Upload SAM åˆ° AWS ç”¨åˆ°çš„æ˜¯ <code>sam deploy</code></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img155435.png"></p><ul><li>SAM Accelerate <code>sam sync</code><ul><li>A set of features to reduce latency while deploying resources to AWS</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img154010.png"></p><hr><h4 id="SAM-Policy-Templates"><a href="#SAM-Policy-Templates" class="headerlink" title="SAM Policy Templates"></a>SAM Policy Templates</h4><ul><li>List of templates to apply permissions to Lambda Functions<ul><li><code>S3ReadPolicy</code>: Give read only permission to objects in S3</li><li><code>SQSPollerPolicy</code>: Allow to poll an SQS queue</li><li><code>DynamoDBCrudPolicy</code>: create, read, update, delete</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img154539.png"></p><hr><h4 id="SAM-Local-Capabilities"><a href="#SAM-Local-Capabilities" class="headerlink" title="SAM Local Capabilities"></a>SAM Local Capabilities</h4><ul><li>SAM Local ç”¨äºæœ¬åœ°æ¨¡æ‹Ÿã€æµ‹è¯•å’Œè°ƒè¯•æ— æœåŠ¡å™¨åº”ç”¨ç¨‹åº, æ”¯æŒ Lambda å’Œ API Gateway</li><li>Locally start AWS Lambda (è®°ä½è¿™é‡Œéƒ½æ˜¯ SAM CLI + AWS Toolkits)</li><li>Locally invoke Lambda Function</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img154914.png"></p><ul><li>Locally start an API Gateway Endpoint</li><li>Generate AWS Events for Lambda Functions</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img155003.png"></p><hr><h3 id="24-Cloud-Deployment-Kit-CDK"><a href="#24-Cloud-Deployment-Kit-CDK" class="headerlink" title="24. Cloud Deployment Kit (CDK)"></a>24. Cloud Deployment Kit (CDK)</h3><h4 id="AWS-Cloud-Development-Kit"><a href="#AWS-Cloud-Development-Kit" class="headerlink" title="AWS Cloud Development Kit"></a>AWS Cloud Development Kit</h4><ul><li>Define your cloud infrastructure using a familiar language (Java, Python)</li><li>Can deploy infrastructure and application runtime code together</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img160250.png"></p><ul><li>CDK å’Œ SAM çš„ä¸åŒ (è™½ç„¶å®ƒä»¬éƒ½ç”¨ CloudFormation)<ul><li>SAM ä¸»è¦å…³æ³¨çš„æ˜¯ Serverless å’Œ Lambda, è€Œä¸”åªèƒ½ç”¨ JSON æˆ–è€… YAML çš„å½¢å¼</li><li>CDK å¯ä»¥ç”¨åœ¨æ‰€æœ‰ AWS services ä¸Š, å¯ä»¥ç”¨æ‰€æœ‰ç¼–ç¨‹è¯­è¨€</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img160532.png"></p><ul><li>æ³¨æ„, CDK æ‰ä¼šæä¾› app template, è€Œä¸æ˜¯ CloudFormation (é‡è¦)</li></ul><hr><h3 id="25-Cognito"><a href="#25-Cognito" class="headerlink" title="25. Cognito"></a>25. Cognito</h3><h4 id="AWS-Cognito"><a href="#AWS-Cognito" class="headerlink" title="AWS Cognito"></a>AWS Cognito</h4><ul><li>AWS Cognito æ˜¯ä¸€ç§ç”¨æˆ·èº«ä»½ç®¡ç†æœåŠ¡, ç”¨äºå®‰å…¨åœ°æ·»åŠ ç”¨æˆ·æ³¨å†Œã€ç™»å½•å’Œè®¿é—®æ§åˆ¶åŠŸèƒ½<ul><li>Cognito User Pools: Sign in for app, integraet with API Gateway &amp; ALB</li><li>Cognito Identity Pools: Integrate with Cognito User Pools as identity provider</li></ul></li><li>CUP + CIP &#x3D; authentication + authorization</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img181012.png"></p><ul><li>Cognito Sync: Enable cross-device syncing of application related user data</li></ul><hr><h4 id="Cognito-User-Pools-CUP"><a href="#Cognito-User-Pools-CUP" class="headerlink" title="Cognito User Pools (CUP)"></a>Cognito User Pools (CUP)</h4><ul><li>ä¸ API Gateway å’Œ Application Load Balancer é›†æˆ (é‡è¦)</li><li>After a successful login using Cognito User Pools, it sends a JWT token (é‡è¦)</li><li>Adaptive Authentication<ul><li>Block sign-ins or require MFA if the login appears suspicious (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img181142.png"></p><hr><h4 id="Cognito-Identity-Pools-CIP"><a href="#Cognito-Identity-Pools-CIP" class="headerlink" title="Cognito Identity Pools (CIP)"></a>Cognito Identity Pools (CIP)</h4><ul><li>Get identities for <code>users</code> so they obtain temporary AWS credentials</li><li>å¦‚æœéœ€è¦ integrate user-specific file upload and download feature, ä½¿ç”¨ IAM policy with AWS Cognito identity prefix to restrict users to use their own folders in S3</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img20555%EF%BC%95.png"></p><hr><h3 id="26-Step-Functions-amp-AppSync"><a href="#26-Step-Functions-amp-AppSync" class="headerlink" title="26. Step Functions &amp; AppSync"></a>26. Step Functions &amp; AppSync</h3><h4 id="AWS-Step-Functions"><a href="#AWS-Step-Functions" class="headerlink" title="AWS Step Functions"></a>AWS Step Functions</h4><ul><li>AWS Step Functions æ˜¯ä¸€ç§å¯è§†åŒ–å·¥ä½œæµæœåŠ¡, ç”¨äºåè°ƒå’Œç®¡ç†åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºå’Œå¾®æœåŠ¡</li><li>æœ‰ä¸¤ç§ Workflows: Standard å’Œ Express (Express é‡Œæœ‰ Sync å’Œ Async)<ul><li>Standard é€‚åˆ long-running, durable, and auditable workflow</li><li>Express é€‚åˆ high event rates and short duration workflow</li></ul></li><li>Task States: Do some work in the state machine (æ¯”å¦‚ invoke Lambda function)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img215042.png"></p><ul><li>Parallel State: Begin parallel branches of execution</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img215355.png"></p><ul><li>A Task state <code>(&quot;Type&quot;: &quot;Task&quot;)</code> represents a single unit of work performed by a state machine (é‡è¦)</li></ul><hr><h4 id="Step-Functions-Error-Handling"><a href="#Step-Functions-Error-Handling" class="headerlink" title="Step Functions Error Handling"></a>Step Functions Error Handling</h4><ul><li>Any state can encounter runtime errors for various reasons</li><li>Use <code>Retry</code> and <code>Catch</code> in the State Machine to handle error instead of application code</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img215654.png"></p><hr><h4 id="Step-Functions-Wait-for-Task-Token"><a href="#Step-Functions-Wait-for-Task-Token" class="headerlink" title="Step Functions Wait for Task Token"></a>Step Functions Wait for Task Token</h4><ul><li>Allow to pause Step Functions during a Task until a Task Token is returned</li><li>Append <code>.waitForTaskToken</code> to the Resource field</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img220013.png"></p><hr><h4 id="Step-Functions-Activity-Tasks"><a href="#Step-Functions-Activity-Tasks" class="headerlink" title="Step Functions Activity Tasks"></a>Step Functions Activity Tasks</h4><ul><li>Task performed by an Activity Worker (Acitvity Worker å¯ä»¥åœ¨ EC2, Lambda ä¸Šè·‘)</li><li>After Activity Worker complete its work, it sends a response back to Step Functions</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img220441.png"></p><hr><h4 id="AWS-AppSync"><a href="#AWS-AppSync" class="headerlink" title="AWS AppSync"></a>AWS AppSync</h4><ul><li>AppSync is a managed service that use GraphQL (é‡è¦)</li><li>Retrieve data in real-time with WebSocket or MQTT on WebSocket (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img221024.png"></p><hr><h4 id="AWS-Amplify"><a href="#AWS-Amplify" class="headerlink" title="AWS Amplify"></a>AWS Amplify</h4><ul><li>A set of tools to create mobile and web applications (å°±ç±»ä¼¼ firebase, é‡è¦)<ul><li>Authentication: leverage AWS Cognito</li><li>Datastore: leverage AWS AppSync and DynamoDB</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img22%EF%BC%96024.png"></p><hr><h3 id="27-Advanced-Identity"><a href="#27-Advanced-Identity" class="headerlink" title="27. Advanced Identity"></a>27. Advanced Identity</h3><h4 id="AWS-STS"><a href="#AWS-STS" class="headerlink" title="AWS STS"></a>AWS STS</h4><ul><li>AWS STS (Security Token Service) æ˜¯ä¸€ç§ç”¨äºä¸´æ—¶ç”Ÿæˆè®¿é—®å¯†é’¥ä»¥è®¿é—® AWS èµ„æºçš„æœåŠ¡<ul><li>Allow to grant limited and temporary access to AWS up to 1 hour</li></ul></li><li>æ³¨æ„, é‡åˆ° <code>decode-authorization-message</code> çš„å°±æ˜¯ STS</li><li>STS çš„æœ‰æ•ˆæœŸä» 15 åˆ†é’Ÿåˆ° 1 å°æ—¶, æœ‰æ•ˆæœŸè¿‡åéœ€è¦ renew</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230636.png"></p><hr><h4 id="Advanced-IAM"><a href="#Advanced-IAM" class="headerlink" title="Advanced IAM"></a>Advanced IAM</h4><ul><li>Evaluation of Policies (é‡è¦)<ul><li>å…ˆæŸ¥æ˜¯ä¸æ˜¯ Deny, æ˜¯å°±ç›´æ¥ Deny,ä¸æ˜¯å°±æŸ¥æ˜¯ä¸æ˜¯ Allow, æ˜¯å°±ç›´æ¥ Allow, å¦åˆ™ç›´æ¥ Deny</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img231838.png"></p><ul><li>IAM Policies &amp; S3 Bucket Policies<ul><li>éœ€è¦åŒæ—¶ evaluate IAM å’Œ S3 çš„ Polciy, åªè¦ä¸¤ä¸ªé‡Œé¢æ²¡æœ‰ Deny å°±è¡Œ</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232221.png"></p><ul><li>Dynamic Policies with IAM (é‡è¦)<ul><li>Give IAM policy to a specific user, using <code>$&#123;aws:username&#125; </code>(dynamic variable)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232539.png"></p><hr><h4 id="IAM-Access-Analyzer"><a href="#IAM-Access-Analyzer" class="headerlink" title="IAM Access Analyzer"></a>IAM Access Analyzer</h4><ul><li>IAM Access Analyzer simplifies inspecting unused access to guide you toward least privilege (é‡è¦, å¯ä»¥ remove ä¸€äº›ä¸éœ€è¦çš„ IAM Roles)</li><li>IAM Access Analyzer also lets you identify unintended access to your resources and data, which is a security risk (å‡å°‘ security issues)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img012837.png"></p><hr><h4 id="AWS-Directory-Services-AD"><a href="#AWS-Directory-Services-AD" class="headerlink" title="AWS Directory Services (AD)"></a>AWS Directory Services (AD)</h4><ul><li>AWS Directory Services (AD) æ˜¯ä¸€ç§æ‰˜ç®¡æœåŠ¡, ç”¨äºåœ¨ AWS äº‘ä¸­è¿è¡Œ Microsoft Active Directory,ç®€åŒ–èº«ä»½éªŒè¯å’Œèµ„æºç®¡ç†<ul><li>AWS Managed Microsoft AD: AD in AWS, supports MFA (é‡è¦ï¼ŒAD åœ¨ AWS )</li><li>AD Connector: Redirect to on-premise AD, supports MFA (é‡è¦, AD åœ¨ on premise)</li><li>Simple AD: AD-compatible managed directory on AWS</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232910.png"></p><hr><h3 id="28-AWS-Security-amp-Encryption"><a href="#28-AWS-Security-amp-Encryption" class="headerlink" title="28. AWS Security &amp; Encryption"></a>28. AWS Security &amp; Encryption</h3><h4 id="Encryption-101"><a href="#Encryption-101" class="headerlink" title="Encryption 101"></a>Encryption 101</h4><ul><li>Encryption in flight<ul><li>Data is encrypted before sending and decrypted after receive (é‡è¦)</li></ul></li><li>Server-side encryption<ul><li>Both encryption and decryption happen on the server (é‡è¦)</li></ul></li><li>Client-side encryption<ul><li>Data is encrypted by client and never decrypted by the server (é‡è¦)</li></ul></li></ul><blockquote><p>IAM policy to enforce SSL request to objects stored in S3: <code>aws:SecureTransport</code></p></blockquote><hr><h4 id="AWS-KMS"><a href="#AWS-KMS" class="headerlink" title="AWS KMS"></a>AWS KMS</h4><ul><li>Anytime you hear <code>encryption</code> for an AWS service, itâ€™s most likely KMS</li><li>AWS managed encryption keys for us, æ¯”å¦‚ EBS, S3, RDS, SSM (ä¸éœ€è¦è‡ªå·±åˆ›å»º)</li><li>KMS Keys are scoped per Region, Automatic Key Rotation is 1 year</li><li>æ³¨æ„, KMS å¹¶ä¸é€‚åˆä¿å­˜ secret, åŠ å¯†çš„ä¸œè¥¿ä¸ä¸€å®šæ˜¯ secret</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175137.png"></p><ul><li>Types of KMS Keys (3 ç§): AWS Owned, AWS Managed, CMK (Custom Managed)<ul><li>KMS stores the CMK and receives data from client, which it encrypt and send back</li></ul></li><li>ä¸¤ç§ Key çš„å½¢å¼: Symmetric (Single) &amp; Asymmetric (Public &amp; Private)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img171058.png"></p><ul><li>KMS Key Policies<ul><li>KMS Key Policy å¯ä»¥ç”¨æ¥ç®¡ç† KMS CMK (é‡è¦)</li><li>Custom KMS Key Policy: Define who can access the key (Cross Account Access)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175606.png"></p><blockquote><p>Deleting an AWS KMS key in AWS Key Management Service (AWS KMS) is destructive and potentially dangerous. Therefore, AWS KMS enforces a waiting period. (Pending state)</p></blockquote><hr><h4 id="KMS-Envelope-Encryption"><a href="#KMS-Envelope-Encryption" class="headerlink" title="KMS Envelope Encryption"></a>KMS Envelope Encryption</h4><ul><li>KMS <code>Encrypt</code> API call has a limit of 4 KB (é‡è¦)</li><li>If encrypt &gt; 4 KM, we need to use Envelope Encryption (<code>GenerateDataKey</code> API)</li><li>Envelope Encryption æ˜¯ reference data as file within the code</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175943.png"></p><ul><li>KMS Symmetric API Summary<ul><li><code>Encrypt</code>: encrypt up to 4KB of data through KMS</li><li><code>GenerateDataKey</code>: generates a unique symmetric data key (DEK)</li><li><code>GemerateDataKeyWithoutPlaintext</code>: generate a DEK to use later</li><li><code>Decrypt</code>: decrypt up to 4 KB of data</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img180803.png"></p><hr><h4 id="KMS-Limits"><a href="#KMS-Limits" class="headerlink" title="KMS Limits"></a>KMS Limits</h4><ul><li>KMS Request Quotas: Exceed a request quota, get a <code>ThrottlingException</code></li><li>Request a Requst Quotas increase through API or AWS support</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184019.png"></p><hr><h4 id="AWS-CloudHSM"><a href="#AWS-CloudHSM" class="headerlink" title="AWS CloudHSM"></a>AWS CloudHSM</h4><ul><li>AWS CloudHSM æ˜¯ä¸€ç§æ‰˜ç®¡ç¡¬ä»¶å®‰å…¨æ¨¡å—æœåŠ¡, ç”¨äºå®‰å…¨å­˜å‚¨å’Œç®¡ç†åŠ å¯†å¯†é’¥<ul><li>We have to manage the encryption keys entirely</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184859.png"></p><hr><h4 id="SSM-Parameter-Store"><a href="#SSM-Parameter-Store" class="headerlink" title="SSM Parameter Store"></a>SSM Parameter Store</h4><ul><li>SSM Parameter Store æ˜¯ä¸€ç§å®‰å…¨çš„å­˜å‚¨æœåŠ¡, ç®¡ç†é…ç½®æ•°æ®å’Œå¯†é’¥, å¦‚å¯†ç å’Œæ•°æ®åº“å­—ç¬¦ä¸²<ul><li>æ¯”èµ· Secrets Manager æœ‰æ›´å¹¿çš„ç”¨é€”, æ¯”å¦‚ URLs, AMI IDs, License keys ç­‰ç­‰</li><li>SSM æ²¡æœ‰ Automatic key rotation (éå¸¸é‡è¦)</li></ul></li><li>Have built-in verion tracking (æ¯æ¬¡ edit secret éƒ½ä¼šè¢«è®°å½•, é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173611.png"></p><ul><li>å¯ä»¥å°† secret å‚¨å­˜æˆ SecureString åœ¨ SSM Parameter Store é‡Œ (é‡è¦)</li></ul><hr><h4 id="AWS-Secrets-Manager"><a href="#AWS-Secrets-Manager" class="headerlink" title="AWS Secrets Manager"></a>AWS Secrets Manager</h4><ul><li>Store secrets, integrated with RDS &amp; Aurora (éå¸¸é‡è¦, å­˜æ•°æ®åº“ secrets çš„)<ul><li>æ˜¯ç»™ confidential information (like database credentials, API keys) ç”¨çš„</li><li>æ¯”èµ· SSM Parameter Store, Secrets Manager æ”¯æŒ Key çš„è½®æ¢ (90 å¤©)</li><li>æ³¨æ„, Secrets Manager çš„ Key Rotateion æ˜¯ 90 å¤©, KMS çš„ Key Rotateion æ˜¯ä¸€å¹´</li></ul></li><li>æ¯”èµ· KMS, Secrets Manager æ›´é€‚åˆå»ä¿å­˜ secret, æ¯”å¦‚ database credential, è€Œä¸” Secrets Manager ä¹Ÿæœ‰ Automatic key rotation</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185726.png"></p><ul><li>Multi-Region Secrets (å’Œ Multi-Region Key ç±»ä¼¼)<ul><li>Replicate Secrets across multiple AWS Regions (disaster recovery)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174258.png"></p><hr><h4 id="CloudWatch-Logs-Encryption"><a href="#CloudWatch-Logs-Encryption" class="headerlink" title="CloudWatch Logs Encryption"></a>CloudWatch Logs Encryption</h4><ul><li>Encrypt CloudWatch Logs with KMS keys<ul><li>Encryption is enabled at the log group level, by associating a CMK</li></ul></li><li><code>associate-kms-key</code>: if log group already exists (é‡è¦, CloudWatch å­˜åœ¨çš„æƒ…å†µ)</li><li><code>create-log-group</code>: if the log group doesnâ€™t exist</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190545.png"></p><hr><h4 id="AWS-Nitro-Enclaves"><a href="#AWS-Nitro-Enclaves" class="headerlink" title="AWS Nitro Enclaves"></a>AWS Nitro Enclaves</h4><ul><li>Process highly sensitive data in an isolated compute environment</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190809.png"></p><hr><h3 id="29-Other-AWS-Services"><a href="#29-Other-AWS-Services" class="headerlink" title="29. Other AWS Services"></a>29. Other AWS Services</h3><h4 id="AWS-SES-Simple-Email-Service"><a href="#AWS-SES-Simple-Email-Service" class="headerlink" title="AWS SES (Simple Email Service)"></a>AWS SES (Simple Email Service)</h4><ul><li>Managed service to send email securely (å‘é‚®ä»¶çš„)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img004334.png"></p><hr><h4 id="AWS-OpenSearch"><a href="#AWS-OpenSearch" class="headerlink" title="AWS OpenSearch"></a>AWS OpenSearch</h4><ul><li>With OpenSearch, you can search any field, even partially matches<ul><li>åŸæ¥å«åš ElasticSearch (å°±æ˜¯åšæŸ¥è¯¢çš„)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192053.png"></p><hr><h4 id="AWS-Athena"><a href="#AWS-Athena" class="headerlink" title="AWS Athena"></a>AWS Athena</h4><ul><li>Athena is an query service that analyze data in Amazon S3 using standard SQL<ul><li>Athena æ”¯æŒ SQL query å»å¤„ç† S3 æ•°æ®çš„</li><li>Athena cannot be used to analyze data in real time (æ²¡åŠæ³•å®æ—¶å¤„ç†æ•°æ®, é‡è¦)</li></ul></li><li>Use Athena to process logs, perform ad-hoc analysis, and run interactive queries (é‡è¦)</li><li>Use columnar data for cost-saving (çœé’±, less scan)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192218.png"></p><ul><li>Federated Query<ul><li>Allow to run SQL queries across data stored on AWS or On-Premise</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200427.png"></p><hr><h4 id="AWS-MSK"><a href="#AWS-MSK" class="headerlink" title="AWS MSK"></a>AWS MSK</h4><ul><li>Managed Apache Kafka on AWS (Have Serverless)<ul><li>Kinesis çš„ä»£æ›¿ (åŒæ ·å¤„ç† Stream data), ä½†æ˜¯é’ˆå¯¹ Apache Kafka</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230056.png"></p><hr><h4 id="AWS-Certificate-Manager-ACM"><a href="#AWS-Certificate-Manager-ACM" class="headerlink" title="AWS Certificate Manager (ACM)"></a>AWS Certificate Manager (ACM)</h4><ul><li>AWS Certificate Manager (ACM) æ˜¯ä¸€ç§ç®¡ç† SSL&#x2F;TLS è¯ä¹¦çš„æœåŠ¡, ç”¨äºå®‰å…¨åœ°ä¿æŠ¤å’Œç®¡ç†ç½‘ç«™å’Œåº”ç”¨ç¨‹åºçš„é€šä¿¡<ul><li>å¦‚æœæ˜¯ third party SSL å°±æ²¡åŠæ³•ä½¿ç”¨ automatic certificate rotation</li></ul></li><li>å¯ä»¥ç”¨ EventBridge æ¥æ£€æŸ¥ ACM Certificates æ˜¯å¦è¿‡æœŸ (è¿‡æœŸ Invoke SNS)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174451.png"></p><hr><h4 id="AWS-Macie"><a href="#AWS-Macie" class="headerlink" title="AWS Macie"></a>AWS Macie</h4><ul><li>Use ML to protect sensitive data (PII) in AWS (ç”¨ ML ä¿æŠ¤æ•æ„Ÿä¿¡æ¯)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192617.png"></p><hr><h4 id="AWS-AppConfig"><a href="#AWS-AppConfig" class="headerlink" title="AWS AppConfig"></a>AWS AppConfig</h4><ul><li>Configurate, validate, and deploy dynamic configurations</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192722.png"></p><hr><h3 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h3><blockquote><p>è¯·å‹¿éšæ„ä¿®æ”¹, è°¢è°¢</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Certification </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è€ƒè¯ï¼šAWS SAA-C03</title>
      <link href="/posts/fa4ed4d8.html"/>
      <url>/posts/fa4ed4d8.html</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><blockquote><p>ä¸€äº›æˆ‘æ•´ç†çš„èµ„æ–™:</p><ul><li>å®˜ç½‘: <a href="https://aws.amazon.com/certification/certified-solutions-architect-associate/">https://aws.amazon.com/certification/certified-solutions-architect-associate/</a></li><li>ç½‘è¯¾ï¼š<a href="https://www.udemy.com/course/aws-certified-solutions-architect-associate-saa-c03/">https://www.udemy.com/course/aws-certified-solutions-architect-associate-saa-c03/</a></li><li>é¢˜åº“: <a href="https://www.udemy.com/course/practice-exams-aws-certified-solutions-architect-associate/">https://www.udemy.com/course/practice-exams-aws-certified-solutions-architect-associate/</a></li><li>é¢˜åº“: <a href="https://www.examtopics.com/exams/amazon/aws-certified-solutions-architect-associate-saa-c03/">https://www.examtopics.com/exams/amazon/aws-certified-solutions-architect-associate-saa-c03/</a> (å‰ 200 é¢˜å…è´¹)</li><li>å‡†å¤‡æ—¶é—´: 1 æœˆ 13 å·å‡†å¤‡, ä¸­é—´ä¸Šè¯¾æ¨è¿Ÿåˆ° 2 æœˆ 20 å·å‡†å¤‡, 3 æœˆ 29 å·è€ƒè¯• (è€ƒè¿‡, çœŸçš„èŠ±äº†æˆ‘ 2 å°æ—¶ ğŸ§ )</li></ul></blockquote><hr><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><h3 id="1-AWS-Cloud-Overview"><a href="#1-AWS-Cloud-Overview" class="headerlink" title="1. AWS Cloud Overview"></a>1. AWS Cloud Overview</h3><ul><li>Global Services: IAM, Route53, CloudFront, WAF ç­‰ç­‰</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img140948.png"></p><h4 id="AWS-Regions"><a href="#AWS-Regions" class="headerlink" title="AWS Regions"></a>AWS Regions</h4><ul><li>A Region is a cluster of data centers </li><li>è€ƒè™‘ Compliance (åˆè§„), Proximity (ä¸´è¿‘ç”¨æˆ·), Available Services å’Œ Pricing</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img231130.png"></p><hr><h4 id="AWS-Availability-Zone-AZ"><a href="#AWS-Availability-Zone-AZ" class="headerlink" title="AWS Availability Zone (AZ)"></a>AWS Availability Zone (AZ)</h4><ul><li>ä¸€ä¸ª Region å¯ä»¥æœ‰ 3 - 6 ä¸ª AZ (æ¯ä¸ª AZ éƒ½æ˜¯åˆ†å¼€çš„)</li><li>To coordinate Availability Zones across accounts, you must use the AZ ID (æ³¨æ„)<ul><li>A åœ¨ us-west-2a å’Œ B åœ¨ us-west-2a æ˜¯ä¸ä¸€æ ·çš„</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img140727.png"></p><hr><h4 id="AWS-Edge-Locations"><a href="#AWS-Edge-Locations" class="headerlink" title="AWS Edge Locations"></a>AWS Edge Locations</h4><ul><li>Deliver content to user with low latency (ç¦»ç”¨æˆ·è¶Šè¿‘, deliver é€Ÿåº¦è¶Šå¿«)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img140903.png"></p><hr><h3 id="2-IAM"><a href="#2-IAM" class="headerlink" title="2. IAM"></a>2. IAM</h3><h4 id="AWS-IAM"><a href="#AWS-IAM" class="headerlink" title="AWS IAM"></a>AWS IAM</h4><ul><li>Root Account: Created by default, ä¸è¦å’Œåˆ«äººåˆ†äº«</li><li>Users: People within the organization</li><li>Groups: Only contain Users, not other Groups (User å¯ä»¥å±äºå¤šä¸ª Group)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img145736.png"></p><hr><h4 id="IAM-Permissions"><a href="#IAM-Permissions" class="headerlink" title="IAM Permissions"></a>IAM Permissions</h4><ul><li>å®šä¹‰äº† User æˆ–è€… Group çš„ Permission</li><li>è®°å¾—éµå®ˆ Least Privilege Principle</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img160124.png"></p><hr><h4 id="IAM-Polices"><a href="#IAM-Polices" class="headerlink" title="IAM Polices"></a>IAM Polices</h4><blockquote><p>IAM policies define permissions for an action regardless of the method that you use to perform the operation.</p></blockquote><ul><li>Statements é‡Œé¢å¿…é¡»åŒ…å«: Effect, Principal, Action, Resource<ul><li>Inline Policy æ˜¯ assign ç»™ä¸ªäººçš„</li></ul></li><li>æ³¨æ„, The only resource-based policy IAM support is Trust policy</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175653.png"></p><hr><h4 id="IAM-MFA"><a href="#IAM-MFA" class="headerlink" title="IAM MFA"></a>IAM MFA</h4><ul><li>Protect Root Accounts and IAM Users</li><li>MFA options: Virtual MFA Device, U2F Sercurity Key (USB)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img180624.png"></p><hr><h4 id="IAM-CLI-amp-SDK"><a href="#IAM-CLI-amp-SDK" class="headerlink" title="IAM CLI &amp; SDK"></a>IAM CLI &amp; SDK</h4><ul><li>å¯ä»¥ç”¨ AWS Management Console, AWS CLI, AWS SDK æ¥è®¿é—® AWS</li><li>AWS CLI, AWS SDK ç”± Access Keys ä¿æŠ¤<ul><li>Set the DeleteOnTermination attribute to False using the command line</li><li>å¦‚æœè€ƒè¯•é‡åˆ°ä¸ä¼šçš„å°±é€‰ CLI</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img193342.png"></p><hr><h4 id="IAM-Roles"><a href="#IAM-Roles" class="headerlink" title="IAM Roles"></a>IAM Roles</h4><ul><li>æˆæƒ AWS æœåŠ¡å»åšæŸäº›äº‹ (æ¯”å¦‚ EB éœ€è¦ EC2 Role å’Œ Service Role)</li><li>å¸¸è§çš„ Role: EC2 Instance Role, Lambda Function Role ç­‰ç­‰</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203306.png"></p><hr><h4 id="IAM-Security-Tools"><a href="#IAM-Security-Tools" class="headerlink" title="IAM Security Tools"></a>IAM Security Tools</h4><ul><li>IAM Credentials Report: è¿”å›ç”¨æˆ·æ•°æ®å’Œä»–ä»¬çš„ credentials (å‡­æ®)</li><li>IAM Access Advisor: æ˜¾ç¤ºå½“å‰ç”¨æˆ·è¢«æˆæƒçš„æœåŠ¡å’Œä½¿ç”¨æ—¶é—´</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203553.png"></p><hr><h4 id="IAM-Extra"><a href="#IAM-Extra" class="headerlink" title="IAM Extra"></a>IAM Extra</h4><ul><li>Trust Policy (å”¯ä¸€çš„ resource-based policy)<ul><li>Trust policies define which principal entities can assume the role.</li></ul></li><li>AWS Organizations Service Control Policies (SCP, é’ˆå¯¹ Organization çš„)<ul><li>SCPs are JSON policies that specify the maximum permissions for an organization or organizational unit (OU)</li></ul></li><li>Access Control List (ACL, ç®¡ç†åˆ«äººçš„ account çš„)<ul><li>Access control lists (ACLs) are service policies that allow you to control which principals in another account can access a resource</li></ul></li><li>Permissions Boundary (ç®¡ç†ä¸€ä¸ª account æœ€å¤šæœ‰ä»€ä¹ˆæƒé™)<ul><li>A permissions boundary is an advanced feature for using a managed policy to set the maximum permissions that an identity-based policy can grant to an IAM entity.</li></ul></li></ul><hr><h3 id="3-EC2-Fundamentals"><a href="#3-EC2-Fundamentals" class="headerlink" title="3. EC2 Fundamentals"></a>3. EC2 Fundamentals</h3><h4 id="AWS-EC2"><a href="#AWS-EC2" class="headerlink" title="AWS EC2"></a>AWS EC2</h4><ul><li>å±äº Infrastructure as Service (IaaS) , ç»‘å®š AZ</li><li>User Data: EC2 å¯åŠ¨çš„æ—¶å€™è¿è¡Œçš„ä»£ç  (æ¯”å¦‚å¾€ EC2 Instance é‡Œé¢è£… Appache)<ul><li>By default, user data runs only during boot cycle when first lauch instance</li><li>By default, scripts entered as user data are executed with root user privileges</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img214749.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img214956.png"></p><ul><li>SSH åˆ° EC2 Instance çš„ public IP (è®°ä½, 169, meta-data)<ul><li><a href="http://169.254.169.254/latest/meta-data/public-ipv4">http://169.254.169.254/latest/meta-data/public-ipv4</a></li></ul></li></ul><hr><h4 id="EC2-Instance-Type"><a href="#EC2-Instance-Type" class="headerlink" title="EC2 Instance Type"></a>EC2 Instance Type</h4><ul><li>ä¸€å…± 7 ç§ EC2 Instance Type, ä½† 4 ç§ç”¨çš„æœ€å¤š<ul><li>General Purpose, Compute Optimized, Memory Optimized, Storage Optimized</li></ul></li><li>General Purpose: Balanced (å¹³è¡¡çš„)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img221846.png"></p><ul><li>Compute Optimized: High performance (å¤„ç† Batch, è§†é¢‘å’Œ HPC)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img221936.png"></p><ul><li>Memory Optimized: Process data in memory (å¤„ç† In memory database, cache)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img222020.png"></p><ul><li>Storage Optimized: Read and write data on local storage (OLTP)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img222129.png"></p><hr><h4 id="EC2-Security-Groups"><a href="#EC2-Security-Groups" class="headerlink" title="EC2 Security Groups"></a>EC2 Security Groups</h4><ul><li>Control how traffic is allowed into or out of EC2 instance (ç±»ä¼¼é˜²ç«å¢™)<ul><li>Can be attached to multiple instances (å¯ä»¥å¤ç”¨)</li><li>Locked down to Region &#x2F; VPC</li></ul></li><li>å¯ä»¥ä½œä¸º Security Group çš„ Inbound Rule æœ‰<ul><li>IP address, CIDR block, Security Group</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img222531.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223020.png"></p><hr><h4 id="EC2-Instance-Purchasing-Options"><a href="#EC2-Instance-Purchasing-Options" class="headerlink" title="EC2 Instance Purchasing Options"></a>EC2 Instance Purchasing Options</h4><ul><li>On-Demand Intances: Short workload, pay by second (çŸ­æœŸå†…ç´§æ€¥ä½¿ç”¨)</li><li>Reserved: 1 - 3 years (72% discount, reserve capacity in an AZ)<ul><li>Reserved Instance: Long workload (1 - 3 å¹´, discount éšå¹´ä»½å¢åŠ )</li><li>Convertible Reserved Instances (RI): Long workload with flexible instance (66% discount, ä½†æ˜¯å¯ä»¥è‡ªç”±æ”¹å˜ Instance Type)</li></ul></li><li>Saving Plans: 1 - 3 years, commitment to an amount of usage (72% discount, è¦å®šä¸€ä¸ªä½¿ç”¨ä¸Šé™, è¶…è¿‡ä¸Šé™å°±å˜æˆ On-Demand)<ul><li>è¿˜æœ‰ Compute Saving Plan, 66% discount, work with Lambda and Fargate</li></ul></li><li>Spot Instance: Short workload, can lose instance (æœ€ä¾¿å®œ, 90% discount)</li><li>Dedicated Host: The physical server is yours (æœ€è´µ, å¯ä»¥æ§åˆ¶ how Instance placed)</li><li>Dedicated Instance: Run hardware, but not lockdown to you (æœåŠ¡å™¨å¤§éƒ¨åˆ†æ˜¯ä½ çš„)</li><li>Capacity Reservation: Reserve capacity in AZ (æ¯”å¦‚ä¸€å¤©ä¸­åªæœ‰å‡ ä¸ªå°æ—¶éœ€è¦ EC2)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img224149.png"></p><hr><h4 id="EC2-Spot-Instance"><a href="#EC2-Spot-Instance" class="headerlink" title="EC2 Spot Instance"></a>EC2 Spot Instance</h4><ul><li>åªèƒ½åœ¨ open, active æˆ–è€… disabled çš„çŠ¶æ€ä¸‹ cancel Spot Instance</li><li>éœ€è¦å…ˆ cancel Spot Instance, ç„¶åå† terminate (Cancel ä¸ä»£è¡¨ Terminate)</li><li>Spot Instance æœ‰ one-time å’Œ persistent ä¸¤ç§ request type</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img225943.png"></p><ul><li>Spot Fleets: Automatically request Spot Instance with lowest price (Spot + On-Demand)<ul><li>æ‹¿åˆ°æœ€ä¾¿å®œçš„ Spot Instances</li></ul></li><li>Spot Fleets are set to maintain target capacity (å¯ä»¥ä¿è¯ä¸€å®šæ•°é‡çš„ Instance)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230258.png"></p><hr><h3 id="4-EC2-SAA-Level"><a href="#4-EC2-SAA-Level" class="headerlink" title="4. EC2 SAA Level"></a>4. EC2 SAA Level</h3><h4 id="Elastic-IP"><a href="#Elastic-IP" class="headerlink" title="Elastic IP"></a>Elastic IP</h4><ul><li>Public IP: Unique across the whole web</li><li>Private IP: Unique across the private network</li><li>Elastic IP: Fixed Public IP for EC2 instance (ä¸ä¼šæ”¹å˜)<ul><li>ä¸ºä»€ä¹ˆè¦ Elastic IP, å› ä¸º EC2 çš„ Public IP ä¼šåœ¨é‡å¯åæ”¹å˜</li><li>è€Œä¸” Elastic IP å¯ä»¥èŠ‚çœ EC2 çš„å¼€æ”¯, Private IP ä¹Ÿå¯ä»¥ (åœ¨ private internet æ¡ä»¶ä¸‹)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img165706.png"></p><hr><h4 id="EC2-Placement-Groups"><a href="#EC2-Placement-Groups" class="headerlink" title="EC2 Placement Groups"></a>EC2 Placement Groups</h4><ul><li>Cluster: Low-latency, single AZ, ç½‘é€Ÿå¿«ä½† AZ å¯èƒ½ fail (å¤„ç† HPC)</li><li>Spread: High availability, critical application, é£é™©å°ä½†æœ‰é™åˆ¶, æ¯ä¸ª AZ æœ€å¤š 7 ä¸ªå®ä¾‹<ul><li>å¤„ç† small number of critical instances that need seperate from each other</li></ul></li><li>Partition: Partition instances across many partitions within an AZ, 7 partitions per AZ, up to 100 instances, span multiple region (Big Data, é£é™©å°, é™åˆ¶ä½)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img170342.png"></p><ul><li>Cluster: Low-latency, single AZ, ç½‘é€Ÿå¿«ä½† AZ å¯èƒ½ fail (é€‚åˆ HPC)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img170525.png"></p><ul><li>Spread: High availability, critical application, é£é™©å°ä½†æœ‰é™åˆ¶, æ¯ä¸ª AZ æœ€å¤š 7 ä¸ªå®ä¾‹</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img170652.png"></p><ul><li>Partition: Spreads instances across many partitions within an AZ, 7 partitions per AZ, up to 100 instances, span multiple region (Big Data, é£é™©å°, é™åˆ¶ä½)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img170936.png"></p><hr><h4 id="Elatic-Network-Interfaces-ENI"><a href="#Elatic-Network-Interfaces-ENI" class="headerlink" title="Elatic Network Interfaces (ENI)"></a>Elatic Network Interfaces (ENI)</h4><ul><li>Virtual network card in a VPC</li><li>å¤„ç† EC2 Instance failover (æ•…éšœè½¬ç§»), ç»‘å®š AZ (ä¸å¯ä»¥ attach åˆ°å…¶ä»– AZ ä¸Š)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img182407.png"></p><hr><h4 id="EC2-Hibernate"><a href="#EC2-Hibernate" class="headerlink" title="EC2 Hibernate"></a>EC2 Hibernate</h4><ul><li>EC2 Hibernate: Make EC2 instance boot faster (ä¸æ˜¯ stoped, è€Œæ˜¯ hibernated)</li><li>EC2 Instance Root Volume type must be an EBS volume</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img183846.png"></p><hr><h3 id="5-EC2-Instance-Storage"><a href="#5-EC2-Instance-Storage" class="headerlink" title="5. EC2 Instance Storage"></a>5. EC2 Instance Storage</h3><h4 id="AWS-EBS"><a href="#AWS-EBS" class="headerlink" title="AWS EBS"></a>AWS EBS</h4><ul><li>Block-level storage, ç±»ä¼¼ network drive, ç»‘å®š AZ, provisioned capacity<ul><li>By default, Root Volume will be deleted on termination (é‡è¦)</li><li>By default, other EBS volume will not be deleted on termination (é‡è¦)</li></ul></li><li>å¯ä»¥ä»ä¸€ä¸ª EC2 Instance å–ä¸‹æ¥è£…åˆ°å¦ä¸€ä¸ªä¸Š</li><li>EBS æ˜¯ç»‘å®š AZ çš„ (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img191440.png"></p><hr><h4 id="EBS-Snapshots"><a href="#EBS-Snapshots" class="headerlink" title="EBS Snapshots"></a>EBS Snapshots</h4><ul><li>Make a backup of EBS volume (å¤‡ä»½ EBS)</li><li>å¯ä»¥å°†è¿™ä¸ª snapshot ç”¨åœ¨å…¶ä»– AZ æˆ–è€… Region ä¸Š</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img195715.png"></p><ul><li>EBS Snapchot Archive: ä¾¿å®œ 75%</li><li>Recycle Bin: Setup rules to retain deleted snapshots (å¯ä»¥ recover)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img195833.png"></p><hr><h4 id="AWS-AMI"><a href="#AWS-AMI" class="headerlink" title="AWS AMI"></a>AWS AMI</h4><ul><li>AMI: Amazon Machine Image (Customization of an EC2 Instance)<ul><li>å¯ä»¥æ›´å¥½çš„ç®¡ç†å’Œå¯åŠ¨ EC2 Instance</li></ul></li><li>Built for a specific region and can copy across regions (AMI è·¨åŸŸå¤åˆ¶)</li></ul><blockquote><p>When the new AMI is copied from Region A into Region B, it automatically creates a snapshot in Region B (æ³¨æ„, è·¨åŸŸ copy AMI ä¼šäº§ç”Ÿ snapshot)</p></blockquote><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200249.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200341.png"></p><hr><h4 id="EC2-Instance-Store"><a href="#EC2-Instance-Store" class="headerlink" title="EC2 Instance Store"></a>EC2 Instance Store</h4><ul><li>Block-level storage, ç‰©ç†ç¡¬ç›˜ (Physical drive, temporary storage)</li><li>High random I&#x2F;O performance, good for cache &amp; buffer at low cost (é‡è¦)</li><li>EC2 Instance Store lose when stopped (Ephemeral, æ•°æ®åœ¨ Instance Store å…³é—­æ—¶æ¶ˆå¤±)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203146.png"></p><ul><li>You canâ€™t detach an Instance Store volume from one instance and attach it to a different instance</li><li>If you create an Amazon Machine Image (AMI) from an instance, the data on its instance store volumes isnâ€™t preserved</li></ul><hr><h4 id="EBS-Volume-Types"><a href="#EBS-Volume-Types" class="headerlink" title="EBS Volume Types"></a>EBS Volume Types</h4><ul><li>General Purpose (gp2 &#x2F; gp3): Balanced, cost-effective</li><li>Provisioned IOPS (io1 &#x2F; io2): High-performance, support Multi-Attach<ul><li>è®°ä½, io çš„æ¯” gp çš„è´µ, ä½†æ˜¯ io çš„ IOPS ä¹Ÿæ¯” gp é«˜</li></ul></li><li>Hard Disk Drives (HDD): Data intensive (st1) æˆ–è€… less frequent access (sc1)<ul><li>HDD ä¸å¯ä»¥ç”¨æ¥åˆ›å»º EC2</li></ul></li><li>ä¸Šé¢è¿™äº›éƒ½æ²¡æœ‰è¶…è¿‡ 300,000 IOPS</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203437.png"></p><hr><h4 id="EBS-Multi-Attach"><a href="#EBS-Multi-Attach" class="headerlink" title="EBS Multi-Attach"></a>EBS Multi-Attach</h4><ul><li>Attach same EBS volume to multiple EC2 instance in same AZ (è®°ä½æ˜¯ç›¸åŒçš„ AZ)</li><li>Only for io1 &#x2F; io2 family (Provisioned IOPS SSD, é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203956.png"></p><hr><h4 id="EBS-Encryption"><a href="#EBS-Encryption" class="headerlink" title="EBS Encryption"></a>EBS Encryption</h4><ul><li>EBS Encryption (æ‰€æœ‰ç¯èŠ‚éƒ½æ˜¯ encrypted çš„)<ul><li>Data at rest is encrypted &amp; Data in flight is encrypted &amp; Snapshot is encrypted</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img204137.png"></p><ul><li>é¦–å…ˆ create snapshot, ç„¶å encrypt snapshot, ç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„ EBS Volume (ä» encrypted snapshot),  ç„¶åå°†è¿™ä¸ª volume åŠ å…¥åˆ°åŸæ¥çš„ Instance ä¸Š</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img204208.png"></p><hr><h4 id="EBS-RAID"><a href="#EBS-RAID" class="headerlink" title="EBS RAID"></a>EBS RAID</h4><ul><li>RAID 0 (çœ‹é‡ I&#x2F;O performance)<ul><li>Use RAID 0 when I&#x2F;O performance is more important than fault tolerance</li></ul></li><li>RAID 1 (çœ‹é‡ falut tolerance)<ul><li>Use RAID 1 when fault tolerance is more important than I&#x2F;O performance</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/imgpt6-q37-i1.jpg"></p><hr><h4 id="AWS-EFS"><a href="#AWS-EFS" class="headerlink" title="AWS EFS"></a>AWS EFS</h4><ul><li>NFS (Network file system), å¯ä»¥ mount åˆ°å¤šä¸ª EC2 Instance<ul><li>Scale automatically, no capacity planning</li></ul></li><li>EC2 Instances can access files on an EFS file system across AZs, Regions and VPCs<ul><li>é‡è¦, å¯ä»¥ä»ä¸åŒçš„ AZ, Region, VPC æ¥ access</li></ul></li><li>å¯ä»¥ç”¨ VPC Security Group æˆ–è€… IAM Policy æ¥ control access to EFS</li><li>EFS Infrequent Access (å¦‚æœé‡åˆ° POSIX compliant file storage)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233415.png"></p><ul><li>NFS æœ‰ 2 ç§ Performance Mode<ul><li>General Purpose: Default (web server)</li><li>Max I&#x2F;O: High latency, throughput, parallel (Big Data, media process, é‡è¦)</li></ul></li><li>NFS æœ‰ 3 ç§ Throughput Mode (é‡è¦)<ul><li>Bursting: å¾ˆå¿«</li><li>Provisioned: è®¾ç½®ä¸Šé™ (high throughput, å¤„ç†å¤§é‡æ–‡ä»¶ migrate æ—¶å€™ä½¿ç”¨)</li><li>Elastic: æ ¹æ® workload æ¥ scale</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233732.png"></p><blockquote><p>EFS é€‚åˆå­˜å‚¨å¤§å‹æ–‡ä»¶, ä»ä»·æ ¼çš„è§’åº¦æ¥çœ‹, å­˜ 100 GB çš„æ–‡ä»¶, EBS &gt; EFS &gt; S3 (ä»·æ ¼)<br>EFS å¹¶ä¸æ˜¯æ°¸è¿œæœ€è´µçš„, ä½† S3 æ°¸è¿œæ˜¯æœ€ä¾¿å®œçš„</p></blockquote><hr><h3 id="6-ELB-amp-ASG"><a href="#6-ELB-amp-ASG" class="headerlink" title="6. ELB &amp; ASG"></a>6. ELB &amp; ASG</h3><h4 id="Scalability-amp-High-Availability"><a href="#Scalability-amp-High-Availability" class="headerlink" title="Scalability &amp; High Availability"></a>Scalability &amp; High Availability</h4><ul><li>Vertical (ç«–ç›´) Scale: Increase the size of the Instance (ä½†æ˜¯æœ‰ hardware limit)</li><li>Horizontal (æ°´å¹³) Scale: Increase the number of the Instance</li><li>High Availability: Rrunning application in at least 2 AZ (Disaster recovery, DR, é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img080120.png"></p><hr><h4 id="AWS-ELB"><a href="#AWS-ELB" class="headerlink" title="AWS ELB"></a>AWS ELB</h4><ul><li>Foward traffic to multiple EC2 Instances (æµé‡æ§åˆ¶)<ul><li>High Availability across AZs, handle failures of downstream instances</li></ul></li><li>Health Check: å¯ä»¥çŸ¥é“ EC2 Instance æ˜¯å¦æ˜¯ Healthy çš„<ul><li>ASG æ˜¯ç”¨ EC2 based health check, ALB ç”¨çš„æ˜¯ ALB based health check</li><li>ELB åº”è¯¥åœ¨ public subnet, ASG åº”è¯¥åœ¨ private subnet (é‡è¦)</li></ul></li><li>ELB cannot distribute traffic for targets deployed in different region</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img141400.png"></p><ul><li>Application Load Balancer (HTTP &#x2F; HTTPS, Layer 7)</li><li>Network Load Balancer (TCP &#x2F; UDP, Layer 4)<ul><li>NLB provide static DNS and static IP, ALB only provide static DNS</li></ul></li><li>Gateway Load Balancer (Security, Layer 3, è¦ç‰¹åˆ«æ³¨æ„)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img090125.png"></p><hr><h4 id="Application-Load-Balancer-ALB"><a href="#Application-Load-Balancer-ALB" class="headerlink" title="Application Load Balancer (ALB)"></a>Application Load Balancer (ALB)</h4><ul><li>Deal with Layer 7 (HTTP &#x2F; HTTPS)</li><li>Route base on Path (&#x2F;Home) or Query (?Platform&#x3D;Mobile)</li><li>ALB adds an additional header called â€œX-Forwarded-Forâ€ contains the clientâ€™s IP</li><li>å¯ä»¥ configure ALB to redirect HTTP to HTTPS (é‡è¦)</li><li>ALB æ— æ³•è¢« assign Elstaic IP</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192523.png"></p><ul><li>Routing tables to different target groups<ul><li>Route based on path in URL</li><li>Route based on hostname in URL</li><li>Route based on Query String, Headers, Client IP</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img142631.png"></p><ul><li>ALB Target Groups:<ul><li>EC2 Instance, ECS, Lambda, IP Address</li></ul></li></ul><blockquote><p>To forward all requests to the website so that the requests will use HTTPS, a solutions architect can create a listener rule on the ALB that redirects HTTP traffic to HTTPS. </p></blockquote><hr><h4 id="Network-Load-Balancer-NLB"><a href="#Network-Load-Balancer-NLB" class="headerlink" title="Network Load Balancer (NLB)"></a>Network Load Balancer (NLB)</h4><ul><li>Deal with Layer 4 (TCP &#x2F; UDP), å¾ˆå¿«, å¤„ç†æœ‰å¤§é‡ request çš„æƒ…å†µ</li><li>One static IP per AZ or use Elastic IP</li><li>NLB supports HTTP health checks as well as TCP and HTTPS</li><li>æ³¨æ„, NLB best suited for use-cases involving low latency and high throughput workloads, æ¯”å¦‚é“¶è¡Œ, æ¸¸æˆ</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img144359.png"></p><blockquote><p>If you specify targets using an instance ID, traffic is routed to instances using the primary private IP address specified in the primary network interface for the instance.</p></blockquote><hr><h4 id="Gateway-Load-Balancer-GWLB"><a href="#Gateway-Load-Balancer-GWLB" class="headerlink" title="Gateway Load Balancer (GWLB)"></a>Gateway Load Balancer (GWLB)</h4><ul><li>Deal with Layer 3 (Security, 3rd Party)</li><li>GWLB allows perform inline inspection of traffic from multiple spoke VPCs in a simplified and scalable fashion</li><li>Use GENEVE protocol on port 6081</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223042.png"></p><hr><h4 id="Sticky-Sessions-Session-Affinity"><a href="#Sticky-Sessions-Session-Affinity" class="headerlink" title="Sticky Sessions (Session Affinity)"></a>Sticky Sessions (Session Affinity)</h4><ul><li>Same client is always redirect to the same instance behind a load balancer</li><li>Make sure user doesnâ€™t loss session data (æ¯”å¦‚ç”¨æˆ·ç™»å½•)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223425.png"></p><ul><li>Application-based Cookies: Donâ€™t use AWSALB, AWSALBAPP, AWSALBTG</li><li>Duration-based Cookies: AWSALB for ALB, AWSELB for CLB</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223604.png"></p><hr><h4 id="Cross-Zone-Load-Balancing"><a href="#Cross-Zone-Load-Balancing" class="headerlink" title="Cross Zone Load Balancing"></a>Cross Zone Load Balancing</h4><ul><li>ELB distributes traffic evenly across all registered EC2 instances in all AZs<ul><li>æ‰€æœ‰ Instance åˆ†åˆ°çš„ traffic ä¸€å®šæ˜¯ä¸€æ ·çš„</li><li>å¦‚æœæ²¡æœ‰ enable, é‚£ä¹ˆ AZ å†…éƒ¨å°±æ˜¯å¹³å‡åˆ†</li></ul></li><li>ALB enabled by default, NLB disabled by default (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230059.png"></p><hr><h4 id="SSL-Certificates"><a href="#SSL-Certificates" class="headerlink" title="SSL Certificates"></a>SSL Certificates</h4><ul><li>Allow traffic between client and load balancer encrypted in transit (HTTPS)<ul><li>Manage SSL certificates using ACM (AWS Certificate Manager)</li></ul></li><li>å¦‚æœé—®åˆ°éœ€è¦ç®¡ç†å¾ˆå¤šä¸ª SSL æˆ–è€… TSL, é€‰æ‹© SNI (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230614.png"></p><ul><li>Could be used in ALB &amp; NLB, use SNI to make it work</li><li>SNI: Load multiple SSL certificates onto one web server (Server Name Indication)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230910.png"></p><hr><h4 id="Connection-Draining"><a href="#Connection-Draining" class="headerlink" title="Connection Draining"></a>Connection Draining</h4><ul><li>Waiting for existing connections to complete</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img231418.png"></p><blockquote><p>Connection Draining enables the load balancer to complete in-flight requests made to instances that are de-registering or unhealthy</p></blockquote><hr><h4 id="AWS-ASG"><a href="#AWS-ASG" class="headerlink" title="AWS ASG"></a>AWS ASG</h4><ul><li>ASG å¯ä»¥å’Œ ELB ä¸€èµ·ç”¨, æ¥ scale out æˆ–è€… in åŸºäºæœåŠ¡å™¨å‹åŠ› (å…è´¹)</li><li>ASG å¯ä»¥ä¿è¯æœ€å°‘æˆ–æœ€å¤šæœ‰å¤šå°‘ EC2 Instance åœ¨å·¥ä½œ (min, max)<ul><li>ASG æ˜¯åœ¨ä¸€ä¸ª Region é‡Œé¢å»æ ¹æ® availiable çš„ AZ è¿›è¡Œ scale</li></ul></li><li>å½“ä¸€ä¸ª Instance æ˜¯ unhealthy çš„æ—¶å€™, ASG ä¼š terminate è¿™ä¸ª Instance<ul><li>ASG åœ¨ä¸€ä¸ª AZ é‡Œæœ€æ—© terminate çš„æ˜¯é‚£ä¸ªæœ€æ—©è¢« launch çš„ Instance</li><li>é‡åˆ° unbalanced çš„æƒ…å†µ, ASG æ˜¯å…ˆ launch new instance ç„¶å terminate old instance</li><li>ä½†æ˜¯åœ¨ unhealthy çš„æƒ…å†µä¸‹æ˜¯å…ˆ terminate unhealth Instance ç„¶å create new</li></ul></li><li>å¦‚æœé—®åˆ°åœ¨æŸä¸ªèŠ‚æ—¥å‰å» scale, é‚£å°±æ˜¯ ASG scheduled action</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232350.png"></p><ul><li>å¯ä»¥å’Œ ELB ä¸€èµ·ç”¨, æ¥ scale out æˆ–è€… in åŸºäºæœåŠ¡å™¨å‹åŠ›</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232615.png"></p><ul><li>Launch Template: å¯ä»¥ä½œä¸º template æ¥ç”Ÿæˆ EC2 Instance<ul><li>Launch Template æ˜¯ç®¡è¦ç”Ÿæˆä»€ä¹ˆ Instance çš„ (eg. Spot, On-Demand)</li><li>Launch Configuration æ˜¯ç®¡ç”Ÿæˆçš„ Instance çš„ä¿¡æ¯çš„ (eg. AMI, security group)</li></ul></li><li>å¦‚æœè¦æ›´æ–° Launch Template, éœ€è¦åˆ æ‰æ—§çš„ç„¶åä½¿ç”¨æ–°çš„ (æ³¨æ„)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232823.png"></p><ul><li>å¯ä»¥å’Œ CloudWatch Alarm ä¸€èµ·æ ¹æ®æœåŠ¡å™¨å‹åŠ› scale out æˆ– scale in</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232959.png"></p><ul><li>ASG ä¸ terminate Instance çš„æƒ…å†µ<ul><li>The health check grace period for the instance has not expired</li><li>The instance maybe in Impaired status</li><li>The instance has failed the Elastic Load Balancing (ELB) health check status</li></ul></li></ul><hr><h4 id="Scaling-Policies"><a href="#Scaling-Policies" class="headerlink" title="Scaling Policies"></a>Scaling Policies</h4><ul><li>Dynamic Scaling<ul><li>Target Tracking Scaling: æ ¹æ® CPU ç”¨é‡æˆ–è€… SQS é•¿åº¦æ¥ scale</li><li>Simple &#x2F; Step Scaling: å’Œ CloudWatch Alarm å…³è”</li><li>Scheduled Actions: æ¯”å¦‚åœ¨æ„Ÿæ©èŠ‚é‚£å¤©è¿›è¡Œ scale</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233532.png"></p><ul><li>Predictive Scaling<ul><li>Forecast load and schedule scaling ahead</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233711.png"></p><hr><h3 id="7-AWS-Fundamentals"><a href="#7-AWS-Fundamentals" class="headerlink" title="7. AWS Fundamentals"></a>7. AWS Fundamentals</h3><h4 id="AWS-RDS"><a href="#AWS-RDS" class="headerlink" title="AWS RDS"></a>AWS RDS</h4><ul><li>ä½¿ç”¨ RDS çš„å¥½å¤„ (å¯¹æ¯”å°†æ•°æ®åº“å­˜åœ¨ EC2 ä¸Š)<ul><li>Automated provisioning, auto-scaling, backup</li><li>Read Replicas (æœ€å¤š 15 ä¸ª) å’Œ Multi-AZ</li></ul></li><li>RDS RIs: ç±»ä¼¼ EC2 RIs</li><li>RDS Read Replica: If master database is encrypted, the replica is also encrypted<ul><li>æ³¨æ„, Read Replica æé«˜çš„æ˜¯ read, è€Œä¸æ˜¯ scale æ•°æ®åº“çš„ storage (è€Œä¸” Replica è´µ), å¤„ç†ç±»ä¼¼ report æˆ–è€… analytics çš„å°±æ˜¯ Read Replica</li><li>Read Replica ä¸æ˜¯æé«˜ High Availability, Multi-AZ æ‰æ˜¯</li><li>Cross-Region Read Replica: å½“ disaster å‘ç”Ÿ, å¯ä»¥ä½œä¸º DB backup</li></ul></li><li>RDS Multi-AZ: RDS create a primary DB Instance and synchronously replicates the data to a standby instance in a different AZ (High Availability)<ul><li>RDS Multi-AZ update æ˜¯ standby å’Œ primary ä¸€èµ· update (ä¼šæœ‰ downtime)</li></ul></li><li>Support MySQL, PostgreSQL, MariaDB, Oracle, MS SQL Server, and Amazon Aurora</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img161720.png"></p><ul><li>Storage Auto Scaling (è‡ªåŠ¨ scale)<ul><li>For application with unpredictable workloads</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img161952.png"></p><ul><li>Disaster Recovery<ul><li>Create a Read Replica in different region and enable Multi-AZ on Read Replica</li></ul></li><li>IAM Database Authentication: å¯ä»¥ç”¨æ¥è®¿é—® RDS</li><li>å¯ä»¥ä» RDS Read Replica è¿ç§»åˆ° Aurora Read Replica, è¿™ä¸ªåšæ³•å¯ä»¥ minimal change</li></ul><hr><h4 id="Read-Replicas-vs-Multi-AZ"><a href="#Read-Replicas-vs-Multi-AZ" class="headerlink" title="Read Replicas vs. Multi AZ"></a>Read Replicas vs. Multi AZ</h4><ul><li>Read Replicas: Scalability, Async Replication<ul><li>Within AZ, Cross AZ or Cross Region</li></ul></li><li>Read Replicas in Same Region is free (Replication in AZs), Cross Region is not free</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173522.png"></p><ul><li>ç”¨ Production databse å¤„ç†æ—¥å¸¸, ç”¨ Read Replica æ¥å»ºä¸€ä¸ªå‰¯æœ¬å¤„ç†æ•°æ®åˆ†æ</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173820.png"></p><ul><li>Multi AZ: High Availability, Disaster Recovery, Sync Replication<ul><li>åœ¨ Multi-AZ çš„æƒ…å†µä¸‹, å½“ RDS æ•°æ®åº“ goes down, CNAME ä¼šæ›´æ–°æŒ‡å‘ standby</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174148.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174357.png"></p><hr><h4 id="RDS-Custom"><a href="#RDS-Custom" class="headerlink" title="RDS Custom"></a>RDS Custom</h4><ul><li>Could access the underlying database and OS <ul><li>åªæœ‰ Oracle å’Œ Microsoft SQL Server å¯ä»¥</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174702.png"></p><hr><h4 id="AWS-Aurora"><a href="#AWS-Aurora" class="headerlink" title="AWS Aurora"></a>AWS Aurora</h4><ul><li>Support PostgreSQL and MySQL (ä¸éœ€è¦ç®¡ç† storage)</li><li>Aurora æ²¡æœ‰ standby database, Aurora Replica å¯ä»¥ä½œä¸º failover target</li><li>ä¸€èˆ¬æ¥è¯´, Aurora æ¯” RDS å¿«</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img183915.png"></p><ul><li>High Availiability &amp; Read Scaling (Aurora Read Replica)<ul><li>One Master Write, Multiple Read Replicas (Up to 15 Replica), ä¸€å…± 16 ä¸ª</li><li>å¦‚æœé—®åˆ°å’Œ Aurora æœ‰å…³, ä¸”å…³äºå¤„ç†ç½‘ç»œè¯·æ±‚æ¿€å¢çš„é—®é¢˜, é€‰ Aurora Replica</li><li>Replica Tier è¶Šé«˜, failover æ—¶è¢« promote</li></ul></li><li>å¦‚æœé—®åˆ°å…³äº Aurora çš„ Auto-Scaling, é‚£å°±æ˜¯ Aurora Serverless</li><li>å¦‚æœé—®åˆ° Aurora è€Œä¸”æ˜¯ test database, é€‰æ‹© Aurora Database Cloning</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184105.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184221.png"></p><hr><h4 id="Aurora-Advanced"><a href="#Aurora-Advanced" class="headerlink" title="Aurora Advanced"></a>Aurora Advanced</h4><ul><li>Aurora Replicas Auto Scaling: å’Œ EC2 çš„ Auto Scaling ç±»ä¼¼</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184516.png"></p><ul><li>Aurora Custom Endpoints: å¯ä»¥åœ¨ä¸Šé¢è·‘æ•°æ®åˆ†æ</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184559.png"></p><ul><li>Aurora Serverless: Automated database instantiation and auto scaling (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184700.png"></p><ul><li>Aurora Global: Cross Region replication takes less than 1 second <ul><li>åŒæ—¶ä¿è¯è‡³å°‘æœ‰ä¸€ä¸ª Replica å¯ä»¥ç”¨ (é‡è¦)</li><li>Designed for globally distributed application, with fast local reads with low latency</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184847.png"></p><ul><li>Aurora Machine Learning: ML prediction</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184942.png"></p><ul><li>Aurora Database Cloning<ul><li>å¯ä»¥å¿«é€Ÿ access Aurora DB, æ¯” snapshot &amp; retore å¿«</li><li>å½“éœ€è¦åˆ¶ä½œ test database çš„æ—¶å€™é€‰ Aurora Database Cloning</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185556.png"></p><hr><h4 id="Backup-amp-Monitoring"><a href="#Backup-amp-Monitoring" class="headerlink" title="Backup &amp; Monitoring"></a>Backup &amp; Monitoring</h4><ul><li>RDS Backups (æœ‰ä¸¤ç§)<ul><li>Automated backups: æ¯å¤©è‡ªåŠ¨ backup</li><li>Manual DB Snapshots: æ‰‹åŠ¨ backup</li></ul></li><li>æ³¨æ„, å¦‚æœæ˜¯ä¸ºäº†çœé’±, å¯ä»¥åœ¨ç”¨å®Œæ•°æ®åº“ååˆ¶ä½œæ•°æ®åº“ snapshot, ç„¶å terminate æ•°æ®åº“, åœ¨éœ€è¦çš„æ—¶å€™å†æŠŠæ•°æ®åº“ snapshot restore å›å»</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185223.png"></p><ul><li>Aurora Backups (å’Œä¸Šé¢ä¸€æ ·)<ul><li>Automated backups: æ¯å¤©è‡ªåŠ¨ backup</li><li>Manual DB Snapshots: æ‰‹åŠ¨ backup</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185353.png"></p><ul><li>RDS &amp; Aurora Restore options<ul><li>æœ€åŸºæœ¬çš„å°±æ˜¯ç”¨ snapshot æ¥ restore</li><li>å¦‚æœæ˜¯ä» On-Premise, å¯ä»¥åšä¸€ä¸ª backup ç„¶åå­˜åˆ° S3, å†ä» S3 æ¥ restore</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185459.png"></p><hr><h4 id="RDS-Security"><a href="#RDS-Security" class="headerlink" title="RDS Security"></a>RDS Security</h4><ul><li>At-rest encryption: AWS KMS (Key Management Service)</li><li>In-flight encryption: AWS TLS Certificates</li><li>IAM Authentication: IAM roles to connect to database</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img133048.png"></p><hr><h4 id="RDS-Proxy"><a href="#RDS-Proxy" class="headerlink" title="RDS Proxy"></a>RDS Proxy</h4><ul><li>Have a proxy for access RDS or Aurora, ç¼“è§£æ•°æ®åº“å‹åŠ›, minimize open connections<ul><li>Allow apps to pool and share DB connections (æé«˜ DB efficiency)</li><li>Reduced RDS &amp; Aurora failover time by up 66%</li><li>No code change (é‡è¦)</li></ul></li><li>Serverless, auto scaling, Highly Avaliable (Multi-AZ)</li><li>Not publicly accessible (Need to use VPC)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184531.png"></p><hr><h4 id="AWS-ElastiCache"><a href="#AWS-ElastiCache" class="headerlink" title="AWS ElastiCache"></a>AWS ElastiCache</h4><ul><li>Manage Redis or Memcached (ElastiCache è§£å†³çš„æ˜¯æ•°æ®åº“é«˜é¢‘è¯»å–çš„é—®é¢˜, é‡è¦)<ul><li>ElastiCache ä¹Ÿæ˜¯ in-memory data store, è€Œä¸”æ”¯æŒ SQL query caching</li></ul></li><li>Cache are in-memory database with high performance and low latency (compute-intensive)</li><li>Cache helps reduce load off of database for read intensive workload (read heavy)</li><li>Help to make application stateless (AWS è´Ÿè´£å¤§éƒ¨åˆ†å·¥ä½œ)</li><li>å¤„ç† S3 çš„æ˜¯ CloudFront, è€Œä¸æ˜¯ ElastiCache (è®°ä½)</li><li>æ”¯æŒ multi-threading çš„æ˜¯ ElastiCache for Memcached</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184841.png"></p><ul><li>DB Cache: Get data from ElastiCache<ul><li>If not avaliable, get from RDS and store in ElastiCache</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185024.png"></p><ul><li>User Session: Write Session data into ElastiCache<ul><li>User in another instance could still be logged in</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185153.png"></p><ul><li>Redis vs Memcahed<ul><li>Redis: Read Replicas, High Availiablity, Backup and restore (éå¸¸é‡è¦)</li><li>Memcached: Not High Availiablity, No Backup, Have Risk to Lose Data, Multi-threaded</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185310.png"></p><hr><h4 id="ElastiCache-SAA"><a href="#ElastiCache-SAA" class="headerlink" title="ElastiCache SAA"></a>ElastiCache SAA</h4><ul><li>ElastiCache supports IAM Authentication for Redis</li><li>Memcached supports SASL-based authentication</li><li>IAM Database Authentication does not support Oracle</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200638.png"></p><ul><li>Patterns for ElastiCache<ul><li>Lazy Loading, Write Through, Session Store</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200822.png"></p><ul><li>ElastiCache Use Case<ul><li>Gaming Leaderboards (ç”¨ Redis çš„ Sorted Sets, é‡è¦)</li><li>Manage and store session data</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200907.png"></p><hr><h3 id="8-Route-53"><a href="#8-Route-53" class="headerlink" title="8. Route 53"></a>8. Route 53</h3><h4 id="Whatâ€™s-DNS"><a href="#Whatâ€™s-DNS" class="headerlink" title="Whatâ€™s DNS"></a>Whatâ€™s DNS</h4><ul><li>Translate hostname into IP address<ul><li><a href="http://www.google.com/">www.google.com</a> &#x3D; 172.217.18.36</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img213136.png"></p><hr><h4 id="AWS-Route-53"><a href="#AWS-Route-53" class="headerlink" title="AWS Route 53"></a>AWS Route 53</h4><ul><li>User can update the DNS records (High available, scalable)</li><li>Route 53 is a Domain Registrar</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img213527.png"></p><ul><li>Route 53 Records:<ul><li>Domain Name, Record Type, Value, Routing Policy, TTL</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img213613.png"></p><ul><li>Route 53 Record Types<ul><li>A: IPv4</li><li>AAAA: IPv6</li><li>CNAME: Map hostname to another hostname</li><li>NS: Name Servers for the Hosted Zone</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img213753.png"></p><ul><li>Route 53: Hosted Zones<ul><li>Public Hosted Zones: Public domain name</li><li>Private Hosted Zones: Private domain name (VPC)</li></ul></li></ul><blockquote><p>æ³¨æ„, DNS hostnames and DNS resolution are required settings for private hosted zones</p></blockquote><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234126.png"></p><ul><li>GoDaddy + Route 53 (As DNS Service Provider)<ul><li>Create a Public Hosted Zone and update the 3rd party Registrar NS records</li></ul></li><li>Route 53 Health Check<ul><li>å¦‚æœ ELB å‡ºé—®é¢˜, å°±å»æ‰¾ Route 53 Health Check</li></ul></li></ul><hr><h4 id="Route-53-TTL"><a href="#Route-53-TTL" class="headerlink" title="Route 53 TTL"></a>Route 53 TTL</h4><ul><li>TTL: Time To Live (ç”Ÿå­˜æ—¶é—´)<ul><li>How long the value should be cached (åç«¯æ›´æ–°ä¸ä»£è¡¨ cache æ›´æ–°äº†)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232659.png"></p><hr><h4 id="CNAME-vs-Alias"><a href="#CNAME-vs-Alias" class="headerlink" title="CNAME vs Alias"></a>CNAME vs Alias</h4><ul><li>CNAME: Point a hostname to another hostname<ul><li>ä» acme.example.com åˆ° zenith.example.org æˆ–è€… example.com åˆ° example.net</li></ul></li><li>Alias: Point a hostname to an AWS Resource (å¯¹è±¡æ˜¯ CloudFront, S3 è¿™äº›)<ul><li>ä» covid19survey.com åˆ° <a href="http://www.covid19survey.com/">www.covid19survey.com</a></li><li>ä» app.mydomain.com åˆ° app.amazonaws.com</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233313.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233425.png"></p><hr><h4 id="Health-Checks"><a href="#Health-Checks" class="headerlink" title="Health Checks"></a>Health Checks</h4><ul><li>Health Checks are only for public resources</li><li>Health Check æ£€æµ‹: Endpoints, å…¶ä»– Health Checks, CloudWatch Alarms</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img000106.png"></p><hr><h4 id="Routing-Policy-Simple"><a href="#Routing-Policy-Simple" class="headerlink" title="Routing Policy (Simple)"></a>Routing Policy (Simple)</h4><ul><li>Define how Route 53 responds to DNS queries</li><li>ä¸€å…± 7 ç§ Routing Policies</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234623.png"></p><ul><li>Simple: Route traffic to a single resource<ul><li>If multiple values returned, a random one is chosen by client</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234350.png"></p><hr><h4 id="Routing-Policy-Weighted"><a href="#Routing-Policy-Weighted" class="headerlink" title="Routing Policy (Weighted)"></a>Routing Policy (Weighted)</h4><ul><li>Weighted: Control the % of the request go to each resource</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234856.png"></p><hr><h4 id="Routing-Policy-Latency"><a href="#Routing-Policy-Latency" class="headerlink" title="Routing Policy (Latency)"></a>Routing Policy (Latency)</h4><ul><li>Latency: Redirect to the resource that has the least latency close to us</li><li>Latency is based on traffic between users and AWS Regions</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img235654.png"></p><hr><h4 id="Routing-Policy-Failover"><a href="#Routing-Policy-Failover" class="headerlink" title="Routing Policy (Failover)"></a>Routing Policy (Failover)</h4><ul><li>Failover: Have a Primary Instance and a Secondary Instance (é‡è¦)<ul><li>When failover, switch to Secondary Instance</li></ul></li><li>æ³¨æ„, å½“é—®åˆ° failover çš„æ—¶å€™, é€‰æ‹©çš„æ˜¯ active-passive failover routing policy<ul><li>æ²¡æœ‰ä»€ä¹ˆ active-active, åªæœ‰ active-passive</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150940.png"></p><hr><h4 id="Routing-Policy-Geolocation"><a href="#Routing-Policy-Geolocation" class="headerlink" title="Routing Policy (Geolocation)"></a>Routing Policy (Geolocation)</h4><ul><li>Geolocation: Routing based on user location<ul><li>Need to create a â€œDefaultâ€ record</li><li>Use cases: website localization, restrict content distribution ç­‰ç­‰</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151650.png"></p><hr><h4 id="Routing-Policy-Geoproximity"><a href="#Routing-Policy-Geoproximity" class="headerlink" title="Routing Policy (Geoproximity)"></a>Routing Policy (Geoproximity)</h4><ul><li>Geoproximity: Route traffic to resource based on geolocation<ul><li>But have the ability to shift more traffic to resource based on bias (é‡è¦)</li><li>å¯ä»¥åšåˆ° route more traffic or less</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img152310.png"></p><hr><h4 id="Routing-Policy-IP-Based"><a href="#Routing-Policy-IP-Based" class="headerlink" title="Routing Policy (IP-Based)"></a>Routing Policy (IP-Based)</h4><ul><li>IP-Based: Routing based on clientâ€™s IP address<ul><li>Provide a list of CIDRs for your client</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img153711.png"></p><hr><h4 id="Routing-Policy-Multi-Value"><a href="#Routing-Policy-Multi-Value" class="headerlink" title="Routing Policy (Multi-Value)"></a>Routing Policy (Multi-Value)</h4><ul><li>Multi-Value: Route traffic to multiple resources<ul><li>Not a subsitute for ELB</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img153842.png"></p><hr><h3 id="9-Beanstalk"><a href="#9-Beanstalk" class="headerlink" title="9. Beanstalk"></a>9. Beanstalk</h3><h4 id="Instantiate-App"><a href="#Instantiate-App" class="headerlink" title="Instantiate App"></a>Instantiate App</h4><ul><li>EC2 Instance<ul><li>Golden AMI: Install all applications beforehand and launch EC2 Instance</li><li>User Data: Dynamic configuration (è®°ä½æ˜¯ dynamic)</li></ul></li><li>RDS Database: Restore from a snapshot (Data &amp; Schema ready)</li><li>EBS Volume: Restore from a snapshot</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173401.png"></p><hr><h4 id="Elastic-Beanstalk"><a href="#Elastic-Beanstalk" class="headerlink" title="Elastic Beanstalk"></a>Elastic Beanstalk</h4><ul><li>åªéœ€è¦è´Ÿè´£ Code, å…¶ä»–éƒ½ç”± AWS è´Ÿè´£</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img210323.png"></p><ul><li>Web Server Tier vs. Worker Tier<ul><li>ä¸€ä¸ªç®¡ Web Server, å¦ä¸€ä¸ªå¤„ç† Process (SQS, SNS ç­‰ç­‰)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img210711.png"></p><hr><h3 id="10-AWS-S3"><a href="#10-AWS-S3" class="headerlink" title="10. AWS S3"></a>10. AWS S3</h3><h4 id="AWS-S3"><a href="#AWS-S3" class="headerlink" title="AWS S3"></a>AWS S3</h4><ul><li>S3 Buckets (S3 æ˜¯ Global çš„, ä½†æ˜¯ Bucket æ˜¯ Regional çš„)<ul><li>Store objects (files) in â€œbucketsâ€</li><li>Buckets must have globally unique name (åå­—å¿…é¡»ç‹¬ç‰¹)</li><li>Buckets are defined at region level</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img171839.png"></p><ul><li>Objects (files) have a key, max object size is 5TB</li><li>The key is the FULL path (prefix + object name)</li><li>å¦‚æœä¸Šä¼ è¶…è¿‡ 5 GB, å°±è¦ç”¨ Multi-Part Upload (è¿˜æœ‰ S3 Transfer Acceleration)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img172025.png"></p><ul><li>S3 sync command: Uses the CopyObject APIs to copy objects between S3 buckets</li><li>S3 always return the lastest version of the object (é‡è¦)</li><li>S3 æ²¡åŠæ³•åŠ å¯† metadata</li><li>S3 æ˜¯ serverless çš„</li><li>å¦‚æœé‡åˆ°éœ€è¦å¤„ç† static content çš„, å°±ä¸€å®šæ˜¯ S3 + CloudFront (é‡è¦)</li><li>å¦‚æœé—®åˆ° S3 è€Œä¸”æ˜¯å…³äºå›¾ç‰‡ä¸Šä¼ , é€‰æ‹© S3 Event Notification, ä¸æ˜¯ EventBridge (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/imglifecycle-transitions-v2.png"></p><ul><li>å¦‚æœå‘ç° S3 çš„ä¼ è¾“åŠŸèƒ½å‡ºé—®é¢˜, é‚£ä¹ˆå°±ç»™ S3 bucket åŠ ä¸Š prefix</li><li>æ³¨æ„, S3 å’Œ Database æ˜¯ä¸æ²¾è¾¹çš„, S3 ä¸æ˜¯æ•°æ®åº“</li></ul><blockquote><p>By default, an Amazon S3 object is owned by the AWS account that uploaded it. This is true even when the bucket is owned by another account (é‡è¦)</p></blockquote><ul><li>Host åœ¨ S3 ä¸Šé¢çš„ç½‘ç«™ä¸€èˆ¬æ˜¯ä»¥ä¸‹ä¸¤ç§åç¼€ (dash Region æˆ–è€… dot Region)<ul><li>s3-website dash (-) Region â€ <a href="http://bucket-name.s3-website.region.amazonaws.com/">http://bucket-name.s3-website.Region.amazonaws.com</a></li><li>s3-website dot (.) Region â€ <a href="http://bucket-name.s3-website-region.amazonaws.com/">http://bucket-name.s3-website-Region.amazonaws.com</a></li></ul></li></ul><hr><h4 id="S3-Bucket-Policy"><a href="#S3-Bucket-Policy" class="headerlink" title="S3 Bucket Policy"></a>S3 Bucket Policy</h4><ul><li>User-Based Security<ul><li>IAM Policies: Which API calls should be allowed for a user from IAM (é‡è¦)</li></ul></li><li>Resource-Based Security<ul><li>Bucket Policies: Bucket rules (æ¯”å¦‚è®© Object public, é‡è¦)</li><li>Object Access Control List (ACL)</li><li>Bucket Access Control List (ACL)</li></ul></li><li>Encryption: Encrypt objects in S3 with encryption keys</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173050.png"></p><ul><li>S3 Bucket Policies (JSON based policies)<ul><li>Resoruces: buckets and objects</li><li>Effect: Allow &#x2F; Deny</li><li>Actions: API to Allow or Deny</li><li>Principal: The account or user to apply the policy to</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173325.png"></p><hr><h4 id="S3-Versioning"><a href="#S3-Versioning" class="headerlink" title="S3 Versioning"></a>S3 Versioning</h4><ul><li>Enabled at the bucket level (Default is null)</li><li>Best pratice to version the buckets (å¯ä»¥ roll back, å¯ä»¥é˜²æ­¢è¯¯åˆ , é‡è¦)<ul><li>å¯ä»¥é˜²æ­¢ accidental deletion of objects</li></ul></li><li>Once version-enable a bucket, it can never return to an unversioned state (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174246.png"></p><hr><h4 id="S3-Replication-CRR-amp-SRR"><a href="#S3-Replication-CRR-amp-SRR" class="headerlink" title="S3 Replication (CRR &amp; SRR)"></a>S3 Replication (CRR &amp; SRR)</h4><ul><li>CRR: Cross Region Replication (compliance, lower latency access)</li><li>SRR: Same Region Replication (create test environment)<ul><li>Must enable Versioning</li><li>The Copying is asynchronous</li><li>Must give IAM permissions to S3</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174840.png"></p><ul><li>Only new objects are replicated, existing objects need S3 Batch Replication<ul><li>ä¹Ÿå°±æ˜¯è¯´åªæœ‰æ–°çš„ object ä¼šè¢« Replicate, è€çš„ object è¦ S3 Batch Replication</li></ul></li><li>No â€œchainingâ€ in replication<ul><li>æ¯”å¦‚æŠŠ A å¤åˆ¶åˆ° B å’Œ C, éœ€è¦ A å¤åˆ¶åˆ° B å’Œ A å¤åˆ¶åˆ° C</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175004.png"></p><hr><h4 id="S3-Storage-Classes"><a href="#S3-Storage-Classes" class="headerlink" title="S3 Storage Classes"></a>S3 Storage Classes</h4><ul><li>ä¸€å…± 7 ç§ Storage Class: General + 2 IA + 3 Glacier + Intelligent</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175742.png"></p><ul><li>S3 Standard - General Purpose<ul><li>Used for frequently accessed data (æœ€å¸¸è§)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175932.png"></p><ul><li>S3 Infrequent Access (Standard IA &amp; One Zone IA)<ul><li>For data is less frequent access but require rapid access when needed (é‡è¦)</li><li>Lower cost than Standard </li><li>ä» Standard è½¬åˆ° One Zone IA æœ€å°‘è¦ 30 å¤©</li><li>One Zone IA ä¸æ˜¯ High Availability çš„é€‰æ‹© (æ³¨æ„, å› ä¸º AZ ä¼š down)</li><li>å¦‚æœé‡åˆ° access is always required å°±ä¸èƒ½é€‰ One Zone IA, å› ä¸º AZ å¯èƒ½ä¼š down</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img180147.png"></p><ul><li>S3 Glacier Storage Classes (Archive ä¸“ç”¨)<ul><li>Low-cost object storage for archiving &#x2F; backup</li><li>Price: storage + retrieval</li><li>S3 Glacier Instant Retrieval: Glacier é‡Œæœ€å¿«ä½†ä¹Ÿæœ€è´µ</li><li>S3 Glacier Flexible Retrieval: ä¸‰ç§æ¨¡å¼ (Expedited åŠ æ€¥, Standard, Bulk æ‰¹é‡)</li><li>S3 Glacier Deep Archive: å­˜çš„æ—¶é—´æœ€ä¹…, ä¸¤ç§æ¨¡å¼ (Standard, Bulk), 48 å°æ—¶ retrieval</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img180642.png"></p><ul><li>S3 Intelligent Tiering<ul><li>Move objects automatically between Access Tiers based on usage</li><li>å°±æ˜¯è‡ªåŠ¨å¸®ä½ æŠŠ Object ç§»åˆ°ä¸åŒçš„ Storage Class é‡Œ</li><li>Intelligent Tier æ˜¯åœ¨ Standard å’Œ Standard IA ä¸‹é¢çš„, ä¸èƒ½ä»ä¸‹å¾€ä¸Šè½¬ç§»</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img180806.png"></p><hr><h3 id="11-AWS-S3-Advance"><a href="#11-AWS-S3-Advance" class="headerlink" title="11. AWS S3 Advance"></a>11. AWS S3 Advance</h3><h4 id="S3-Lifecycle-Rules"><a href="#S3-Lifecycle-Rules" class="headerlink" title="S3 Lifecycle Rules"></a>S3 Lifecycle Rules</h4><ul><li>Transition objects between storage classes (æ¯”å¦‚ä» IA åˆ° Glacier)<ul><li>Transition éœ€è¦ Lifecycle Rules (é‡è¦)</li></ul></li><li>æ¯”å¦‚ä» Snowball åˆ° Glacier å°±éœ€è¦ Lifecycle Rule</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img235516.png"></p><ul><li>Transition Actions: Configure objects to transition to another storage class (è½¬ç§»)</li><li>Expiration Actions: Configure objects to expire after some time (åˆ é™¤)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img235639.png"></p><ul><li>S3 Analytics: Help decide when to transition objects to the right storage class</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img000151.png"></p><hr><h4 id="S3-Requester-Pays"><a href="#S3-Requester-Pays" class="headerlink" title="S3 Requester Pays"></a>S3 Requester Pays</h4><ul><li>The requester pays the cost of the request intead of the bucket owner<ul><li>åè€Œæ˜¯ç”¨æˆ·ä»˜é’±, ä½†æ˜¯ç”¨æˆ·å¾—æ˜¯ AWS ç”¨æˆ·</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img000532.png"></p><hr><h4 id="S3-Event-Notifications"><a href="#S3-Event-Notifications" class="headerlink" title="S3 Event Notifications"></a>S3 Event Notifications</h4><ul><li>Automatically react to certain event happened in S3 (æ¯”å¦‚å›¾ç‰‡ä¸Šä¼ )<ul><li>Need to have IAM Permissions</li><li>S3 Event Notification çš„ destination æ˜¯ SQS, SNS, Lambda (è®°ä½)</li></ul></li><li>å¤§éƒ¨åˆ†å’Œ S3 äº‹ä»¶ç›¸å…³çš„éƒ½æ˜¯ S3 Event Notification, è€Œä¸æ˜¯ EventBridge (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img000725.png"></p><hr><h4 id="S3-Performance"><a href="#S3-Performance" class="headerlink" title="S3 Performance"></a>S3 Performance</h4><ul><li>For Upload ä¸Šä¼  (é‡è¦)<ul><li>Multi-Part Upload: å½“ä¸Šä¼ æ–‡ä»¶å¤§äº 5 GB, å¯ä»¥ parallelize uploads</li><li>S3 Transfer Acceleration: å°†æ–‡ä»¶ä¼ åˆ° AWS edge location, å¯ä»¥å’Œ Multi-Part ä¸€èµ·ç”¨</li><li>S3 Transfer Acceleration (S3TA) can speed up content transfers to and from S3 (é’ˆå¯¹å…³äº S3 çš„ä¸Šä¼ å’Œä¸‹è½½)</li><li>æ³¨æ„, S3 Transfer Acceleration æ²¡åŠæ³• copy object between buckets</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img001645.png"></p><ul><li>For Download ä¸‹è½½<ul><li>S3 Byte-Range Fetches: Parallelize GETs, retrieve partial data (æ‹¿éƒ¨åˆ†æ•°æ®, é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img001828.png"></p><hr><h4 id="S3-Select-amp-Glacier-Select"><a href="#S3-Select-amp-Glacier-Select" class="headerlink" title="S3 Select &amp; Glacier Select"></a>S3 Select &amp; Glacier Select</h4><ul><li>S3 Select ä½¿ç”¨ SQL æ¥åš server-side filtering, è¿‡æ»¤ä»è€Œå‡å°‘æ•°æ®é‡</li><li>400% Faster, 80% Cheaper (æ€§èƒ½ä¼˜åŒ–)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img002050.png"></p><hr><h4 id="S3-Batch-Operations"><a href="#S3-Batch-Operations" class="headerlink" title="S3 Batch Operations"></a>S3 Batch Operations</h4><ul><li>Perform bulk operations (æ‰¹é‡æ“ä½œ) on existing S3 objects<ul><li>ä¾‹å¦‚ encrypt all un-encrypted objects (åŠ å¯†æ‰€æœ‰æ²¡æœ‰åŠ å¯†çš„æ–‡ä»¶)</li></ul></li><li>åœ¨å¤„ç† Batch ä¹‹å‰, ç”¨ S3 Inventory to get object list and use S3 Select to filter objects</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img022334.png"></p><hr><h3 id="12-AWS-S3-Security"><a href="#12-AWS-S3-Security" class="headerlink" title="12. AWS S3 Security"></a>12. AWS S3 Security</h3><h4 id="S3-Encryption"><a href="#S3-Encryption" class="headerlink" title="S3 Encryption"></a>S3 Encryption</h4><ul><li>ä¸€å…±æœ‰ 4 ç§æ–¹æ³• (SSE-S3 å…è´¹, SSE-KMS è¦é’±)<ul><li>Server-Side Encryption (SSE-S3, SSE-KMS, SSE-C)</li><li>Client-Side Encryption (å¦‚æœç”¨æˆ·å·²ç»æœ‰ encryption method)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223133.png"></p><ul><li>Server-Side Encryption with Amazon S3-Managed Keys (SSE-S3)<ul><li>Enabled by default for new buckets &amp; objects</li><li>SSE-S3 çš„ header æ˜¯ x-amz-server-side-encryption</li><li>ä½¿ç”¨ SSE-S3, æ¯ä¸€ä¸ª Object éƒ½æ˜¯ç”± unique key æ¥ encrypt çš„</li><li>SSE-S3 ä½¿ç”¨ 256-bit Advanced Encryption Standard (AES-256)</li><li>SSE-S3 æ˜¯æ²¡æœ‰ automatic key rotation çš„, è¦ç”¨ SSE-KMS (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223242.png"></p><ul><li>Server-Side Encryption with KMS Keys stored in AWS KMS (SSE-KMS)<ul><li>User control + audit key usage in CloudTrail (å¯ä»¥ç®¡ç† key rotation)</li><li>SSE-KMS çš„ header æ˜¯ x-amz-server-side-encryption + aws:kms</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223417.png"></p><ul><li>Server-Side Encryption with Customer-Provided Keys (SSE-C)<ul><li>ç”¨æˆ·è‡ªå·±æœ‰ keys, AWS will not store the key, HTTPS must be used</li><li>å½“é—®é¢˜ä¸­æåˆ°ç”¨æˆ·éœ€è¦ä½¿ç”¨è‡ªå·±çš„ key, ä½†æ˜¯æ‰“ç®—åœ¨ AWS ç«¯åš encryption</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223602.png"></p><ul><li>Client-Side Encryption<ul><li>User fully manages the keys and encryption cycle</li><li>æ•°æ®åœ¨é€åˆ° AWS ä¹‹å‰å°±æ˜¯åŠ å¯†å¥½çš„</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223715.png"></p><ul><li>Encryption in Transit (SSL&#x2F;TLS)<ul><li>å¯ä»¥ç”¨ aws:SecureTransport æ¥ enforce (ä¸è¿‡æœ‰ SSL åŸºæœ¬ä¸Šå°±æ˜¯ HTTPS)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223811.png"></p><hr><h4 id="S3-CORS"><a href="#S3-CORS" class="headerlink" title="S3 CORS"></a>S3 CORS</h4><ul><li>CORS: Cross-Origin Resource Sharing (è·¨åŸŸé—®é¢˜)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img224630.png"></p><ul><li>S3 CORS (é‡è¦)<ul><li>A client makes a cross-origin request on S3 bucket, need the correct CORS headers</li><li>Can allow specific origin or *</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img224951.png"></p><hr><h4 id="S3-MFA-Delete"><a href="#S3-MFA-Delete" class="headerlink" title="S3 MFA Delete"></a>S3 MFA Delete</h4><ul><li>MFA Delete: é˜²æ­¢ä¸å°å¿ƒåˆ é™¤æ–‡ä»¶, ç”¨æˆ·éœ€è¦å…ˆéªŒè¯èº«ä»½ (é‡è¦)<ul><li>To use MFA Delete: Versioning must be enabled</li></ul></li><li>Only the bucket owner (root user) can enable&#x2F;disable MFA Delete (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img225415.png"></p><hr><h4 id="S3-Access-Logs"><a href="#S3-Access-Logs" class="headerlink" title="S3 Access Logs"></a>S3 Access Logs</h4><ul><li>Any request made to S3 will be logged to another S3 bucket (æ•°æ®åˆ†æ)<ul><li>å¯ä»¥ä½œä¸º Data Analysis çš„å·¥å…·</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230251.png"></p><hr><h4 id="S3-Pre-signed-URLs"><a href="#S3-Pre-signed-URLs" class="headerlink" title="S3 Pre-signed URLs"></a>S3 Pre-signed URLs</h4><ul><li>Have URL expiration (è¿‡æœŸ)<ul><li>ç”¨åœ¨ Private Bucket ä¸Š, ä¸€æ®µæ—¶é—´å URL è¿‡æœŸ</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230702.png"></p><hr><h4 id="Glacier-Vault-Lock-amp-S3-Object-Lock"><a href="#Glacier-Vault-Lock-amp-S3-Object-Lock" class="headerlink" title="Glacier Vault Lock &amp; S3 Object Lock"></a>Glacier Vault Lock &amp; S3 Object Lock</h4><ul><li>S3 Glacier Vault Lock<ul><li>Adopt a WORM (Write Once Read Many), ä¿¡æ¯ä¸€æ—¦å†™å…¥å°±æ— æ³•ä¿®æ”¹</li><li>The object canâ€™t be deleted (æ— æ³•ä¿®æ”¹)</li></ul></li><li>å¯ä»¥ç”¨ Glacier Vault Lock å‚¨å­˜ sensitive æ•°æ®, ç„¶åç”¨ Vault Lock Policy å»ç®¡ç†</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230941.png"></p><ul><li>S3 Object Lock (Must have Versioning, é‡è¦)<ul><li>Block an object version deletion for an amount of time (æœ‰æ—¶é™)</li><li>ä¸¤ä¸ª Retention mode (é‡è¦)<ul><li>Compliance: æ‰€æœ‰äººéƒ½æ²¡æ³•åˆ , Root user ä¹Ÿä¸è¡Œ</li><li>Governance: æœ‰äº›äººå¯ä»¥åˆ , æœ‰æƒé™çš„äººå¯ä»¥</li></ul></li><li>Legal Hold: é˜²æ­¢ Object Version è¢«æ”¹, é™¤éä½ è‡ªå·±æŠŠ Legal Hold ç§»é™¤ (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img231203.png"></p><hr><h4 id="S3-Access-Points"><a href="#S3-Access-Points" class="headerlink" title="S3 Access Points"></a>S3 Access Points</h4><ul><li>Access Points simplify security management for S3 Buckets (æ ¹æ®ç”¨æˆ·å±æ€§)</li><li>Each Access Point: DNS name + Access Point Policy</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img231500.png"></p><hr><h4 id="S3-Object-Lambda"><a href="#S3-Object-Lambda" class="headerlink" title="S3 Object Lambda"></a>S3 Object Lambda</h4><ul><li>Use AWS Lambda to change object before retrieve by caller (åœ¨åˆ°è¾¾ caller ä¹‹å‰)<ul><li>ç”¨é€”: å¯ä»¥ç»™å›¾ç‰‡æ‰“æ°´å°</li></ul></li><li>éœ€è¦ S3 Access Point å’Œ S3 Object Lambda Access Points</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img231810.png"></p><hr><h3 id="13-CloudFront-amp-AWS-Global-Accelerator"><a href="#13-CloudFront-amp-AWS-Global-Accelerator" class="headerlink" title="13. CloudFront &amp; AWS Global Accelerator"></a>13. CloudFront &amp; AWS Global Accelerator</h3><h4 id="AWS-CloudFront"><a href="#AWS-CloudFront" class="headerlink" title="AWS CloudFront"></a>AWS CloudFront</h4><ul><li>Content Delivery Network (CDN), å¯ä»¥ serve static &amp; dynamic content<ul><li>Improve read performance, content is cached at the edge</li></ul></li><li>å¯ä»¥é˜²æ­¢ DDoS protection (æ­é… AWS Shield), å¯ä»¥æ ¹æ® content type æ¥ route, å¯ä»¥æŒ‡å®š primary &amp; secondary origins æ¥åš High Availiability &amp; Failover</li><li>CloudFront Origins: S3 Bucket (OAC) æˆ–è€… Custom Origin (HTTP)<ul><li>OAC: Origin Access Control (é‡è¦, å¦‚æœæ¶‰åŠåˆ° S3 çš„é—®é¢˜)</li></ul></li><li>å¦‚æœé—®åˆ° CloudFront è€Œä¸”éœ€è¦ encryption, é€‰æ‹© field level encryption (ä¸æ˜¯ KMS)<ul><li>Field-level encryption allows you to enable your users to securely upload sensitive information to your web servers.</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232701.png"></p><ul><li>CloudFront vs S3 Cross Region Replication<ul><li>CloudFront: ä½¿ç”¨ global edge network, æœ‰ TTL, ç”¨äº static content</li><li>S3 Cross Region Replication (CRR): æ¯ä¸ª Region éƒ½è¦è®¾ç½®, ä½†æ˜¯æ²¡æœ‰ TTL, ç”¨äº dynamic content (updated in near real-time, åªè¯»)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233016.png"></p><ul><li>Price Classes: ä¸åŒåœ°åŒºçš„ä»·æ ¼ä¸ä¸€æ ·<ul><li>å¯ä»¥ç”¨æ¥ cost reduction (é™ä½ä»·æ ¼)</li></ul></li><li>CloudFront å…è®¸ Proxy methods å’Œ Dynamic content è·³è¿‡ regional edge cache</li><li>é™¤äº† WAF å¯ä»¥å» block IP, è¿˜å¯ä»¥ä½¿ç”¨ OAI (origin access identity, é‡è¦)<ul><li>OAI ä¹Ÿå¯ä»¥ç”¨æ¥ secure communication between CloudFront &amp; S3</li></ul></li><li>å¯ä»¥ç”¨ CloudFront signed URLs å’Œ CloudFront signed cookies æ¥ restrict access to documents (æ¯”å¦‚ subscription)</li><li>Can configure CloudFront to require HTTPS from clients (å¯ä»¥ç”¨ CloudFront è¦æ±‚ client å¿…é¡»ä½¿ç”¨ HTTPS)</li></ul><hr><h4 id="CloudFront-Geo-Restriction"><a href="#CloudFront-Geo-Restriction" class="headerlink" title="CloudFront Geo Restriction"></a>CloudFront Geo Restriction</h4><ul><li>Allowlist &amp; Blocklist (é’ˆå¯¹ IP, å›½å®¶è¿›è¡Œè®¿é—®é™åˆ¶)<ul><li>CloudFront Geo Restriction æ²¡åŠæ³•å’Œ VPC ä¸€èµ·ä½¿ç”¨</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233638.png"></p><hr><h4 id="CloudFront-Cache-Invalidation"><a href="#CloudFront-Cache-Invalidation" class="headerlink" title="CloudFront Cache Invalidation"></a>CloudFront Cache Invalidation</h4><ul><li>è®© CloudFront è·³è¿‡ TTL ç«‹å³æ›´æ–°<ul><li>æ¯”å¦‚ä½ æ›´æ–°äº†åç«¯, ä½†æ˜¯ CloudFront ä¸ä¼šç«‹å³æ›´æ–°, éœ€è¦ CloudFront Invalidation æ¥è·³è¿‡ TTL æ¥ç«‹å³æ›´æ–°</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234007.png"></p><hr><h4 id="AWS-Global-Accelerator"><a href="#AWS-Global-Accelerator" class="headerlink" title="AWS Global Accelerator"></a>AWS Global Accelerator</h4><ul><li>åˆ©ç”¨ AWS internal network to route application<ul><li>Provide 2 global static anycast IPs (é‡è¦)</li><li>Improve availability and performance of the applications (globally)</li></ul></li><li>Global Accelerator improves performance for applications over TCP or UDP</li><li>Global Accelerator has automatic failover </li><li>Global Accelerator is more expensive as it adds an extra layer of infrastructure (å¯¹æ¯” CloudFront ä¸æ˜¯ä¸€ä¸ª cost-effective çš„é€‰æ‹©)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234527.png"></p><ul><li>AWS Global Accelerator vs CloudFront<ul><li>CloudFront: Content is served at edge, æ¯”å¦‚å›¾ç‰‡å’Œè§†é¢‘ (cacheable), Dynamic content such as API acceleration &amp; dynamic site delivery</li><li>Global Accelerator: é€‚åˆ TCP æˆ–è€… UDP, æ¯”å¦‚æ¸¸æˆå’Œ IoT (static IP)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img000939.png"></p><blockquote><p>AWS Global Accelerator is a network service that can provide a global traffic management solution. By creating a standard accelerator in AWS Global Accelerator, you can guide user traffic to the endpoint closest to them, thereby improving the performance and availability of the application. </p></blockquote><hr><h3 id="14-AWS-Storage-Extra"><a href="#14-AWS-Storage-Extra" class="headerlink" title="14. AWS Storage Extra"></a>14. AWS Storage Extra</h3><h4 id="AWS-Snow-Family"><a href="#AWS-Snow-Family" class="headerlink" title="AWS Snow Family"></a>AWS Snow Family</h4><ul><li>æ•´ä¸ª Snow Family éƒ½æ˜¯ç¡¬ä»¶å½¢å¼</li><li>Data migration (in &amp; out AWS) &amp; Edge Computing (process data at edge)<ul><li>Snowcone (ä½“ç§¯å°, é€‚åˆå¸¦åˆ°ç‰¹æ®Šç¯å¢ƒ, æ²¡æœ‰ Snowball å†…å­˜å¤§)</li><li>Snowball Edge (Storage Optimized å’Œ Compute Optimized, æ¨èå¤„ç† 10 - 100 TB)<ul><li>Compute Optimized æ˜¯æ”¯æŒ storage clustering çš„</li><li>Terabytes, low costs, limited time &#x3D; AWS Snowball devices</li></ul></li><li>Snowmobile (ä¸ç®—åœ¨ Edge Computing é‡Œ, æ•°æ®ä¼ è¾“æœ€å¤§, æ¨èå¤„ç† 10 PB ä»¥ä¸Š)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200544.png"></p><ul><li>Edge Location: æ¯”å¦‚æµ·ä¸Šæˆ–è€…çŸ¿æ´é‡Œ, æ²¡æœ‰ç½‘ç»œçš„æƒ…å†µä¸‹<ul><li>æ‰€ä»¥éœ€è¦ Edge Computing å’Œ Snow Family</li></ul></li><li>AWS OpsHub: ç”¨æ¥ç®¡ç† AWS Snow Family</li><li>Snowball to Glacier: Use S3 lifecycle policy (Snowball å…¼å®¹ S3 ä½†æ˜¯ Glacier ä¸è¡Œ, é‡è¦)<ul><li>æ³¨æ„, è¿™é‡Œçš„ Glacier æŒ‡çš„æ˜¯æ•´ä¸ª Glacier Family (eg. Glacier Deep Archive)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201918.png"></p><hr><h4 id="AWS-FSx"><a href="#AWS-FSx" class="headerlink" title="AWS FSx"></a>AWS FSx</h4><ul><li>Third party high-performance file systems on AWS (ç¬¬ä¸‰æ–¹æ–‡ä»¶ç³»ç»Ÿ)<ul><li>FSx for Windows: Window file system, support SMB &amp; Windows NTFS</li><li>FSx for Lustre (Linux): å¯ä»¥ maximize IOPS, é€‚åˆ HPC, å¯ä»¥å’Œ S3 Integrate</li><li>FSx for NetApp ONTAP: File system for NFS, SMB, iSCSI</li><li>FSx for OpenZFS: OpenZFS file system (å’Œå®ƒåå­—ä¸€æ ·)</li></ul></li></ul><blockquote><p>FSx for Lustre provides the ability to both process the â€˜hot dataâ€™ in a parallel and distributed fashion as well as easily store the â€˜cold dataâ€™ on Amazon S3.</p></blockquote><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img202205.png"></p><ul><li>ä¸¤ç§ Deployment Options<ul><li>Scratch File System: Temporary storage, data not replicated</li><li>Persistent File System: Long term storage, data replicated (Same AZ, é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img202555.png"></p><hr><h4 id="AWS-Storage-Gateway"><a href="#AWS-Storage-Gateway" class="headerlink" title="AWS Storage Gateway"></a>AWS Storage Gateway</h4><ul><li>Bridge between On-Premise data and cloud data (Hybrid cloud, é‡è¦)<ul><li>On-Premise å’Œ AWS Cloud ä¹‹é—´çš„æ¡¥æ¢ (ä¿ç•™ä» On-Premise å»è®¿é—® AWS æ•°æ®çš„èƒ½åŠ›)</li><li>é‡ç‚¹, Hybrid Cloud, give On-Premise ability to access cloud storage</li></ul></li><li>æåˆ° NFS çš„å°±æ˜¯ File Gateway, é—® S3 å¤§éƒ¨åˆ†éƒ½æ˜¯ File Gateway</li><li>DataSync æ˜¯ç”¨æ¥ç§»æ•°æ®çš„, File Gateway æ˜¯ç”¨æ¥ç»´æŒ access çš„ (é‡è¦)</li><li>File Gateway æ˜¯ file storage, Volume Gateway æ˜¯ block storage (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203211.png"></p><ul><li>ä¸€å…±æœ‰ 4 ç§ Gateway (æ³¨æ„, Storage Gateway æ³›æŒ‡ä¸‹é¢è¿™ 4 ä¸ª Gateway)<ul><li>S3 File Gateway: ä» On-Premise è®¿é—® S3 Buckets (NFS, SMB), file storage</li><li>FSx File Gateway: ä» On-Premise è®¿é—® FSx (SMB, NTFS)</li><li>Volume Gateway: ä» On-Premise è®¿é—® S3 å’Œ EBS (iSCSI), block storage<ul><li>Cached volumes: Access most recent data (eg. logs) å¦‚æœé—®åˆ° S3 çš„è¯</li><li>Stored volumes: Entire dataset is On-Premise, backup at S3</li></ul></li><li>Tap Gateway: ä» On-Premise è®¿é—® Archieved Taps stored in AWS Glacier<ul><li>å¦‚æœé—®é¢˜é‡Œé¢æœ‰ Tap å°±æ˜¯ Tap Gateway</li></ul></li></ul></li></ul><hr><h4 id="AWS-Transfer-Family"><a href="#AWS-Transfer-Family" class="headerlink" title="AWS Transfer Family"></a>AWS Transfer Family</h4><ul><li>Use FTP protocol to transfer files into or out S3 æˆ– EFS <ul><li>æœ‰ä¸‰ç§ Protocols: FTP, FTPS, SFTP (é‡è¦, å¦‚æœé—®åˆ°å…³äº FTP æˆ–è€… SFTP çš„é—®é¢˜)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203933.png"></p><hr><h4 id="AWS-DataSync"><a href="#AWS-DataSync" class="headerlink" title="AWS DataSync"></a>AWS DataSync</h4><ul><li>å¯ä»¥ä» On-Premise æˆ–è€… AWS è½¬ç§»å¤§é‡æ•°æ® (to &amp; from)<ul><li>On-Premise åˆ° AWS S3, EFS, FSx ç­‰ç­‰ (need agent)</li><li>AWS åˆ° AWS (no agent)</li></ul></li><li>Scheduled replication tasks (æ¯”å¦‚æ¯å‘¨äº”éƒ½ä¼š replicate ä¸€æ¬¡)</li><li>File permissions and metadata are perserved (é‡è¦)</li><li>DataSync æ˜¯ç”¨æ¥ç§»æ•°æ®çš„, File Gateway æ˜¯ç”¨æ¥ç»´æŒ access çš„</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img204155.png"></p><blockquote><p>AWS DataSync is an online data transfer service that simplifies, automates, and accelerates copying large amounts of data between on-premises storage systems and AWS Storage services, as well as between AWS Storage services.</p></blockquote><hr><h3 id="15-SQS-SNS-Kinesis-Active-MQ"><a href="#15-SQS-SNS-Kinesis-Active-MQ" class="headerlink" title="15. SQS, SNS, Kinesis, Active MQ"></a>15. SQS, SNS, Kinesis, Active MQ</h3><h4 id="AWS-SQS"><a href="#AWS-SQS" class="headerlink" title="AWS SQS"></a>AWS SQS</h4><ul><li>ç”¨æ¥ decouple applications (æ¯”å¦‚å¤„ç†è§†é¢‘, å±äºå¤šå¯¹å¤šæ¨¡å‹)</li><li>SQS scale automatically (Unlimited throughput, unlimited message, can retry)<ul><li>é‡åˆ°è¯´ decouple microservice (ä½†æ˜¯æ²¡æœ‰ 3rd party çš„) å°±æ˜¯ SQS</li></ul></li><li>Standard SQS å…è®¸å°† S3 ä½œä¸º event notification destination, SQS FIFO åˆ™ä¸è¡Œ</li><li>å¦‚æœé‡åˆ° SQS message process failure, é€‰æ‹© DLQ æ¥è§£å†³ (é‡è¦)</li><li>å¦‚æœé‡åˆ°éœ€è¦å¤„ç† high-throughput request-reponse message pattern çš„, é€‰æ‹© temporary queue (é‡è¦)</li><li>å¦‚æœé‡åˆ°éœ€è¦ SQS å» postpone the delivery of new messages, é‚£ä¹ˆå°±æ˜¯ delay queue</li><li>é‡åˆ° parallel é€‰ SQS è€Œä¸æ˜¯ SNS</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img235912.png"></p><ul><li>å¯ä»¥æœ‰å¾ˆå¤š consumer æ¥åŒæ—¶ parallel å¤„ç† messages<ul><li>Consumer delete messages after processing them (å¤„ç†å®Œå°±åˆ æ‰)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img000504.png"></p><ul><li>SQS Message Visibility Timeout (é‡è¦)<ul><li>Visibility Timeout is high: Consumer crash, re-process take time</li><li>Visibility Timeout is low: Get duplicate (é˜²æ­¢ read duplicate, å¢åŠ  Timeout, é‡è¦)</li><li>Use the ChangeMessageVisibility API call to increase the visibility timeout</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img020440.png"></p><ul><li>å½“é‡åˆ° SQS è€Œä¸”éœ€è¦ priority çš„æ—¶å€™, Create two Amazon SQS standard queues, Set up Amazon EC2 instances to prioritize polling</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/imgpt6-q32-i1.jpg"></p><ul><li>æŠŠ SQS è½¬æˆ FIFO queue<ul><li>Delete the existing SQS and recreate it as FIFO queue</li><li>Make sure the name of the FIFO queue ends with .fifo suffix</li><li>Make sure the throughput for the FIFO queue not exceed 3000 meesage &#x2F; second</li></ul></li></ul><hr><h4 id="SQS-Long-Polling"><a href="#SQS-Long-Polling" class="headerlink" title="SQS Long Polling"></a>SQS Long Polling</h4><ul><li>Decrease latency &amp; decrease API call (å‡å°‘ API è¯·æ±‚, æ›´å¥½çš„ performance)<ul><li>Minimize the cost of using SQS (çœé’±)</li><li>Long Polling ä¸èƒ½å¤„ç† SQS duplicate, è¿˜æ˜¯è¦ç”¨ Visibility Timeout</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img003255.png"></p><hr><h4 id="SQS-FIFO-Queue"><a href="#SQS-FIFO-Queue" class="headerlink" title="SQS FIFO Queue"></a>SQS FIFO Queue</h4><ul><li>æŒ‰é¡ºåºä¼ é€’ message (SNS ä¹Ÿå¯ä»¥åšåˆ°)<ul><li>By default, FIFO queues support up to 300 messages per second</li></ul></li><li>å¦‚æœæ²¡æœ‰ GroupID, é‚£åªèƒ½æœ‰ 1 ä¸ª consumer, å¦‚æœæœ‰ GroupID, å¯ä»¥æœ‰å¤šä¸ª consumer</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img003507.png"></p><hr><h4 id="AWS-SNS"><a href="#AWS-SNS" class="headerlink" title="AWS SNS"></a>AWS SNS</h4><ul><li>Send one message to many receivers (å¯ä»¥ç»™ç”¨æˆ·å‘ email)<ul><li>Publisher &amp; Subscriber æ¨¡å‹ (å±äºä¸€å¯¹å¤šæ¨¡å‹)</li><li>Subscriber: SQS, Lambda, Kinesis Data Firehose, HTTPS endpoints, Email</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img010634.png"></p><hr><h4 id="Fan-Out-Pattern"><a href="#Fan-Out-Pattern" class="headerlink" title="Fan Out Pattern"></a>Fan Out Pattern</h4><ul><li>Push once in SNS, receive in all SQS (ç”± SNS ä¼ é€’ message ç»™ SQS æ¥æ¥æ”¶)<ul><li>Fully decoupled, no data loss</li><li>å¯ä»¥ç”¨äº message filtering (ä¿¡æ¯è¿‡æ»¤, æ ¹æ®ä¸åŒçš„ filter policy)</li></ul></li><li>Kinesis ä¹Ÿå¯ä»¥ä½¿ç”¨ Fan Out Pattern (ä½¿ç”¨ Shard)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img011026.png"></p><hr><h4 id="AWS-Kinesis"><a href="#AWS-Kinesis" class="headerlink" title="AWS Kinesis"></a>AWS Kinesis</h4><ul><li>Process, ingest, buffer streaming data in real-time (å¤„ç†å®æ—¶æ•°æ®)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150053.png"></p><ul><li>Kinesis Data Streams: Capture, process, store data streams</li><li>Kinesis Data Firehose: Load data streams into AWS data stores (S3, Redshift)</li><li>å½“ Kinesis Data Streams ä½œä¸ºæ•°æ®æºå†™æ•°æ®åˆ° Kinesis Data Firehose æ˜¯ä¸ç”¨ agent çš„</li></ul><blockquote><p>Kinesis Agent cannot write to Amazon Kinesis Firehose for which the delivery stream source is already set as Amazon Kinesis Data Streams</p></blockquote><hr><h4 id="Kinesis-Data-Streams"><a href="#Kinesis-Data-Streams" class="headerlink" title="Kinesis Data Streams"></a>Kinesis Data Streams</h4><ul><li>Have the ability to reprocess &amp; replay stream data (replay, å¤„ç†æ•°æ®, é‡è¦)<ul><li>å¤„ç† real-time data stream, æ¯”å¦‚ clickstreams, transactions, media (é‡‘èæ•°æ®)</li><li>Consumer æœ‰ Lambda, Kinesis Firehose, Kinesis Data Analytics</li><li>Kinesis Data Streams æœ‰åŠ©äºæ¯ç§’ä»å¤šä¸ªæ¥æºè¿ç»­æ”¶é›†æ•° GB çš„æ•°æ®</li></ul></li><li>Once data is inserted in Kinesis, it canâ€™t be deleted (immutability)</li><li>å¦‚æœé—®åˆ° Kinesis Data Stream åŠ ä¸Š SQL, é‚£ä¹ˆç­”æ¡ˆé‡Œä¸€å®šæœ‰ Kinesis Data Analytics</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img014850.png"></p><ul><li>Data share the same partition goes the same shard (æœ‰é¡ºåºçš„)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151123.png"></p><ul><li>Capacity Mode (Provisioned è®¾ç½®ä¸Šé™, On-Demand è‡ªåŠ¨ scale)<ul><li>Provisioned mode: Choose a number of shards provisioned, scale manually</li><li>On-demand mode: No need to provision or manage capacity (è‡ªåŠ¨)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151507.png"></p><blockquote><p>å¦‚æœé‡åˆ° ProvisionedThroughputExceededException é—®é¢˜, é€‰æ‹© batch messages è§£å†³</p></blockquote><hr><h4 id="Kinesis-Data-Firehose"><a href="#Kinesis-Data-Firehose" class="headerlink" title="Kinesis Data Firehose"></a>Kinesis Data Firehose</h4><ul><li>Kinesis Data Firehose load streaming data into data stores and analytics tools<ul><li>Managed service, auto scaling, serverless, support data transformation</li><li>Kinesis Data Firehose æä¾›å°†æ•°æ®æµä¼ è¿›æ•°æ®å­˜å‚¨æˆ–è€…æ•°æ®åˆ†æçš„åŠŸèƒ½</li></ul></li><li>Firehose çš„å¯¹è±¡æ˜¯ S3, Redshift è¿™ç§ (Serverless, ä¸“é—¨å¤„ç† log æ•°æ®)<ul><li>Firehose ä¸æ”¯æŒ DynamoDB çš„</li></ul></li><li>Near Real Time, è€Œä¸” Firehose åªæ”¯æŒä¸€ä¸ª consumer (dump data in a single data repo)<ul><li>ä½†æ˜¯ä¸è¦è¢« Near Real Time å¿½æ‚ , è¦æ ¹æ®é¢˜ç›®é€‰æ‹© Data Stream æˆ–è€… Data Firehose</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img015040.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151812.png"></p><ul><li>Kinesis Data Streams vs Firehose<ul><li>Data Streams: Write custom code, real-time, have data storage, have replay</li><li>Firehose: Fully managed, near real-time, no data storage, no replay</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img152247.png"></p><hr><h4 id="Data-ordering-for-Kinesis"><a href="#Data-ordering-for-Kinesis" class="headerlink" title="Data ordering for Kinesis"></a>Data ordering for Kinesis</h4><ul><li>Same key (Partition) will always go to the same shard (æœ‰é¡ºåº)</li><li>ç›¸æ¯”ä¹‹ä¸‹ SQS åªæœ‰ FIFO (é’ˆå¯¹äºéœ€è¦å¤§é‡ consumer)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img154939.png"></p><hr><h4 id="AWS-MQ"><a href="#AWS-MQ" class="headerlink" title="AWS MQ"></a>AWS MQ</h4><ul><li>ç®¡ç†ç¬¬ä¸‰æ–¹æ¶ˆæ¯ä»£ç† (Message Broker) è½¯ä»¶<ul><li>RabbitMQ and ActiveMQ</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img170638.png"></p><hr><h3 id="16-Containers-on-AWS"><a href="#16-Containers-on-AWS" class="headerlink" title="16. Containers on AWS"></a>16. Containers on AWS</h3><h4 id="AWS-ECS"><a href="#AWS-ECS" class="headerlink" title="AWS ECS"></a>AWS ECS</h4><ul><li>Elastic Container Service (Manage Docker containers on AWS)</li><li>ECS æœ‰ä¸¤ç§ Launch Type: EC2 å’Œ Fargate (Fargate æ˜¯ serverless çš„)</li><li>EC2 Launch Type: Need Provision, éœ€è¦ ECS Agent (é‡ç‚¹)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img212508.png"></p><ul><li>Fargate Launch Type: Serverless, No Provision (é‡ç‚¹)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img212546.png"></p><ul><li>IAM Roles for ECS (é‡è¦, æ˜¯ IAM)<ul><li>EC2 Instance Profile: åªé’ˆå¯¹ EC2 Launch Type</li><li>ECS Task Role: æ¯ä¸ª Task éƒ½æœ‰è‡ªå·±çš„ Role (è´Ÿè´£)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img212709.png"></p><ul><li>ECS å¯ä»¥å’Œ Load Balancer ä¸€èµ·ç”¨</li><li>ECS å¯ä»¥å’Œ EFS ä¸€èµ·ç”¨ (Fargate + EFS &#x3D; Serverless, ç®¡ç†æ–‡ä»¶)</li></ul><blockquote><p>Amazon ECS with EC2 launch type is charged based on EC2 instances and EBS volumes used. Amazon ECS with Fargate launch type is charged based on vCPU and memory resources that the containerized application requests</p></blockquote><hr><h4 id="ECS-Auto-Scaling"><a href="#ECS-Auto-Scaling" class="headerlink" title="ECS Auto Scaling"></a>ECS Auto Scaling</h4><ul><li>Automatically increase &#x2F; decrease the number of ECS tasks<ul><li>Target Scaling: Scale based on target value for CloudWatch metric</li><li>Step Scaling: Scale based on CloudWatch Alarm</li><li>Scheduled Scaling: Scale based on specific time (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img222247.png"></p><hr><h4 id="AWS-ECR"><a href="#AWS-ECR" class="headerlink" title="AWS ECR"></a>AWS ECR</h4><ul><li>Elastic Container Registry (ECR, ç®¡ç† Docker Image, ä¸æ˜¯ Docker Container)<ul><li>Store and manage Docker images on AWS</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img222836.png"></p><hr><h4 id="AWS-EKS"><a href="#AWS-EKS" class="headerlink" title="AWS EKS"></a>AWS EKS</h4><ul><li>Elastic Kubernetes Service (Manage Kubernetes clusters on AWS)<ul><li>Support 2 deployment mode: EC2 &amp; Fargate (å’Œ ECS ä¸€æ ·)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223132.png"></p><ul><li>EKS Data Volumes (éœ€è¦ StorageClass)<ul><li>Leverages a Container Storage Interface (CSI) compliant driver</li><li>æ”¯æŒ EBS, EFS, FSx</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223503.png"></p><ul><li>EKS Node Type (ä¸€å…±ä¸‰ç§)<ul><li>Managed Node Groups (é’ˆå¯¹ EC2 Instance)</li><li>Self-Managed Nodes (è‡ªå·±åˆ›å»º)</li><li>AWS Fargate (ä¸éœ€è¦ç®¡ç†)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img022321.png"></p><hr><h4 id="AWS-App-Runner"><a href="#AWS-App-Runner" class="headerlink" title="AWS App Runner"></a>AWS App Runner</h4><ul><li>Deploy web application and APIs (Build å’Œ Deploy)</li><li>No infrasture experience required (ä¸éœ€è¦ AWS ç»éªŒ)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img223649.png"></p><hr><h3 id="17-Serverless"><a href="#17-Serverless" class="headerlink" title="17. Serverless"></a>17. Serverless</h3><h4 id="AWS-Lambda"><a href="#AWS-Lambda" class="headerlink" title="AWS Lambda"></a>AWS Lambda</h4><ul><li>Virtual functions, Serverless, limited by time (short executions, 15 mins)<ul><li>Run on-demand, scaling is automated</li></ul></li><li>Could be Event-Driven, could handle CRON job (Jobs on a repeating schedule)<ul><li>Use EventBridge to trigger Lambda every hour</li></ul></li><li>Lambda æ˜¯æœ‰ account quota (é…é¢é™åˆ¶) çš„, éœ€è¦è”ç³» AWS æ¥æé«˜ä¸Šé™</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img212846.png"></p><ul><li>Lambda Limits (é™åˆ¶)<ul><li>Execution: Memory, Execution Time</li><li>Deployment: Size</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img213554.png"></p><blockquote><p>By default, AWS Lambda functions always operate from an AWS-owned VPC and hence have access to any public internet address or public AWS APIs. Once an AWS Lambda function is VPC-enabled, it will need a route through a Network Address Translation gateway (NAT gateway) in a public subnet to access public resources</p></blockquote><hr><h4 id="Lambda-SnapStart"><a href="#Lambda-SnapStart" class="headerlink" title="Lambda SnapStart"></a>Lambda SnapStart</h4><ul><li>å¯¹äº Java 11 ä»¥ä¸Š, Function is invoked from a pre-initialized state</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img213945.png"></p><hr><h4 id="CloudFront-Functions-amp-Lambda-Edge"><a href="#CloudFront-Functions-amp-Lambda-Edge" class="headerlink" title="CloudFront Functions &amp; Lambda@Edge"></a>CloudFront Functions &amp; Lambda@Edge</h4><ul><li>Execute logic at the edge (Edge Function, Serverless)</li><li>ä¸¤ç§æ–¹æ³•: CloudFront Functions, Lambda@Edge (å®ƒä»¬æ”¯æŒçš„è¯­è¨€ä¸åŒ)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img214215.png"></p><ul><li>CloudFront Functions (Javascript)<ul><li>Native feature of CloudFront, short execution time</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img214350.png"></p><ul><li>Lambda@Edge (NodeJS or Python)<ul><li>Longer execution time</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img214545.png"></p><ul><li>CloudFront Functions vs Lambda@Edge</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img214716.png"></p><hr><h4 id="Lambda-in-VPC"><a href="#Lambda-in-VPC" class="headerlink" title="Lambda in VPC"></a>Lambda in VPC</h4><ul><li>æ­£å¸¸æƒ…å†µä¸‹, Lambda æ— æ³•è®¿é—® VPC (æ‰€ä»¥è¦ Lambda in VPC)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img214940.png"></p><hr><h4 id="RDS-with-Lambda"><a href="#RDS-with-Lambda" class="headerlink" title="RDS with Lambda"></a>RDS with Lambda</h4><ul><li>Invoke Lambda functions from DB instance <ul><li>RDS for PostgreSQL, Aurora for MySQL, éœ€è¦ permission</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img215442.png"></p><hr><h4 id="AWS-DynamoDB"><a href="#AWS-DynamoDB" class="headerlink" title="AWS DynamoDB"></a>AWS DynamoDB</h4><ul><li>NoSQL database, with replication across multiple AZs, auto-scaling, no provision</li><li>ä¸¤ç§ Class: Standard &amp; Infrequent Access (IA)</li><li>å¦‚æœé—®åˆ° DynamoDB è€Œä¸”æ˜¯å¤„ç† Email çš„, å°±æ˜¯ DynamoDB Stream<ul><li>å¦‚æœé—®åˆ°å…³äº Stream çš„, ä¹Ÿè¦å»è€ƒè™‘ DynamoDB Stream</li></ul></li><li>å¦‚æœé—®åˆ° DynamoDB è€Œä¸”æ˜¯å¤„ç† unpredictable æ•°æ®çš„æ—¶å€™, é€‰æ‹© On-Demand table</li><li>By default, DynamoDB tables are encrypted with AWS owned key</li><li>ä¸è¦ç”¨ DB å»å­˜ Image (ä¸çŸ¥é“ä¸ºå•¥)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img224558.png"></p><ul><li>Read &#x2F; Write Capacity Mode<ul><li>RCU å’Œ WCU æ²¡æœ‰å…³è” (å¯ä»¥åªåŠ  RCU ä¸åŠ  WCU)</li><li>Provisioned Mode: è‡ªå·±å®šä¹‰éœ€è¦å¤šå°‘ RCU å’Œ WCU</li><li>On-Demand Mode: è‡ªåŠ¨ Scale éœ€è¦çš„ RCU å’Œ WCU (è´µ)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img225117.png"></p><ul><li>Point-In-Time Recovery (PITR, é‡è¦)<ul><li>When enable PITR, DynamoDB backs up table data automatically with per-second granularity so that you can restore to any given second in the preceding 35 days.</li></ul></li></ul><hr><h4 id="DynamoDB-Advance"><a href="#DynamoDB-Advance" class="headerlink" title="DynamoDB Advance"></a>DynamoDB Advance</h4><ul><li>DynamoDB Accelerator (DAX, å¯ä»¥å¤„ç† cache, ä½†æ˜¯ DAX ä¸æ˜¯ relational çš„)<ul><li>Help solve read congestion by caching (microseconds latency, ç¼“å­˜)</li><li>DAX ä¸æ”¯æŒ SQL query caching</li><li>å¯ä»¥æé«˜ DynamoDB çš„ performance (æé«˜çš„æ˜¯ read è€Œä¸æ˜¯ write, é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233440.png"></p><ul><li>DynamoDB Stream Processing (å¤„ç† Stream)<ul><li>Ordered stream of item-level modifications in table </li><li>ç”¨æ¥å¤„ç† Stream çš„, å¯ä»¥ Invoke Lambda function (æ¯”å¦‚å‘é‚®ä»¶)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233610.png"></p><ul><li>DynamoDB Global Tables (é‡è¦)<ul><li>Make DynamoDB table accessible with low latency in multiple regions</li><li>éœ€è¦å…ˆæœ‰ DynamoDB Stream ä½œä¸ºå‰æ</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233729.png"></p><ul><li>DynamoDB Time To Live (TTL, é‡è¦)<ul><li>Automatic delete items after an expiry timestamp (å®šæ—¶åˆ é™¤ DynamoDB é‡Œçš„ item)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233830.png"></p><hr><h4 id="AWS-API-Gateway"><a href="#AWS-API-Gateway" class="headerlink" title="AWS API Gateway"></a>AWS API Gateway</h4><ul><li>Invoke Lambda function, expose REST API (Stateless client-server communication)</li><li>Lambda + API Gateway &#x3D; No infrastructure to manage</li><li>API Gateway å¯ä»¥é˜²æ­¢ API overwhelmed by too many requests (é˜²æŠ–)</li><li>API Gateway Caching (å¯ä»¥ improve latency)<ul><li>With caching, you can reduce the number of calls made to your endpoint and also improve the latency of requests to your API</li><li>åæ­£è®°ä½, Read Replica æ˜¯è¦åŠ é’±çš„</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234222.png"></p><ul><li>API Gateway Endpoint Types<ul><li>Edge-Optimized (default): For global clients, API Gateway live in one region</li><li>Regional: For client in same region</li><li>Private: é’ˆå¯¹ VPC</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174118.png"></p><hr><h4 id="AWS-Step-Functions"><a href="#AWS-Step-Functions" class="headerlink" title="AWS Step Functions"></a>AWS Step Functions</h4><ul><li>Build serverless visual workflow to orchestrate Lambda functions <ul><li>æ­å»º Serverless å¯è§†åŒ– Workflow (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234352.png"></p><hr><h4 id="AWS-Cognito"><a href="#AWS-Cognito" class="headerlink" title="AWS Cognito"></a>AWS Cognito</h4><ul><li>Give users identity to interact with web or mobile application<ul><li>Cognito User Pools: è´Ÿè´£ç”¨æˆ·ç™»å½•, have built-in user management</li><li>Cognito Identity Pools: ç»™ä¸´æ—¶ AWS credentials æ¥ access AWS æœåŠ¡</li></ul></li><li>æ³¨æ„, ALB + Cognito User Pool æ‰æ˜¯åš Auth çš„, è€Œä¸æ˜¯ CloudFront</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234512.png"></p><hr><h3 id="18-Database-Summary"><a href="#18-Database-Summary" class="headerlink" title="18. Database Summary"></a>18. Database Summary</h3><h4 id="AWS-RDS-SM"><a href="#AWS-RDS-SM" class="headerlink" title="AWS RDS (SM)"></a>AWS RDS (SM)</h4><ul><li>Manage PostgreSQL, MySQL, Oracle, SQL Server ç­‰ç­‰</li><li>Provisioned, Auto Scaling, Backup</li><li>Have Read Replica &amp; Multi-AZ (å›å»çœ‹ç¬¬ä¸ƒç« )</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151151.png"></p><hr><h4 id="AWS-Aurora-SM"><a href="#AWS-Aurora-SM" class="headerlink" title="AWS Aurora (SM)"></a>AWS Aurora (SM)</h4><ul><li>Manage PostgreSQL &amp; MySQL (åªæœ‰è¿™ä¸¤ä¸ª, å›å»çœ‹ç¬¬ä¸ƒç« )</li><li>Data stored in 6 replias, across 3 AZ, high available, auto-scaling</li><li>Aurora Serverless: For unpredictable workloads (Auto Scaling)</li><li>Aurora Global: Less than 1 second storage replication (ä¿è¯è‡³å°‘æœ‰ä¸€ä¸ª Replica å¯ä»¥ç”¨)</li><li>Aurora Database Cloning: å¿«é€Ÿ access Aurora DB, é€‚åˆ test database ç”Ÿæˆ</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151441.png"></p><hr><h4 id="AWS-ElastiCache-SM"><a href="#AWS-ElastiCache-SM" class="headerlink" title="AWS ElastiCache (SM)"></a>AWS ElastiCache (SM)</h4><ul><li>Manage Redis &#x2F; Memcached (In-memory data store, å›å»çœ‹ç¬¬ä¸ƒç« )</li><li>Support Clustering (Redis), Multi-AZ and Read Replicas (Shard)</li><li>Require some application code change to be leveraged (é‡ç‚¹)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151732.png"></p><hr><h4 id="AWS-DynamoDB-SM"><a href="#AWS-DynamoDB-SM" class="headerlink" title="AWS DynamoDB (SM)"></a>AWS DynamoDB (SM)</h4><ul><li>Severless, NoSQL database (For rapidly evolve schemas, å›å»çœ‹ç¬¬åä¸ƒç« )</li><li>Capacity modes: Provisioned capacity or On-Demand capacity</li><li>DAX cluster for read cache, microsecond read latency (ç¼“å­˜)</li><li>Event Processing: DynamoDB Stream with Lambda or Kinesis Data Streams</li><li>Export to S3 without using RCU, Import from S3 without WCU</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img152140.png"></p><hr><h4 id="AWS-S3-SM"><a href="#AWS-S3-SM" class="headerlink" title="AWS S3 (SM)"></a>AWS S3 (SM)</h4><ul><li>S3 is a key &#x2F; value store for objects (é€‚åˆæ–‡ä»¶ä½“ç§¯å¤§çš„, å›å»çœ‹ç¬¬åç« )</li><li>Tiers: Standard, IA, Glacier ç­‰ç­‰</li><li>Features: Versioning, Encryption, Replication ç­‰ç­‰</li><li>Encryption: SSE-S3, SSE-KMS, SSE-C</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img152526.png"></p><hr><h4 id="AWS-DocumentDB"><a href="#AWS-DocumentDB" class="headerlink" title="AWS DocumentDB"></a>AWS DocumentDB</h4><ul><li>DocumentDB is for MongoDB (Also a NoSQL database, ä½†æ˜¯åªè´Ÿè´£ MongoDB)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img152629.png"></p><hr><h4 id="AWS-Neptune"><a href="#AWS-Neptune" class="headerlink" title="AWS Neptune"></a>AWS Neptune</h4><ul><li>Graph database (For social network, å›¾æ•°æ®åº“)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img152726.png"></p><hr><h4 id="AWS-Keyspaces"><a href="#AWS-Keyspaces" class="headerlink" title="AWS Keyspaces"></a>AWS Keyspaces</h4><ul><li>Manage Apache Cassandra (also NoSQL) database (é˜¿å¸•å¥‡å¡æ¡‘å¾·æ‹‰)</li><li>Use cases: Store IoT devices info, time-series data</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img153058.png"></p><hr><h4 id="AWS-QLDB"><a href="#AWS-QLDB" class="headerlink" title="AWS QLDB"></a>AWS QLDB</h4><ul><li>QLDB: Quantum Ledger Database (Immutable, æ— æ³•åˆ é™¤)<ul><li>For recording financial transactions (Serverless, åŠ å¯†èµ„äº§)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img153301.png"></p><hr><h4 id="AWS-Timestream"><a href="#AWS-Timestream" class="headerlink" title="AWS Timestream"></a>AWS Timestream</h4><ul><li>Serverless Time series database (æ—¶é—´åºåˆ—æ•°æ®åº“)</li><li>Use cases: IoT apps, real-time analytics</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img153436.png"></p><hr><h3 id="19-Data-amp-Analytics"><a href="#19-Data-amp-Analytics" class="headerlink" title="19. Data &amp; Analytics"></a>19. Data &amp; Analytics</h3><h4 id="AWS-Athena"><a href="#AWS-Athena" class="headerlink" title="AWS Athena"></a>AWS Athena</h4><ul><li>Athena is an interactive query service that makes it easy to analyze data directly in Amazon S3 using standard SQL (Athena is Serverless)<ul><li>Athena æ”¯æŒ SQL query å»å¤„ç† S3 æ•°æ®çš„</li><li>Athena cannot be used to analyze data in real time (æ²¡åŠæ³•å®æ—¶å¤„ç†æ•°æ®, é‡è¦)</li></ul></li><li>Use Athena to process logs, perform ad-hoc analysis, and run interactive queries (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200048.png"></p><ul><li>Performance Improvement<ul><li>Use columnar data for cost-saving (å¯ä»¥æœ‰æ›´å°‘çš„ scan)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200302.png"></p><ul><li>Federated Query<ul><li>Allow to run SQL queries across data stored on AWS or On-Premise</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200427.png"></p><hr><h4 id="AWS-Redshift"><a href="#AWS-Redshift" class="headerlink" title="AWS Redshift"></a>AWS Redshift</h4><ul><li>Based on PostgreSQL, but itâ€™s OLAP (Online analytical processing)</li><li>å¤„ç† BI æ•°æ®, å’Œ AWS Quicksight æˆ–è€… Tableau ä¸€èµ·ç”¨<ul><li>Petabyte scale - Redshift (é‡è¦)</li></ul></li><li>å¦‚æœé—®åˆ° Redshift ä¸”å’Œ S3 æœ‰å…³, å°±æ˜¯ Redshift Spectrum (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201036.png"></p><ul><li>Snapshots &amp; DR<ul><li>Redshift has â€œMulti-AZâ€ mode for clusters</li><li>Enable Automated Snapshots, copy the Redshift cluster to another AWS region</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201212.png"></p><ul><li>Load data into Redshift (å°†æ•°æ®å­˜åˆ° Redshift é‡Œ)<ul><li>Kinesis Data Firehose, S3 with Enhanced VPC Routing (æ³¨æ„), EC2 Instance</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230656.png"></p><ul><li>Redshift Spectrum (å’Œ S3 æœ‰å…³)<ul><li>Query data that is already in S3 without loading it (é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201418.png"></p><hr><h4 id="AWS-OpenSearch"><a href="#AWS-OpenSearch" class="headerlink" title="AWS OpenSearch"></a>AWS OpenSearch</h4><ul><li>With OpenSearch, you can search any field, even partially matches<ul><li>åŸæ¥å«åš ElasticSearch (å°±æ˜¯åšæŸ¥è¯¢çš„)</li></ul></li><li>å¯ä»¥ç”¨ OpenSearch å®æ—¶å¤„ç†å’Œæœç´¢ Logs</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203117.png"></p><hr><h4 id="AWS-EMR"><a href="#AWS-EMR" class="headerlink" title="AWS EMR"></a>AWS EMR</h4><ul><li>EMR: Elastic MapReduce (å¤„ç†å¤§æ•°æ®çš„)<ul><li>EMR helps to creating Hadoop clusters (Big Data, å¤§æ•°æ®)</li><li>æœ‰ Hadoop, Apache Spark å•¥çš„å°±æ˜¯ EMR</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203405.png"></p><ul><li>Node types &amp; purchasing<ul><li>Node: Master, Core, Task</li><li>Purchasing options: On-Demand, Reserved, Spot Instance</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203545.png"></p><hr><h4 id="AWS-QuickSight"><a href="#AWS-QuickSight" class="headerlink" title="AWS QuickSight"></a>AWS QuickSight</h4><ul><li>Serverless machine learning business intelligence service to create dashboard<ul><li>ç®€å•æ¥è¯´å°±æ˜¯ç”¨ ML æ¥åˆ†æå•†ä¸šæ•°æ®å¹¶æ­å»º Dashboard</li></ul></li><li>In-memory computation using SPICE engine</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203724.png"></p><ul><li>Dashboard &amp; Analysis<ul><li>Share analysis or dashboard with Users or Groups (å¯ä»¥é€‰æ‹©æ€§çš„åˆ†äº«æ•°æ®)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203954.png"></p><hr><h4 id="AWS-Glue"><a href="#AWS-Glue" class="headerlink" title="AWS Glue"></a>AWS Glue</h4><ul><li>Managed extract, transform and load (ETL) service (Serverless)<ul><li>For customers to prepare and load their data for analytics</li><li>é‡åˆ°å¤„ç† ETL çš„å°±æ˜¯ Glue, ç”¨åˆ° Apache Spark</li><li>Use AWS Glue to process the raw data in Amazon S3 (é‡è¦)</li></ul></li></ul><blockquote><p>AWS Glue ETL jobs can use Amazon S3, data stores in a VPC, or on-premises JDBC data stores as a source. AWS Glue jobs extract data, transform it, and load the resulting data back to S3, data stores in a VPC, or on-premises JDBC data stores as a target.</p></blockquote><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img224509.png"></p><ul><li>Convert data into Apache Parquet format (è½¬æ•°æ®æ ¼å¼, å¾ˆå¥‡æ€ª, ä½†æ˜¯ä¼šè€ƒ)<ul><li>çœ‹åˆ°è¿™ä¸ª Apache Parquet å°±è¦æƒ³èµ· Glue</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img224817.png"></p><ul><li>Glue Job Bookmarks: é˜²æ­¢ re-process æ—§æ•°æ® (é‡è¦)</li><li>Glue Elastic Views: Combine and replicate data accross multiple data stores with SQL</li><li>Glue DataBrew: Clean and normalize data</li></ul><hr><h4 id="AWS-Lake-Formation"><a href="#AWS-Lake-Formation" class="headerlink" title="AWS Lake Formation"></a>AWS Lake Formation</h4><ul><li>Managed services to setup Data Lake (æ•°æ®æ¹–)<ul><li>Central place to have all data for analytics purpose</li><li>æ³¨æ„, å¦‚æœé¢˜ç›®é‡Œæåˆ° Fine-grained Access Control for application, å°±è¦æƒ³èµ· Lake Foramtion</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img224948.png"></p><hr><h4 id="Kinesis-Data-Analytics"><a href="#Kinesis-Data-Analytics" class="headerlink" title="Kinesis Data Analytics"></a>Kinesis Data Analytics</h4><ul><li>Real-time analytics on Kinesis Data Streams &amp; Firehose using SQL (é‡è¦)<ul><li>Fully managed, auto-scaling, serverless</li><li>ä»¥ Kinesis Data Streams &amp; Firehose ä½œä¸ºç›®æ ‡ä½¿ç”¨ SQL è¿›è¡Œæ•°æ®åˆ†æ</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img225813.png"></p><ul><li>Amazon Managed Service for Apache Flink</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img225906.png"></p><hr><h4 id="AWS-MSK"><a href="#AWS-MSK" class="headerlink" title="AWS MSK"></a>AWS MSK</h4><ul><li>Managed Apache Kafka on AWS (Have Serverless)<ul><li>Kinesis çš„ä»£æ›¿ (åŒæ ·å¤„ç† Stream data), ä½†æ˜¯é’ˆå¯¹ Apache Kafka</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230056.png"></p><ul><li>Kinesis Data Streams (ç¬¬åäº”ç« ) vs AWS MSK</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230216.png"></p><hr><h3 id="20-Machine-Learning"><a href="#20-Machine-Learning" class="headerlink" title="20. Machine Learning"></a>20. Machine Learning</h3><h4 id="AWS-Rekognition"><a href="#AWS-Rekognition" class="headerlink" title="AWS Rekognition"></a>AWS Rekognition</h4><ul><li>Find object, people, text, scenes in images and videos using ML (è¯†åˆ«ç‰©å“)</li><li>Facial analysis and facial search</li><li>Content Moderation: Detect content that is inappropriate (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img004131.png"></p><hr><h4 id="AWS-Transcribe"><a href="#AWS-Transcribe" class="headerlink" title="AWS Transcribe"></a>AWS Transcribe</h4><ul><li>Convert speech to text (è¯­éŸ³è½¬æ–‡å­—, Transcribe æ˜¯è½¬å½•çš„æ„æ€)</li><li>Automatically remove Personally Identifiable Information (PII, é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img004337.png"></p><hr><h4 id="AWS-Polly"><a href="#AWS-Polly" class="headerlink" title="AWS Polly"></a>AWS Polly</h4><ul><li>Convert text to speech (æ–‡å­—è½¬è¯­éŸ³)</li><li>Pronunciation Lexicons: Customize the pronunciation of words</li><li>Speech Synthesis Markup Language (SSML): Emphasize words (å°å£°)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img004547.png"></p><hr><h4 id="AWS-Translate"><a href="#AWS-Translate" class="headerlink" title="AWS Translate"></a>AWS Translate</h4><ul><li>Language translation (ç¿»è¯‘)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img004816.png"></p><hr><h4 id="AWS-Lex-amp-Connect"><a href="#AWS-Lex-amp-Connect" class="headerlink" title="AWS Lex &amp; Connect"></a>AWS Lex &amp; Connect</h4><ul><li>AWS Lex: Build chatbot (æ‰€æœ‰å’Œ chatbot æœ‰å…³çš„éƒ½æ˜¯ Lex)</li><li>AWS Connect: Build cloud contact center</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img004954.png"></p><hr><h4 id="AWS-Comprehend"><a href="#AWS-Comprehend" class="headerlink" title="AWS Comprehend"></a>AWS Comprehend</h4><ul><li>Natural Language Processing (NLP)</li><li>Comprehend Medical: for clinical text (åŒ»ç–—æ–¹é¢, éå¸¸é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img005107.png"></p><hr><h4 id="AWS-SageMaker"><a href="#AWS-SageMaker" class="headerlink" title="AWS SageMaker"></a>AWS SageMaker</h4><ul><li>Build ML models (å»º ML æ¨¡å‹)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img005342.png"></p><hr><h4 id="AWS-Forecast"><a href="#AWS-Forecast" class="headerlink" title="AWS Forecast"></a>AWS Forecast</h4><ul><li>Use ML to deliver highly accurate forecasts (åšé¢„æµ‹ç”¨çš„)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img012641.png"></p><hr><h4 id="AWS-Kendra"><a href="#AWS-Kendra" class="headerlink" title="AWS Kendra"></a>AWS Kendra</h4><ul><li>Managed document search service (æ–‡æ¡£æŸ¥æ‰¾)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img012746.png"></p><hr><h4 id="AWS-Personalize"><a href="#AWS-Personalize" class="headerlink" title="AWS Personalize"></a>AWS Personalize</h4><ul><li>ML with real-time personalized recommendations (åšæ¨èç”¨çš„)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img012921.png"></p><hr><h4 id="AWS-Textract"><a href="#AWS-Textract" class="headerlink" title="AWS Textract"></a>AWS Textract</h4><ul><li>ML to extract text (æå–æ–‡å­—ç”¨çš„, é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img013008.png"></p><hr><h3 id="21-AWS-Mointoring-amp-Audit"><a href="#21-AWS-Mointoring-amp-Audit" class="headerlink" title="21. AWS Mointoring &amp; Audit"></a>21. AWS Mointoring &amp; Audit</h3><h4 id="CloudWatch-Metrics"><a href="#CloudWatch-Metrics" class="headerlink" title="CloudWatch Metrics"></a>CloudWatch Metrics</h4><ul><li>CloudWatch Metrics helps to monitor every services in AWS</li><li>å¯ä»¥ç”¨ CloudWatch Metrics å¤„ç† CloudTrail logs æ¥ç›‘è§†å¼‚å¸¸</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150021.png"></p><ul><li>CloudWatch Metric Streams<ul><li>Stream CloudWatch Metrics with near-real-time delivery (æ³¨æ„)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150150.png"></p><hr><h4 id="CloudWatch-Logs"><a href="#CloudWatch-Logs" class="headerlink" title="CloudWatch Logs"></a>CloudWatch Logs</h4><ul><li>A place to store application logs in AWS (S3, Kinesis, Lambda)<ul><li>Logs are encrypted by default</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150343.png"></p><ul><li>CloudWatch Logs Insights<ul><li>Search and analyze log data stored in CloudWatch Logs</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150531.png"></p><ul><li>CloudWatch Logs Subscriptions (å¯ä»¥ Export ç»™ S3)<ul><li>Get a real-time log events from CloudWatch Logs for processing and analysis</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150643.png"></p><blockquote><p>You can configure a CloudWatch Logs log group to stream data it receives to your Amazon OpenSearch Service cluster in NEAR REAL-TIME through a CloudWatch Logs subscription</p></blockquote><hr><h4 id="CloudWatch-Agent"><a href="#CloudWatch-Agent" class="headerlink" title="CloudWatch Agent"></a>CloudWatch Agent</h4><ul><li>å¯ä»¥æŠŠ EC2 çš„ log ä¼ é€’ç»™ CloudWatch (By default, EC2 ä¸ä¼ é€’ log, é‡è¦)</li><li>CloudWatch Logs Agent: ä¼ é€’ç»™ CloudWatch</li><li>CloudWatch Unified Agent: å¯ä»¥ä¼ é€’æ›´å¤šä¿¡æ¯, æ¯”å¦‚ CPU, RAM ç­‰ç­‰</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151251.png"></p><hr><h4 id="CloudWatch-Alarms"><a href="#CloudWatch-Alarms" class="headerlink" title="CloudWatch Alarms"></a>CloudWatch Alarms</h4><ul><li>CloudWatch Alarms are used to trigger notifications for any metric (ç”¨ SNS å‘æ¶ˆæ¯)<ul><li>æ¯”å¦‚ EC2 çš„ Health å‡ºé—®é¢˜</li><li>Target: EC2, ASG, SNS</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151423.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151514.png"></p><ul><li>Composite Alarams (ç›‘è§†å½“å‰æ‰€æœ‰ Alarm çš„æƒ…å†µ)<ul><li>Composite Alarams are mointoring the states of multiple other alarms</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151615.png"></p><hr><h4 id="AWS-EventBridge"><a href="#AWS-EventBridge" class="headerlink" title="AWS EventBridge"></a>AWS EventBridge</h4><ul><li>Schedule CRON jobs (Jobs on a repeating schedule, event-driven)</li><li>React to events from SaaS application (AWS services)<ul><li>å¦‚æœæåˆ° 3rd party application, è€ƒè™‘ EventBridge</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185605.png"></p><ul><li>åŸºæœ¬ä¸Šæ‰€æœ‰ event éƒ½è¦ç»è¿‡ EventBridge</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185712.png"></p><ul><li>Event Bus (Replay archived events, æ³¨æ„)<ul><li>æœ‰ Default Event Bus å’Œ Partner Event Bus (Datadog)</li><li>å¯ä»¥ Archive Events å¹¶ä¸” Replay (Good for debug)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190403.png"></p><ul><li>Schema Registry<ul><li>Analyze events in Event Bus and infer schema</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190004.png"></p><ul><li>Resource-based Policy<ul><li>Manage permissions (allow &#x2F; deny) for a specific Event Bus</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190215.png"></p><hr><h4 id="CloudWatch-Insights"><a href="#CloudWatch-Insights" class="headerlink" title="CloudWatch Insights"></a>CloudWatch Insights</h4><ul><li>è¿™é‡Œçš„ CloudWatch Insights æœ‰å¥½å‡ ç§ä¸åŒçš„ Insights (4 ç§)<ul><li>Container, Lambda, Contributor, Application</li></ul></li><li>CloudWatch Container Insights (å¤„ç† Container å®¹å™¨çš„)<ul><li>Collect, aggregate, summarize metrics and logs from container</li><li>ECS, EKS, Kubernetes, Fargate ç­‰ç­‰</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190651.png"></p><ul><li>CloudWatch Lambda Insights<ul><li>Monitoring solutions for serverless application running on Lambda</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190750.png"></p><ul><li>CloudWatch Contributor Insights (æ³¨æ„, å¯ä»¥æŸ¥ IP)<ul><li>Analyze log data and display contributor data (for system performance)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190854.png"></p><ul><li>CloudWatch Application Insights<ul><li>Provide dashboard to show the potential application issue related to AWS service</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img191050.png"></p><hr><h4 id="AWS-CloudTrail"><a href="#AWS-CloudTrail" class="headerlink" title="AWS CloudTrail"></a>AWS CloudTrail</h4><ul><li>Provide governance, compliance and audit for AWS account (å®¡è®¡ events å’Œ API call)<ul><li>æ¯”å¦‚ History of events æˆ–è€… API calls</li></ul></li><li>CloudTrail æ˜¯ Global Service, å¦‚æœä¸œè¥¿è¢«è¯¯åˆ , ç¬¬ä¸€æ—¶é—´çœ‹ CloudTrail</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img191802.png"></p><ul><li>CloudTrail Events<ul><li>Management Events: Performed on resources in AWS account</li><li>Data Events: S3 object-level activity (GetObject, DeleteObject)</li><li>CloudTrail Insigths Events: Detect unusual activity (å®‰å…¨)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192042.png"></p><ul><li>CloudTrail Insights (é‡è¦)<ul><li>CloudTaril Insights to detect unusual activity in account</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192157.png"></p><ul><li>CloudTrail Event Retention (ä¿å­˜ events)<ul><li>Keep events to S3 after they stored 90 days</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192301.png"></p><hr><h4 id="AWS-Config"><a href="#AWS-Config" class="headerlink" title="AWS Config"></a>AWS Config</h4><ul><li>AWS Config provides a detailed view of the configuration of AWS resources (é‡è¦)<ul><li>Record configurations and changes over time (è®°å½• config æ˜¯å¦è¢«ä¿®æ”¹)</li></ul></li><li>å¯ä»¥ç”¨ Config å»æ£€æŸ¥ ACM çš„ certificate æœ‰æ²¡æœ‰ä¸´è¿‘è¿‡æœŸ</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192656.png"></p><ul><li>Config Rules: å¯ä»¥è‡ªå®šä¹‰ Rule æ¥æ£€æŸ¥ (ä¹Ÿæœ‰ AWS managed rules, æ¯”å¦‚ä¸‹é¢ä¸¤ä¸ª)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img045705.png"></p><ul><li>Config Remediations <ul><li>Automate remediation (çº æ­£) of non-compliant resource using SSM Automation Documents (eg. unrestricted SSH access)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192951.png"></p><ul><li>Config Notifications<ul><li>Use EventBridge to trigger notifications when AWS resources are noncompliant</li><li>ç›¸å½“äºå½“æœ‰ä¸åˆè§„çš„ Resource å‡ºç°æ—¶, å¯ä»¥ Trigger Notifications</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img193119.png"></p><hr><h3 id="22-IAM-Advanced"><a href="#22-IAM-Advanced" class="headerlink" title="22. IAM Advanced"></a>22. IAM Advanced</h3><h4 id="AWS-Organizations"><a href="#AWS-Organizations" class="headerlink" title="AWS Organizations"></a>AWS Organizations</h4><ul><li>Manage multiple AWS accounts, global service</li><li>Consolidated Billing across all accounts (åˆå¹¶è´¦å•, é‡è¦)<ul><li>å¦‚æœé—®åˆ°å’Œ Shield Advance æœ‰å…³çš„é’±çš„é—®é¢˜, é‚£å°±æ˜¯æ²¡æœ‰è®¾ç½® Consolidated Billing</li></ul></li><li>Shared reserved instance and Saving Plans discounts across accounts (é‡è¦)</li><li>å¦‚æœè¦æŠŠä¸€ä¸ª Account è½¬åˆ°å¦ä¸€ä¸ª Organization, è¦å…ˆæŠŠå®ƒä»åŸæ¥çš„ Organization ç§»é™¤</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img235557.png"></p><ul><li>Service Control Policies (SCP, é™åˆ¶ç”¨æˆ·)<ul><li>IAM policies applied to OU (Organization Unit) or Accounts to restrict Users and Roles (Blocklist and Allowlist)</li><li>IAM Roles æ˜¯é’ˆå¯¹ Service, SCP é’ˆå¯¹ Organization</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img013921.png"></p><ul><li><p>IAM Permission Boundary (å›å»çœ‹ç¬¬äºŒç« )</p><ul><li>A permissions boundary is an advanced feature for using a managed policy to set the maximum permissions that an identity-based policy can grant to an IAM entity.</li></ul></li><li><p>Service Control Policies (SCPs)</p><ul><li>If a user or role has an IAM permission policy that grants access to an action that is either not allowed or explicitly denied by the applicable service control policy (SCP), the user or role canâ€™t perform that action</li><li>Service control policy (SCP) affects all users and roles in the member accounts, including root user of the member accounts</li><li>Service control policy (SCP) does not affect service-linked role</li></ul></li></ul><hr><h4 id="IAM-Conditions"><a href="#IAM-Conditions" class="headerlink" title="IAM Conditions"></a>IAM Conditions</h4><ul><li>è¦åˆ†æ¸…æ¥š bucket level permissions å’Œ object level permissions (&#x2F;*)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img022652.png"></p><hr><h4 id="IAM-Roles-vs-Resource-Based-Policies"><a href="#IAM-Roles-vs-Resource-Based-Policies" class="headerlink" title="IAM Roles vs Resource Based Policies"></a>IAM Roles vs Resource Based Policies</h4><ul><li>Role: Give up original permissions and take the permissions assigned to the Role</li><li>Resource Based Policy: The principal doesnâ€™t have to give up permissions</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img015940.png"></p><ul><li>EventBridge ä¾‹å­<ul><li>Resource based policy: Lambda, SNS, SQS ç­‰ç­‰</li><li>IAM Roles: Kinesis stream, ECS ç­‰ç­‰</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img023321.png"></p><hr><h4 id="Policy-Evaluation-Logic"><a href="#Policy-Evaluation-Logic" class="headerlink" title="Policy Evaluation Logic"></a>Policy Evaluation Logic</h4><ul><li>IAM Permission Boundaries<ul><li>A feature to set the maximum permissions an IAM entity can get</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img020209.png"></p><ul><li>ç­”æ¡ˆ No, No, No (Evaluate é€»è¾‘æ˜¯å…ˆæ¥ååˆ°, å…ˆ Deny å°±ç®—åé¢ Allow ä¹Ÿæ²¡æœ‰ç”¨)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img161535.png"></p><hr><h4 id="IAM-Identity-Center"><a href="#IAM-Identity-Center" class="headerlink" title="IAM Identity Center"></a>IAM Identity Center</h4><ul><li>One login for all (SSO) <ul><li>AWS accounts in AWS Organizations</li><li>Business cloud applications (Salesforce)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img020909.png"></p><ul><li>Fine-grained Permissions and Assignments<ul><li>Multi-Account Permissions: Manage access across AWS accounts</li><li>Application Assignments: SSO access to business applications</li><li>Attribute-Based Access Control (ABAC): Permission based on userâ€™s attribute (tags)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img021246.png"></p><hr><h4 id="AWS-Directory-Services"><a href="#AWS-Directory-Services" class="headerlink" title="AWS Directory Services"></a>AWS Directory Services</h4><ul><li>Create Active Directory (AD, ç›®å½•æœåŠ¡) in AWS (é‡è¦)<ul><li>AWS Managed Microsoft AD: Create own AD in AWS </li><li>AD Connector: Proxy to redirect to On-Premise AD</li><li>Simple AD: AD-compatible managed directory on AWS</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img021607.png"></p><hr><h4 id="AWS-Control-Tower"><a href="#AWS-Control-Tower" class="headerlink" title="AWS Control Tower"></a>AWS Control Tower</h4><ul><li>Set up and govern a secure and compliant multi-account AWS environment (é‡è¦)<ul><li>ç®¡ç† AWS å¤šè´¦æˆ·ç¯å¢ƒ, è€Œä¸”æ˜¯ Best Practice</li></ul></li><li>ControlTower use AWS Organizations to create accounts</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img021857.png"></p><ul><li>ControlTower - Guardrails (ç®¡ç† ControlTower)<ul><li>Preventive Guardrail: Use SCPs (Restrict REgions across all accounts)</li><li>Detective Guardrail: Use AWS Config (identify untagged resources)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img022019.png"></p><hr><h3 id="23-AWS-Security-amp-Encryption"><a href="#23-AWS-Security-amp-Encryption" class="headerlink" title="23. AWS Security &amp; Encryption"></a>23. AWS Security &amp; Encryption</h3><h4 id="AWS-KMS"><a href="#AWS-KMS" class="headerlink" title="AWS KMS"></a>AWS KMS</h4><ul><li>Anytime you hear â€œencryptionâ€ for an AWS service, itâ€™s most likely KMS</li><li>AWS managed encryption keys for us (Integrated with most AWS services)<ul><li>æ¯”å¦‚ EBS, S3, RDS, SSM (AWS managed keys),</li></ul></li><li>KMS Keys are scoped per Region</li><li>æ³¨æ„, KMS å¹¶ä¸é€‚åˆä¿å­˜ secret, åŠ å¯†çš„ä¸œè¥¿ä¸ä¸€å®šæ˜¯ secret</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img170646.png"></p><ul><li>Types of KMS Keys (3 ç§): AWS Owned, AWS Managed, CMK (Custom Managed)</li><li>ä¸¤ç§ Key çš„å½¢å¼: Symmetric (Single) &amp; Asymmetric (Public &amp; Private)</li><li>Automatic Key Rotation: 1 year</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img171058.png"></p><ul><li>KMS Key Policies (Control access to KMS keys)<ul><li>Default KMS Key Policy: Entire AWS account</li><li>Custom KMS Key Policy: Define who can access the key (Cross Account Access)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img171356.png"></p><blockquote><p>Deleting an AWS KMS key in AWS Key Management Service (AWS KMS) is destructive and potentially dangerous. Therefore, AWS KMS enforces a waiting period. (Pending state)</p></blockquote><hr><h4 id="KMS-Multi-Region-Keys"><a href="#KMS-Multi-Region-Keys" class="headerlink" title="KMS Multi-Region Keys"></a>KMS Multi-Region Keys</h4><ul><li>Identical KMS keys in different AWS Regions (åœ¨å…¶ä»– Region ä¹Ÿèƒ½ç”¨åŒæ ·çš„ KMS Key)<ul><li>Encrypt in one Region and decrypt in other Regions</li></ul></li><li>Use cases: DynamoDB Global Tables &amp; Global Aurora</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img172433.png"></p><hr><h4 id="S3-Replication-with-Encryption"><a href="#S3-Replication-with-Encryption" class="headerlink" title="S3 Replication with Encryption"></a>S3 Replication with Encryption</h4><ul><li>Unencrypted objects and objects encrypted with SSE-S3 are replicated by default</li><li>For objects encrypted with SSE-KMS, you need more options<ul><li>ä¹Ÿå°±æ˜¯è¯´ SSE-S3 åœ¨å¤åˆ¶çš„æ—¶å€™ä¼šä¿æŒ, ä½†æ˜¯ SSE-KMS éœ€è¦è®¾ç½®</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img172816.png"></p><hr><h4 id="Encrypted-AMI-Sharing-Process"><a href="#Encrypted-AMI-Sharing-Process" class="headerlink" title="Encrypted AMI Sharing Process"></a>Encrypted AMI Sharing Process</h4><ul><li>éœ€è¦ Launch Permission, éœ€è¦ Share KMS Keys, éœ€è¦ Permission to decrypte<ul><li>åæ­£åªè¦çŸ¥é“ AMI ä¹Ÿæ˜¯å¯ä»¥ Encrypt å¹¶ Share çš„</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173020.png"></p><hr><h4 id="SSM-Parameter-Store"><a href="#SSM-Parameter-Store" class="headerlink" title="SSM Parameter Store"></a>SSM Parameter Store</h4><ul><li>Secure storage for configuration and secrets <ul><li>æ¯”èµ· Secrets Manager æœ‰æ›´å¹¿çš„ç”¨é€”, æ¯”å¦‚ URLs, AMI IDs, License keys ç­‰ç­‰</li></ul></li><li>Have built-in verion tracking (æ¯æ¬¡ edit secret éƒ½ä¼šè¢«è®°å½•)</li><li>SSM æ²¡æœ‰ Automatic key rotation (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173611.png"></p><hr><h4 id="AWS-Secrets-Manager"><a href="#AWS-Secrets-Manager" class="headerlink" title="AWS Secrets Manager"></a>AWS Secrets Manager</h4><ul><li>Store secrets, integrated with RDS &amp; Aurora (éå¸¸é‡è¦, å­˜æ•°æ®åº“ secrets çš„)<ul><li>æ˜¯ç»™ confidential information (like database credentials, API keys) ç”¨çš„</li><li>æ¯”èµ· SSM Parameter Store, Secrets Manager æ”¯æŒ Key çš„è½®æ¢ (90 å¤©)</li><li>æ³¨æ„, Secret Manager çš„ Key Rotateion æ˜¯ 90 å¤©, KMS çš„ Key Rotateion æ˜¯ä¸€å¹´</li></ul></li><li>æ¯”èµ· KMS, Secrets Manager æ›´é€‚åˆå»ä¿å­˜ secret, æ¯”å¦‚ database credential, è€Œä¸” Secrets Manager ä¹Ÿæœ‰ Automatic key rotation</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174132.png"></p><ul><li>Multi-Region Secrets (å’Œ Multi-Region Key ç±»ä¼¼)<ul><li>Replicate Secrets across multiple AWS Regions (disaster recovery)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174258.png"></p><hr><h4 id="AWS-Certificate-Manager-ACM"><a href="#AWS-Certificate-Manager-ACM" class="headerlink" title="AWS Certificate Manager (ACM)"></a>AWS Certificate Manager (ACM)</h4><ul><li>Easily provision, manage, and deploy TLS Certificates (HTTPS)<ul><li>å¦‚æœä½ è¦ç»™ EB ä¸Š HTTPS å°±è¦ç”¨åˆ° ACM</li><li>å¦‚æœæ˜¯ third party SSL å°±æ²¡åŠæ³•ä½¿ç”¨ automatic certificate rotation</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174451.png"></p><ul><li>å¯ä»¥ç”¨ EventBridge æ¥æ£€æŸ¥ ACM Certificates æ˜¯å¦è¿‡æœŸ (è¿‡æœŸ Invoke SNS)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img172923.png"></p><hr><h4 id="AWS-WAF"><a href="#AWS-WAF" class="headerlink" title="AWS WAF"></a>AWS WAF</h4><ul><li>WAF: Web Application Firewall (é˜²ç«å¢™)</li><li>Protect web application in Layer 7 (HTTP &#x2F; HTTPS)<ul><li>Layer 4 æ˜¯ TCP &#x2F; UDP, Layer 3 å¤„ç† VPC ä¹‹ç±»çš„</li></ul></li><li>å¦‚æœè¦ block countries, å¯ä»¥ç”¨ WAF Geo Match æˆ–è€… WAF IP Set Statement (é‡è¦)</li><li>WAF å¯ä»¥è®¾ç½® rate-based rules, Shield ä¸å¯ä»¥</li><li>å¦‚æœéœ€è¦åœ¨ä¸åŒçš„ accout æˆ–è€… region ç”¨ WAF, è€ƒè™‘ Firewall Manager (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img174857.png"></p><ul><li>Web ACL: å¯ä»¥æ ¹æ® IP, HTTP Headers, Size æ¥å†³å®šè°å¯ä»¥ Access<ul><li>ä¹Ÿå°±æ˜¯è¯´, WAF å¯ä»¥ block access from certain countries</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175006.png"></p><blockquote><p>If you want to use AWS WAF across accounts, accelerate WAF configuration, automate the protection of new resources, use Firewall Manager with AWS WAF</p></blockquote><hr><h4 id="AWS-Shield"><a href="#AWS-Shield" class="headerlink" title="AWS Shield"></a>AWS Shield</h4><ul><li>Protect from DDoS attack (WAF ä¹Ÿå¯ä»¥, ä½†æ˜¯è€ƒè¯•é‡åˆ° DDoS çš„æ—¶å€™é€‰ Shield)</li><li>æœ‰ Shield Standard (å…è´¹) å’Œ Shield Advanced (ä»˜è´¹)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175302.png"></p><hr><h4 id="AWS-Firewall-Manager"><a href="#AWS-Firewall-Manager" class="headerlink" title="AWS Firewall Manager"></a>AWS Firewall Manager</h4><ul><li>Manage security rules in all accounts of an AWS Organization<ul><li>æ¯”å¦‚ WAF rules, AWS Shield Advanced, Security Group for EC2 &amp; VPC ç­‰ç­‰</li></ul></li><li>Rules are applied to new resources as they are created</li><li>å¦‚æœéœ€è¦åœ¨ä¸åŒçš„ accout æˆ–è€… region ç”¨ WAF, è€ƒè™‘ Firewall Manager (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175531.png"></p><ul><li>WAF vs Firewall Manager vs Shield<ul><li>å®ƒä»¬ä¸€èµ·ç”¨æ¥åšå¤§å‹å®‰å…¨ä¿æŠ¤ (WAF + Firewall Manager + Shield)</li><li>å¦‚æœåªæ˜¯æ—¥å¸¸ä¿æŠ¤, å°±ç”¨ WAF</li><li>å¦‚æœé‡åˆ° DDoS æ”»å‡», è€ƒè™‘ä½¿ç”¨ Shield</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175631.png"></p><hr><h4 id="AWS-GuardDuty"><a href="#AWS-GuardDuty" class="headerlink" title="AWS GuardDuty"></a>AWS GuardDuty</h4><ul><li>Intelligent threat discovery (ML) to protect AWS account (ç”¨ ML é˜²æ­¢åŠ å¯†æ”»å‡»)<ul><li>Input data: CloudTrail, VPC, DNS (é‡è¦)</li></ul></li><li>Use case: CryptoCurrency attacks</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175935.png"></p><hr><h4 id="AWS-Inspector"><a href="#AWS-Inspector" class="headerlink" title="AWS Inspector"></a>AWS Inspector</h4><ul><li>Automated Security Assessments (è‡ªåŠ¨å®‰å…¨è¯„ä¼°)<ul><li>EC2 Instance &amp; Container Images (ECR) &amp; Lambda Functions</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img180110.png"></p><hr><h4 id="AWS-Macie"><a href="#AWS-Macie" class="headerlink" title="AWS Macie"></a>AWS Macie</h4><ul><li>Use ML to protect sensitive data (PII) in AWS (ç”¨ ML ä¿æŠ¤æ•æ„Ÿä¿¡æ¯)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img180224.png"></p><hr><h3 id="24-Networking-VPC"><a href="#24-Networking-VPC" class="headerlink" title="24. Networking VPC"></a>24. Networking VPC</h3><ul><li>CIDR &#x3D; Base IP + Subnet Mask<ul><li>ä¾‹å­: CIDR 10.0.4.0&#x2F;28, &#x2F;28 ä»£è¡¨ 16 IPs &#x3D; (2^(32-28) &#x3D; 2^4), 8 çš„å€æ•°å¤§è¿‡28åªæœ‰32, æ‰€ä»¥ç­”æ¡ˆæ˜¯10.0.4.0åˆ°10.0.4.15 (0-15 ä¸€å…±æœ‰16ä¸ª)</li></ul></li><li>CIDR should not overlap, max CIDR size in AWS is &#x2F;16, min CIDR size in AWS is &#x2F;28</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img002822.png"></p><hr><h4 id="AWS-VPC"><a href="#AWS-VPC" class="headerlink" title="AWS VPC"></a>AWS VPC</h4><ul><li>VPC: Virtual Private Cloud<ul><li>All new AWS account have a default VPC</li></ul></li><li>CIDR should not overlap, max CIDR size in AWS is &#x2F;16, min CIDR size in AWS is &#x2F;28</li><li>è¦è®© VPC ä½¿ç”¨ custom domain éœ€è¦ enableDnsHostnames å’Œ enableDnsSupport</li><li>å¯ä»¥åˆ›å»º Shared Service VPC, è¿™æ ·æ¯ä¸ª VPC éƒ½å¯ä»¥ access åˆ°éœ€è¦çš„ services (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201530.png"></p><ul><li>Each Amazon EC2 instance that you launch into a VPC has a tenancy attribute (é‡è¦)<ul><li>å¯ä»¥åœ¨ dedicated å’Œ host ä¹‹é—´äº’ç›¸åˆ‡æ¢</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img042420.png"></p><hr><h4 id="VPC-Subnet"><a href="#VPC-Subnet" class="headerlink" title="VPC Subnet"></a>VPC Subnet</h4><ul><li>Can have Public Subnet and Private Subnet</li><li>AWS reserves 5 IP addresses in each subnet (first 4 &amp; last 1, é‡è¦)<ul><li>è®°å¾—å‰å››ä¸ªæ˜¯ä» 0 å¼€å§‹ç®—çš„, ä¹Ÿå°±æ˜¯ 0 - 3</li><li>æ¯”å¦‚æˆ‘è¦åšä¸€ä¸ªå¯ä»¥å¤„ç† 28 ä¸ªçš„, æˆ‘éœ€è¦ 28 + 5 + 26 + 5 &#x3D; 64</li></ul></li><li>Subnet is always associated with Route Table (é‡è¦)<ul><li>é—®å…³äº Subnet çš„é—®é¢˜å°±å’Œ Route Table æ²¡æœ‰å…³ç³»</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201819.png"></p><hr><h4 id="Internet-Gateway-IGW-amp-Route-Table"><a href="#Internet-Gateway-IGW-amp-Route-Table" class="headerlink" title="Internet Gateway (IGW) &amp; Route Table"></a>Internet Gateway (IGW) &amp; Route Table</h4><ul><li>IGW allow resource (eg. EC2 Instance) in a VPC connect to internet<ul><li>ç›¸å½“äºè®© VPC é‡Œçš„ resource å¯ä»¥è¿ä¸Šç½‘</li><li>IGW éœ€è¦ Route Table (é‡è¦)</li></ul></li><li>å¦‚æœ IGW å‡ºé—®é¢˜<ul><li>Need to also have Route Table (é¦–å…ˆæ£€æŸ¥ Route Table, å› ä¸º IGW éœ€è¦)</li><li>æ£€æŸ¥ Security Group æ˜¯å¦å…è®¸é€šè¿‡</li></ul></li><li>å¤„ç† Network Address Translation çš„å°±æ˜¯ Internet Gateway</li><li>Internet Gateway æ— æ³•ç›´æ¥åœ¨ private subnet é‡Œé¢ä½¿ç”¨ (é‡è¦)</li><li>NAT é’ˆå¯¹çš„æ˜¯ Subnet å±‚é¢, IGW é’ˆå¯¹çš„æ˜¯ VPC å±‚é¢ (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img202043.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img193121.png"></p><hr><h4 id="Bastion-Hosts"><a href="#Bastion-Hosts" class="headerlink" title="Bastion Hosts"></a>Bastion Hosts</h4><ul><li>Use Bastion Host to SSH into private EC2 instance (SSH è¿›å…¥ EC2)</li><li>Bastion Host is in the public subnet and is connected to the private subnet<ul><li>ç®€å•æ¥è¯´å°±æ˜¯ Public Internet åˆ° Private Subnet</li></ul></li><li>Bastion Host security group must restrict internet access (port 22)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img202553.png"></p><blockquote><p>Create a public Network Load Balancer that links to Amazon EC2 instances that are bastion hosts managed by an Auto Scaling Group</p></blockquote><hr><h4 id="NAT-Instances-Outdated"><a href="#NAT-Instances-Outdated" class="headerlink" title="NAT Instances (Outdated)"></a>NAT Instances (Outdated)</h4><ul><li>NAT: Network Address Translation</li><li>Allow EC2 Instance in Private Subnet to connect to the Internet<ul><li>ä½†ç°åœ¨éƒ½æ˜¯ç”¨ NAT Gateway (NAT Gateway is the prefered solution now)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img202940.png"></p><ul><li>NAT instance can be used as a bastion server</li><li>Security Groups can be associated with a NAT instance</li><li>NAT instance supports port forwarding</li></ul><hr><h4 id="NAT-Gateway-NATGW"><a href="#NAT-Gateway-NATGW" class="headerlink" title="NAT Gateway (NATGW)"></a>NAT Gateway (NATGW)</h4><ul><li>AWS managed NAT, AZ specific, use Elastic IP (é’ˆå¯¹ IPv4, Egress æ˜¯ IPv6)<ul><li>Allow EC2 Instance in Private Subnet to connect to the Internet</li><li>Requires an IGW, NATGW æ˜¯å¤„äº public subnet çš„ (æ³¨æ„)</li></ul></li><li>NAT é’ˆå¯¹çš„æ˜¯ Subnet å±‚é¢, IGW é’ˆå¯¹çš„æ˜¯ VPC å±‚é¢</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203409.png"></p><ul><li>Resilient within single AZ, Multiple-AZ need multiple NATGW <ul><li>æ¯ä¸ª AZ éƒ½è¦ä¸€ä¸ª NATGW, ç”¨æ¥ fault-tolerance (å®¹é”™èƒ½åŠ›)</li></ul></li><li>Highly availiable within AZ (create in another AZ)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203654.png"></p><hr><h4 id="NACL-amp-Security-Groups"><a href="#NACL-amp-Security-Groups" class="headerlink" title="NACL &amp; Security Groups"></a>NACL &amp; Security Groups</h4><ul><li>The request has to go over NACL before go to Subnet (Subnet level)<ul><li>NACL is stateless (inbound outbound éƒ½è¦æ£€æµ‹)</li></ul></li><li>The request has to go over Security Group before go to EC2 Instance (Instance level)<ul><li>Security Group (SG) is stateful (inbound accepted &#x3D; outbound accepted)</li></ul></li><li>åæ­£è®°ä½ NACL æ˜¯ Subnet level (stateless), Security Group æ˜¯ Instance level (stateful)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img204310.png"></p><ul><li>Network Access Control List (NACL)<ul><li>NACL control traffic from and to subnets (eg. block IP)</li><li>One NACL per subnet, each subnet have default NACL (æ³¨æ„)<ul><li>Default NACL accept every inbound and outbound</li></ul></li><li>NACL Rules have number, higher precedence with lower number (è¶Šä¼˜å…ˆæ•°å­—è¶Šä½)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img204553.png"></p><hr><h4 id="VPC-Peering-amp-Sharing"><a href="#VPC-Peering-amp-Sharing" class="headerlink" title="VPC Peering &amp; Sharing"></a>VPC Peering &amp; Sharing</h4><ul><li>VPC Peering: Privately connect two VPCs using AWS network (åªé€‚åˆå°‘é‡ VPC, é‡è¦)<ul><li>æ¯ä¸€å¯¹ VPC éƒ½è¦ VPC Peering, å’Œ S3 Replication ç±»ä¼¼</li></ul></li><li>Can create VPC Peering between VPCs in different AWS accounts &#x2F; regions</li><li>Need to update Route Table in each VPC subnet to make sure they can communicate<ul><li>å‡ºé—®é¢˜å°±æ£€æŸ¥ Route Table</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img205313.png"></p><ul><li>VPC Sharing: Allows multiple AWS accounts to create resources (eg. EC2, RDS) into shared and centrally-managed AWS VPC (é‡è¦)<ul><li>é‡åˆ° centrally managed çš„å°±æ˜¯ VPC Sharing</li><li>è€Œä¸”æ˜¯ owner éœ€è¦ share one or more subnet (æ³¨æ„)</li></ul></li></ul><hr><h4 id="VPC-Endpoints-AWS-PrivateLink"><a href="#VPC-Endpoints-AWS-PrivateLink" class="headerlink" title="VPC Endpoints (AWS PrivateLink)"></a>VPC Endpoints (AWS PrivateLink)</h4><ul><li>VPC Endpoints allow private access to AWS services within a VPC (é‡è¦)<ul><li>ç”¨ Private Network è¿æ¥ AWS æœåŠ¡, å’Œ On-Premise æ²¡æœ‰å…³ç³»</li><li>Interface Endpoint æ”¯æŒå¤§éƒ¨åˆ† AWS æœåŠ¡ (ä»˜è´¹)</li><li>Gateway Endpoint åªæ”¯æŒ S3 å’Œ DynamoDB (å¾ˆå®¹æ˜“è€ƒ, å…è´¹)</li></ul></li><li>æ³¨æ„, VPC Gateway Endpoint ä¸“é—¨å¤„ç† S3 å’Œ DynamoDB (ä¸è¦å»é€‰æ‹© NAT æˆ–è€… IGW)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img205719.png"></p><ul><li>ä¸¤ç§ Types of Endpoints (Interface &#x2F; Gateway)<ul><li>Interface Endpoints: Supports most AWS services (ä»˜è´¹)</li><li>Gateway Endpoints: Must be used as a target in a route table (å…è´¹, é‡è¦)<ul><li>Only support S3 and DynamoDB (åªæ”¯æŒ S3 å’Œ DynamoDB)</li></ul></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img205939.png"></p><hr><h4 id="VPC-Flow-Logs"><a href="#VPC-Flow-Logs" class="headerlink" title="VPC Flow Logs"></a>VPC Flow Logs</h4><ul><li>Capture information about IP traffic going into interfaces (ç›‘è§† IP æµé‡çš„)<ul><li>Monitor &amp; troubleshoot connectivity issues (ç½‘ç»œè¿æ¥é—®é¢˜)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img231819.png"></p><hr><h4 id="Site-to-Site-VPN-VPN-Connection"><a href="#Site-to-Site-VPN-VPN-Connection" class="headerlink" title="Site-to-Site VPN (VPN Connection)"></a>Site-to-Site VPN (VPN Connection)</h4><ul><li>Site-to-Site VPN: Connect AWS to Corporate Data Center over public internet (é‡ç‚¹, public internet, On-Premise to AWS)<ul><li>Need a Virtual Private Gateway (VGW) on VPC (AWS æ–¹)</li><li>Need a Customer Gateway (CGW) on DC (On-Premise æ–¹)</li></ul></li><li>å¯¹æ¯” DX, Site-to-Site VPN æ²¡æœ‰æä¾› low latency, and high throughput connection</li><li>Site-to-Site VPN æœ‰ encrypted network connectivity between On-Premise and VPC</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232320.png"></p><ul><li>éœ€è¦ VPN Gateway å’Œ Customer Gateway æ¥è¿æ¥ VPC å’Œ On-Premise</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232649.png"></p><hr><h4 id="VPN-CloudHub"><a href="#VPN-CloudHub" class="headerlink" title="VPN CloudHub"></a>VPN CloudHub</h4><ul><li>Provide secure communication for multiple VPN Connections (Site-to-Site VPN)<ul><li>åœ¨éœ€è¦ç®¡ç†å¤šä¸ª Site-to-Site VPN çš„æ—¶å€™</li><li>å¯ä»¥ä½œä¸º backup connection ä½¿ç”¨ public internet å»é˜²æ­¢ failover</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img202141.png"></p><blockquote><p>If you have multiple AWS Site-to-Site VPN connections, you can provide secure communication between sites using the AWS VPN CloudHub.</p></blockquote><hr><h4 id="Direct-Connect-DX"><a href="#Direct-Connect-DX" class="headerlink" title="Direct Connect (DX)"></a>Direct Connect (DX)</h4><ul><li>Provide a dedicated private connection from a remote network to VPC (é‡ç‚¹, private internet, On-Premise to AWS)<ul><li>éœ€è¦è®¾ç½® VGW, å¦‚æœç»™ DX æ‰¾ backup, é‚£ä¹ˆå°±é€‰æ‹© Site-to-Site VPN (è¿™ä¸¤ä¸ªæœåŠ¡ç±»ä¼¼)</li><li>å¯¹æ¯” Site-to-Site VPN, DX provide low latency, and high throughput connection</li><li>DX ä¸æ”¯æŒ encrypted network connectivity, Site-to-Site VPN å¯ä»¥, ä½†æ˜¯å¦‚æœéœ€è¦ encrypt DX connection å¯ä»¥å’Œ AWS VPN ä¸€èµ·ç”¨ (æ³¨æ„)</li><li>DX çš„ set up æ—¶é—´å¾ˆé•¿ (æ‰€ä»¥ DX ä¸ç®—ä»€ä¹ˆ quick solution)</li></ul></li><li>All private, no public network involve (æ³¨æ„, å¦‚æœé—®åˆ° all Private å°±æ˜¯ DX)<ul><li>Direct Connect does not involve the Internet</li></ul></li><li>å¯ä»¥ access public resources (S3) å’Œ private resources (EC2)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233024.png"></p><ul><li>ä¸¤ç§ Connection Type (å¸¦å®½é€‰é¡¹, Dedicated æœ€å¿«)<ul><li>Dedicated Connections: 1Gbps åˆ° 100Gbps</li><li>Hosted Connections: 50Mbps åˆ° 10 Gbps</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img004140.png"></p><ul><li>Direct Connect Gateway (è¿æ¥è®¸å¤š VPC åœ¨ä¸åŒçš„ Region)<ul><li>Direct Connection to one or more VPC in many different regions</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233531.png"></p><ul><li>PrivateLink vs DX<ul><li><p>AWS PrivateLink provides a connection between VPCs (Virtual Private Clouds) and AWS services while bypassing the public Internet. It is a private network connection that securely transfers data without leaving the AWS network</p></li><li><p>AWS Direct Connect is a dedicated, private connection between the customerâ€™s on-premises infrastructure at a data center and an AWS location. The main features of the connection are ultra-fast data transfer rates, low latency, and improved security since it bypasses the public Internet</p></li></ul></li></ul><hr><h4 id="Transite-Gateway"><a href="#Transite-Gateway" class="headerlink" title="Transite Gateway"></a>Transite Gateway</h4><ul><li>Have transitive peering between thousands of VPCs, On-Premise ç­‰ç­‰ (é‡è¦)<ul><li>Regional resource, å¯ä»¥ Cross-Region (Transite Gateway è¿æ¥äº†å¤§é‡çš„ VPC)</li><li>å¯ä»¥é€šè¿‡ ECMP å» maximize the VPN throughput (é‡è¦)</li></ul></li><li>Support IP Multicast, IP å¤šæ’­å¯ä»¥åœ¨å•æ¬¡ä¼ è¾“ä¸­å‘ä¸€ç»„æ„Ÿå…´è¶£çš„æ¥æ”¶è€…å‘é€äº’è”ç½‘åè®®</li><li>å¦‚æœé—®åˆ°å…³äº star network æˆ–è€… hub-and-spoke çš„å°±æ˜¯ Transite Gateway</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img334237.png"></p><ul><li>Site-to-Site VPN ECMP (é‡è¦)<ul><li>ECMP &#x3D; Equal-cost multi-path routing (increase bandwidth)</li><li>è·¯ç”±ç­–ç•¥, å°†æ•°æ®åŒ…è½¬å‘åˆ°å•ä¸ªç›®çš„åœ°å¯ä»¥é€šè¿‡å…·æœ‰ç›¸åŒè·¯ç”±ä¼˜å…ˆçº§çš„å¤šæ¡æœ€ä½³è·¯å¾„</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234354.png"></p><hr><h4 id="VPC-Traffic-Mirroring"><a href="#VPC-Traffic-Mirroring" class="headerlink" title="VPC Traffic Mirroring"></a>VPC Traffic Mirroring</h4><ul><li>Capture and inspect network traffic in VPC (ç›‘æµ‹ VPC ç½‘ç»œæµé‡)</li><li>Use cases: content inspection, threat monitoring ç­‰ç­‰</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img002627.png"></p><hr><h4 id="IPv6-in-VPC"><a href="#IPv6-in-VPC" class="headerlink" title="IPv6 in VPC"></a>IPv6 in VPC</h4><ul><li>IPv4 cannot be disabled for VPC and subnets</li><li>Eg. EC2 Instance get at least 1 private IPv4 and a public IPv6<ul><li>æ‰€ä»¥å¦‚æœæ— æ³•å¯åŠ¨ EC2 Instance, é‚£ä¹ˆ IPv4 ä¸€å®šæœ‰é—®é¢˜</li><li>Create a new IPv4 CIDR in subnet (æ³¨æ„)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img001017.png"></p><hr><h4 id="Egress-only-Internet-Gateway"><a href="#Egress-only-Internet-Gateway" class="headerlink" title="Egress-only Internet Gateway"></a>Egress-only Internet Gateway</h4><ul><li>Use for IPv6 only (Similar to NAT Gateway, but NATGW only for IPv4)<ul><li>åªå…è®¸ outbound connection ä» VPC åˆ° Internet, ä¸å…è®¸ inbound ä» Internt åˆ° VPC</li><li>ä¹Ÿéœ€è¦ Update Route Table</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img001334.png"></p><hr><h4 id="AWS-Network-Firewall"><a href="#AWS-Network-Firewall" class="headerlink" title="AWS Network Firewall"></a>AWS Network Firewall</h4><ul><li>Protect entire AWS VPC (ç›¸å½“äº VPC çš„é˜²ç«å¢™, åƒä¸‡è¦è®°ä½)<ul><li>From Layer 3 to Layer 7 protection (å…¨æ–¹é¢, é‡è¦)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img002037.png"></p><ul><li>Have traffic filtering: Allow, drop, or alert traffic that match the rules</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img002200.png"></p><ul><li>AWS Network Firewall is a managed firewall service that provides filtering for both inbound and outbound network traffic. It allows you to create rules for traffic inspection and filtering, which can help protect your production VPC</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234322.png"></p><hr><h3 id="25-Disaster-Recovery-amp-Migrations"><a href="#25-Disaster-Recovery-amp-Migrations" class="headerlink" title="25. Disaster Recovery &amp; Migrations"></a>25. Disaster Recovery &amp; Migrations</h3><h4 id="Disaster-Recovery"><a href="#Disaster-Recovery" class="headerlink" title="Disaster Recovery"></a>Disaster Recovery</h4><ul><li>RPO: Recovery Point Objective (è¿™æ®µæ—¶é—´çš„æ•°æ®ä¸¢å¤±)</li><li>RTO: Recovery Time Objective (è¿™æ®µæ—¶é—´ App åœæœº)</li><li>é‡åˆ° DR å°±åº”è¯¥å»æƒ³ Multi-Region çš„å¤„ç†æ–¹æ³• (æ³¨æ„)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img002206.png"></p><ul><li>Disaster Recovery Startegies<ul><li>Backup and Restore: High RPO &amp; RTO, å°† On-Premise æ•°æ®å¤‡ä»½åœ¨ Cloud ä¸Š</li><li>Pilot Light: ä¸€éƒ¨åˆ† app åœ¨ Cloud ä¸Šè·‘ (Only the critical infrastructure)<ul><li>æ³¨æ„, é‡åˆ°æœ‰æåˆ° DR (Disaster Recovery) with minimum çš„å°±æ˜¯ Pilot Light</li></ul></li><li>Warm Standby: ä¸€éƒ¨åˆ† app åœ¨ Cloud ä¸Šè·‘ (Scale-down version, scale-up quickly)<ul><li>æ³¨æ„, é‡åˆ°æœ‰æåˆ° DR (Disaster Recovery) with scale-down çš„å°±æ˜¯ Warm Standby</li></ul></li><li>Multi-Site: Every Low RTO &amp; RPO, å…¨éƒ¨ app åœ¨ Cloud ä¸Šè·‘ (æœ€è´µ)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img142543.png"></p><hr><h4 id="Database-Migration-Service-DMS"><a href="#Database-Migration-Service-DMS" class="headerlink" title="Database Migration Service (DMS)"></a>Database Migration Service (DMS)</h4><ul><li>Migrate database to AWS (å°†æ•°æ®åº“è¿ç§»åˆ° AWS, éå¸¸é‡è¦)</li><li>Support Homogeneous migration &amp; Heterogeneous migration<ul><li>Homogeneous å°±æ˜¯ç›¸åŒçš„æ•°æ®åº“ç±»å‹, Heterogeneous å°±æ˜¯ä¸åŒçš„æ•°æ®åº“ç±»å‹</li></ul></li><li>Need to have an EC2 Instance to perform DMS to make it work</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img143551.png"></p><ul><li>AWS Schema Conversion Tool (SCT, é‡è¦)<ul><li>Covert Database Schema from one engine to another (å¦‚æœè¦è¿ç§»çš„æ•°æ®åº“ç±»å‹ä¸åŒ)</li><li>If same DB engine, donâ€™t need SCT (æ¯”å¦‚ PostgreSQL åˆ° AWS RDS PostgreSQL)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img143914.png"></p><ul><li>DMS Multi-AZ Deployement<ul><li>DMS provisions and maintains a synchronously stand replica in different AZ</li><li>ç›¸å½“äºä½ åœ¨æ•°æ®åº“è¿ç§»çš„æ—¶å€™å¯ä»¥åœ¨å¦å¤–ä¸€ä¸ª AZ æœ‰ä¸€ä¸ªå¤‡ä»½</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img144109.png"></p><hr><h4 id="RDS-amp-Aurora-Migration"><a href="#RDS-amp-Aurora-Migration" class="headerlink" title="RDS &amp; Aurora Migration"></a>RDS &amp; Aurora Migration</h4><ul><li>RDS MySQL to Aurora MySQL (PostgreSQL ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†)<ul><li>Op1. DB Snapshots from RDS MySQL restored as Aurora MySQL</li><li>Op2. Create Aurora Read Replica from RDS MySQL</li></ul></li><li>External MySQL to Aurora MySQL<ul><li>Op1. Create backup file in S3, and create Aurora MySQL from S3</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img144459.png"></p><hr><h4 id="On-Premise-Strategy-with-AWS"><a href="#On-Premise-Strategy-with-AWS" class="headerlink" title="On-Premise Strategy with AWS"></a>On-Premise Strategy with AWS</h4><ul><li>AWS Application Discovery Service (DS)</li><li>AWS Database Migration Service (DMS)</li><li>AWS Server Migration Service (SMS)</li><li>VM Import &amp; Export (ä»¥ä¸Šè¿™äº›éƒ½è¦ä¾èµ– On-Premise)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img145118.png"></p><hr><h4 id="AWS-Backup"><a href="#AWS-Backup" class="headerlink" title="AWS Backup"></a>AWS Backup</h4><ul><li>Fully managed service to automate backups across AWS services (åšå¤‡ä»½çš„, é‡è¦)<ul><li>æ”¯æŒ EC2, EBS, S3, RDS, EFS ç­‰ç­‰</li></ul></li><li>Support Cross-Region backups and Cross-Account backups</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img145310.png"></p><ul><li>AWS Backup Valut Lock (ç›¸å½“äºç»™ backup ä¸Šé”)<ul><li>Enforce a WORM state for all backups (æ„æ€å°±æ˜¯æ‰€æœ‰ backup éƒ½åˆ ä¸äº†)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img145549.png"></p><hr><h4 id="Application-Migration-Service-MGN"><a href="#Application-Migration-Service-MGN" class="headerlink" title="Application Migration Service (MGN)"></a>Application Migration Service (MGN)</h4><ul><li>AWS Application Discovery Service (ç›¸å½“äºåœ¨ MGN ä¹‹å‰è¦å…ˆåšè®¡åˆ’)<ul><li>Plan migration projects by gathering information about On-Premise data centers</li><li>æœ‰ Agentless Discovery å’Œ Agent-based Discovery</li></ul></li><li>Result is viewed in AWS Migration Hub</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img145820.png"></p><ul><li>AWS Application Migration Service (MGN)<ul><li>Simplify migrating applications to AWS (å°† App è¿ç§»åˆ° AWS)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img145954.png"></p><hr><h4 id="VMware-Cloud-on-AWS"><a href="#VMware-Cloud-on-AWS" class="headerlink" title="VMware Cloud on AWS"></a>VMware Cloud on AWS</h4><ul><li>Use VMware Cloud to manage and extend On-Premise Data Center</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150508.png"></p><hr><h3 id="26-More-SAA"><a href="#26-More-SAA" class="headerlink" title="26. More SAA"></a>26. More SAA</h3><h4 id="Event-Processing"><a href="#Event-Processing" class="headerlink" title="Event Processing"></a>Event Processing</h4><ul><li>Fan Out Pattern: Have SNS in the middle and subscribe to multiple SQS (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185229.png"></p><ul><li>S3 Event Notifications: Trigger Lambda or SNS when S3 event happen (åœ¨ç¬¬åä¸€ç« )<ul><li>å¦‚æœé‡åˆ°éœ€è¦ set up DLQ (Dead Letter Queue), é€‰æ‹© Lambda</li><li>DLQ æ˜¯å¤„ç†å½“ message æ²¡æœ‰åŠæ³•è¢« processed (consumed) successfully</li></ul></li><li>ä¹Ÿå¯ä»¥å’Œ EventBridge ä¸€èµ·ç”¨, æœ‰ advanced filtering<ul><li>EventBridge å¯ä»¥å’Œ CloudTrail ä¸€èµ·ç”¨æ¥ Intercept API call</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185348.png"></p><hr><h4 id="Caching-Strategies"><a href="#Caching-Strategies" class="headerlink" title="Caching Strategies"></a>Caching Strategies</h4><ul><li>Cache: ç¦»ç”¨æˆ·è¶Šè¿‘è¶Šå¿«, ä½†æ˜¯å¯èƒ½ outdated, æ‰€ä»¥éœ€è¦ TTL (Time to Live)</li><li>API Gateway: Regional Caching (å› ä¸º API Gateway æ˜¯ Regional çš„)</li><li>App Logic: é˜²æ­¢é¢‘ç¹è°ƒç”¨æ•°æ®åº“</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185932.png"></p><hr><h4 id="Block-IP-Address"><a href="#Block-IP-Address" class="headerlink" title="Block IP Address"></a>Block IP Address</h4><ul><li>NACL: Decline the client IP</li><li>WAF: IP address filtering</li><li>æ€»ä¹‹, å¯ä»¥ç”¨ NACL åœ¨å¤„ç†, ä¹Ÿå¯ä»¥ç”¨ WAF å¤„ç† (äºŒè€…é€‰ä¸€, ä½†æ˜¯ä¸€èˆ¬é€‰æ‹© WAF)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190513.png"></p><hr><h4 id="HPC-in-AWS"><a href="#HPC-in-AWS" class="headerlink" title="HPC in AWS"></a>HPC in AWS</h4><ul><li>Cloud is the perfect place to perform HPC (High Performance Computing)</li><li>Data Management &amp; Transfer (æ•°æ®å¤„ç†å’Œè¿ç§»)<ul><li>AWS Direct Connect, Snowball, AWS DataSync</li></ul></li><li>æåˆ° HPC å°±åº”è¯¥æƒ³åˆ° EFA, Cluster Placement, FSx Lustre</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190820.png"></p><ul><li>Compute &amp; Networking<ul><li>EC2 Instance + EC2 Placement Group (Cluster, å› ä¸º network å¿«)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190944.png"></p><ul><li>Compute &amp; Networking (Cont.)<ul><li>EC2 Enhanced Networking (SR-IOV): éœ€è¦ Elastic Network Adapter (ENA)</li><li>Elastic Fabric Adapter (EFA): Improved ENA for HPC, only work for Linux</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img191112.png"></p><ul><li>Storage<ul><li>Instance-attached storage: EBS, Instance Store</li><li>Network storage: S3, EFS, FSx</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img191328.png"></p><ul><li>Automation &amp; Orchestration<ul><li>AWS Batch: Run multi-node pararllel jobs in multiple EC2 instances</li><li>AWS ParallelCluster: Deploy HPC on AWS, can enable EFA on cluster</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img191502.png"></p><hr><h4 id="EC2-Instance-High-Availability"><a href="#EC2-Instance-High-Availability" class="headerlink" title="EC2 Instance High Availability"></a>EC2 Instance High Availability</h4><ul><li>Elastic IP + Standby EC2 Instance + CloudWatch + Lambda<ul><li>å½“ failover, è½¬åˆ° standby EC2 Instance</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img191841.png"></p><ul><li>Elastic IP + Auto Scaling Group (min, max)<ul><li>å½“ failover, æœ‰ replacement EC2 Instance (ä¸éœ€è¦ CloudWatch äº†)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192115.png"></p><hr><h3 id="27-Other-AWS-Services"><a href="#27-Other-AWS-Services" class="headerlink" title="27. Other AWS Services"></a>27. Other AWS Services</h3><h4 id="AWS-CloudFormation"><a href="#AWS-CloudFormation" class="headerlink" title="AWS CloudFormation"></a>AWS CloudFormation</h4><ul><li>A declarative way of outlining AWS Infrastructure (ç›¸å½“äºæœ‰ä¸€ä¸ªæ¨¡æ¿å¸®ä½ ç”Ÿæˆä½ æƒ³è¦çš„)<ul><li>éœ€è¦ä»€ä¹ˆ (eg. EC2 Instance, S3), CloudFormation ç»™ä½  create ä»€ä¹ˆ</li><li>CloudFormation æ˜¯ IaaS (Infrastructure as a Service)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img003448.png"></p><ul><li>Infrastructure as a Service (IaaS, no need to manually create)</li><li>Good if we need to repeat architecture in different environment</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img003657.png"></p><hr><h4 id="CloudFormation-StackSets"><a href="#CloudFormation-StackSets" class="headerlink" title="CloudFormation StackSets"></a>CloudFormation StackSets</h4><ul><li>ä½¿ç”¨ StackSets, å¦‚æœéœ€è¦ cross account æˆ–è€… region å»ä½¿ç”¨ CloudFormation</li><li>AWS CloudFormation StackSet extends the functionality of stacks by enabling you to create, update, or delete stacks across multiple accounts and regions with a single operation</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img013227.png"></p><hr><h4 id="CloudFormation-Service-Role"><a href="#CloudFormation-Service-Role" class="headerlink" title="CloudFormation Service Role"></a>CloudFormation Service Role</h4><ul><li>Service Role: IAM role that allows CloudFormation to create &#x2F; update &#x2F; delete resource</li><li>Give ability to user to do the above (å®‰å…¨æ–¹é¢)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img004103.png"></p><hr><h4 id="AWS-SES-Simple-Email-Service"><a href="#AWS-SES-Simple-Email-Service" class="headerlink" title="AWS SES (Simple Email Service)"></a>AWS SES (Simple Email Service)</h4><ul><li>Managed service to send email securely (å‘é‚®ä»¶çš„)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img004334.png"></p><hr><h4 id="AWS-Pinpoint"><a href="#AWS-Pinpoint" class="headerlink" title="AWS Pinpoint"></a>AWS Pinpoint</h4><ul><li>Scalable 2-way (outbound &#x2F; inbound) marketing communication serivce (é‡è¦)<ul><li>ç»™å®¢æˆ·å‘æ¶ˆæ¯ç”¨çš„</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img004519.png"></p><hr><h4 id="AWS-SSM-Session-Manager"><a href="#AWS-SSM-Session-Manager" class="headerlink" title="AWS SSM Session Manager"></a>AWS SSM Session Manager</h4><ul><li>SSM Session Manager: Systems Manager Session Manager</li><li>Allow to start a secure shell on EC2 and On-Premise (æ›´å¥½çš„ä» On-Premise access EC2)<ul><li>No need SSH access (Better security)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img004759.png"></p><hr><h4 id="AWS-Cost-Explorer"><a href="#AWS-Cost-Explorer" class="headerlink" title="AWS Cost Explorer"></a>AWS Cost Explorer</h4><ul><li>Visualize &amp; manage AWS costs and usage over time (å¯ä»¥ç”Ÿæˆæ¶ˆè´¹æŠ¥å‘Š)</li><li>Can choose a optimal Saving Plan</li><li>å¦‚æœé—®å’Œé’±ç›¸å…³çš„å¾ˆå¤§ç¨‹åº¦å°±æ˜¯ Cost Explorer (é‡è¦)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img005425.png"></p><hr><h4 id="AWS-Compute-Optimizer"><a href="#AWS-Compute-Optimizer" class="headerlink" title="AWS Compute Optimizer"></a>AWS Compute Optimizer</h4><ul><li>ç®€å•æ¥è¯´, Cost Explorer + Compute Optimizer ä¸€èµ·å°±æ˜¯æ¥çœé’±çš„</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img173241.png"></p><blockquote><p>AWS Compute Optimizer recommends optimal AWS Compute resources for your workloads to reduce costs and improve performance by using machine learning to analyze historical utilization metrics.</p></blockquote><hr><h4 id="AWS-Batch"><a href="#AWS-Batch" class="headerlink" title="AWS Batch"></a>AWS Batch</h4><ul><li>Managed batch processing at any scale (æ‰¹é‡å¤„ç†)<ul><li>Batch can dynamically launch EC2 Instance or Spot Instance</li></ul></li><li>Batch jobs are defined as Docker images and run on ECS</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img005610.png"></p><ul><li>Batch vs Lambda<ul><li>Lambda: Time limit, Serverless</li><li>Batch: No time limit, Not Serverless</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img005741.png"></p><hr><h4 id="AWS-AppFlow"><a href="#AWS-AppFlow" class="headerlink" title="AWS AppFlow"></a>AWS AppFlow</h4><ul><li>Transfer data between Software-as-a-Service (SaaS) applications and AWS (é‡è¦)<ul><li>å¦‚æœé¢˜ç›®é—®åˆ° SaaS å°±è¦æƒ³èµ· AppFlow</li><li>Source: Salesforce, Slack ç­‰ç­‰ (é‡åˆ° SaaS å°±æ˜¯ AppFlow)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img005910.png"></p><hr><h4 id="AWS-Amplify"><a href="#AWS-Amplify" class="headerlink" title="AWS Amplify"></a>AWS Amplify</h4><ul><li>A set of tools to develop and deploy full stack web and mobile application<ul><li>æ­å»ºå…¨æ ˆé¡¹ç›®çš„</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img010043.png"></p><hr><h4 id="AWS-Resource-Access-Manager-RAM"><a href="#AWS-Resource-Access-Manager-RAM" class="headerlink" title="AWS Resource Access Manager (RAM)"></a>AWS Resource Access Manager (RAM)</h4><ul><li>RAM is a service that enables easily and securely share AWS resources with any AWS account or within AWS Organization. (eg. Transite Gateway, Subnets)<ul><li>é€‰æ‹© RAM çš„ä¸»è¦åŸå› æ˜¯å®ƒä¾¿å®œ</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img043006.png"></p><hr><h4 id="AWS-Systems-Manager"><a href="#AWS-Systems-Manager" class="headerlink" title="AWS Systems Manager"></a>AWS Systems Manager</h4><ul><li>AWS Systems Manager is an AWS service that you can use to view and control your infrastructure on AWS (æ¯”å¦‚ group resources, eg. EC2, S3 ç­‰ç­‰)</li><li>Use AWS Systems Manager Run Command to run a custom command that applies the patch to all EC2 instances</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img013522.png"></p><hr><h3 id="28-WhitePapers"><a href="#28-WhitePapers" class="headerlink" title="28. WhitePapers"></a>28. WhitePapers</h3><ul><li>Well Architected Framework: æœ‰ 6 ä¸ª Pillars è¦è®°</li><li>Operational Excellence (è¿è¥) + Security (å®‰å…¨) + Reliability (å¯é ) + Performance Efficiency (æ€§èƒ½æ•ˆç‡) + Cost Optimization (çœé’±) + Sustainability (æŒç»­å‘å±•)</li><li>Maximum resilience is achieved by separate connections terminating on separate devices in more than one location</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img911011.png"></p><ul><li>AWS Well-Architected Tool<ul><li>Review architectures against 6 pillars (best practice)</li></ul></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img010508.png"> </p><hr><h4 id="AWS-Trusted-Advisor"><a href="#AWS-Trusted-Advisor" class="headerlink" title="AWS Trusted Advisor"></a>AWS Trusted Advisor</h4><ul><li>High level AWS account assessment (AWS è´¦æˆ·è¯„ä¼°)<ul><li>Learn the best practices on cost optimization, performance, and security</li></ul></li><li>æ ¹æ®ä¸Šé¢çš„ 6 Pillars æ¥åˆ¤æ–­ (è¦è®°ä½)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img010724.png"></p><hr><h3 id="29-Extra"><a href="#29-Extra" class="headerlink" title="29. Extra"></a>29. Extra</h3><ul><li><p>DNS queries</p><ul><li>To resolve any DNS queries for resources in the AWS VPC from the on-premises network, you can create an inbound endpoint on Amazon Route 53 Resolver and then DNS resolvers on the on-premises network can forward DNS queries to Amazon Route 53 Resolver via this endpoint.</li><li>To resolve DNS queries for any resources in the on-premises network from the AWS VPC, you can create an outbound endpoint on Amazon Route 53 Resolver and then Amazon Route 53 Resolver can conditionally forward queries to resolvers on the on-premises network via this endpoint.</li></ul></li><li><p>EC2 Instance recover from impaired state</p><ul><li>A recovered instance is identical to the original instance, including the instance ID, private IP addresses, Elastic IP addresses, and all instance metadata</li><li>If your instance has a public IPv4 address, it retains the public IPv4 address after recovery</li></ul></li><li><p>Spot Instance &amp; Spot Fleet</p><ul><li>If a spot request is persistent, then it is opened again after your Spot Instance is interrupted</li><li>Spot Fleets can maintain target capacity by launching replacement instances after Spot Instances in the fleet are terminated</li><li>When you cancel an active spot request, it does not terminate the associated instance</li></ul></li><li><p>Improve the security at the authentication level by leveraging short-lived credentials</p><ul><li>Use IAM authentication from AWS Lambda to Amazon RDS PostgreSQL</li><li>Attach an AWS Identity and Access Management (IAM) role to AWS Lambda</li></ul></li><li><p>Only root user account can do</p><ul><li>Some of the AWS tasks that only a root account user can do are as follows: change account name or root password or root email address, change AWS support plan, close AWS account, enable AWS Multi-Factor Authentication (AWS MFA) on S3 bucket delete, create Cloudfront key pair, register for GovCloud.</li></ul></li></ul><hr><h3 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h3><blockquote><p>è¯·å‹¿éšæ„ä¿®æ”¹, è°¢è°¢</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Certification </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è€ƒè¯ï¼šAWS CLF-C02</title>
      <link href="/posts/ced5b880.html"/>
      <url>/posts/ced5b880.html</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><blockquote><p>ä¸€äº›æˆ‘æ•´ç†çš„èµ„æ–™:</p><ul><li>å®˜ç½‘: <a href="https://aws.amazon.com/certification/certified-cloud-practitioner/">https://aws.amazon.com/certification/certified-cloud-practitioner/</a></li><li>å‚è€ƒç¬”è®°: <a href="https://cong-onion.cn/archives/acp-prepare-note">https://cong-onion.cn/archives/acp-prepare-note</a></li><li>ç™½çš®ä¹¦: <a href="https://d0.awsstatic.com/whitepapers/aws-overview.pdf">https://d0.awsstatic.com/whitepapers/aws-overview.pdf</a></li><li>ç½‘è¯¾ï¼š<a href="https://www.udemy.com/course/aws-certified-cloud-practitioner-new/">https://www.udemy.com/course/aws-certified-cloud-practitioner-new/</a> (ä¸ªäººæ¯”è¾ƒæ¨èï¼Œè¯¾æ¯”è¾ƒæ–°ï¼ŒWhizlabs çš„è¯¾æœ‰äº›å†…å®¹å¹¶ä¸æ˜¯åŸºäºæ–°çš„ AWS)</li><li>ç½‘è¯¾: <a href="https://www.whizlabs.com/aws-certified-cloud-practitioner/">https://www.whizlabs.com/aws-certified-cloud-practitioner/</a> (ä¸æ¨è)</li><li>é¢˜åº“: Whizlabs è´­ä¹°çš„è¯¾æœ‰ 4 å¥—é¢˜ (Whizlabs çš„é¢˜è¿˜è¡Œ)</li><li>é¢˜åº“: <a href="https://www.udemy.com/course/practice-exams-aws-certified-cloud-practitioner/">https://www.udemy.com/course/practice-exams-aws-certified-cloud-practitioner/</a> (æ¨è)</li><li>é¢˜åº“: <a href="https://www.examtopics.com/exams/amazon/aws-certified-cloud-practitioner-clf-c02/view/">https://www.examtopics.com/exams/amazon/aws-certified-cloud-practitioner-clf-c02/view/</a> (è¿™ä¸ªæ˜¯å…è´¹çš„)</li><li>å‡†å¤‡æ—¶é—´: 1 æœˆ 1 å·å‡†å¤‡ï¼Œ1 æœˆ 8 å·è€ƒè¿‡ (æœ‰ä¸€å®š AWS çš„åŸºç¡€)</li></ul></blockquote><hr><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><p>é‡ç‚¹: Pay-as-you-goï¼Œon-demand delivery<br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img105337.png"></p><ul><li>There are three fundamental drivers of cost with AWS: compute, storage, and outbound data transfer. In most cases, there is no charge for inbound data transfer or data transfer between other AWS services within the same region.</li></ul><hr><h4 id="Types-of-Cloud-Computing"><a href="#Types-of-Cloud-Computing" class="headerlink" title="Types of Cloud Computing"></a>Types of Cloud Computing</h4><p>é‡ç‚¹: 3 types of cloud computing</p><ul><li>IaaS: æ¯”å¦‚ EC2</li><li>PaaS: æ¯”å¦‚ Elastic Beanstalk</li><li>SaaS: æ¯”å¦‚ Rekognition</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img110812.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img110945.png"></p><hr><h4 id="Six-Advantages-of-Cloud-Computing"><a href="#Six-Advantages-of-Cloud-Computing" class="headerlink" title="Six Advantages of Cloud Computing"></a>Six Advantages of Cloud Computing</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img084401.png"></p><hr><h4 id="AWS-Global-Infrastructure"><a href="#AWS-Global-Infrastructure" class="headerlink" title="AWS Global Infrastructure"></a>AWS Global Infrastructure</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img114544.png"></p><p>AWS Region</p><ul><li>A region is a cluster of data centers</li><li>ä¸€ä¸ª Region è‡³å°‘æœ‰ä¸‰ä¸ª AZ</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img114639.png"></p><p>AWS Availability Zones</p><ul><li>Each availiablity zone (AZ) is one or more discrete data centers in the same location</li><li>AZ ç»„åˆèµ·æ¥å°±æ˜¯ Region</li><li>All traffic between Availability Zones (AZ) is encrypted</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img114958.png"></p><p>AWS Points of Presence (Edge Locations)</p><ul><li>Content is delivered to end users with low latency</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img115255.png"></p><hr><h4 id="AWS-Shared-Responsibility-Model"><a href="#AWS-Shared-Responsibility-Model" class="headerlink" title="AWS Shared Responsibility Model"></a>AWS Shared Responsibility Model</h4><ul><li>AWS è´Ÿè´£ä»€ä¹ˆï¼ŒCustomer è´Ÿè´£ä»€ä¹ˆ</li><li>AWS is responsible for Security â€œofâ€ the Cloud</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img120115.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img103332.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img103410.png"></p><hr><h3 id="1-Identity-and-Access-Management"><a href="#1-Identity-and-Access-Management" class="headerlink" title="1. Identity and Access Management"></a>1. Identity and Access Management</h3><h4 id="IAM-Users-amp-Group"><a href="#IAM-Users-amp-Group" class="headerlink" title="IAM Users &amp; Group"></a>IAM Users &amp; Group</h4><ul><li>Global service</li><li>Root account: donâ€™t share with others</li><li>Root user access credentials are the email address and password used to create the AWS account</li><li>Users: people within organization</li><li>Groups: a group of people</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img134540.png"></p><p>IAM Permissions</p><ul><li>least privilege principle</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img134928.png"></p><h4 id="IAM-Policies"><a href="#IAM-Policies" class="headerlink" title="IAM Policies"></a>IAM Policies</h4><ul><li>Inline Policy æ˜¯ Attach ç»™ä¸ªäººçš„ Policy</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img135808.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img140013.png"></p><p>IAM Password Policy &amp; MFA</p><ul><li>MFA æ˜¯ Root Account çš„ Best Practice</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img142523.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img142218.png"></p><p>AWS Access Keys &amp; CLI &amp; SDK</p><ul><li>æœ‰ 3 ç§æ–¹æ³• Access AWS: AWS Management Consoleï¼ŒAWS CLIï¼ŒAWS SDK</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img143439.png"></p><h4 id="IAM-Roles"><a href="#IAM-Roles" class="headerlink" title="IAM Roles"></a>IAM Roles</h4><ul><li>Assign permissions to AWS services with IAM Roles</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150558.png"></p><p>IAM Guildlines &amp; Best Parctices</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img153158.png"></p><p>Shared Responsibility Model for IAM</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img153447.png"></p><h4 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img154627.png"></p><hr><h3 id="2-Elastic-Compute-Cloud"><a href="#2-Elastic-Compute-Cloud" class="headerlink" title="2. Elastic Compute Cloud"></a>2. Elastic Compute Cloud</h3><h4 id="AWS-EC2"><a href="#AWS-EC2" class="headerlink" title="AWS EC2"></a>AWS EC2</h4><ul><li>60 seconds - There is a one-minute minimum charge for Linux based EC2 instances</li><li>Convertible reserved instance (RI): Purchase convertible reserved instance (RI) if you need additional flexibility, such as the ability to use different instance families, operating systems, or tenancies over the reserved instance (RI) term.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img193350.png"></p><p>User Data:</p><ul><li>EC2 Instance ç¬¬ä¸€æ¬¡è·‘çš„æ—¶å€™ä¼š Runï¼Œç”¨æ¥åš Task (æ¯”å¦‚å®‰è£… Apache)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img194029.png"></p><h4 id="EC2-Instance-Types"><a href="#EC2-Instance-Types" class="headerlink" title="EC2 Instance Types"></a>EC2 Instance Types</h4><ul><li>General Purpose: Balance between Computeï¼ŒMemoryï¼ŒNetworking</li><li>Compute Optimized: Great for compute-intensive tasks</li><li>Memory Optimized: Fast performance for workloads that process large data sets</li><li>Storage Optimized: Great for storage-intensive tasks</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img195856.png"></p><h4 id="Security-Groups"><a href="#Security-Groups" class="headerlink" title="Security Groups"></a>Security Groups</h4><ul><li>Security Group å°±æ˜¯ EC2 çš„é˜²ç«å¢™</li><li>Security Group å¯ä»¥ Attach ç»™å¤šä¸ª Instances</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200755.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201255.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201629.png"></p><h4 id="EC2-Instances-Purchasing-Options"><a href="#EC2-Instances-Purchasing-Options" class="headerlink" title="EC2 Instances Purchasing Options"></a>EC2 Instances Purchasing Options</h4><ul><li>On-Demand Instances: Pay for what you use</li><li>Reserved: é•¿æœŸä½¿ç”¨ (1-3 å¹´)</li><li>Saving Plans: æœ‰å›ºå®šçš„ Billingï¼Œè¶…è¿‡çš„è¿›å…¥ On-Demand</li><li>Spot Instances: æœ€ä¾¿å®œï¼Œä½†æ˜¯å¯èƒ½ Lose Instance</li><li>Dedicated Hosts: å®Œå…¨ Control ä¸€ä¸ª Server</li><li>Capacity Reservations: çŸ­æœŸå†…ä¿è¯æœ‰ Instance å¯ä»¥ä½¿ç”¨ï¼Œå³ä½¿ä¸ä½¿ç”¨</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img024118.png"></p><p>Shared Responsibility Model for EC2</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img025826.png"></p><h4 id="Summary-1"><a href="#Summary-1" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img025957.png"></p><hr><h3 id="3-EC2-Instance-Storage"><a href="#3-EC2-Instance-Storage" class="headerlink" title="3. EC2 Instance Storage"></a>3. EC2 Instance Storage</h3><h4 id="AWS-EBS"><a href="#AWS-EBS" class="headerlink" title="AWS EBS"></a>AWS EBS</h4><ul><li>Attach EBS to EC2 instance like a USB drive</li><li>EBS Volume tied to AZ</li><li>Persist data even after termination</li><li>Block-level storage</li><li>Charge for EBS Volumes: Provisioned IOPSï¼ŒVolume type</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img030842.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img032719.png"></p><p>EBS Snapshots (å¤‡ä»½)</p><ul><li>Make a backup (snapshot) of EBS volume</li><li>Recycle Bin å¯ä»¥é˜²æ­¢ Accidental Delete</li><li>Amazon Elastic Block Store (Amazon EBS) Snapshots are stored incrementally, which means you are billed only for the changed blocks stored</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img035925.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img040322.png"></p><p>EC2 Instance Store</p><ul><li>ç‰©ç†ç¡¬ç›˜</li><li>Block-level storage</li><li>Fast I&#x2F;O performance</li><li>Good for cache</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img054643.png"></p><p>Shared Responsibility Model for EC2 Storage</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img055927.png"></p><hr><h4 id="AWS-EFS"><a href="#AWS-EFS" class="headerlink" title="AWS EFS"></a>AWS EFS</h4><ul><li>å¯ä»¥ Mount åˆ°å¤šä¸ª EC2 Instance</li><li>Provides a simple, scalable, fully managed elastic NFS file system for use with AWS Cloud services and on-premises resources.</li><li>EBS volume can be attached to a single instance in the same Availability Zone (AZ) whereas EFS file system can be mounted on instances across multiple Availability Zones (AZ)</li><li>EC2 instances can access files on an Amazon Elastic File System (Amazon EFS) file system across many Availability Zones (AZ), Regions and VPCs</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img055110.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img055536.png"></p><p>EFS Infrequent Access (EFS-IA)</p><ul><li>Storing files in an accessible location to satisfy audit requirements</li><li>You will pay a fee each time you read from or write data stored on the Amazon Elastic File System (Amazon EFS) - Infrequent Access storage class</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img055437.png"></p><hr><h4 id="AWS-AMI"><a href="#AWS-AMI" class="headerlink" title="AWS AMI"></a>AWS AMI</h4><ul><li>Amazon Machine Image</li><li>å¯ä»¥æ›´å¥½çš„ Configure å’Œ Launch EC2 Instance (æ¯”å¦‚ä¸éœ€è¦é‡è£… Apache)</li><li>Region specific</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img053649.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img053738.png"></p><p>EC2 Image Builder</p><ul><li>Automatically buildï¼Œtest and distribute AMIs</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img054433.png"></p><hr><h4 id="AWS-FSx"><a href="#AWS-FSx" class="headerlink" title="AWS FSx"></a>AWS FSx</h4><ul><li>ç¬¬ä¸‰æ–¹æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ</li><li>FSx for Windows</li><li>FSx for Lustre</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img060300.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img060312.png"></p><hr><h4 id="Summary-2"><a href="#Summary-2" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img060513.png"></p><hr><h3 id="4-ELB-amp-ASG"><a href="#4-ELB-amp-ASG" class="headerlink" title="4. ELB &amp; ASG"></a>4. ELB &amp; ASG</h3><h4 id="Scalability-amp-High-Availability"><a href="#Scalability-amp-High-Availability" class="headerlink" title="Scalability &amp; High Availability"></a>Scalability &amp; High Availability</h4><ul><li>Vertical Scale: increase the size of the instance</li><li>Horizontal Scale: increase the number of instances (elastic)</li><li>High Availability: running application in at least 2 AZ (disaster recovery)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img065903.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img080120.png"></p><hr><h4 id="AWS-ELB"><a href="#AWS-ELB" class="headerlink" title="AWS ELB"></a>AWS ELB</h4><ul><li>Spread load across multiple downstream instances</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img085521.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img085832.png"></p><ul><li>Application Load Balancer (HTTP&#x2F;HTTPS)</li><li>Network Load Balancer (Allow TCP&#x2F;UDP)</li><li>Gateway Load Balancer (Security)</li><li>Classic Load Balancer (retired in 2023)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img090125.png"></p><hr><h4 id="AWS-ASG"><a href="#AWS-ASG" class="headerlink" title="AWS ASG"></a>AWS ASG</h4><ul><li>å¯ä»¥ä½œä¸º Template æ¥ç”Ÿæˆ EC2 Instance (Launch Template)</li><li>å¯ä»¥å’Œ ELB ä¸€èµ·ç”¨ï¼Œæ¥ Scale Up or Down åŸºäºæœåŠ¡å™¨å‹åŠ›</li><li>å¯ä»¥è‡ªåŠ¨ Replace Unhealth Instance (Meet desired Instances)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img091045.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img091228.png"></p><p>Scaling Strategies</p><ul><li>Manual Scaling</li><li>Dynamic Scaling</li><li>Predictive Scaling (Use ML)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img092355.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img092454.png"></p><hr><h4 id="Summary-3"><a href="#Summary-3" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img092733.png"></p><hr><h3 id="5-Simple-Storage-Service"><a href="#5-Simple-Storage-Service" class="headerlink" title="5. Simple Storage Service"></a>5. Simple Storage Service</h3><h4 id="AWS-S3"><a href="#AWS-S3" class="headerlink" title="AWS S3"></a>AWS S3</h4><ul><li><p>Buckets have a globally unique name</p></li><li><p>Buckets are defined at the region level</p></li><li><p>All Amazon S3 buckets have encryption configured by default, and objects are automatically encrypted by using server-side encryption with Amazon S3 managed keys (SSE-S3).</p></li><li><p>Amazon Simple Storage Service (Amazon S3) is a key value based object storage service</p></li><li><p>Amazon Simple Storage Service (Amazon S3) stores data in a flat non-hierarchical structure</p></li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img093348.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img093802.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img093849.png"></p><p>Bucket Policies</p><ul><li>User Access to S3: Use IAM permission</li><li>EC2 Instance Access: Use IAM Roles</li><li>Cross-Account Access: Use Bucket Policy</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img102509.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img102630.png"></p><p>S3 Website (Static Website Hosting)</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img104755.png"></p><p>S3 Versioning</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img105035.png"></p><p>S3 Replication (CRR &amp; SRR)</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img105607.png"></p><p>S3 Storage Classes</p><ul><li>Standard</li><li>Infrequent Access (IA)</li><li>Glacier</li><li>Intelligent Tiering</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img110113.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img110226.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img110336.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img110708.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img110810.png"></p><p>S3 Encryption</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img111248.png"></p><p>Shared Responsibility Model for S3</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img111547.png"></p><hr><h4 id="AWS-Snow-Family"><a href="#AWS-Snow-Family" class="headerlink" title="AWS Snow Family"></a>AWS Snow Family</h4><ul><li>Snowconeï¼ŒSnowball (TB &amp; Petabyte-scale)ï¼ŒSnowmobile (Exabytes-scale)</li><li>Transfer data to AWS physically</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img122700.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175223.png"></p><p>Edge Computing</p><ul><li>åœ¨ä»»ä½•åœ°æ–¹å¤„ç†æ•°æ®</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img123338.png"></p><hr><h4 id="AWS-OpsHub"><a href="#AWS-OpsHub" class="headerlink" title="AWS OpsHub"></a>AWS OpsHub</h4><ul><li>Manage Snow Family Device</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img123604.png"></p><hr><h4 id="AWS-Storage-Gateway"><a href="#AWS-Storage-Gateway" class="headerlink" title="AWS Storage Gateway"></a>AWS Storage Gateway</h4><ul><li>å¤„ç† Hybrid Storage on Cloud</li><li>Automatically enabled data encryption</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img132624.png"></p><hr><h4 id="Summary-4"><a href="#Summary-4" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img132831.png"></p><hr><h3 id="6-Database-amp-Analytics"><a href="#6-Database-amp-Analytics" class="headerlink" title="6. Database &amp; Analytics"></a>6. Database &amp; Analytics</h3><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img134205.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img242377.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img134415.png"></p><hr><h4 id="AWS-RDS"><a href="#AWS-RDS" class="headerlink" title="AWS RDS"></a>AWS RDS</h4><ul><li>è´Ÿè´£ Relational Database</li><li>Amazon RDS RIs: Like Amazon EC2 RIs</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img124658.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img134210.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img134849.png"></p><p>AWS Aurora</p><ul><li>AWS å¼€å‘çš„æ•°æ®åº“</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img134956.png"></p><p>RDS Deployments Options</p><ul><li>Read Replicas: Scale</li><li>Multi-AZ: Failover</li><li>Multi-Region: Disaster recovery</li><li>You can use both read replicas and multi-AZ deployment for disaster recovery</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img140045.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img148104.png"></p><hr><h4 id="AWS-Elastic-Cache"><a href="#AWS-Elastic-Cache" class="headerlink" title="AWS Elastic Cache"></a>AWS Elastic Cache</h4><ul><li>In-memory database (ç±»ä¼¼ Redis)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img140153.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img140242.png"></p><hr><h4 id="AWS-DynamoDB"><a href="#AWS-DynamoDB" class="headerlink" title="AWS DynamoDB"></a>AWS DynamoDB</h4><ul><li>NoSQL Database</li><li>DynamoDB Reserved Capacity</li><li>Support High Availability by default</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img142315.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img143342.png"></p><p>DynamoDB Accelerator (DAX)</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img142430.png"></p><p>DynamoDB Global Tables</p><ul><li>Low latency in multiple-regions</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img142815.png"></p><hr><h4 id="AWS-Redshift"><a href="#AWS-Redshift" class="headerlink" title="AWS Redshift"></a>AWS Redshift</h4><ul><li>Analytics and data warehousing</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img143251.png"></p><p>Redshift Serverless</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img123392.png"></p><hr><h4 id="AWS-EMR"><a href="#AWS-EMR" class="headerlink" title="AWS EMR"></a>AWS EMR</h4><ul><li>Help creating Hadoop clusters (Big Data) to analyze vast amount of data</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img242278.png"></p><hr><h4 id="AWS-Athena"><a href="#AWS-Athena" class="headerlink" title="AWS Athena"></a>AWS Athena</h4><ul><li>Perform analytics against S3 objects</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img144857.png"></p><hr><h4 id="AWS-QuickSight"><a href="#AWS-QuickSight" class="headerlink" title="AWS QuickSight"></a>AWS QuickSight</h4><ul><li>ç”Ÿæˆ Visualization Dashboard (å¤„ç† BI)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img145053.png"></p><hr><h4 id="AWS-DocumentDB"><a href="#AWS-DocumentDB" class="headerlink" title="AWS DocumentDB"></a>AWS DocumentDB</h4><ul><li>For MongoDBï¼ŒNoSQL</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img145305.png"></p><hr><h4 id="AWS-Neptune"><a href="#AWS-Neptune" class="headerlink" title="AWS Neptune"></a>AWS Neptune</h4><ul><li>Graph database</li><li>NoSQL</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img145437.png"></p><hr><h4 id="AWS-Timestream"><a href="#AWS-Timestream" class="headerlink" title="AWS Timestream"></a>AWS Timestream</h4><ul><li>Time series database</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img145616.png"></p><hr><h4 id="AWS-QLDB"><a href="#AWS-QLDB" class="headerlink" title="AWS QLDB"></a>AWS QLDB</h4><ul><li>Immutableï¼Œfor financial transcations</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img122316.png"></p><hr><h4 id="AWS-Managed-Blockchain"><a href="#AWS-Managed-Blockchain" class="headerlink" title="AWS Managed Blockchain"></a>AWS Managed Blockchain</h4><ul><li>Decentralized</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150042.png"></p><hr><h4 id="AWS-Glue"><a href="#AWS-Glue" class="headerlink" title="AWS Glue"></a>AWS Glue</h4><ul><li>AWS Glue is a fully managed extract, transform, and load (ETL) service that makes it easy for customers to prepare and load their data for analytics.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img150226.png"></p><hr><h4 id="AWS-DMS"><a href="#AWS-DMS" class="headerlink" title="AWS DMS"></a>AWS DMS</h4><ul><li>Database Migration Service</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img120404.png"></p><hr><h4 id="Summary-5"><a href="#Summary-5" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img622313.png"></p><hr><h3 id="7-Other-Compute-Services"><a href="#7-Other-Compute-Services" class="headerlink" title="7. Other Compute Services"></a>7. Other Compute Services</h3><h4 id="AWS-ECS"><a href="#AWS-ECS" class="headerlink" title="AWS ECS"></a>AWS ECS</h4><ul><li>Launch Docker containers on AWS</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185536.png"></p><hr><h4 id="AWS-Fargate"><a href="#AWS-Fargate" class="headerlink" title="AWS Fargate"></a>AWS Fargate</h4><ul><li>Launch Docker containers on AWS (Serverless)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185649.png"></p><hr><h4 id="AWS-ECR"><a href="#AWS-ECR" class="headerlink" title="AWS ECR"></a>AWS ECR</h4><ul><li>Docker Registry on AWS</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185752.png"></p><hr><h4 id="AWS-Lambda"><a href="#AWS-Lambda" class="headerlink" title="AWS Lambda"></a>AWS Lambda</h4><ul><li>Could be Event-Driven</li><li>Could use EventBridge trigger Lambda every hour (CRON)</li><li>You pay for the compute time you consume for AWS Lambda</li><li>Serverless</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190238.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img022933.png"></p><hr><h4 id="AWS-API-Gateway"><a href="#AWS-API-Gateway" class="headerlink" title="AWS API Gateway"></a>AWS API Gateway</h4><ul><li>Expose Lambda as HTTP API</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img031238.png"></p><hr><h4 id="AWS-Batch"><a href="#AWS-Batch" class="headerlink" title="AWS Batch"></a>AWS Batch</h4><ul><li>A job with a start and an end</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img035927.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img040028.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img040129.png"></p><hr><h4 id="AWS-Lightsail"><a href="#AWS-Lightsail" class="headerlink" title="AWS Lightsail"></a>AWS Lightsail</h4><ul><li>For people with little cloud experience</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img042248.png"></p><hr><h4 id="Summary-6"><a href="#Summary-6" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img042816.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img042914.png"></p><hr><h3 id="8-Deployment-amp-Manage-Infrastructure"><a href="#8-Deployment-amp-Manage-Infrastructure" class="headerlink" title="8. Deployment &amp; Manage Infrastructure"></a>8. Deployment &amp; Manage Infrastructure</h3><h4 id="AWS-CloudFormation"><a href="#AWS-CloudFormation" class="headerlink" title="AWS CloudFormation"></a>AWS CloudFormation</h4><ul><li>Infrastructure as code (ä¸éœ€è¦æ‰‹åŠ¨ Config EC2 ä¹‹ç±»çš„)</li><li>ä½œä¸º Template æ¥ç”Ÿæˆå„ç§ Services</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img044630.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img044747.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img044837.png"></p><hr><h4 id="AWS-CDK"><a href="#AWS-CDK" class="headerlink" title="AWS CDK"></a>AWS CDK</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img045950.png"></p><hr><h4 id="AWS-Elastic-Beanstalk"><a href="#AWS-Elastic-Beanstalk" class="headerlink" title="AWS Elastic Beanstalk"></a>AWS Elastic Beanstalk</h4><ul><li>PaaS (åªè´Ÿè´£å†™ Applicationï¼Œå…¶ä»–éƒ½ç”± EB æ¥å¤„ç†)</li><li>Free of cost</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img064808.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img064855.png"></p><hr><h4 id="AWS-CodeDeploy"><a href="#AWS-CodeDeploy" class="headerlink" title="AWS CodeDeploy"></a>AWS CodeDeploy</h4><ul><li>Deploy application automatically</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img074724.png"></p><hr><h4 id="AWS-CodeCommit"><a href="#AWS-CodeCommit" class="headerlink" title="AWS CodeCommit"></a>AWS CodeCommit</h4><ul><li>ç±»ä¼¼ Github</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img074839.png"></p><hr><h4 id="AWS-CodeBuild"><a href="#AWS-CodeBuild" class="headerlink" title="AWS CodeBuild"></a>AWS CodeBuild</h4><ul><li>Automatically build and test</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img075430.png"></p><hr><h4 id="AWS-CodePipeline"><a href="#AWS-CodePipeline" class="headerlink" title="AWS CodePipeline"></a>AWS CodePipeline</h4><ul><li>CICD</li><li>AWS CodePipeline uses Amazon CloudWatch Events to detect changes in CodeCommit repositories used as a source for a pipeline</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img081356.png"></p><hr><h4 id="AWS-CodeArtifact"><a href="#AWS-CodeArtifact" class="headerlink" title="AWS CodeArtifact"></a>AWS CodeArtifact</h4><ul><li>Manage packages (dependencies)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img082203.png"></p><hr><h4 id="AWS-CodeStar"><a href="#AWS-CodeStar" class="headerlink" title="AWS CodeStar"></a>AWS CodeStar</h4><ul><li>Each AWS CodeStar project includes development tools, including AWS CodePipeline, AWS CodeCommit, AWS CodeBuild, and AWS CodeDeploy, that can be used on their own and with existing AWS applications</li><li>You can use AWS CodeStar and AWS Cloud9 to develop, build, and deploy a serverless web application</li></ul><hr><h4 id="AWS-Cloud9"><a href="#AWS-Cloud9" class="headerlink" title="AWS Cloud9"></a>AWS Cloud9</h4><ul><li>Cloud IDE</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img082707.png"></p><hr><h4 id="AWS-SSM"><a href="#AWS-SSM" class="headerlink" title="AWS SSM"></a>AWS SSM</h4><ul><li>Manage a fleet of EC2 Instances</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img135524.png"></p><hr><h4 id="Summary-7"><a href="#Summary-7" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img140426.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img140520.png"></p><hr><h3 id="9-AWS-Global-Infrastructure"><a href="#9-AWS-Global-Infrastructure" class="headerlink" title="9. AWS Global Infrastructure"></a>9. AWS Global Infrastructure</h3><p>Why make a global application?</p><ul><li>Decreased Latency</li><li>Disaster Recovery (DR)</li></ul><p>Global Applications in AWS</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img142534.png"></p><hr><h4 id="AWS-Route53"><a href="#AWS-Route53" class="headerlink" title="AWS Route53"></a>AWS Route53</h4><ul><li>DNS (Domain Name System)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img142637.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img142729.png"></p><p>Routing Policies</p><ul><li>Simple Routing Policy (No health check)</li><li>Weighted Routing Policy (Distribute traffic)</li><li>Latency Routing Policy (Minimize Latency)</li><li>Failover Routing Policy (Disaster recoveryï¼Œactive-passive)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img142821.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img142907.png"></p><hr><h4 id="AWS-CloudFront"><a href="#AWS-CloudFront" class="headerlink" title="AWS CloudFront"></a>AWS CloudFront</h4><ul><li>Global service</li><li>CDN</li><li>Cached in edged location</li><li>Integrated with WAF (Network Firewall) and Shield (DDoS)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img144056.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img144157.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img144238.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img144434.png"></p><hr><h4 id="AWS-Global-Accelerator"><a href="#AWS-Global-Accelerator" class="headerlink" title="AWS Global Accelerator"></a>AWS Global Accelerator</h4><ul><li>AWS Internal Network (No cache)</li><li>AWS Global Accelerator is a good fit for non-HTTP use cases</li><li>AWS Global Accelerator provides static IP addresses that act as a fixed entry point to your applications</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184614.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184642.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img184736.png"></p><hr><h4 id="AWS-Outposts"><a href="#AWS-Outposts" class="headerlink" title="AWS Outposts"></a>AWS Outposts</h4><ul><li>Server Rack (ç‰©ç†å±‚é¢)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185046.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185126.png"></p><hr><h4 id="AWS-WaveLength"><a href="#AWS-WaveLength" class="headerlink" title="AWS WaveLength"></a>AWS WaveLength</h4><ul><li>5G</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185306.png"></p><hr><h4 id="AWS-Local-Zones"><a href="#AWS-Local-Zones" class="headerlink" title="AWS Local Zones"></a>AWS Local Zones</h4><ul><li>AWS Local Zones allow you to use select AWS services, like compute and storage services, closer to more end-users, providing them very low latency access to the applications running locally.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185415.png"></p><hr><h4 id="Global-Applications-Architecture"><a href="#Global-Applications-Architecture" class="headerlink" title="Global Applications Architecture"></a>Global Applications Architecture</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185706.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185814.png"></p><hr><h4 id="Summary-8"><a href="#Summary-8" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img185939.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img190014.png"></p><hr><h3 id="10-Cloud-Integration"><a href="#10-Cloud-Integration" class="headerlink" title="10.Cloud Integration"></a>10.Cloud Integration</h3><ul><li>SQSï¼ŒSNSï¼ŒKinesis</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img191712.png"></p><hr><h4 id="AWS-SQS"><a href="#AWS-SQS" class="headerlink" title="AWS SQS"></a>AWS SQS</h4><ul><li>Decouple application</li><li>Message deleted after Customer read</li><li>Guarantee message will be processed</li><li>Queue Model</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192002.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192052.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192138.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img192214.png"></p><hr><h4 id="AWS-Kinesis"><a href="#AWS-Kinesis" class="headerlink" title="AWS Kinesis"></a>AWS Kinesis</h4><ul><li>Real-time big data streaming</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200432.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200512.png"></p><hr><h4 id="AWS-SNS"><a href="#AWS-SNS" class="headerlink" title="AWS SNS"></a>AWS SNS</h4><ul><li>Send one message to many receivers</li><li>Pub&#x2F;Sub Model</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200634.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img200723.png"></p><hr><h4 id="AWS-MQ"><a href="#AWS-MQ" class="headerlink" title="AWS MQ"></a>AWS MQ</h4><ul><li>ç®¡ç†ç¬¬ä¸‰æ–¹è½¯ä»¶</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201142.png"></p><hr><h4 id="Summary-9"><a href="#Summary-9" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img201319.png"></p><hr><h3 id="11-Cloud-Monitoring"><a href="#11-Cloud-Monitoring" class="headerlink" title="11. Cloud Monitoring"></a>11. Cloud Monitoring</h3><h4 id="AWS-CloudWatch"><a href="#AWS-CloudWatch" class="headerlink" title="AWS CloudWatch"></a>AWS CloudWatch</h4><ul><li>Application performance</li><li>Resource utilization</li></ul><p>CloudWatch Metric</p><ul><li>Billing metric data is stored in the US East (N. Virginia) Region and represents worldwide charges.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img202020.png"></p><p>CloudWatch Alarms</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img202259.png"></p><p>CloudWatch Logs</p><ul><li>Use CloudWatch Logs for both the EC2 instance and the on-premises servers</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203214.png"></p><hr><h4 id="AWS-EventBridge"><a href="#AWS-EventBridge" class="headerlink" title="AWS EventBridge"></a>AWS EventBridge</h4><ul><li>å®šåˆ¶ Event æ¥è§¦å‘æŸäº›åŠŸèƒ½ (Lambdaï¼ŒSNS)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203642.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img203712.png"></p><hr><h4 id="AWS-CloudTrail"><a href="#AWS-CloudTrail" class="headerlink" title="AWS CloudTrail"></a>AWS CloudTrail</h4><ul><li>Governanceï¼Œcompliance and audit for AWS account</li><li>AWS CloudTrail Insights helps AWS users identify and respond to unusual activity associated with write API calls by continuously analyzing CloudTrail management events.</li><li>By default, AWS CloudTrail logs all management events and does not include data events or Insights events.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img064634.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img064712.png"></p><hr><h4 id="AWS-X-Ray"><a href="#AWS-X-Ray" class="headerlink" title="AWS X-Ray"></a>AWS X-Ray</h4><ul><li>You can use AWS X-Ray to analyze and debug serverless and distributed applications such as those built using a microservices architecture.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img070456.png"></p><hr><h4 id="AWS-CodeGuru"><a href="#AWS-CodeGuru" class="headerlink" title="AWS CodeGuru"></a>AWS CodeGuru</h4><ul><li>ML for code review</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img073052.png"></p><hr><h4 id="AWS-Health-Dashboard"><a href="#AWS-Health-Dashboard" class="headerlink" title="AWS Health Dashboard"></a>AWS Health Dashboard</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img073557.png"></p><hr><h4 id="Summary-10"><a href="#Summary-10" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img074126.png"></p><hr><h3 id="12-VPC-amp-Networking"><a href="#12-VPC-amp-Networking" class="headerlink" title="12. VPC &amp; Networking"></a>12. VPC &amp; Networking</h3><h4 id="AWS-VPC"><a href="#AWS-VPC" class="headerlink" title="AWS VPC"></a>AWS VPC</h4><p>IP Address in AWS</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img075533.png"></p><p>VPC &amp; Subnets</p><ul><li>VPC: Virtual Private Network</li><li>Subnets: Partition network inside VPC</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img075637.png"></p><p>Internet Gateway &amp; NAT Gateways</p><ul><li>IGW: Public</li><li>NAT: Private</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img075859.png"></p><p>Security Groups &amp; Network Access Control List (NACL)</p><ul><li>NACL: Firewall for Allow and Deny rules</li><li>Security Group: Firewall for Allow rules</li><li>A security group is stateful, that is, it automatically allows the return traffic</li><li>Security Group acts as a firewall at the instance level whereas Network Access Control List (Network ACL) acts as a firewall at the subnet level</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img080543.png"></p><p>VPC Flow Logs</p><ul><li>Capture log information</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img080849.png"></p><p>VPC Peering</p><ul><li>Connect two VPC</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img080936.png"></p><p>VPC Endpoints</p><ul><li>Access services privately</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img101047.png"></p><hr><h4 id="AWS-PrivateLink"><a href="#AWS-PrivateLink" class="headerlink" title="AWS PrivateLink"></a>AWS PrivateLink</h4><ul><li>ç¬¬ä¸‰æ–¹ VPC è¿æ¥åˆ° AWS VPC</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img101255.png"></p><hr><h4 id="Site-to-Site-VPN-amp-Direct-Connect"><a href="#Site-to-Site-VPN-amp-Direct-Connect" class="headerlink" title="Site to Site VPN &amp; Direct Connect"></a>Site to Site VPN &amp; Direct Connect</h4><ul><li>AWS Direct Connect is a cloud service solution that makes it easy to establish a dedicated network connection from your premises to AWS. </li><li>Components of AWS Site to Site VPN: Virtual private gateway (VGW)ï¼ŒCustomer gateway</li><li>A customer gateway device is a physical or software appliance on your side of a Site-to-Site VPN connection. You or your network administrator must configure the device to work with the Site-to-Site VPN connection.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img101436.png"></p><hr><h4 id="AWS-ClientVPN"><a href="#AWS-ClientVPN" class="headerlink" title="AWS ClientVPN"></a>AWS ClientVPN</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img101635.png"></p><hr><h4 id="AWS-Transit-Gateway"><a href="#AWS-Transit-Gateway" class="headerlink" title="AWS Transit Gateway"></a>AWS Transit Gateway</h4><ul><li>AWS Transit Gateway connects Amazon Virtual Private Clouds (Amazon VPC) and on-premises networks through a central hub.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img101746.png"></p><hr><h4 id="AWS-VPN"><a href="#AWS-VPN" class="headerlink" title="AWS VPN"></a>AWS VPN</h4><ul><li>AWS Virtual Private Network (VPN) solutions establish secure connections between on-premises networks, remote offices, client devices, and the AWS global network.</li></ul><hr><h4 id="Summary-11"><a href="#Summary-11" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img101912.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img102013.png"></p><hr><h3 id="13-Security-amp-Compliance"><a href="#13-Security-amp-Compliance" class="headerlink" title="13. Security &amp; Compliance"></a>13. Security &amp; Compliance</h3><h4 id="AWS-WAF-amp-Shield"><a href="#AWS-WAF-amp-Shield" class="headerlink" title="AWS WAF &amp; Shield"></a>AWS WAF &amp; Shield</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img103546.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img103621.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img103650.png"></p><p>AWS Shield</p><ul><li>é˜²æ­¢ DDoS æ”»å‡»</li><li>Shield Advance ç”¨åœ¨ Route53 å’Œ AWS Global Accelerator ä¸Š</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img103738.png"></p><p>AWS WAF</p><ul><li>Define Web ACL (Access Control List)</li><li>Can be deployed on Amazon CloudFront, Application Load Balancer, Amazon API Gateway, AWS AppSync</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img103839.png"></p><hr><h4 id="AWS-Network-Firewall"><a href="#AWS-Network-Firewall" class="headerlink" title="AWS Network Firewall"></a>AWS Network Firewall</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img103945.png"></p><hr><h4 id="AWS-Firewall-Manager"><a href="#AWS-Firewall-Manager" class="headerlink" title="AWS Firewall Manager"></a>AWS Firewall Manager</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img105934.png"></p><hr><h4 id="AWS-KMS-amp-CloudHSM"><a href="#AWS-KMS-amp-CloudHSM" class="headerlink" title="AWS KMS &amp; CloudHSM"></a>AWS KMS &amp; CloudHSM</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img120236.png"></p><p>KMS: Manage Encryption keys</p><ul><li>Use AWS managed master keys that are automatically created in your account for each service</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img120343.png"></p><p>CloudHSM: Encryption Hardware (ç‰©ç†å±‚é¢)</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img120433.png"></p><hr><h4 id="AWS-ACM"><a href="#AWS-ACM" class="headerlink" title="AWS ACM"></a>AWS ACM</h4><ul><li>Manage certificates</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img124350.png"></p><hr><h4 id="AWS-Secrets-Manager"><a href="#AWS-Secrets-Manager" class="headerlink" title="AWS Secrets Manager"></a>AWS Secrets Manager</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img124445.png"></p><hr><h4 id="AWS-Artifact"><a href="#AWS-Artifact" class="headerlink" title="AWS Artifact"></a>AWS Artifact</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img124706.png"></p><hr><h4 id="AWS-GuardDuty"><a href="#AWS-GuardDuty" class="headerlink" title="AWS GuardDuty"></a>AWS GuardDuty</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img125533.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img125621.png"></p><hr><h4 id="AWS-Inspector"><a href="#AWS-Inspector" class="headerlink" title="AWS Inspector"></a>AWS Inspector</h4><ul><li>Amazon Inspector is an automated security assessment service that helps improve the security and compliance of applications deployed on AWS. </li><li>Only for EC2, Container Image &amp; Lambda</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img125801.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img125844.png"></p><hr><h4 id="AWS-Config"><a href="#AWS-Config" class="headerlink" title="AWS Config"></a>AWS Config</h4><ul><li>AWS Config is a service that enables you to assess, audit, and evaluate the configurations of your AWS resources.</li><li>Think resource-specific history, audit, and compliance; think Config.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img125948.png"></p><hr><h4 id="AWS-Macie"><a href="#AWS-Macie" class="headerlink" title="AWS Macie"></a>AWS Macie</h4><ul><li>Find sensitive data</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img130515.png"></p><hr><h4 id="AWS-Security-Hub"><a href="#AWS-Security-Hub" class="headerlink" title="AWS Security Hub"></a>AWS Security Hub</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img131533.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img131605.png"></p><hr><h4 id="AWS-Detective"><a href="#AWS-Detective" class="headerlink" title="AWS Detective"></a>AWS Detective</h4><ul><li>Analyze AWS CloudTrail logs, Amazon VPC Flow Logs, and Amazon GuardDuty findings</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img132824.png"></p><hr><h4 id="IAM-Access-Analyzer"><a href="#IAM-Access-Analyzer" class="headerlink" title="IAM Access Analyzer"></a>IAM Access Analyzer</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img133559.png"></p><hr><h4 id="Summary-12"><a href="#Summary-12" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img152124.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img155139.png"></p><hr><h3 id="14-Machine-Learning"><a href="#14-Machine-Learning" class="headerlink" title="14. Machine Learning"></a>14. Machine Learning</h3><h4 id="AWS-Rekognition"><a href="#AWS-Rekognition" class="headerlink" title="AWS Rekognition"></a>AWS Rekognition</h4><ul><li>Find text or image using ML</li><li>Regional in scope</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img164327.png"></p><hr><h4 id="AWS-Transcribe"><a href="#AWS-Transcribe" class="headerlink" title="AWS Transcribe"></a>AWS Transcribe</h4><ul><li>Convert speech to text</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img164826.png"></p><hr><h4 id="Amazon-Elastic-Transcoder"><a href="#Amazon-Elastic-Transcoder" class="headerlink" title="Amazon Elastic Transcoder"></a>Amazon Elastic Transcoder</h4><ul><li>Amazon Elastic Transcoder lets you convert media files that you have stored in Amazon Simple Storage Service (Amazon S3) into media files in the formats required by consumer playback devices.</li></ul><hr><h4 id="AWS-Polly"><a href="#AWS-Polly" class="headerlink" title="AWS Polly"></a>AWS Polly</h4><ul><li>Convert text to speech</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img165059.png"></p><hr><h4 id="AWS-Translate"><a href="#AWS-Translate" class="headerlink" title="AWS Translate"></a>AWS Translate</h4><ul><li>Translate language</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img171433.png"></p><hr><h4 id="AWS-Lex-amp-Connect"><a href="#AWS-Lex-amp-Connect" class="headerlink" title="AWS Lex &amp; Connect"></a>AWS Lex &amp; Connect</h4><p>Lex: Conversational bots<br>Connect: Cloud contact center</p><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img171703.png"></p><hr><h4 id="AWS-Comprehend"><a href="#AWS-Comprehend" class="headerlink" title="AWS Comprehend"></a>AWS Comprehend</h4><ul><li>NLP</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img171904.png"></p><hr><h4 id="AWS-SageMaker"><a href="#AWS-SageMaker" class="headerlink" title="AWS SageMaker"></a>AWS SageMaker</h4><ul><li>Build ML</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175503.png"></p><hr><h4 id="AWS-Forecast"><a href="#AWS-Forecast" class="headerlink" title="AWS Forecast"></a>AWS Forecast</h4><ul><li>Forecast things using ML</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img180029.png"></p><hr><h4 id="AWS-Kendra"><a href="#AWS-Kendra" class="headerlink" title="AWS Kendra"></a>AWS Kendra</h4><ul><li>Document search service</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img180235.png"></p><hr><h4 id="AWS-Personalize"><a href="#AWS-Personalize" class="headerlink" title="AWS Personalize"></a>AWS Personalize</h4><ul><li>Personal Recommendation</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img180943.png"></p><hr><h4 id="AWS-Textract"><a href="#AWS-Textract" class="headerlink" title="AWS Textract"></a>AWS Textract</h4><ul><li>Extract text</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img181533.png"></p><hr><h4 id="Summary-13"><a href="#Summary-13" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img181025.png"></p><hr><h3 id="15-Account-Managementï¼ŒBilling-amp-Support"><a href="#15-Account-Managementï¼ŒBilling-amp-Support" class="headerlink" title="15. Account Managementï¼ŒBilling &amp; Support"></a>15. Account Managementï¼ŒBilling &amp; Support</h3><h4 id="AWS-Organization"><a href="#AWS-Organization" class="headerlink" title="AWS Organization"></a>AWS Organization</h4><ul><li>Manage multiple AWS accounts</li><li>Consolidated Billing</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img215935.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img220144.png"></p><hr><h4 id="AWS-Control-Tower"><a href="#AWS-Control-Tower" class="headerlink" title="AWS Control Tower"></a>AWS Control Tower</h4><ul><li>Running on top of AWS Organization</li><li>AWS Control Tower is an AWS native service providing a pre-defined set of blueprints and guardrails to help customers implement a landing zone for new AWS accounts</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230602.png"></p><hr><h4 id="AWS-Service-Catalog"><a href="#AWS-Service-Catalog" class="headerlink" title="AWS Service Catalog"></a>AWS Service Catalog</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img230820.png"></p><hr><h4 id="Pricing-Models-in-AWS"><a href="#Pricing-Models-in-AWS" class="headerlink" title="Pricing Models in AWS"></a>Pricing Models in AWS</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img231117.png"></p><hr><h4 id="AWS-Compute-Optimizer"><a href="#AWS-Compute-Optimizer" class="headerlink" title="AWS Compute Optimizer"></a>AWS Compute Optimizer</h4><ul><li>Reduce cost and improve performance</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img232258.png"></p><hr><h4 id="Cost-Allocation-Tags"><a href="#Cost-Allocation-Tags" class="headerlink" title="Cost Allocation Tags"></a>Cost Allocation Tags</h4><ul><li>For each resource, each tag key must be unique, and each tag key can have only one value</li><li>You must activate both AWS generated tags and user-defined tags separately before they can appear in Cost Explorer or on a cost allocation report</li></ul><hr><h4 id="AWS-Budgets"><a href="#AWS-Budgets" class="headerlink" title="AWS Budgets"></a>AWS Budgets</h4><ul><li>Create alarm when exceed budget</li><li>Budget Types: Cost budgetï¼ŒUsage budgetï¼ŒReservation budget </li><li>AWS Budgets gives you the ability to set custom budgets that alert you when your costs or usage exceed (or are forecasted to exceed) your budgeted amount.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233133.png"></p><hr><h4 id="AWS-Pricing-Calculator"><a href="#AWS-Pricing-Calculator" class="headerlink" title="AWS Pricing Calculator"></a>AWS Pricing Calculator</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img075527.png"></p><hr><h4 id="Cost-and-Usage-Reports"><a href="#Cost-and-Usage-Reports" class="headerlink" title="Cost and Usage Reports"></a>Cost and Usage Reports</h4><ul><li>AWS Cost &amp; Usage Report (AWS CUR) contains the most comprehensive set of cost and usage data available.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img075737.png"></p><hr><h4 id="Cost-Explorer"><a href="#Cost-Explorer" class="headerlink" title="Cost Explorer"></a>Cost Explorer</h4><ul><li>AWS Cost Explorer has an easy-to-use interface that lets you visualize, understand, and manage your AWS costs and usage over time.</li><li>Can be used to forecast your AWS account usage and costs</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img075833.png"></p><hr><h4 id="AWS-Trusted-Advisor"><a href="#AWS-Trusted-Advisor" class="headerlink" title="AWS Trusted Advisor"></a>AWS Trusted Advisor</h4><ul><li>AWS Trusted Advisor is an online tool that provides you real-time guidance to help you provision your resources following AWS best practices on cost optimization</li><li>Identify unattached or underutilized EBS volumes</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233600.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175558.png"></p><hr><h4 id="AWS-Service-Quotas"><a href="#AWS-Service-Quotas" class="headerlink" title="AWS Service Quotas"></a>AWS Service Quotas</h4><ul><li>Service Quotas enables you to view and manage your quotas for AWS services from a central location.</li></ul><hr><h4 id="AWS-Support-Plans-Pricing"><a href="#AWS-Support-Plans-Pricing" class="headerlink" title="AWS Support Plans Pricing"></a>AWS Support Plans Pricing</h4><ul><li>Freeï¼ŒDeveloperï¼ŒBusinessï¼ŒEnterprise On-Rampï¼ŒEnterprise</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img233819.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234952.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img235020.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img235048.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img235117.png"></p><hr><h4 id="Summary-14"><a href="#Summary-14" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234240.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img234349.png"></p><hr><h3 id="16-Adavanced-Identity"><a href="#16-Adavanced-Identity" class="headerlink" title="16. Adavanced Identity"></a>16. Adavanced Identity</h3><h4 id="AWS-STS"><a href="#AWS-STS" class="headerlink" title="AWS STS"></a>AWS STS</h4><ul><li>Security Token Service</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img072649.png"></p><hr><h4 id="AWS-Cognito"><a href="#AWS-Cognito" class="headerlink" title="AWS Cognito"></a>AWS Cognito</h4><ul><li>å¤„ç†ç”¨æˆ·ç™»å½• (Googleï¼ŒFacebook)</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img072756.png"></p><hr><h4 id="AWS-IAM-Identity-Center"><a href="#AWS-IAM-Identity-Center" class="headerlink" title="AWS IAM Identity Center"></a>AWS IAM Identity Center</h4><ul><li>One login for multiple accounts</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img073056.png"></p><hr><h4 id="Summary-15"><a href="#Summary-15" class="headerlink" title="Summary"></a>Summary</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img073540.png"></p><hr><h3 id="17-Other-AWS-Services"><a href="#17-Other-AWS-Services" class="headerlink" title="17. Other AWS Services"></a>17. Other AWS Services</h3><h4 id="AWS-WorkSpace"><a href="#AWS-WorkSpace" class="headerlink" title="AWS WorkSpace"></a>AWS WorkSpace</h4><ul><li>Global cloud-based products</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img083303.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img083335.png"></p><hr><h4 id="AWS-AppStream"><a href="#AWS-AppStream" class="headerlink" title="AWS AppStream"></a>AWS AppStream</h4><ul><li>Deliver application within web</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img083422.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img083502.png"></p><hr><h4 id="AWS-IoT"><a href="#AWS-IoT" class="headerlink" title="AWS IoT"></a>AWS IoT</h4><ul><li>ç‰©è”ç½‘</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img083607.png"></p><hr><h4 id="AWS-AppSync"><a href="#AWS-AppSync" class="headerlink" title="AWS AppSync"></a>AWS AppSync</h4><ul><li>GraphQL</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img083702.png"></p><hr><h4 id="AWS-Amplify"><a href="#AWS-Amplify" class="headerlink" title="AWS Amplify"></a>AWS Amplify</h4><ul><li>Deploy fullstack web or mobile app</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img085244.png"></p><hr><h4 id="AWS-Application-Composer"><a href="#AWS-Application-Composer" class="headerlink" title="AWS Application Composer"></a>AWS Application Composer</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img085340.png"></p><hr><h4 id="AWS-Device-Farm"><a href="#AWS-Device-Farm" class="headerlink" title="AWS Device Farm"></a>AWS Device Farm</h4><ul><li>Test web app in different devices</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img085508.png"></p><hr><h4 id="AWS-Backup"><a href="#AWS-Backup" class="headerlink" title="AWS Backup"></a>AWS Backup</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img085539.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img085603.png"></p><hr><h4 id="Disaster-Recovery-Strategies"><a href="#Disaster-Recovery-Strategies" class="headerlink" title="Disaster Recovery Strategies"></a>Disaster Recovery Strategies</h4><ul><li>æœ€ä¾¿å®œ: Back and Restore</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img085705.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img085729.png"></p><hr><h4 id="AWS-DRS"><a href="#AWS-DRS" class="headerlink" title="AWS DRS"></a>AWS DRS</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img085904.png"></p><hr><h4 id="AWS-DataSync"><a href="#AWS-DataSync" class="headerlink" title="AWS DataSync"></a>AWS DataSync</h4><ul><li>Incremental</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img085958.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img090038.png"></p><hr><h4 id="AWS-Application-Discovery-Service"><a href="#AWS-Application-Discovery-Service" class="headerlink" title="AWS Application Discovery Service"></a>AWS Application Discovery Service</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img090147.png"></p><hr><h4 id="AWS-Application-Migration-Service"><a href="#AWS-Application-Migration-Service" class="headerlink" title="AWS Application Migration Service"></a>AWS Application Migration Service</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img090259.png"></p><hr><h4 id="AWS-Migration-Hub"><a href="#AWS-Migration-Hub" class="headerlink" title="AWS Migration Hub"></a>AWS Migration Hub</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img090459.png"></p><hr><h4 id="AWS-Migration-Evaluator"><a href="#AWS-Migration-Evaluator" class="headerlink" title="AWS Migration Evaluator"></a>AWS Migration Evaluator</h4><ul><li>AWS Migration Evaluator (Formerly TSO Logic) is a complimentary service to create data-driven business cases for AWS Cloud planning and migration.</li></ul><hr><h4 id="AWS-FIS"><a href="#AWS-FIS" class="headerlink" title="AWS FIS"></a>AWS FIS</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img090535.png"></p><hr><h4 id="AWS-Step-Functions"><a href="#AWS-Step-Functions" class="headerlink" title="AWS Step Functions"></a>AWS Step Functions</h4><ul><li>Serverless</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img090614.png"></p><hr><h4 id="AWS-Ground-Station"><a href="#AWS-Ground-Station" class="headerlink" title="AWS Ground Station"></a>AWS Ground Station</h4><ul><li>Satellite</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img090709.png"></p><hr><h4 id="AWS-Pinpoint"><a href="#AWS-Pinpoint" class="headerlink" title="AWS Pinpoint"></a>AWS Pinpoint</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img090818.png"></p><hr><h4 id="AWS-Systems-Manager"><a href="#AWS-Systems-Manager" class="headerlink" title="AWS Systems Manager"></a>AWS Systems Manager</h4><ul><li>AWS Systems Manager allows you to centralize operational data from multiple AWS services and automate tasks across your AWS resources.</li><li>Get operational insights of its resources to quickly identify any issues that might impact applications using those resources</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img075954.png"></p><hr><h4 id="AWS-Systems-Manager-Session-Manager-SSM"><a href="#AWS-Systems-Manager-Session-Manager-SSM" class="headerlink" title="AWS Systems Manager Session Manager (SSM)"></a>AWS Systems Manager Session Manager (SSM)</h4><ul><li>AWS SSM Session Manager is a fully-managed service that provides you with an interactive browser-based shell and CLI experience.</li><li>Runs on a fleet of Amazon EC2 instances</li></ul><hr><h4 id="AWS-SSO"><a href="#AWS-SSO" class="headerlink" title="AWS SSO"></a>AWS SSO</h4><ul><li>AWS SSO is an AWS service that enables you to makes it easy to centrally manage access to multiple AWS accounts and business applications and provide users with single sign-on access to all their assigned accounts and applications from one place.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img080225.png"></p><hr><h4 id="AWS-Quick-Starts-references"><a href="#AWS-Quick-Starts-references" class="headerlink" title="AWS Quick Starts references"></a>AWS Quick Starts references</h4><ul><li>Quick Starts are built by AWS solutions architects and partners to help you deploy popular technologies on AWS, based on AWS best practices for security and high availability.</li></ul><hr><h4 id="APN-Consulting-Partner"><a href="#APN-Consulting-Partner" class="headerlink" title="APN Consulting Partner"></a>APN Consulting Partner</h4><ul><li>APN Consulting Partners are professional services firms that help customers of all types and sizes design, architect, build, migrate, and manage their workloads and applications on AWS, accelerating their migration to AWS cloud.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img080758.png"></p><hr><h4 id="Penetration-Testing"><a href="#Penetration-Testing" class="headerlink" title="Penetration Testing"></a>Penetration Testing</h4><ul><li>AWS customers can carry out security assessments or penetration tests against their AWS infrastructure without prior approval for few common AWS services.</li></ul><hr><h4 id="AWS-Personal-Health-Dashboard"><a href="#AWS-Personal-Health-Dashboard" class="headerlink" title="AWS Personal Health Dashboard"></a>AWS Personal Health Dashboard</h4><ul><li>AWS Personal Health Dashboard provides alerts and remediation guidance when AWS is experiencing events that may impact you.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img083000.png"></p><hr><h4 id="AWS-Service-Health-Dashboard"><a href="#AWS-Service-Health-Dashboard" class="headerlink" title="AWS Service Health Dashboard"></a>AWS Service Health Dashboard</h4><ul><li>AWS Service Health Dashboard publishes most up-to-the-minute information on the status and availability of all AWS services in tabular form for all Regions that AWS is present in.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img083127.png"></p><hr><h4 id="AWS-Marketplace"><a href="#AWS-Marketplace" class="headerlink" title="AWS Marketplace"></a>AWS Marketplace</h4><ul><li>Sell Software as a Service (SaaS) solutions to AWS customers</li><li>AWS customer can buy software that has been bundled into customized AMIs by the AWS Marketplace sellers</li></ul><hr><h4 id="AWS-Service-Catalog-1"><a href="#AWS-Service-Catalog-1" class="headerlink" title="AWS Service Catalog"></a>AWS Service Catalog</h4><ul><li>AWS Service Catalog allows organizations to create and manage catalogs of IT services that are approved for use on AWS.</li></ul><hr><h4 id="AWS-Well-Architected-Tool"><a href="#AWS-Well-Architected-Tool" class="headerlink" title="AWS Well-Architected Tool"></a>AWS Well-Architected Tool</h4><ul><li>The AWS Well-Architected Tool helps you review the state of your workloads and compares them to the latest AWS architectural best practices.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img175558.png"></p><hr><h4 id="AWS-Resource-Groups"><a href="#AWS-Resource-Groups" class="headerlink" title="AWS Resource Groups"></a>AWS Resource Groups</h4><ul><li>You can use AWS Resource Groups to organize your AWS resources. Resource groups make it easier to manage and automate tasks on large numbers of resources at a time.</li></ul><hr><h4 id="AWS-Cloud-Foundations"><a href="#AWS-Cloud-Foundations" class="headerlink" title="AWS Cloud Foundations"></a>AWS Cloud Foundations</h4><ul><li>Cloud Foundations provides a guided path to help customers deploy, configure, and secure their new workloads while ensuring they are ready for on-going operations in the cloud.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img170401.png"></p><hr><h4 id="Credentials-Report"><a href="#Credentials-Report" class="headerlink" title="Credentials Report"></a>Credentials Report</h4><ul><li>You can generate and download a credentials report that lists all users in your account and the status of their various credentials, including passwords, access keys, and MFA devices.</li></ul><hr><h4 id="CloudEndure-Disaster-Recovery"><a href="#CloudEndure-Disaster-Recovery" class="headerlink" title="CloudEndure Disaster Recovery"></a>CloudEndure Disaster Recovery</h4><ul><li>CloudEndure Disaster Recovery enables you to use AWS Cloud as a disaster recovery Region for an on-premises workload and its environment.</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img091100.png"></p><hr><h3 id="18-AWS-Architecting-amp-Ecosystem"><a href="#18-AWS-Architecting-amp-Ecosystem" class="headerlink" title="18. AWS Architecting &amp; Ecosystem"></a>18. AWS Architecting &amp; Ecosystem</h3><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img091239.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img091320.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img091347.png"></p><hr><h4 id="Operation-Excellence"><a href="#Operation-Excellence" class="headerlink" title="Operation Excellence"></a>Operation Excellence</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img091439.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img091513.png"></p><hr><h4 id="Security"><a href="#Security" class="headerlink" title="Security"></a>Security</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img091656.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img091735.png"></p><hr><h4 id="Reliability"><a href="#Reliability" class="headerlink" title="Reliability"></a>Reliability</h4><ul><li>AWS Configï¼ŒAWS CloudTrailï¼ŒAmazon CloudWatch</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img091813.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img091848.png"></p><hr><h4 id="Performance-Efficiency"><a href="#Performance-Efficiency" class="headerlink" title="Performance Efficiency"></a>Performance Efficiency</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img091927.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img091956.png"></p><hr><h4 id="Cost-Optimization"><a href="#Cost-Optimization" class="headerlink" title="Cost Optimization"></a>Cost Optimization</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img092031.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img092058.png"></p><hr><h4 id="Sustainability"><a href="#Sustainability" class="headerlink" title="Sustainability"></a>Sustainability</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img092133.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img092201.png"></p><hr><h4 id="Cloud-Adoption-Framework-CAF"><a href="#Cloud-Adoption-Framework-CAF" class="headerlink" title="Cloud Adoption Framework (CAF)"></a>Cloud Adoption Framework (CAF)</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img092346.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img092416.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img092445.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151051.png"><br><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img151120.png"></p><hr><h4 id="AWS-IQ"><a href="#AWS-IQ" class="headerlink" title="AWS IQ"></a>AWS IQ</h4><ul><li>æ‰¾äººå¸®å¿™</li></ul><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img092907.png"></p><hr><h4 id="AWS-AMS"><a href="#AWS-AMS" class="headerlink" title="AWS AMS"></a>AWS AMS</h4><p><img src="https://raw.githubusercontent.com/Hongda-OSU/PicGo-2.3.1/master/img093104.png"></p><hr><h3 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h3><blockquote><p>è¯·å‹¿éšæ„ä¿®æ”¹ï¼Œè°¢è°¢</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Certification </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯ åˆ‡å›¾ä»”</title>
      <link href="/posts/bfacd5b7.html"/>
      <url>/posts/bfacd5b7.html</url>
      
        <content type="html"><![CDATA[<h3 id="æ»šåŠ¨è§†å·®"><a href="#æ»šåŠ¨è§†å·®" class="headerlink" title="æ»šåŠ¨è§†å·®"></a>æ»šåŠ¨è§†å·®</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/fnhrbse2/101/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="æ‰“å­—æ•ˆæœ"><a href="#æ‰“å­—æ•ˆæœ" class="headerlink" title="æ‰“å­—æ•ˆæœ"></a>æ‰“å­—æ•ˆæœ</h3><p>ä»å‰åç«¯çš„è§’åº¦åº”è¯¥ç”¨ Stream æ¥åš</p><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/qgaywfs8/55/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><iframe src="https://codesandbox.io/embed/fw94fg?view=preview&module=%2Fsrc%2Findex.js"     style="width:100%; height: 500px; border:0; border-radius: 4px; overflow:hidden;"     title="inspiring-violet"     allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"     sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"   ></iframe><h3 id="3D-å¡ç‰‡æ•ˆæœ"><a href="#3D-å¡ç‰‡æ•ˆæœ" class="headerlink" title="3D å¡ç‰‡æ•ˆæœ"></a>3D å¡ç‰‡æ•ˆæœ</h3><p>Reference: <code>https://www.cnblogs.com/coco1s/p/17979602</code></p><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/cswk73b2/41/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><iframe src="https://codesandbox.io/embed/cwy6d7?view=preview&module=%2Fsrc%2FCard.js"     style="width:100%; height: 500px; border:0; border-radius: 4px; overflow:hidden;"     title="crazy-lumiere-cwy6d7"     allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"     sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"   ></iframe><h3 id="å¡ç‰‡æ•ˆæœ"><a href="#å¡ç‰‡æ•ˆæœ" class="headerlink" title="å¡ç‰‡æ•ˆæœ"></a>å¡ç‰‡æ•ˆæœ</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/9czbrops/46/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="ä¸‹åˆ’çº¿ç‰¹æ•ˆ"><a href="#ä¸‹åˆ’çº¿ç‰¹æ•ˆ" class="headerlink" title="ä¸‹åˆ’çº¿ç‰¹æ•ˆ"></a>ä¸‹åˆ’çº¿ç‰¹æ•ˆ</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/xpq1g3eu/63/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="Zoom-æ•ˆæœ"><a href="#Zoom-æ•ˆæœ" class="headerlink" title="Zoom æ•ˆæœ"></a>Zoom æ•ˆæœ</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/cpuLzsfm/137/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="è§†é¢‘èƒŒæ™¯"><a href="#è§†é¢‘èƒŒæ™¯" class="headerlink" title="è§†é¢‘èƒŒæ™¯"></a>è§†é¢‘èƒŒæ™¯</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/wdehmqgp/50/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="å¤´åƒç‰¹æ•ˆ"><a href="#å¤´åƒç‰¹æ•ˆ" class="headerlink" title="å¤´åƒç‰¹æ•ˆ"></a>å¤´åƒç‰¹æ•ˆ</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/56y0gqzw/37/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="é¼ æ ‡æ•ˆæœ"><a href="#é¼ æ ‡æ•ˆæœ" class="headerlink" title="é¼ æ ‡æ•ˆæœ"></a>é¼ æ ‡æ•ˆæœ</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/qxndvehu/21/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/8trua6n4/16/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><iframe src="https://codesandbox.io/embed/fgrc6y?view=preview&module=%2Fsrc%2Fstyles.css"     style="width:100%; height: 500px; border:0; border-radius: 4px; overflow:hidden;"     title="é¼ æ ‡ç‰¹æ•ˆ"     allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"     sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"   ></iframe><h3 id="å›¾ç‰‡å€’å½±"><a href="#å›¾ç‰‡å€’å½±" class="headerlink" title="å›¾ç‰‡å€’å½±"></a>å›¾ç‰‡å€’å½±</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/v5Loj9b1/74/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="å™ªéŸ³"><a href="#å™ªéŸ³" class="headerlink" title="å™ªéŸ³"></a>å™ªéŸ³</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/ksyx497p/4/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="ç®€å•å›¾ç‰‡å †å "><a href="#ç®€å•å›¾ç‰‡å †å " class="headerlink" title="ç®€å•å›¾ç‰‡å †å "></a>ç®€å•å›¾ç‰‡å †å </h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/sfc0anmu/85/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="è§†å·®æ»šåŠ¨"><a href="#è§†å·®æ»šåŠ¨" class="headerlink" title="è§†å·®æ»šåŠ¨"></a>è§†å·®æ»šåŠ¨</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/28rnshqx/88/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="äººæ½®æ±¹æ¶Œ"><a href="#äººæ½®æ±¹æ¶Œ" class="headerlink" title="äººæ½®æ±¹æ¶Œ"></a>äººæ½®æ±¹æ¶Œ</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/dyhzrxpm/35/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="æ–‡å­—ç‰¹æ•ˆ"><a href="#æ–‡å­—ç‰¹æ•ˆ" class="headerlink" title="æ–‡å­—ç‰¹æ•ˆ"></a>æ–‡å­—ç‰¹æ•ˆ</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/0ezmgf81/253/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="å›¾ç‰‡æ¶ˆå¤±"><a href="#å›¾ç‰‡æ¶ˆå¤±" class="headerlink" title="å›¾ç‰‡æ¶ˆå¤±"></a>å›¾ç‰‡æ¶ˆå¤±</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/e9kzqtop/228/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="å¥‡æ€ªçš„ç‰¹æ•ˆ"><a href="#å¥‡æ€ªçš„ç‰¹æ•ˆ" class="headerlink" title="å¥‡æ€ªçš„ç‰¹æ•ˆ"></a>å¥‡æ€ªçš„ç‰¹æ•ˆ</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/cyL2t579/34/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="æ¨ªå¹…æ•ˆæœ"><a href="#æ¨ªå¹…æ•ˆæœ" class="headerlink" title="æ¨ªå¹…æ•ˆæœ"></a>æ¨ªå¹…æ•ˆæœ</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/s8r6qtmg/153/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="Hover-æ•ˆæœ"><a href="#Hover-æ•ˆæœ" class="headerlink" title="Hover æ•ˆæœ"></a>Hover æ•ˆæœ</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/bf476zy1/11/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/ok27hLs1/8/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/fw9reojc/105/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/anumv6g4/87/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="Dragable"><a href="#Dragable" class="headerlink" title="Dragable"></a>Dragable</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/x4s5dnrq/74/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="æ— é™å›¾ç‰‡"><a href="#æ— é™å›¾ç‰‡" class="headerlink" title="æ— é™å›¾ç‰‡"></a>æ— é™å›¾ç‰‡</h3><iframe src="https://codesandbox.io/embed/k98xf4?view=Editor+%2B+Preview&module=%2Fstyles.css"     style="width:100%; height: 500px; border:0; border-radius: 4px; overflow:hidden;"     title="reverent-benz (forked)"     allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"     sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"   ></iframe><h3 id="ç¥å…‰"><a href="#ç¥å…‰" class="headerlink" title="ç¥å…‰"></a>ç¥å…‰</h3><iframe width="100%" height="400px" src="//jsfiddle.net/HDL52/cLmaf6tu/60/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe><h3 id="kokomi-js-ç”¨ä¾‹"><a href="#kokomi-js-ç”¨ä¾‹" class="headerlink" title="kokomi.js ç”¨ä¾‹"></a>kokomi.js ç”¨ä¾‹</h3><iframe src="https://codesandbox.io/embed/p4xxc9?view=Editor+%2B+Preview&module=%2Findex.html"     style="width:100%; height: 500px; border:0; border-radius: 4px; overflow:hidden;"     title="inspiring-violet"     allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"     sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"   ></iframe><h3 id="è·‘é©¬ç¯æ•ˆæœ"><a href="#è·‘é©¬ç¯æ•ˆæœ" class="headerlink" title="è·‘é©¬ç¯æ•ˆæœ"></a>è·‘é©¬ç¯æ•ˆæœ</h3><h3 id="å­—ä½“ç¿»è½¬"><a href="#å­—ä½“ç¿»è½¬" class="headerlink" title="å­—ä½“ç¿»è½¬"></a>å­—ä½“ç¿»è½¬</h3><iframe src="https://codesandbox.io/embed/xhs6ws?view=preview&module=%2Fsrc%2FApp.js&hidenavigation=1"     style="width:100%; height: 500px; border:0; border-radius: 4px; overflow:hidden;"     title="ç¿»è½¬"     allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"     sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"   ></iframe><h3 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h3><blockquote><p>è¯·å‹¿éšæ„ä¿®æ”¹ï¼Œè°¢è°¢</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ç»ƒä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³• Algorithm â€¢ ä¸‹</title>
      <link href="/posts/3b015f5e.html"/>
      <url>/posts/3b015f5e.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>æœ¬è¯»ä¹¦ç¬”è®°èŠ‚é€‰è‡ª<code>krahets</code>å¤§ä½¬ç¼–å†™çš„<a href="https://www.hello-algo.com/">ã€ŠHello ç®—æ³•ã€‹</a>ã€‚å‹‰åŠ±è‡ªå·±å¼€å§‹ç³»ç»Ÿçš„ç®—æ³•å­¦ä¹ ã€‚</p></blockquote><hr><h2 id="10-æœç´¢"><a href="#10-æœç´¢" class="headerlink" title="10. æœç´¢"></a>10. æœç´¢</h2><h3 id="10-1-äºŒåˆ†æŸ¥æ‰¾"><a href="#10-1-äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="10.1 äºŒåˆ†æŸ¥æ‰¾"></a>10.1 äºŒåˆ†æŸ¥æ‰¾</h3><p>ã€ŒäºŒåˆ†æŸ¥æ‰¾<code>binary search</code>ã€æ˜¯ä¸€ç§åŸºäºåˆ†æ²»ç­–ç•¥çš„é«˜æ•ˆæœç´¢ç®—æ³•ã€‚å®ƒåˆ©ç”¨æ•°æ®çš„æœ‰åºæ€§ï¼Œæ¯è½®å‡å°‘ä¸€åŠæœç´¢èŒƒå›´ï¼Œç›´è‡³æ‰¾åˆ°ç›®æ ‡å…ƒç´ æˆ–æœç´¢åŒºé—´ä¸ºç©ºä¸ºæ­¢ã€‚</p><blockquote><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º<code>n</code>çš„æ•°ç»„<code>nums</code>ï¼Œå…ƒç´ æŒ‰ä»å°åˆ°å¤§çš„é¡ºåºæ’åˆ—ï¼Œæ•°ç»„ä¸åŒ…å«é‡å¤å…ƒç´ ã€‚è¯·æŸ¥æ‰¾å¹¶è¿”å›å…ƒç´ <code>target</code>åœ¨è¯¥æ•°ç»„ä¸­çš„ç´¢å¼•ã€‚è‹¥æ•°ç»„ä¸åŒ…å«è¯¥å…ƒç´ ï¼Œåˆ™è¿”å›<code>-1</code>ã€‚</p></blockquote><p><img src="https://www.hello-algo.com/chapter_searching/binary_search.assets/binary_search_example.png"></p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…ˆåˆå§‹åŒ–æŒ‡é’ˆ<code>i = 0</code>å’Œ<code>j = n - 1</code>ï¼Œåˆ†åˆ«æŒ‡å‘æ•°ç»„é¦–å…ƒç´ å’Œå°¾å…ƒç´ ï¼Œä»£è¡¨æœç´¢åŒºé—´<code>[0, n - 1]</code>ã€‚è¯·æ³¨æ„ï¼Œä¸­æ‹¬å·è¡¨ç¤ºé—­åŒºé—´ï¼Œå…¶åŒ…å«è¾¹ç•Œå€¼æœ¬èº«ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œå¾ªç¯æ‰§è¡Œä»¥ä¸‹ä¸¤æ­¥ã€‚</p><ul><li>è®¡ç®—ä¸­ç‚¹ç´¢å¼•<code>m = [(i + j) / 2]</code>ï¼Œå…¶ä¸­<code>[]</code>è¡¨ç¤ºå‘ä¸‹å–æ•´æ“ä½œã€‚</li><li>åˆ¤æ–­<code>nums[m]</code>å’Œ<code>target</code>çš„å¤§å°å…³ç³»ï¼Œåˆ†ä¸ºä»¥ä¸‹ä¸‰ç§æƒ…å†µã€‚<ul><li>å½“<code>nums[m] &lt; target</code>æ—¶ï¼Œè¯´æ˜<code>target</code>åœ¨åŒºé—´<code>[m + 1, j]</code>ä¸­ï¼Œæ‰§è¡Œ<code>i = m + 1</code>ã€‚</li><li>å½“<code>nums[m] &gt; target</code>æ—¶ï¼Œè¯´æ˜<code>target</code>åœ¨åŒºé—´<code>[i, m - 1]</code>ä¸­ï¼Œæ‰§è¡Œ<code>j = m - 1</code>ã€‚</li><li>å½“<code>nums[m] = target</code>æ—¶ï¼Œè¯´æ˜æ‰¾åˆ°<code>target</code>ï¼Œå› æ­¤è¿”å›ç´¢å¼•<code>m</code>ã€‚</li></ul></li></ul><p>è‹¥æ•°ç»„ä¸åŒ…å«ç›®æ ‡å…ƒç´ ï¼Œæœç´¢åŒºé—´æœ€ç»ˆä¼šç¼©å°ä¸ºç©ºã€‚æ­¤æ—¶è¿”å›<code>-1</code>ã€‚</p><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1"><1></button></li><li class="tab"><button type="button" data-href="#placeholder-2"><2></button></li><li class="tab"><button type="button" data-href="#placeholder-3"><3></button></li><li class="tab"><button type="button" data-href="#placeholder-4"><4></button></li><li class="tab"><button type="button" data-href="#placeholder-5"><5></button></li><li class="tab"><button type="button" data-href="#placeholder-6"><6></button></li><li class="tab"><button type="button" data-href="#placeholder-7"><7></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_searching/binary_search.assets/binary_search_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_searching/binary_search.assets/binary_search_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_searching/binary_search.assets/binary_search_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_searching/binary_search.assets/binary_search_step4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-5"><p><img src="https://www.hello-algo.com/chapter_searching/binary_search.assets/binary_search_step5.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-6"><p><img src="https://www.hello-algo.com/chapter_searching/binary_search.assets/binary_search_step6.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-7"><p><img src="https://www.hello-algo.com/chapter_searching/binary_search.assets/binary_search_step7.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±äº<code>i</code>å’Œ<code>j</code>éƒ½æ˜¯<code>int</code>ç±»å‹ï¼Œå› æ­¤<code>i + j</code>å¯èƒ½ä¼šè¶…å‡º<code>int</code>ç±»å‹çš„å–å€¼èŒƒå›´ã€‚ä¸ºäº†é¿å…å¤§æ•°è¶Šç•Œï¼Œé€šå¸¸é‡‡ç”¨å…¬å¼<code>m = [i + (j - i) / 2]</code>æ¥è®¡ç®—ä¸­ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* äºŒåˆ†æŸ¥æ‰¾ï¼ˆåŒé—­åŒºé—´ï¼‰ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">binarySearch</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–åŒé—­åŒºé—´ [0, n-1] ï¼Œå³ i, j åˆ†åˆ«æŒ‡å‘æ•°ç»„é¦–å…ƒç´ ã€å°¾å…ƒç´ </span></span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, j = nums.length - <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// å¾ªç¯ï¼Œå½“æœç´¢åŒºé—´ä¸ºç©ºæ—¶è·³å‡ºï¼ˆå½“ i &gt; j æ—¶ä¸ºç©ºï¼‰</span></span><br><span class="line">    <span class="keyword">while</span> (i &lt;= j) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> i + (j - i) / <span class="number">2</span>; <span class="comment">// è®¡ç®—ä¸­ç‚¹ç´¢å¼• m</span></span><br><span class="line">        <span class="keyword">if</span> (nums[m] &lt; target) <span class="comment">// æ­¤æƒ…å†µè¯´æ˜ target åœ¨åŒºé—´ [m+1, j] ä¸­</span></span><br><span class="line">            i = m + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (nums[m] &gt; target) <span class="comment">// æ­¤æƒ…å†µè¯´æ˜ target åœ¨åŒºé—´ [i, m-1] ä¸­</span></span><br><span class="line">            j = m - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="comment">// æ‰¾åˆ°ç›®æ ‡å…ƒç´ ï¼Œè¿”å›å…¶ç´¢å¼•</span></span><br><span class="line">            <span class="keyword">return</span> m;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æœªæ‰¾åˆ°ç›®æ ‡å…ƒç´ ï¼Œè¿”å› -1</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦ï¼šåœ¨äºŒåˆ†å¾ªç¯ä¸­ï¼ŒåŒºé—´æ¯è½®ç¼©å°ä¸€åŠï¼Œå¾ªç¯æ¬¡æ•°ä¸º<code>O(log2n)</code>ã€‚<br>ç©ºé—´å¤æ‚åº¦ï¼šæŒ‡é’ˆ<code>i</code>å’Œ<code>j</code>ä½¿ç”¨å¸¸æ•°å¤§å°ç©ºé—´ã€‚</p><h4 id="åŒºé—´è¡¨ç¤ºæ–¹æ³•"><a href="#åŒºé—´è¡¨ç¤ºæ–¹æ³•" class="headerlink" title="åŒºé—´è¡¨ç¤ºæ–¹æ³•"></a>åŒºé—´è¡¨ç¤ºæ–¹æ³•</h4><p>é™¤äº†ä¸Šè¿°çš„åŒé—­åŒºé—´å¤–ï¼Œå¸¸è§çš„åŒºé—´è¡¨ç¤ºè¿˜æœ‰â€œå·¦é—­å³å¼€â€åŒºé—´ï¼Œå®šä¹‰ä¸º<code>[0, n)</code>ï¼Œå³å·¦è¾¹ç•ŒåŒ…å«è‡ªèº«ï¼Œå³è¾¹ç•Œä¸åŒ…å«è‡ªèº«ã€‚åœ¨è¯¥è¡¨ç¤ºä¸‹ï¼ŒåŒºé—´<code>[i, j]</code>åœ¨<code>i = j</code>æ—¶ä¸ºç©ºã€‚</p><p>åŸºäºè¯¥è¡¨ç¤ºå®ç°å…·æœ‰ç›¸åŒåŠŸèƒ½çš„äºŒåˆ†æŸ¥æ‰¾ç®—æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* äºŒåˆ†æŸ¥æ‰¾ï¼ˆå·¦é—­å³å¼€ï¼‰ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">binarySearchLCRO</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–å·¦é—­å³å¼€ [0, n) ï¼Œå³ i, j åˆ†åˆ«æŒ‡å‘æ•°ç»„é¦–å…ƒç´ ã€å°¾å…ƒç´ +1</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, j = nums.length;</span><br><span class="line">    <span class="comment">// å¾ªç¯ï¼Œå½“æœç´¢åŒºé—´ä¸ºç©ºæ—¶è·³å‡ºï¼ˆå½“ i = j æ—¶ä¸ºç©ºï¼‰</span></span><br><span class="line">    <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> i + (j - i) / <span class="number">2</span>; <span class="comment">// è®¡ç®—ä¸­ç‚¹ç´¢å¼• m</span></span><br><span class="line">        <span class="keyword">if</span> (nums[m] &lt; target) <span class="comment">// æ­¤æƒ…å†µè¯´æ˜ target åœ¨åŒºé—´ [m+1, j) ä¸­</span></span><br><span class="line">            i = m + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (nums[m] &gt; target) <span class="comment">// æ­¤æƒ…å†µè¯´æ˜ target åœ¨åŒºé—´ [i, m) ä¸­</span></span><br><span class="line">            j = m;</span><br><span class="line">        <span class="keyword">else</span> <span class="comment">// æ‰¾åˆ°ç›®æ ‡å…ƒç´ ï¼Œè¿”å›å…¶ç´¢å¼•</span></span><br><span class="line">            <span class="keyword">return</span> m;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æœªæ‰¾åˆ°ç›®æ ‡å…ƒç´ ï¼Œè¿”å› -1</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨ä¸¤ç§åŒºé—´è¡¨ç¤ºä¸‹ï¼ŒäºŒåˆ†æŸ¥æ‰¾ç®—æ³•çš„åˆå§‹åŒ–ã€å¾ªç¯æ¡ä»¶å’Œç¼©å°åŒºé—´æ“ä½œçš†æœ‰æ‰€ä¸åŒã€‚</p><p>ç”±äºâ€œåŒé—­åŒºé—´â€è¡¨ç¤ºä¸­çš„å·¦å³è¾¹ç•Œéƒ½è¢«å®šä¹‰ä¸ºé—­åŒºé—´ï¼Œå› æ­¤æŒ‡é’ˆ<code>i</code>å’Œ<code>j</code>ç¼©å°åŒºé—´æ“ä½œä¹Ÿæ˜¯å¯¹ç§°çš„ã€‚è¿™æ ·æ›´ä¸å®¹æ˜“å‡ºé”™ï¼Œå› æ­¤ä¸€èˆ¬å»ºè®®é‡‡ç”¨â€œåŒé—­åŒºé—´â€çš„å†™æ³•ã€‚</p><p><img src="https://www.hello-algo.com/chapter_searching/binary_search.assets/binary_search_ranges.png"></p><hr><h3 id="10-2-äºŒåˆ†æŸ¥æ‰¾æ’å…¥ç‚¹"><a href="#10-2-äºŒåˆ†æŸ¥æ‰¾æ’å…¥ç‚¹" class="headerlink" title="10.2 äºŒåˆ†æŸ¥æ‰¾æ’å…¥ç‚¹"></a>10.2 äºŒåˆ†æŸ¥æ‰¾æ’å…¥ç‚¹</h3><p>äºŒåˆ†æŸ¥æ‰¾ä¸ä»…å¯ç”¨äºæœç´¢ç›®æ ‡å…ƒç´ ï¼Œè¿˜å…·æœ‰è®¸å¤šå˜ç§é—®é¢˜ï¼Œæ¯”å¦‚æœç´¢ç›®æ ‡å…ƒç´ çš„æ’å…¥ä½ç½®ã€‚</p><h4 id="æ— é‡å¤å…ƒç´ çš„æƒ…å†µ"><a href="#æ— é‡å¤å…ƒç´ çš„æƒ…å†µ" class="headerlink" title="æ— é‡å¤å…ƒç´ çš„æƒ…å†µ"></a>æ— é‡å¤å…ƒç´ çš„æƒ…å†µ</h4><blockquote><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º<code>n</code>çš„æœ‰åºæ•°ç»„<code>nums</code>å’Œä¸€ä¸ªå…ƒç´ <code>target</code>ï¼Œæ•°ç»„ä¸å­˜åœ¨é‡å¤å…ƒç´ ã€‚ç°å°†<code>target</code>æ’å…¥åˆ°æ•°ç»„<code>nums</code>ä¸­ï¼Œå¹¶ä¿æŒå…¶æœ‰åºæ€§ã€‚è‹¥æ•°ç»„ä¸­å·²å­˜åœ¨å…ƒç´ <code>target</code>ï¼Œåˆ™æ’å…¥åˆ°å…¶å·¦æ–¹ã€‚è¯·è¿”å›æ’å…¥å<code>target</code>åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•ã€‚</p></blockquote><p><img src="https://www.hello-algo.com/chapter_searching/binary_search_insertion.assets/binary_search_insertion_example.png"></p><p>å¦‚æœæƒ³è¦å¤ç”¨ä¸ŠèŠ‚çš„äºŒåˆ†æŸ¥æ‰¾ä»£ç ï¼Œåˆ™éœ€è¦å›ç­”ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ã€‚</p><ul><li>å½“æ•°ç»„ä¸­åŒ…å«<code>target</code>æ—¶ï¼Œæ’å…¥ç‚¹çš„ç´¢å¼•æ˜¯å¦æ˜¯è¯¥å…ƒç´ çš„ç´¢å¼•ï¼Ÿ<ul><li>é¢˜ç›®è¦æ±‚å°†<code>target</code>æ’å…¥åˆ°ç›¸ç­‰å…ƒç´ çš„å·¦è¾¹ï¼Œè¿™æ„å‘³ç€æ–°æ’å…¥çš„<code>target</code>æ›¿æ¢äº†åŸæ¥<code>target</code>çš„ä½ç½®ã€‚å½“æ•°ç»„åŒ…å«<code>target</code>æ—¶ï¼Œæ’å…¥ç‚¹çš„ç´¢å¼•å°±æ˜¯è¯¥<code>target</code>çš„ç´¢å¼•ã€‚</li></ul></li><li>å½“æ•°ç»„ä¸­ä¸å­˜åœ¨<code>target</code>æ—¶ï¼Œæ’å…¥ç‚¹æ˜¯å“ªä¸ªå…ƒç´ çš„ç´¢å¼•ï¼Ÿ<ul><li>æ€è€ƒäºŒåˆ†æŸ¥æ‰¾è¿‡ç¨‹ï¼Œå½“<code>nums[m] &lt; target</code>æ—¶<code>i</code>ç§»åŠ¨ï¼Œè¿™æ„å‘³ç€æŒ‡é’ˆ<code>i</code>åœ¨å‘å¤§äºç­‰äº<code>target</code>çš„å…ƒç´ é è¿‘ã€‚åŒç†ï¼ŒæŒ‡é’ˆ <code>j</code>å§‹ç»ˆåœ¨å‘å°äºç­‰äº<code>target</code>çš„å…ƒç´ é è¿‘ã€‚</li><li>å› æ­¤äºŒåˆ†ç»“æŸæ—¶ä¸€å®šæœ‰ï¼Œ<code>i</code>æŒ‡å‘é¦–ä¸ªå¤§äº<code>target</code>çš„å…ƒç´ ï¼Œ<code>j</code>æŒ‡å‘é¦–ä¸ªå°äº<code>target</code>çš„å…ƒç´ ã€‚æ˜“å¾—å½“æ•°ç»„ä¸åŒ…å«<code>target</code>æ—¶ï¼Œæ’å…¥ç´¢å¼•ä¸º<code>i</code>ã€‚</li></ul></li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* äºŒåˆ†æŸ¥æ‰¾æ’å…¥ç‚¹ï¼ˆæ— é‡å¤å…ƒç´ ï¼‰ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">binarySearchInsertionSimple</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, j = nums.length - <span class="number">1</span>; <span class="comment">// åˆå§‹åŒ–åŒé—­åŒºé—´ [0, n-1]</span></span><br><span class="line">    <span class="keyword">while</span> (i &lt;= j) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> i + (j - i) / <span class="number">2</span>; <span class="comment">// è®¡ç®—ä¸­ç‚¹ç´¢å¼• m</span></span><br><span class="line">        <span class="keyword">if</span> (nums[m] &lt; target) &#123;</span><br><span class="line">            i = m + <span class="number">1</span>; <span class="comment">// target åœ¨åŒºé—´ [m+1, j] ä¸­</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[m] &gt; target) &#123;</span><br><span class="line">            j = m - <span class="number">1</span>; <span class="comment">// target åœ¨åŒºé—´ [i, m-1] ä¸­</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> m; <span class="comment">// æ‰¾åˆ° target ï¼Œè¿”å›æ’å…¥ç‚¹ m</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æœªæ‰¾åˆ° target ï¼Œè¿”å›æ’å…¥ç‚¹ i</span></span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å­˜åœ¨é‡å¤å…ƒç´ çš„æƒ…å†µ"><a href="#å­˜åœ¨é‡å¤å…ƒç´ çš„æƒ…å†µ" class="headerlink" title="å­˜åœ¨é‡å¤å…ƒç´ çš„æƒ…å†µ"></a>å­˜åœ¨é‡å¤å…ƒç´ çš„æƒ…å†µ</h4><blockquote><p>åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šï¼Œè§„å®šæ•°ç»„å¯èƒ½åŒ…å«é‡å¤å…ƒç´ ï¼Œå…¶ä½™ä¸å˜ã€‚</p></blockquote><p>å‡è®¾æ•°ç»„ä¸­å­˜åœ¨å¤šä¸ª<code>target</code>ï¼Œåˆ™æ™®é€šäºŒåˆ†æŸ¥æ‰¾åªèƒ½è¿”å›å…¶ä¸­ä¸€ä¸ª<code>target</code>çš„ç´¢å¼•ï¼Œè€Œæ— æ³•ç¡®å®šè¯¥å…ƒç´ çš„å·¦è¾¹å’Œå³è¾¹è¿˜æœ‰å¤šå°‘<code>target</code>ã€‚</p><p>é¢˜ç›®è¦æ±‚å°†ç›®æ ‡å…ƒç´ æ’å…¥åˆ°æœ€å·¦è¾¹ï¼Œæ‰€ä»¥éœ€è¦æŸ¥æ‰¾æ•°ç»„ä¸­æœ€å·¦ä¸€ä¸ª<code>target</code>çš„ç´¢å¼•ã€‚åˆæ­¥è€ƒè™‘é€šè¿‡ä¸‹å›¾æ‰€ç¤ºçš„æ­¥éª¤å®ç°ã€‚</p><ul><li>æ‰§è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œå¾—åˆ°ä»»æ„ä¸€ä¸ª<code>target</code>çš„ç´¢å¼•ï¼Œè®°ä¸º<code>k</code>ã€‚</li><li>ä»ç´¢å¼•<code>k</code>å¼€å§‹ï¼Œå‘å·¦è¿›è¡Œçº¿æ€§éå†ï¼Œå½“æ‰¾åˆ°æœ€å·¦è¾¹çš„<code>target</code>æ—¶è¿”å›ã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_searching/binary_search_insertion.assets/binary_search_insertion_naive.png"></p><p>æ­¤æ–¹æ³•è™½ç„¶å¯ç”¨ï¼Œä½†å…¶åŒ…å«çº¿æ€§æŸ¥æ‰¾ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦ä¸º<code>O(n)</code>ã€‚å½“æ•°ç»„ä¸­å­˜åœ¨å¾ˆå¤šé‡å¤çš„<code>target</code>æ—¶ï¼Œè¯¥æ–¹æ³•æ•ˆç‡å¾ˆä½ã€‚</p><p>è€ƒè™‘æ‹“å±•äºŒåˆ†æŸ¥æ‰¾ä»£ç ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ•´ä½“æµç¨‹ä¿æŒä¸å˜ï¼Œæ¯è½®å…ˆè®¡ç®—ä¸­ç‚¹ç´¢å¼•<code>m</code>ï¼Œå†åˆ¤æ–­<code>target</code>å’Œ<code>nums[m]</code>å¤§å°å…³ç³»ï¼Œåˆ†ä¸ºä»¥ä¸‹å‡ ç§æƒ…å†µã€‚</p><ul><li>å½“<code>nums[m] &lt; target</code>æˆ–<code>nums[m] &gt; target</code>æ—¶ï¼Œè¯´æ˜è¿˜æ²¡æœ‰æ‰¾åˆ°<code>target</code>ï¼Œå› æ­¤é‡‡ç”¨æ™®é€šäºŒåˆ†æŸ¥æ‰¾çš„ç¼©å°åŒºé—´æ“ä½œï¼Œä»è€Œä½¿æŒ‡é’ˆ<code>i</code>å’Œ<code>j</code>å‘<code>target</code>é è¿‘ã€‚</li><li>å½“<code>nums[m] == target</code>æ—¶ï¼Œè¯´æ˜å°äº<code>target</code>çš„å…ƒç´ åœ¨åŒºé—´<code>[i, m - 1]</code>ä¸­ï¼Œå› æ­¤é‡‡ç”¨<code>j = m - 1</code>æ¥ç¼©å°åŒºé—´ï¼Œä»è€Œä½¿æŒ‡é’ˆ<code>j</code>å‘å°äº<code>target</code>çš„å…ƒç´ é è¿‘ã€‚</li></ul><p>å¾ªç¯å®Œæˆåï¼Œ<code>i</code>æŒ‡å‘æœ€å·¦è¾¹çš„<code>target</code>ï¼Œ<code>j</code>æŒ‡å‘é¦–ä¸ªå°äº<code>target</code>çš„å…ƒç´ ï¼Œç´¢å¼•<code>i</code>å°±æ˜¯æ’å…¥ç‚¹ã€‚</p><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1"><1></button></li><li class="tab"><button type="button" data-href="#placeholder-2"><2></button></li><li class="tab"><button type="button" data-href="#placeholder-3"><3></button></li><li class="tab"><button type="button" data-href="#placeholder-4"><4></button></li><li class="tab"><button type="button" data-href="#placeholder-5"><5></button></li><li class="tab"><button type="button" data-href="#placeholder-6"><6></button></li><li class="tab"><button type="button" data-href="#placeholder-7"><7></button></li><li class="tab"><button type="button" data-href="#placeholder-8"><8></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_searching/binary_search_insertion.assets/binary_search_insertion_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_searching/binary_search_insertion.assets/binary_search_insertion_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_searching/binary_search_insertion.assets/binary_search_insertion_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_searching/binary_search_insertion.assets/binary_search_insertion_step4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-5"><p><img src="https://www.hello-algo.com/chapter_searching/binary_search_insertion.assets/binary_search_insertion_step5.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-6"><p><img src="https://www.hello-algo.com/chapter_searching/binary_search_insertion.assets/binary_search_insertion_step6.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-7"><p><img src="https://www.hello-algo.com/chapter_searching/binary_search_insertion.assets/binary_search_insertion_step7.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-8"><p><img src="https://www.hello-algo.com/chapter_searching/binary_search_insertion.assets/binary_search_insertion_step8.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>è§‚å¯Ÿä»¥ä¸‹ä»£ç ï¼Œåˆ¤æ–­åˆ†æ”¯<code>nums[m] &gt; target</code>å’Œ<code>nums[m] == target</code>çš„æ“ä½œç›¸åŒï¼Œå› æ­¤ä¸¤è€…å¯ä»¥åˆå¹¶ã€‚ä½†æ˜¯å› ä¸ºé€»è¾‘æ€§ï¼Œæ•…æ­¤ä¿ç•™ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* äºŒåˆ†æŸ¥æ‰¾æ’å…¥ç‚¹ï¼ˆå­˜åœ¨é‡å¤å…ƒç´ ï¼‰ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">binarySearchInsertion</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, j = nums.length - <span class="number">1</span>; <span class="comment">// åˆå§‹åŒ–åŒé—­åŒºé—´ [0, n-1]</span></span><br><span class="line">    <span class="keyword">while</span> (i &lt;= j) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> i + (j - i) / <span class="number">2</span>; <span class="comment">// è®¡ç®—ä¸­ç‚¹ç´¢å¼• m</span></span><br><span class="line">        <span class="keyword">if</span> (nums[m] &lt; target) &#123;</span><br><span class="line">            i = m + <span class="number">1</span>; <span class="comment">// target åœ¨åŒºé—´ [m+1, j] ä¸­</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[m] &gt; target) &#123;</span><br><span class="line">            j = m - <span class="number">1</span>; <span class="comment">// target åœ¨åŒºé—´ [i, m-1] ä¸­</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            j = m - <span class="number">1</span>; <span class="comment">// é¦–ä¸ªå°äº target çš„å…ƒç´ åœ¨åŒºé—´ [i, m-1] ä¸­</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿”å›æ’å…¥ç‚¹ i</span></span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»çš„æ¥çœ‹ï¼ŒäºŒåˆ†æŸ¥æ‰¾æ— éå°±æ˜¯ç»™æŒ‡é’ˆ<code>i</code>å’Œ<code>j</code>åˆ†åˆ«è®¾å®šæœç´¢ç›®æ ‡ï¼Œç›®æ ‡å¯èƒ½æ˜¯ä¸€ä¸ªå…·ä½“çš„å…ƒç´ ï¼ˆä¾‹å¦‚<code>target</code>ï¼‰ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªå…ƒç´ èŒƒå›´ï¼ˆä¾‹å¦‚å°äº<code>target</code>çš„å…ƒç´ ï¼‰ã€‚</p><p>åœ¨ä¸æ–­çš„å¾ªç¯äºŒåˆ†ä¸­ï¼ŒæŒ‡é’ˆ<code>i</code>å’Œ<code>j</code>éƒ½é€æ¸é€¼è¿‘é¢„å…ˆè®¾å®šçš„ç›®æ ‡ã€‚æœ€ç»ˆï¼Œå®ƒä»¬æˆ–æ˜¯æˆåŠŸæ‰¾åˆ°ç­”æ¡ˆï¼Œæˆ–æ˜¯è¶Šè¿‡è¾¹ç•Œååœæ­¢ã€‚</p><hr><h3 id="10-3-äºŒåˆ†æŸ¥æ‰¾è¾¹ç•Œ"><a href="#10-3-äºŒåˆ†æŸ¥æ‰¾è¾¹ç•Œ" class="headerlink" title="10.3 äºŒåˆ†æŸ¥æ‰¾è¾¹ç•Œ"></a>10.3 äºŒåˆ†æŸ¥æ‰¾è¾¹ç•Œ</h3><h4 id="æŸ¥æ‰¾å·¦è¾¹ç•Œ"><a href="#æŸ¥æ‰¾å·¦è¾¹ç•Œ" class="headerlink" title="æŸ¥æ‰¾å·¦è¾¹ç•Œ"></a>æŸ¥æ‰¾å·¦è¾¹ç•Œ</h4><blockquote><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º<code>n</code>çš„æœ‰åºæ•°ç»„<code>nums</code>ï¼Œæ•°ç»„å¯èƒ½åŒ…å«é‡å¤å…ƒç´ ã€‚è¯·è¿”å›æ•°ç»„ä¸­æœ€å·¦ä¸€ä¸ªå…ƒç´ <code>target</code>çš„ç´¢å¼•ã€‚è‹¥æ•°ç»„ä¸­ä¸åŒ…å«è¯¥å…ƒç´ ï¼Œåˆ™è¿”å›<code>-1</code>ã€‚</p></blockquote><p>å›å¿†äºŒåˆ†æŸ¥æ‰¾æ’å…¥ç‚¹çš„æ–¹æ³•ï¼Œæœç´¢å®Œæˆå<code>i</code>æŒ‡å‘æœ€å·¦ä¸€ä¸ª<code>target</code>ï¼Œå› æ­¤æŸ¥æ‰¾æ’å…¥ç‚¹æœ¬è´¨ä¸Šæ˜¯åœ¨æŸ¥æ‰¾æœ€å·¦ä¸€ä¸ª<code>target</code>çš„ç´¢å¼•ã€‚</p><p>é€šè¿‡æŸ¥æ‰¾æ’å…¥ç‚¹çš„å‡½æ•°å®ç°æŸ¥æ‰¾å·¦è¾¹ç•Œã€‚è¯·æ³¨æ„ï¼Œæ•°ç»„ä¸­å¯èƒ½ä¸åŒ…å«<code>target</code>ï¼Œè¿™ç§æƒ…å†µå¯èƒ½å¯¼è‡´ä»¥ä¸‹ä¸¤ç§ç»“æœã€‚</p><ul><li>æ’å…¥ç‚¹çš„ç´¢å¼•<code>i</code>è¶Šç•Œã€‚</li><li>å…ƒç´ <code>nums[i]</code>ä¸<code>target</code>ä¸ç›¸ç­‰ã€‚</li></ul><p>å½“é‡åˆ°ä»¥ä¸Šä¸¤ç§æƒ…å†µæ—¶ï¼Œç›´æ¥è¿”å›<code>-1</code>å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* äºŒåˆ†æŸ¥æ‰¾æœ€å·¦ä¸€ä¸ª target */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">binarySearchLeftEdge</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    <span class="comment">// ç­‰ä»·äºæŸ¥æ‰¾ target çš„æ’å…¥ç‚¹ ï¼ˆ10.2ï¼‰</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> binary_search_insertion.binarySearchInsertion(nums, target);</span><br><span class="line">    <span class="comment">// æœªæ‰¾åˆ° target ï¼Œè¿”å› -1</span></span><br><span class="line">    <span class="keyword">if</span> (i == nums.length || nums[i] != target) &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ‰¾åˆ° target ï¼Œè¿”å›ç´¢å¼• i</span></span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æŸ¥æ‰¾å³è¾¹ç•Œ"><a href="#æŸ¥æ‰¾å³è¾¹ç•Œ" class="headerlink" title="æŸ¥æ‰¾å³è¾¹ç•Œ"></a>æŸ¥æ‰¾å³è¾¹ç•Œ</h4><p>é‚£ä¹ˆå¦‚ä½•æŸ¥æ‰¾æœ€å³ä¸€ä¸ª<code>target</code>å‘¢ï¼Ÿæœ€ç›´æ¥çš„æ–¹å¼æ˜¯ä¿®æ”¹ä»£ç ï¼Œæ›¿æ¢åœ¨<code>nums[m] == target</code>æƒ…å†µä¸‹çš„æŒ‡é’ˆæ”¶ç¼©æ“ä½œã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">binarySearchRightmost</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, j = nums.length - <span class="number">1</span>; <span class="comment">// åˆå§‹åŒ–åŒé—­åŒºé—´ [0, n-1]</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> -<span class="number">1</span>; <span class="comment">// å­˜å‚¨æ‰¾åˆ°çš„æœ€å³è¾¹çš„ç›®æ ‡å€¼ç´¢å¼•ï¼Œåˆå§‹ä¸º -1 è¡¨ç¤ºæœªæ‰¾åˆ°</span></span><br><span class="line">    <span class="keyword">while</span> (i &lt;= j) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> i + (j - i) / <span class="number">2</span>; <span class="comment">// è®¡ç®—ä¸­ç‚¹ç´¢å¼• m</span></span><br><span class="line">        <span class="keyword">if</span> (nums[m] &lt; target) &#123;</span><br><span class="line">            i = m + <span class="number">1</span>; <span class="comment">// target åœ¨åŒºé—´ [m+1, j] ä¸­</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[m] &gt; target) &#123;</span><br><span class="line">            j = m - <span class="number">1</span>; <span class="comment">// target åœ¨åŒºé—´ [i, m-1] ä¸­</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            result = m; <span class="comment">// æ‰¾åˆ°ä¸€ä¸ªç›®æ ‡å€¼çš„å®ä¾‹ï¼Œä¿å­˜ç´¢å¼•</span></span><br><span class="line">            i = m + <span class="number">1</span>; <span class="comment">// ç»§ç»­åœ¨å³è¾¹åŒºé—´ [m+1, j] ä¸­æŸ¥æ‰¾</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿”å›æ‰¾åˆ°çš„æœ€å³è¾¹çš„ç›®æ ‡å€¼ç´¢å¼•ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°è¿”å› -1</span></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢ä»‹ç»ä¸¤ç§æ›´åŠ å–å·§çš„æ–¹æ³•ã€‚</p><p><strong>ï¼ˆ1ï¼‰å¤ç”¨æŸ¥æ‰¾å·¦è¾¹ç•Œ</strong></p><p>å®é™…ä¸Šï¼Œå¯ä»¥åˆ©ç”¨æŸ¥æ‰¾æœ€å·¦å…ƒç´ çš„å‡½æ•°æ¥æŸ¥æ‰¾æœ€å³å…ƒç´ ï¼Œå…·ä½“æ–¹æ³•ä¸ºï¼Œå°†æŸ¥æ‰¾æœ€å³ä¸€ä¸ª<code>target</code>è½¬åŒ–ä¸ºæŸ¥æ‰¾æœ€å·¦ä¸€ä¸ª<code>target + 1</code>ã€‚</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒæŸ¥æ‰¾å®Œæˆåï¼ŒæŒ‡é’ˆ<code>i</code>æŒ‡å‘æœ€å·¦ä¸€ä¸ª<code>target + 1</code>ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ï¼Œè€Œ<code>j</code>æŒ‡å‘æœ€å³ä¸€ä¸ª<code>target</code>ï¼Œå› æ­¤è¿”å›<code>j</code>å³å¯ã€‚</p><p><img src="https://www.hello-algo.com/chapter_searching/binary_search_edge.assets/binary_search_right_edge_by_left_edge.png"></p><p>è¯·æ³¨æ„ï¼Œè¿”å›çš„æ’å…¥ç‚¹æ˜¯<code>i</code>ï¼Œå› æ­¤éœ€è¦å°†å…¶å‡<code>1</code>ï¼Œä»è€Œè·å¾—<code>j</code>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* äºŒåˆ†æŸ¥æ‰¾æœ€å³ä¸€ä¸ª target */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">binarySearchRightEdge</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    <span class="comment">// è½¬åŒ–ä¸ºæŸ¥æ‰¾æœ€å·¦ä¸€ä¸ª target + 1</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> binary_search_insertion.binarySearchInsertion(nums, target + <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// j æŒ‡å‘æœ€å³ä¸€ä¸ª target ï¼Œi æŒ‡å‘é¦–ä¸ªå¤§äº target çš„å…ƒç´ </span></span><br><span class="line">    <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i - <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// æœªæ‰¾åˆ° target ï¼Œè¿”å› -1</span></span><br><span class="line">    <span class="keyword">if</span> (j == -<span class="number">1</span> || nums[j] != target) &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ‰¾åˆ° target ï¼Œè¿”å›ç´¢å¼• j</span></span><br><span class="line">    <span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ2ï¼‰è½¬åŒ–ä¸ºæŸ¥æ‰¾å…ƒç´ </strong></p><p>å½“æ•°ç»„ä¸åŒ…å«<code>target</code>æ—¶ï¼Œæœ€ç»ˆ<code>i</code>å’Œ<code>j</code>ä¼šåˆ†åˆ«æŒ‡å‘é¦–ä¸ªå¤§äºã€å°äº<code>target</code>çš„å…ƒç´ ã€‚</p><p>å› æ­¤ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥æ„é€ ä¸€ä¸ªæ•°ç»„ä¸­ä¸å­˜åœ¨çš„å…ƒç´ ï¼Œç”¨äºæŸ¥æ‰¾å·¦å³è¾¹ç•Œã€‚</p><ul><li>æŸ¥æ‰¾æœ€å·¦ä¸€ä¸ª<code>target</code>ï¼šå¯ä»¥è½¬åŒ–ä¸ºæŸ¥æ‰¾<code>target - 0.5</code>ï¼Œå¹¶è¿”å›æŒ‡é’ˆ<code>i</code>ã€‚</li><li>æŸ¥æ‰¾æœ€å³ä¸€ä¸ª<code>target</code>ï¼šå¯ä»¥è½¬åŒ–ä¸ºæŸ¥æ‰¾<code>target + 0.5</code>ï¼Œå¹¶è¿”å›æŒ‡é’ˆ<code>j</code>ã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_searching/binary_search_edge.assets/binary_search_edge_by_element.png"></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// i æŒ‡å‘æœ€å·¦ä¸€ä¸ª target</span></span><br><span class="line"><span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> binary_search_insertion.binarySearchInsertion(nums, target - <span class="number">0.5</span>);</span><br><span class="line"><span class="comment">// j æŒ‡å‘æœ€å³ä¸€ä¸ª target</span></span><br><span class="line"><span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> binary_search_insertion.binarySearchInsertion(nums, target + <span class="number">0.5</span>);</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„ä»¥ä¸‹ä¸¤ç‚¹ã€‚</p><ul><li>ç»™å®šæ•°ç»„ä¸åŒ…å«å°æ•°ï¼Œè¿™æ„å‘³ç€æ— é¡»å…³å¿ƒå¦‚ä½•å¤„ç†ç›¸ç­‰çš„æƒ…å†µã€‚</li><li>å› ä¸ºè¯¥æ–¹æ³•å¼•å…¥äº†å°æ•°ï¼Œæ‰€ä»¥éœ€è¦å°†å‡½æ•°ä¸­çš„å˜é‡<code>target</code>æ”¹ä¸ºæµ®ç‚¹æ•°ç±»å‹ã€‚</li></ul><hr><h3 id="10-4-å“ˆå¸Œä¼˜åŒ–ç­–ç•¥"><a href="#10-4-å“ˆå¸Œä¼˜åŒ–ç­–ç•¥" class="headerlink" title="10.4 å“ˆå¸Œä¼˜åŒ–ç­–ç•¥"></a>10.4 å“ˆå¸Œä¼˜åŒ–ç­–ç•¥</h3><p>åœ¨ç®—æ³•é¢˜ä¸­ï¼Œå¸¸é€šè¿‡å°†çº¿æ€§æŸ¥æ‰¾æ›¿æ¢ä¸ºå“ˆå¸ŒæŸ¥æ‰¾æ¥é™ä½ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ã€‚</p><blockquote><p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„<code>nums</code>å’Œä¸€ä¸ªç›®æ ‡å…ƒç´ <code>target</code>ï¼Œè¯·åœ¨æ•°ç»„ä¸­æœç´¢â€œå’Œâ€ä¸º<code>target</code>çš„ä¸¤ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›å®ƒä»¬çš„æ•°ç»„ç´¢å¼•ã€‚è¿”å›ä»»æ„ä¸€ä¸ªè§£å³å¯ã€‚</p></blockquote><h4 id="çº¿æ€§æŸ¥æ‰¾ï¼šæ—¶é—´æ¢ç©ºé—´"><a href="#çº¿æ€§æŸ¥æ‰¾ï¼šæ—¶é—´æ¢ç©ºé—´" class="headerlink" title="çº¿æ€§æŸ¥æ‰¾ï¼šæ—¶é—´æ¢ç©ºé—´"></a>çº¿æ€§æŸ¥æ‰¾ï¼šæ—¶é—´æ¢ç©ºé—´</h4><p>è€ƒè™‘ç›´æ¥éå†æ‰€æœ‰å¯èƒ½çš„ç»„åˆã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¼€å¯ä¸€ä¸ªä¸¤å±‚å¾ªç¯ï¼Œåœ¨æ¯è½®ä¸­åˆ¤æ–­ä¸¤ä¸ªæ•´æ•°çš„å’Œæ˜¯å¦ä¸º<code>target</code>ï¼Œè‹¥æ˜¯åˆ™è¿”å›å®ƒä»¬çš„ç´¢å¼•ã€‚</p><p><img src="https://www.hello-algo.com/chapter_searching/replace_linear_by_hashing.assets/two_sum_brute_force.png"></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æ–¹æ³•ä¸€ï¼šæš´åŠ›æšä¸¾ */</span></span><br><span class="line"><span class="type">int</span>[] twoSumBruteForce(<span class="type">int</span>[] nums, <span class="type">int</span> target) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> nums.length;</span><br><span class="line">    <span class="comment">// ä¸¤å±‚å¾ªç¯ï¼Œæ—¶é—´å¤æ‚åº¦ O(n^2)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i + <span class="number">1</span>; j &lt; size; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[i] + nums[j] == target)</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[] &#123; i, j &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º<code>O(n^2)</code>ï¼Œç©ºé—´å¤æ‚åº¦ä¸º<code>O(1)</code>ï¼Œåœ¨å¤§æ•°æ®é‡ä¸‹éå¸¸è€—æ—¶ã€‚</p><h4 id="å“ˆå¸ŒæŸ¥æ‰¾ï¼šç©ºé—´æ¢æ—¶é—´"><a href="#å“ˆå¸ŒæŸ¥æ‰¾ï¼šç©ºé—´æ¢æ—¶é—´" class="headerlink" title="å“ˆå¸ŒæŸ¥æ‰¾ï¼šç©ºé—´æ¢æ—¶é—´"></a>å“ˆå¸ŒæŸ¥æ‰¾ï¼šç©ºé—´æ¢æ—¶é—´</h4><p>å€ŸåŠ©ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œé”®å€¼å¯¹åˆ†åˆ«ä¸ºæ•°ç»„å…ƒç´ å’Œå…ƒç´ ç´¢å¼•ã€‚å¾ªç¯éå†æ•°ç»„ï¼Œæ¯è½®æ‰§è¡Œä¸‹å›¾æ‰€ç¤ºçš„æ­¥éª¤ã€‚</p><ul><li>åˆ¤æ–­æ•°å­—<code>target - nums[i]</code>æ˜¯å¦åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œè‹¥æ˜¯åˆ™ç›´æ¥è¿”å›è¿™ä¸¤ä¸ªå…ƒç´ çš„ç´¢å¼•ã€‚</li><li>å°†é”®å€¼å¯¹<code>nums[i]</code>å’Œç´¢å¼•<code>i</code>æ·»åŠ è¿›å“ˆå¸Œè¡¨ã€‚</li></ul><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1"><1></button></li><li class="tab"><button type="button" data-href="#placeholder-2"><2></button></li><li class="tab"><button type="button" data-href="#placeholder-3"><3></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_searching/replace_linear_by_hashing.assets/two_sum_hashtable_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_searching/replace_linear_by_hashing.assets/two_sum_hashtable_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_searching/replace_linear_by_hashing.assets/two_sum_hashtable_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>å®ç°ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œä»…éœ€å•å±‚å¾ªç¯å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æ–¹æ³•äºŒï¼šè¾…åŠ©å“ˆå¸Œè¡¨ */</span></span><br><span class="line"><span class="type">int</span>[] twoSumHashTable(<span class="type">int</span>[] nums, <span class="type">int</span> target) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> nums.length;</span><br><span class="line">    <span class="comment">// è¾…åŠ©å“ˆå¸Œè¡¨ï¼Œç©ºé—´å¤æ‚åº¦ O(n)</span></span><br><span class="line">    Map&lt;Integer, Integer&gt; dic = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// å•å±‚å¾ªç¯ï¼Œæ—¶é—´å¤æ‚åº¦ O(n)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dic.containsKey(target - nums[i])) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[] &#123; dic.get(target - nums[i]), i &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        dic.put(nums[i], i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ–¹æ³•é€šè¿‡å“ˆå¸ŒæŸ¥æ‰¾å°†æ—¶é—´å¤æ‚åº¦ä»<code>O(n^2)</code>é™ä½è‡³<code>O(n)</code>ï¼Œå¤§å¹…æå‡è¿è¡Œæ•ˆç‡ã€‚</p><p>ç”±äºéœ€è¦ç»´æŠ¤ä¸€ä¸ªé¢å¤–çš„å“ˆå¸Œè¡¨ï¼Œå› æ­¤ç©ºé—´å¤æ‚åº¦ä¸º<code>O(n)</code>ã€‚å°½ç®¡å¦‚æ­¤ï¼Œè¯¥æ–¹æ³•çš„æ•´ä½“æ—¶ç©ºæ•ˆç‡æ›´ä¸ºå‡è¡¡ï¼Œå› æ­¤å®ƒæ˜¯æœ¬é¢˜çš„æœ€ä¼˜è§£æ³•ã€‚</p><hr><h3 id="10-5-é‡è¯†æœç´¢ç®—æ³•"><a href="#10-5-é‡è¯†æœç´¢ç®—æ³•" class="headerlink" title="10.5 é‡è¯†æœç´¢ç®—æ³•"></a>10.5 é‡è¯†æœç´¢ç®—æ³•</h3><p>æœç´¢ç®—æ³•å¯æ ¹æ®å®ç°æ€è·¯åˆ†ä¸ºä»¥ä¸‹ä¸¤ç±»ã€‚</p><ul><li>é€šè¿‡éå†æ•°æ®ç»“æ„æ¥å®šä½ç›®æ ‡å…ƒç´ ï¼Œä¾‹å¦‚æ•°ç»„ã€é“¾è¡¨ã€æ ‘å’Œå›¾çš„éå†ç­‰ã€‚</li><li>åˆ©ç”¨æ•°æ®ç»„ç»‡ç»“æ„æˆ–æ•°æ®åŒ…å«çš„å…ˆéªŒä¿¡æ¯ï¼Œå®ç°é«˜æ•ˆå…ƒç´ æŸ¥æ‰¾ï¼Œä¾‹å¦‚äºŒåˆ†æŸ¥æ‰¾ã€å“ˆå¸ŒæŸ¥æ‰¾å’ŒäºŒå‰æœç´¢æ ‘æŸ¥æ‰¾ç­‰ã€‚</li></ul><h4 id="æš´åŠ›æœç´¢"><a href="#æš´åŠ›æœç´¢" class="headerlink" title="æš´åŠ›æœç´¢"></a>æš´åŠ›æœç´¢</h4><p>æš´åŠ›æœç´¢é€šè¿‡éå†æ•°æ®ç»“æ„çš„æ¯ä¸ªå…ƒç´ æ¥å®šä½ç›®æ ‡å…ƒç´ ã€‚</p><ul><li>â€œçº¿æ€§æœç´¢â€é€‚ç”¨äºæ•°ç»„å’Œé“¾è¡¨ç­‰çº¿æ€§æ•°æ®ç»“æ„ã€‚å®ƒä»æ•°æ®ç»“æ„çš„ä¸€ç«¯å¼€å§‹ï¼Œé€ä¸ªè®¿é—®å…ƒç´ ï¼Œç›´åˆ°æ‰¾åˆ°ç›®æ ‡å…ƒç´ æˆ–åˆ°è¾¾å¦ä¸€ç«¯ä»æ²¡æœ‰æ‰¾åˆ°ç›®æ ‡å…ƒç´ ä¸ºæ­¢ã€‚</li><li>â€œå¹¿åº¦ä¼˜å…ˆæœç´¢â€å’Œâ€œæ·±åº¦ä¼˜å…ˆæœç´¢â€æ˜¯å›¾å’Œæ ‘çš„ä¸¤ç§éå†ç­–ç•¥ã€‚å¹¿åº¦ä¼˜å…ˆæœç´¢ä»åˆå§‹èŠ‚ç‚¹å¼€å§‹é€å±‚æœç´¢ï¼Œç”±è¿‘åŠè¿œåœ°è®¿é—®å„ä¸ªèŠ‚ç‚¹ã€‚æ·±åº¦ä¼˜å…ˆæœç´¢æ˜¯ä»åˆå§‹èŠ‚ç‚¹å¼€å§‹ï¼Œæ²¿ç€ä¸€æ¡è·¯å¾„èµ°åˆ°å¤´ä¸ºæ­¢ï¼Œå†å›æº¯å¹¶å°è¯•å…¶ä»–è·¯å¾„ï¼Œç›´åˆ°éå†å®Œæ•´ä¸ªæ•°æ®ç»“æ„ã€‚</li></ul><p>æš´åŠ›æœç´¢çš„ä¼˜ç‚¹æ˜¯ç®€å•ä¸”é€šç”¨æ€§å¥½ï¼Œæ— é¡»å¯¹æ•°æ®åšé¢„å¤„ç†å’Œå€ŸåŠ©é¢å¤–çš„æ•°æ®ç»“æ„ã€‚</p><p>ç„¶è€Œï¼Œæ­¤ç±»ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º<code>O(n)</code>ï¼Œå…¶ä¸­<code>n</code>ä¸ºå…ƒç´ æ•°é‡ï¼Œå› æ­¤åœ¨æ•°æ®é‡è¾ƒå¤§çš„æƒ…å†µä¸‹æ€§èƒ½è¾ƒå·®ã€‚</p><h4 id="è‡ªé€‚åº”æœç´¢"><a href="#è‡ªé€‚åº”æœç´¢" class="headerlink" title="è‡ªé€‚åº”æœç´¢"></a>è‡ªé€‚åº”æœç´¢</h4><p>è‡ªé€‚åº”æœç´¢åˆ©ç”¨æ•°æ®çš„ç‰¹æœ‰å±æ€§ï¼ˆä¾‹å¦‚æœ‰åºæ€§ï¼‰æ¥ä¼˜åŒ–æœç´¢è¿‡ç¨‹ï¼Œä»è€Œæ›´é«˜æ•ˆåœ°å®šä½ç›®æ ‡å…ƒç´ ã€‚</p><ul><li>â€œäºŒåˆ†æŸ¥æ‰¾â€åˆ©ç”¨æ•°æ®çš„æœ‰åºæ€§å®ç°é«˜æ•ˆæŸ¥æ‰¾ï¼Œä»…é€‚ç”¨äºæ•°ç»„ã€‚</li><li>â€œå“ˆå¸ŒæŸ¥æ‰¾â€åˆ©ç”¨å“ˆå¸Œè¡¨å°†æœç´¢æ•°æ®å’Œç›®æ ‡æ•°æ®å»ºç«‹ä¸ºé”®å€¼å¯¹æ˜ å°„ï¼Œä»è€Œå®ç°æŸ¥è¯¢æ“ä½œã€‚</li><li>â€œæ ‘æŸ¥æ‰¾â€åœ¨ç‰¹å®šçš„æ ‘ç»“æ„ï¼ˆä¾‹å¦‚äºŒå‰æœç´¢æ ‘ï¼‰ä¸­ï¼ŒåŸºäºæ¯”è¾ƒèŠ‚ç‚¹å€¼æ¥å¿«é€Ÿæ’é™¤èŠ‚ç‚¹ï¼Œä»è€Œå®šä½ç›®æ ‡å…ƒç´ ã€‚</li></ul><p>æ­¤ç±»ç®—æ³•çš„ä¼˜ç‚¹æ˜¯æ•ˆç‡é«˜ï¼Œæ—¶é—´å¤æ‚åº¦å¯è¾¾åˆ°<code>O(logn)</code>ç”šè‡³<code>O(1)</code>ã€‚</p><p>ç„¶è€Œï¼Œä½¿ç”¨è¿™äº›ç®—æ³•å¾€å¾€éœ€è¦å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ã€‚ä¾‹å¦‚ï¼ŒäºŒåˆ†æŸ¥æ‰¾éœ€è¦é¢„å…ˆå¯¹æ•°ç»„è¿›è¡Œæ’åºï¼Œå“ˆå¸ŒæŸ¥æ‰¾å’Œæ ‘æŸ¥æ‰¾éƒ½éœ€è¦å€ŸåŠ©é¢å¤–çš„æ•°æ®ç»“æ„ï¼Œç»´æŠ¤è¿™äº›æ•°æ®ç»“æ„ä¹Ÿéœ€è¦é¢å¤–çš„æ—¶é—´å’Œç©ºé—´å¼€æ”¯ã€‚</p><h4 id="æœç´¢æ–¹æ³•é€‰å–"><a href="#æœç´¢æ–¹æ³•é€‰å–" class="headerlink" title="æœç´¢æ–¹æ³•é€‰å–"></a>æœç´¢æ–¹æ³•é€‰å–</h4><p>ç»™å®šå¤§å°ä¸º<code>n</code>çš„ä¸€ç»„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨çº¿æ€§æœç´¢ã€äºŒåˆ†æŸ¥æ‰¾ã€æ ‘æŸ¥æ‰¾ã€å“ˆå¸ŒæŸ¥æ‰¾ç­‰å¤šç§æ–¹æ³•åœ¨è¯¥æ•°æ®ä¸­æœç´¢ç›®æ ‡å…ƒç´ ã€‚</p><p><img src="https://www.hello-algo.com/chapter_searching/searching_algorithm_revisited.assets/searching_algorithms.png"></p><p>ä¸Šè¿°å‡ ç§æ–¹æ³•çš„æ“ä½œæ•ˆç‡ä¸ç‰¹æ€§å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><table><thead><tr><th align="left"></th><th align="left">çº¿æ€§æœç´¢</th><th align="left">äºŒåˆ†æŸ¥æ‰¾</th><th align="left">æ ‘æŸ¥æ‰¾</th><th align="left">å“ˆå¸ŒæŸ¥æ‰¾</th></tr></thead><tbody><tr><td align="left">æŸ¥æ‰¾å…ƒç´ </td><td align="left"><code>O(n)</code></td><td align="left"><code>O(logn)</code></td><td align="left"><code>O(logn)</code></td><td align="left"><code>O(1)</code></td></tr><tr><td align="left">æ’å…¥å…ƒç´ </td><td align="left"><code>O(1)</code></td><td align="left"><code>O(n)</code></td><td align="left"><code>O(logn)</code></td><td align="left"><code>O(1)</code></td></tr><tr><td align="left">åˆ é™¤å…ƒç´ </td><td align="left"><code>O(n)</code></td><td align="left"><code>O(n)</code></td><td align="left"><code>O(logn)</code></td><td align="left"><code>O(1)</code></td></tr><tr><td align="left">é¢å¤–ç©ºé—´</td><td align="left"><code>O(1)</code></td><td align="left"><code>O(1)</code></td><td align="left"><code>O(n)</code></td><td align="left"><code>O(n)</code></td></tr><tr><td align="left">æ•°æ®é¢„å¤„ç†</td><td align="left"><code>/</code></td><td align="left">æ’åº<code>O(nlogn)</code></td><td align="left">å»ºæ ‘<code>O(nlogn)</code></td><td align="left">å»ºå“ˆå¸Œè¡¨<code>O(n)</code></td></tr><tr><td align="left">æ•°æ®æ˜¯å¦æœ‰åº</td><td align="left">æ— åº</td><td align="left">æœ‰åº</td><td align="left">æœ‰åº</td><td align="left">æ— åº</td></tr></tbody></table><p>å…·ä½“é€‚ç”¨<a href="https://www.hello-algo.com/chapter_searching/searching_algorithm_revisited/#1053">å‚ç…§</a>ï¼Œè¿™é‡Œå°±ä¸å†è®¨è®ºã€‚</p><hr><h2 id="11-æ’åº"><a href="#11-æ’åº" class="headerlink" title="11. æ’åº"></a>11. æ’åº</h2><h3 id="11-1-æ’åºç®—æ³•"><a href="#11-1-æ’åºç®—æ³•" class="headerlink" title="11.1 æ’åºç®—æ³•"></a>11.1 æ’åºç®—æ³•</h3><p>ã€Œæ’åºç®—æ³•<code>sorting algorithm</code>ã€ç”¨äºå¯¹ä¸€ç»„æ•°æ®æŒ‰ç…§ç‰¹å®šé¡ºåºè¿›è¡Œæ’åˆ—ã€‚å®ƒæœ‰ç€å¹¿æ³›çš„åº”ç”¨ï¼Œå› ä¸ºæœ‰åºæ•°æ®é€šå¸¸èƒ½å¤Ÿè¢«æ›´æœ‰æ•ˆåœ°æŸ¥æ‰¾ã€åˆ†æå’Œå¤„ç†ã€‚</p><p>æ’åºç®—æ³•ä¸­çš„æ•°æ®ç±»å‹å¯ä»¥æ˜¯æ•´æ•°ã€æµ®ç‚¹æ•°ã€å­—ç¬¦æˆ–å­—ç¬¦ä¸²ç­‰ã€‚æ’åºçš„åˆ¤æ–­è§„åˆ™å¯æ ¹æ®éœ€æ±‚è®¾å®šï¼Œå¦‚æ•°å­—å¤§å°ã€å­—ç¬¦<code>ASCII</code>ç é¡ºåºæˆ–è‡ªå®šä¹‰è§„åˆ™ã€‚</p><p><img src="https://www.hello-algo.com/chapter_sorting/sorting_algorithm.assets/sorting_examples.png"></p><p><strong>è¯„ä»·ç»´åº¦</strong></p><p>æ’åºç®—æ³•é€šå¸¸æ ¹æ®å¤šä¸ªç»´åº¦æ¥è¿›è¡Œè¯„ä»·ã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„è¯„ä»·æŒ‡æ ‡ã€‚</p><ul><li>è¿è¡Œæ•ˆç‡ï¼šæœŸæœ›çš„æ’åºç®—æ³•æ—¶é—´å¤æ‚åº¦å°½é‡ä½ï¼Œä¸”æ€»ä½“æ“ä½œæ•°é‡è¾ƒå°‘ï¼ˆå³æ—¶é—´å¤æ‚åº¦ä¸­çš„å¸¸æ•°é¡¹é™ä½ï¼‰ã€‚å¯¹äºå¤§æ•°æ®é‡æƒ…å†µï¼Œè¿è¡Œæ•ˆç‡æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</li><li>å°±åœ°æ€§ï¼šã€ŒåŸåœ°æ’åºã€é€šè¿‡åœ¨åŸæ•°ç»„ä¸Šç›´æ¥æ“ä½œå®ç°æ’åºï¼Œæ— é¡»å€ŸåŠ©é¢å¤–çš„è¾…åŠ©æ•°ç»„ï¼Œä»è€ŒèŠ‚çœå†…å­˜ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼ŒåŸåœ°æ’åºçš„æ•°æ®æ¬è¿æ“ä½œè¾ƒå°‘ï¼Œè¿è¡Œé€Ÿåº¦ä¹Ÿæ›´å¿«ã€‚</li><li>ç¨³å®šæ€§ï¼šã€Œç¨³å®šæ’åºã€åœ¨å®Œæˆæ’åºåï¼Œç›¸ç­‰å…ƒç´ åœ¨æ•°ç»„ä¸­çš„ç›¸å¯¹é¡ºåºä¸å‘ç”Ÿæ”¹å˜ã€‚</li></ul><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line"># è¾“å…¥æ•°æ®æ˜¯æŒ‰ç…§å§“åæ’åºå¥½çš„</span><br><span class="line"># (name, age)</span><br><span class="line">  (&#x27;A&#x27;, 19)</span><br><span class="line">  (&#x27;B&#x27;, 18)</span><br><span class="line">  (&#x27;C&#x27;, 21)</span><br><span class="line">  (&#x27;D&#x27;, 19)</span><br><span class="line">  (&#x27;E&#x27;, 23)</span><br><span class="line"></span><br><span class="line"># å‡è®¾ä½¿ç”¨éç¨³å®šæ’åºç®—æ³•æŒ‰å¹´é¾„æ’åºåˆ—è¡¨ï¼Œ</span><br><span class="line"># ç»“æœä¸­ (&#x27;D&#x27;, 19) å’Œ (&#x27;A&#x27;, 19) çš„ç›¸å¯¹ä½ç½®æ”¹å˜ï¼Œ</span><br><span class="line"># è¾“å…¥æ•°æ®æŒ‰å§“åæ’åºçš„æ€§è´¨ä¸¢å¤±</span><br><span class="line">  (&#x27;B&#x27;, 18)</span><br><span class="line">  (&#x27;D&#x27;, 19)</span><br><span class="line">  (&#x27;A&#x27;, 19)</span><br><span class="line">  (&#x27;C&#x27;, 21)</span><br><span class="line">  (&#x27;E&#x27;, 23)</span><br></pre></td></tr></table></figure><ul><li>è‡ªé€‚åº”æ€§ï¼šã€Œè‡ªé€‚åº”æ’åºã€çš„æ—¶é—´å¤æ‚åº¦ä¼šå—è¾“å…¥æ•°æ®çš„å½±å“ï¼Œå³æœ€ä½³ã€æœ€å·®ã€å¹³å‡æ—¶é—´å¤æ‚åº¦å¹¶ä¸å®Œå…¨ç›¸ç­‰ã€‚</li><li>æ˜¯å¦åŸºäºæ¯”è¾ƒï¼šã€ŒåŸºäºæ¯”è¾ƒçš„æ’åºã€ä¾èµ–äºæ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆ<code>&lt;</code>ã€<code>=</code>ã€<code>&gt;</code>ï¼‰æ¥åˆ¤æ–­å…ƒç´ çš„ç›¸å¯¹é¡ºåºï¼Œä»è€Œæ’åºæ•´ä¸ªæ•°ç»„ï¼Œç†è®ºæœ€ä¼˜æ—¶é—´å¤æ‚åº¦ä¸º<code>O(nlogn)</code>ã€‚è€Œã€Œéæ¯”è¾ƒæ’åºã€ä¸ä½¿ç”¨æ¯”è¾ƒè¿ç®—ç¬¦ï¼Œæ—¶é—´å¤æ‚åº¦å¯è¾¾<code>O(n)</code>ï¼Œä½†å…¶é€šç”¨æ€§ç›¸å¯¹è¾ƒå·®ã€‚</li></ul><p>è¿è¡Œå¿«ã€åŸåœ°ã€ç¨³å®šã€æ­£å‘è‡ªé€‚åº”ã€é€šç”¨æ€§å¥½ã€‚æ˜¾ç„¶ï¼Œè¿„ä»Šä¸ºæ­¢å°šæœªå‘ç°å…¼å…·ä»¥ä¸Šæ‰€æœ‰ç‰¹æ€§çš„æ’åºç®—æ³•ã€‚å› æ­¤ï¼Œåœ¨é€‰æ‹©æ’åºç®—æ³•æ—¶ï¼Œéœ€è¦æ ¹æ®å…·ä½“çš„æ•°æ®ç‰¹ç‚¹å’Œé—®é¢˜éœ€æ±‚æ¥å†³å®šã€‚</p><hr><h3 id="11-2-é€‰æ‹©æ’åº"><a href="#11-2-é€‰æ‹©æ’åº" class="headerlink" title="11.2 é€‰æ‹©æ’åº"></a>11.2 é€‰æ‹©æ’åº</h3><p>ã€Œé€‰æ‹©æ’åº<code>selection sort</code>ã€çš„å·¥ä½œåŸç†éå¸¸ç›´æ¥ï¼Œå¼€å¯ä¸€ä¸ªå¾ªç¯ï¼Œæ¯è½®ä»æœªæ’åºåŒºé—´é€‰æ‹©æœ€å°çš„å…ƒç´ ï¼Œå°†å…¶æ”¾åˆ°å·²æ’åºåŒºé—´çš„æœ«å°¾ã€‚</p><p>è®¾æ•°ç»„çš„é•¿åº¦ä¸º<code>n</code>ï¼Œé€‰æ‹©æ’åºçš„ç®—æ³•æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><ul><li>åˆå§‹çŠ¶æ€ä¸‹ï¼Œæ‰€æœ‰å…ƒç´ æœªæ’åºï¼Œå³æœªæ’åºï¼ˆç´¢å¼•ï¼‰åŒºé—´ä¸º<code>[0, n - 1]</code>ã€‚</li><li>é€‰å–åŒºé—´<code>[0, n - 1]</code>ä¸­çš„æœ€å°å…ƒç´ ï¼Œå°†å…¶ä¸ç´¢å¼•<code>0</code>å¤„å…ƒç´ äº¤æ¢ã€‚æ•°ç»„å‰<code>1</code>ä¸ªå…ƒç´ å·²æ’åºã€‚</li><li>é€‰å–åŒºé—´<code>[1, n - 1]</code>ä¸­çš„æœ€å°å…ƒç´ ï¼Œå°†å…¶ä¸ç´¢å¼•<code>1</code>å¤„å…ƒç´ äº¤æ¢ã€‚æ•°ç»„å‰<code>2</code>ä¸ªå…ƒç´ å·²æ’åºã€‚</li><li>ä»¥æ­¤ç±»æ¨ã€‚ç»è¿‡<code>n - 1</code>è½®é€‰æ‹©ä¸äº¤æ¢åï¼Œæ•°ç»„å‰<code>n - 1</code>ä¸ªå…ƒç´ å·²æ’åºã€‚</li><li>ä»…å‰©çš„ä¸€ä¸ªå…ƒç´ å¿…å®šæ˜¯æœ€å¤§å…ƒç´ ï¼Œæ— é¡»æ’åºï¼Œå› æ­¤æ•°ç»„æ’åºå®Œæˆã€‚</li></ul><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1">1</button></li><li class="tab"><button type="button" data-href="#placeholder-2">2</button></li><li class="tab"><button type="button" data-href="#placeholder-3">3</button></li><li class="tab"><button type="button" data-href="#placeholder-4">4</button></li><li class="tab"><button type="button" data-href="#placeholder-5">5</button></li><li class="tab"><button type="button" data-href="#placeholder-6">6</button></li><li class="tab"><button type="button" data-href="#placeholder-7">7</button></li><li class="tab"><button type="button" data-href="#placeholder-8">8</button></li><li class="tab"><button type="button" data-href="#placeholder-9">9</button></li><li class="tab"><button type="button" data-href="#placeholder-10">10</button></li><li class="tab"><button type="button" data-href="#placeholder-11">11</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_sorting/selection_sort.assets/selection_sort_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_sorting/selection_sort.assets/selection_sort_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_sorting/selection_sort.assets/selection_sort_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_sorting/selection_sort.assets/selection_sort_step4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-5"><p><img src="https://www.hello-algo.com/chapter_sorting/selection_sort.assets/selection_sort_step5.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-6"><p><img src="https://www.hello-algo.com/chapter_sorting/selection_sort.assets/selection_sort_step6.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-7"><p><img src="https://www.hello-algo.com/chapter_sorting/selection_sort.assets/selection_sort_step7.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-8"><p><img src="https://www.hello-algo.com/chapter_sorting/selection_sort.assets/selection_sort_step8.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-9"><p><img src="https://www.hello-algo.com/chapter_sorting/selection_sort.assets/selection_sort_step9.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-10"><p><img src="https://www.hello-algo.com/chapter_sorting/selection_sort.assets/selection_sort_step10.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-11"><p><img src="https://www.hello-algo.com/chapter_sorting/selection_sort.assets/selection_sort_step11.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>åœ¨ä»£ç ä¸­ï¼Œä½¿ç”¨<code>k</code>æ¥è®°å½•æœªæ’åºåŒºé—´å†…çš„æœ€å°å…ƒç´ ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* é€‰æ‹©æ’åº */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">selectionSort</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">    <span class="comment">// å¤–å¾ªç¯ï¼šæœªæ’åºåŒºé—´ä¸º [i, n-1]</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="comment">// å†…å¾ªç¯ï¼šæ‰¾åˆ°æœªæ’åºåŒºé—´å†…çš„æœ€å°å…ƒç´ </span></span><br><span class="line">        <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i + <span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[j] &lt; nums[k])</span><br><span class="line">                k = j; <span class="comment">// è®°å½•æœ€å°å…ƒç´ çš„ç´¢å¼•</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å°†è¯¥æœ€å°å…ƒç´ ä¸æœªæ’åºåŒºé—´çš„é¦–ä¸ªå…ƒç´ äº¤æ¢</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> nums[i];</span><br><span class="line">        nums[i] = nums[k];</span><br><span class="line">        nums[k] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç®—æ³•ç‰¹æ€§</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ä¸º<code>O(n^2)</code>ã€éè‡ªé€‚åº”æ’åºï¼šå¤–å¾ªç¯å…±<code>n - 1</code>è½®ï¼Œç¬¬ä¸€è½®çš„æœªæ’åºåŒºé—´é•¿åº¦ä¸º<code>n</code>ï¼Œæœ€åä¸€è½®çš„æœªæ’åºåŒºé—´é•¿åº¦ä¸º<code>2</code>ï¼Œå³å„è½®å¤–å¾ªç¯åˆ†åˆ«åŒ…å«<code>n</code>ã€<code>n - 1</code>ã€<code>...</code>ã€<code>3</code>ã€<code>2</code>è½®å†…å¾ªç¯ï¼Œæ±‚å’Œä¸º<code>((n - 1)(n - 2)) / 2</code>ã€‚</li><li>ç©ºé—´å¤æ‚åº¦<code>O(1)</code>ã€åŸåœ°æ’åºï¼šæŒ‡é’ˆ<code>i</code>å’Œ<code>j</code>ä½¿ç”¨å¸¸æ•°å¤§å°çš„é¢å¤–ç©ºé—´ã€‚</li><li>éç¨³å®šæ’åºï¼šå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…ƒç´ <code>nums[i]</code>æœ‰å¯èƒ½è¢«äº¤æ¢è‡³ä¸å…¶ç›¸ç­‰çš„å…ƒç´ çš„å³è¾¹ï¼Œå¯¼è‡´ä¸¤è€…ç›¸å¯¹é¡ºåºå‘ç”Ÿæ”¹å˜ã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_sorting/selection_sort.assets/selection_sort_instability.png"></p><hr><h3 id="11-3-å†’æ³¡æ’åº"><a href="#11-3-å†’æ³¡æ’åº" class="headerlink" title="11.3 å†’æ³¡æ’åº"></a>11.3 å†’æ³¡æ’åº</h3><p>ã€Œå†’æ³¡æ’åº<code>bubble sort</code>ã€é€šè¿‡è¿ç»­åœ°æ¯”è¾ƒä¸äº¤æ¢ç›¸é‚»å…ƒç´ å®ç°æ’åºã€‚è¿™ä¸ªè¿‡ç¨‹å°±åƒæ°”æ³¡ä»åº•éƒ¨å‡åˆ°é¡¶éƒ¨ä¸€æ ·ï¼Œå› æ­¤å¾—åå†’æ³¡æ’åºã€‚</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå†’æ³¡è¿‡ç¨‹å¯ä»¥åˆ©ç”¨å…ƒç´ äº¤æ¢æ“ä½œæ¥æ¨¡æ‹Ÿã€‚ä»æ•°ç»„æœ€å·¦ç«¯å¼€å§‹å‘å³éå†ï¼Œä¾æ¬¡æ¯”è¾ƒç›¸é‚»å…ƒç´ å¤§å°ï¼Œå¦‚æœâ€œå·¦å…ƒç´  <code>&gt;</code> å³å…ƒç´ â€å°±äº¤æ¢å®ƒä¿©ã€‚éå†å®Œæˆåï¼Œæœ€å¤§çš„å…ƒç´ ä¼šè¢«ç§»åŠ¨åˆ°æ•°ç»„çš„æœ€å³ç«¯ã€‚</p><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1"><1></button></li><li class="tab"><button type="button" data-href="#placeholder-2"><2></button></li><li class="tab"><button type="button" data-href="#placeholder-3"><3></button></li><li class="tab"><button type="button" data-href="#placeholder-4"><4></button></li><li class="tab"><button type="button" data-href="#placeholder-5"><5></button></li><li class="tab"><button type="button" data-href="#placeholder-6"><6></button></li><li class="tab"><button type="button" data-href="#placeholder-7"><7></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_sorting/bubble_sort.assets/bubble_operation_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_sorting/bubble_sort.assets/bubble_operation_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_sorting/bubble_sort.assets/bubble_operation_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_sorting/bubble_sort.assets/bubble_operation_step4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-5"><p><img src="https://www.hello-algo.com/chapter_sorting/bubble_sort.assets/bubble_operation_step5.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-6"><p><img src="https://www.hello-algo.com/chapter_sorting/bubble_sort.assets/bubble_operation_step6.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-7"><p><img src="https://www.hello-algo.com/chapter_sorting/bubble_sort.assets/bubble_operation_step7.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p><strong>ç®—æ³•æµç¨‹</strong></p><p>è®¾æ•°ç»„çš„é•¿åº¦ä¸º<code>n</code>ï¼Œå†’æ³¡æ’åºçš„æ­¥éª¤å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><ul><li>é¦–å…ˆï¼Œå¯¹<code>n</code>ä¸ªå…ƒç´ æ‰§è¡Œâ€œå†’æ³¡â€ï¼Œå°†æ•°ç»„çš„æœ€å¤§å…ƒç´ äº¤æ¢è‡³æ­£ç¡®ä½ç½®ã€‚</li><li>æ¥ä¸‹æ¥ï¼Œå¯¹å‰©ä½™<code>n - 1</code>ä¸ªå…ƒç´ æ‰§è¡Œâ€œå†’æ³¡â€ï¼Œå°†ç¬¬äºŒå¤§å…ƒç´ äº¤æ¢è‡³æ­£ç¡®ä½ç½®ã€‚</li><li>ä»¥æ­¤ç±»æ¨ï¼Œç»è¿‡<code>n - 1</code>è½®â€œå†’æ³¡â€åï¼Œå‰<code>n - 1</code>å¤§çš„å…ƒç´ éƒ½è¢«äº¤æ¢è‡³æ­£ç¡®ä½ç½®ã€‚</li><li>ä»…å‰©çš„ä¸€ä¸ªå…ƒç´ å¿…å®šæ˜¯æœ€å°å…ƒç´ ï¼Œæ— é¡»æ’åºï¼Œå› æ­¤æ•°ç»„æ’åºå®Œæˆã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_sorting/bubble_sort.assets/bubble_sort_overview.png"></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å†’æ³¡æ’åº */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">bubbleSort</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="comment">// å¤–å¾ªç¯ï¼šæœªæ’åºåŒºé—´ä¸º [0, i]</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> nums.length - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="comment">// å†…å¾ªç¯ï¼šå°†æœªæ’åºåŒºé—´ [0, i] ä¸­çš„æœ€å¤§å…ƒç´ äº¤æ¢è‡³è¯¥åŒºé—´çš„æœ€å³ç«¯</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[j] &gt; nums[j + <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="comment">// äº¤æ¢ nums[j] ä¸ nums[j + 1]</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> nums[j];</span><br><span class="line">                nums[j] = nums[j + <span class="number">1</span>];</span><br><span class="line">                nums[j + <span class="number">1</span>] = tmp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ•ˆç‡ä¼˜åŒ–</strong></p><p>å¦‚æœæŸè½®â€œå†’æ³¡â€ä¸­æ²¡æœ‰æ‰§è¡Œä»»ä½•äº¤æ¢æ“ä½œï¼Œè¯´æ˜æ•°ç»„å·²ç»å®Œæˆæ’åºï¼Œå¯ç›´æ¥è¿”å›ç»“æœã€‚å› æ­¤ï¼Œå¯ä»¥å¢åŠ ä¸€ä¸ªæ ‡å¿—ä½<code>flag</code>æ¥ç›‘æµ‹è¿™ç§æƒ…å†µï¼Œä¸€æ—¦å‡ºç°å°±ç«‹å³è¿”å›ã€‚</p><p>ç»è¿‡ä¼˜åŒ–ï¼Œå†’æ³¡æ’åºçš„æœ€å·®å’Œå¹³å‡æ—¶é—´å¤æ‚åº¦ä»ä¸º<code>O(n^2)</code>ã€‚ä½†å½“è¾“å…¥æ•°ç»„å®Œå…¨æœ‰åºæ—¶ï¼Œå¯è¾¾åˆ°æœ€ä½³æ—¶é—´å¤æ‚åº¦<code>O(n)</code>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å†’æ³¡æ’åºï¼ˆæ ‡å¿—ä¼˜åŒ–ï¼‰ */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">bubbleSortWithFlag</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="comment">// å¤–å¾ªç¯ï¼šæœªæ’åºåŒºé—´ä¸º [0, i]</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> nums.length - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>; <span class="comment">// åˆå§‹åŒ–æ ‡å¿—ä½</span></span><br><span class="line">        <span class="comment">// å†…å¾ªç¯ï¼šå°†æœªæ’åºåŒºé—´ [0, i] ä¸­çš„æœ€å¤§å…ƒç´ äº¤æ¢è‡³è¯¥åŒºé—´çš„æœ€å³ç«¯</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[j] &gt; nums[j + <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="comment">// äº¤æ¢ nums[j] ä¸ nums[j + 1]</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> nums[j];</span><br><span class="line">                nums[j] = nums[j + <span class="number">1</span>];</span><br><span class="line">                nums[j + <span class="number">1</span>] = tmp;</span><br><span class="line">                flag = <span class="literal">true</span>; <span class="comment">// è®°å½•äº¤æ¢å…ƒç´ </span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!flag)</span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// æ­¤è½®å†’æ³¡æœªäº¤æ¢ä»»ä½•å…ƒç´ ï¼Œç›´æ¥è·³å‡º</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç®—æ³•ç‰¹æ€§</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ä¸º<code>O(n^2)</code>ã€è‡ªé€‚åº”æ’åºï¼šå„è½®â€œå†’æ³¡â€éå†çš„æ•°ç»„é•¿åº¦ä¾æ¬¡ä¸º<code>n - 1</code>ã€<code>n - 2</code>ã€<code>...</code>ã€<code>2</code>ã€<code>1</code>ï¼Œæ€»å’Œä¸º<code>(n - 1) n / 2</code>ã€‚åœ¨å¼•å…¥<code>flag</code>ä¼˜åŒ–åï¼Œæœ€ä½³æ—¶é—´å¤æ‚åº¦å¯è¾¾åˆ°<code>O(n)</code>ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ä¸º<code>O(1)</code>ã€åŸåœ°æ’åºï¼šæŒ‡é’ˆ<code>i</code>å’Œ<code>j</code>ä½¿ç”¨å¸¸æ•°å¤§å°çš„é¢å¤–ç©ºé—´ã€‚</li><li>ç¨³å®šæ’åºï¼šç”±äºåœ¨â€œå†’æ³¡â€ä¸­é‡åˆ°ç›¸ç­‰å…ƒç´ ä¸äº¤æ¢ã€‚</li></ul><hr><h3 id="11-4-æ’å…¥æ’åº"><a href="#11-4-æ’å…¥æ’åº" class="headerlink" title="11.4 æ’å…¥æ’åº"></a>11.4 æ’å…¥æ’åº</h3><p>ã€Œæ’å…¥æ’åº<code>insertion sort</code>ã€çš„å·¥ä½œåŸç†ä¸æ‰‹åŠ¨æ•´ç†ä¸€å‰¯ç‰Œçš„è¿‡ç¨‹éå¸¸ç›¸ä¼¼ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œåœ¨æœªæ’åºåŒºé—´é€‰æ‹©ä¸€ä¸ªåŸºå‡†å…ƒç´ ï¼Œå°†è¯¥å…ƒç´ ä¸å…¶å·¦ä¾§å·²æ’åºåŒºé—´çš„å…ƒç´ é€ä¸€æ¯”è¾ƒå¤§å°ï¼Œå¹¶å°†è¯¥å…ƒç´ æ’å…¥åˆ°æ­£ç¡®çš„ä½ç½®ã€‚</p><p>ä¸‹å›¾å±•ç¤ºäº†æ•°ç»„æ’å…¥å…ƒç´ çš„æ“ä½œæµç¨‹ã€‚è®¾åŸºå‡†å…ƒç´ ä¸º<code>base</code>ï¼Œéœ€è¦å°†ä»ç›®æ ‡ç´¢å¼•åˆ°<code>base</code>ä¹‹é—´çš„æ‰€æœ‰å…ƒç´ å‘å³ç§»åŠ¨ä¸€ä½ï¼Œç„¶åå†å°†<code>base</code>èµ‹å€¼ç»™ç›®æ ‡ç´¢å¼•ã€‚</p><p><img src="https://www.hello-algo.com/chapter_sorting/insertion_sort.assets/insertion_operation.png"></p><p><strong>ç®—æ³•æµç¨‹</strong></p><p>æ’å…¥æ’åºçš„æ•´ä½“æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><ul><li>åˆå§‹çŠ¶æ€ä¸‹ï¼Œæ•°ç»„çš„ç¬¬<code>1</code>ä¸ªå…ƒç´ å·²å®Œæˆæ’åºã€‚</li><li>é€‰å–æ•°ç»„çš„ç¬¬<code>2</code>ä¸ªå…ƒç´ ä½œä¸º<code>base</code>ï¼Œå°†å…¶æ’å…¥åˆ°æ­£ç¡®ä½ç½®åï¼Œæ•°ç»„çš„å‰<code>2</code>ä¸ªå…ƒç´ å·²æ’åºã€‚</li><li>é€‰å–ç¬¬<code>3</code>ä¸ªå…ƒç´ ä½œä¸º<code>base</code>ï¼Œå°†å…¶æ’å…¥åˆ°æ­£ç¡®ä½ç½®åï¼Œæ•°ç»„çš„å‰<code>3</code>ä¸ªå…ƒç´ å·²æ’åºã€‚</li><li>ä»¥æ­¤ç±»æ¨ï¼Œåœ¨æœ€åä¸€è½®ä¸­ï¼Œé€‰å–æœ€åä¸€ä¸ªå…ƒç´ ä½œä¸º<code>base</code>ï¼Œå°†å…¶æ’å…¥åˆ°æ­£ç¡®ä½ç½®åï¼Œæ‰€æœ‰å…ƒç´ å‡å·²æ’åºã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_sorting/insertion_sort.assets/insertion_sort_overview.png"></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æ’å…¥æ’åº */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">insertionSort</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="comment">// å¤–å¾ªç¯ï¼šå·²æ’åºå…ƒç´ æ•°é‡ä¸º 1, 2, ..., n</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">base</span> <span class="operator">=</span> nums[i], j = i - <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// å†…å¾ªç¯ï¼šå°† base æ’å…¥åˆ°å·²æ’åºéƒ¨åˆ†çš„æ­£ç¡®ä½ç½®</span></span><br><span class="line">        <span class="keyword">while</span> (j &gt;= <span class="number">0</span> &amp;&amp; nums[j] &gt; base) &#123;</span><br><span class="line">            nums[j + <span class="number">1</span>] = nums[j]; <span class="comment">// å°† nums[j] å‘å³ç§»åŠ¨ä¸€ä½</span></span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">        nums[j + <span class="number">1</span>] = base;        <span class="comment">// å°† base èµ‹å€¼åˆ°æ­£ç¡®ä½ç½®</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç®—æ³•ç‰¹æ€§</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦<code>O(n^2)</code>ã€è‡ªé€‚åº”æ’åºï¼šæœ€å·®æƒ…å†µä¸‹ï¼Œæ¯æ¬¡æ’å…¥æ“ä½œåˆ†åˆ«éœ€è¦å¾ªç¯<code>n - 1</code>ã€<code>n - 2</code>ã€<code>...</code>ã€<code>2</code>ã€<code>1</code>æ¬¡ï¼Œæ±‚å’Œå¾—åˆ°<code>(n - 1) n / 2</code>ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦ä¸º<code>O(n^2)</code>ã€‚åœ¨é‡åˆ°æœ‰åºæ•°æ®æ—¶ï¼Œæ’å…¥æ“ä½œä¼šæå‰ç»ˆæ­¢ã€‚å½“è¾“å…¥æ•°ç»„å®Œå…¨æœ‰åºæ—¶ï¼Œæ’å…¥æ’åºè¾¾åˆ°æœ€ä½³æ—¶é—´å¤æ‚åº¦<code>O(n)</code>ã€‚</li><li>ç©ºé—´å¤æ‚åº¦<code>O(1)</code>ã€åŸåœ°æ’åºï¼šæŒ‡é’ˆ<code>i</code>å’Œ<code>j</code>ä½¿ç”¨å¸¸æ•°å¤§å°çš„é¢å¤–ç©ºé—´ã€‚</li><li>ç¨³å®šæ’åºï¼šåœ¨æ’å…¥æ“ä½œè¿‡ç¨‹ä¸­ï¼Œä¼šå°†å…ƒç´ æ’å…¥åˆ°ç›¸ç­‰å…ƒç´ çš„å³ä¾§ï¼Œä¸ä¼šæ”¹å˜å®ƒä»¬çš„é¡ºåºã€‚</li></ul><p><strong>æ’å…¥æ’åºä¼˜åŠ¿</strong></p><p>æ’å…¥æ’åºçš„æ—¶é—´å¤æ‚åº¦ä¸º<code>O(n^2)</code>ï¼Œå¿«é€Ÿæ’åºçš„æ—¶é—´å¤æ‚åº¦ä¸º<code>O(nlogn)</code>ã€‚å°½ç®¡æ’å…¥æ’åºçš„æ—¶é—´å¤æ‚åº¦ç›¸æ¯”å¿«é€Ÿæ’åºæ›´é«˜ï¼Œä½†åœ¨æ•°æ®é‡è¾ƒå°çš„æƒ…å†µä¸‹ï¼Œæ’å…¥æ’åºé€šå¸¸æ›´å¿«ã€‚</p><p>è™½ç„¶å†’æ³¡æ’åºã€é€‰æ‹©æ’åºå’Œæ’å…¥æ’åºçš„æ—¶é—´å¤æ‚åº¦éƒ½ä¸º<code>O(n^2)</code>ï¼Œä½†åœ¨å®é™…æƒ…å†µä¸­ï¼Œæ’å…¥æ’åºçš„ä½¿ç”¨é¢‘ç‡æ˜¾è‘—é«˜äºå†’æ³¡æ’åºå’Œé€‰æ‹©æ’åºï¼Œä¸»è¦æœ‰ä»¥ä¸‹åŸå› ã€‚</p><ul><li>å†’æ³¡æ’åºåŸºäºå…ƒç´ äº¤æ¢å®ç°ï¼Œéœ€è¦å€ŸåŠ©ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œå…±æ¶‰åŠ<code>3</code>ä¸ªå•å…ƒæ“ä½œã€‚æ’å…¥æ’åºåŸºäºå…ƒç´ èµ‹å€¼å®ç°ï¼Œä»…éœ€<code>1</code>ä¸ªå•å…ƒæ“ä½œã€‚å› æ­¤ï¼Œå†’æ³¡æ’åºçš„è®¡ç®—å¼€é”€é€šå¸¸æ¯”æ’å…¥æ’åºæ›´é«˜ã€‚</li><li>é€‰æ‹©æ’åºåœ¨ä»»ä½•æƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦éƒ½ä¸º<code>O(n^2)</code>ã€‚å¦‚æœç»™å®šä¸€ç»„éƒ¨åˆ†æœ‰åºçš„æ•°æ®ï¼Œæ’å…¥æ’åºé€šå¸¸æ¯”é€‰æ‹©æ’åºæ•ˆç‡æ›´é«˜ã€‚</li></ul><hr><h3 id="11-5-å¿«é€Ÿæ’åº"><a href="#11-5-å¿«é€Ÿæ’åº" class="headerlink" title="11.5 å¿«é€Ÿæ’åº"></a>11.5 å¿«é€Ÿæ’åº</h3><p>ã€Œå¿«é€Ÿæ’åº<code>quick sort</code>ã€æ˜¯ä¸€ç§åŸºäºåˆ†æ²»ç­–ç•¥çš„æ’åºç®—æ³•ï¼Œè¿è¡Œé«˜æ•ˆï¼Œåº”ç”¨å¹¿æ³›ã€‚</p><p>å¿«é€Ÿæ’åºçš„æ ¸å¿ƒæ“ä½œæ˜¯â€œå“¨å…µåˆ’åˆ†â€ï¼Œå…¶ç›®æ ‡æ˜¯ï¼Œé€‰æ‹©æ•°ç»„ä¸­çš„æŸä¸ªå…ƒç´ ä½œä¸ºâ€œåŸºå‡†æ•°â€ï¼Œå°†æ‰€æœ‰å°äºåŸºå‡†æ•°çš„å…ƒç´ ç§»åˆ°å…¶å·¦ä¾§ï¼Œè€Œå¤§äºåŸºå‡†æ•°çš„å…ƒç´ ç§»åˆ°å…¶å³ä¾§ã€‚å…·ä½“æ¥è¯´ï¼Œå“¨å…µåˆ’åˆ†çš„æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><ul><li>é€‰å–æ•°ç»„æœ€å·¦ç«¯å…ƒç´ ä½œä¸ºåŸºå‡†æ•°ï¼Œåˆå§‹åŒ–ä¸¤ä¸ªæŒ‡é’ˆ<code>i</code>å’Œ<code>j</code>åˆ†åˆ«æŒ‡å‘æ•°ç»„çš„ä¸¤ç«¯ã€‚</li><li>å¾ªç¯ï¼Œåœ¨æ¯è½®ä¸­ä½¿ç”¨<code>i</code>ï¼Œ<code>j</code>åˆ†åˆ«å¯»æ‰¾ç¬¬ä¸€ä¸ªæ¯”åŸºå‡†æ•°å¤§ï¼Œå°çš„å…ƒç´ ï¼Œç„¶åäº¤æ¢è¿™ä¸¤ä¸ªå…ƒç´ ã€‚</li><li>å¾ªç¯æ‰§è¡Œä¸Šä¸€ä¸ªæ­¥éª¤ï¼Œç›´åˆ°<code>i</code>å’Œ<code>j</code>ç›¸é‡æ—¶åœæ­¢ï¼Œæœ€åå°†åŸºå‡†æ•°äº¤æ¢è‡³ä¸¤ä¸ªå­æ•°ç»„çš„åˆ†ç•Œçº¿ã€‚</li></ul><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1"><1></button></li><li class="tab"><button type="button" data-href="#placeholder-2"><2></button></li><li class="tab"><button type="button" data-href="#placeholder-3"><3></button></li><li class="tab"><button type="button" data-href="#placeholder-4"><4></button></li><li class="tab"><button type="button" data-href="#placeholder-5"><5></button></li><li class="tab"><button type="button" data-href="#placeholder-6"><6></button></li><li class="tab"><button type="button" data-href="#placeholder-7"><7></button></li><li class="tab"><button type="button" data-href="#placeholder-8"><8></button></li><li class="tab"><button type="button" data-href="#placeholder-9"><9></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_sorting/quick_sort.assets/pivot_division_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_sorting/quick_sort.assets/pivot_division_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_sorting/quick_sort.assets/pivot_division_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_sorting/quick_sort.assets/pivot_division_step4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-5"><p><img src="https://www.hello-algo.com/chapter_sorting/quick_sort.assets/pivot_division_step5.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-6"><p><img src="https://www.hello-algo.com/chapter_sorting/quick_sort.assets/pivot_division_step6.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-7"><p><img src="https://www.hello-algo.com/chapter_sorting/quick_sort.assets/pivot_division_step7.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-8"><p><img src="https://www.hello-algo.com/chapter_sorting/quick_sort.assets/pivot_division_step8.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-9"><p><img src="https://www.hello-algo.com/chapter_sorting/quick_sort.assets/pivot_division_step9.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>å“¨å…µåˆ’åˆ†å®Œæˆåï¼ŒåŸæ•°ç»„è¢«åˆ’åˆ†æˆä¸‰éƒ¨åˆ†ï¼Œå·¦å­æ•°ç»„ã€åŸºå‡†æ•°ã€å³å­æ•°ç»„ï¼Œä¸”æ»¡è¶³â€œå·¦å­æ•°ç»„ä»»æ„å…ƒç´ <code>&lt;=</code>åŸºå‡†æ•°<code>&lt;=</code>å³å­æ•°ç»„ä»»æ„å…ƒç´ â€ã€‚å› æ­¤ï¼Œæ¥ä¸‹æ¥åªéœ€å¯¹è¿™ä¸¤ä¸ªå­æ•°ç»„è¿›è¡Œæ’åºã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å…ƒç´ äº¤æ¢ */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> nums[i];</span><br><span class="line">    nums[i] = nums[j];</span><br><span class="line">    nums[j] = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å“¨å…µåˆ’åˆ† */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">partition</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> left, <span class="type">int</span> right)</span> &#123;</span><br><span class="line">    <span class="comment">// ä»¥ nums[left] ä½œä¸ºåŸºå‡†æ•°</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> left, j = right;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; j &amp;&amp; nums[j] &gt;= nums[left])</span><br><span class="line">            j--;          <span class="comment">// ä»å³å‘å·¦æ‰¾é¦–ä¸ªå°äºåŸºå‡†æ•°çš„å…ƒç´ </span></span><br><span class="line">        <span class="keyword">while</span> (i &lt; j &amp;&amp; nums[i] &lt;= nums[left])</span><br><span class="line">            i++;          <span class="comment">// ä»å·¦å‘å³æ‰¾é¦–ä¸ªå¤§äºåŸºå‡†æ•°çš„å…ƒç´ </span></span><br><span class="line">        swap(nums, i, j); <span class="comment">// äº¤æ¢è¿™ä¸¤ä¸ªå…ƒç´ </span></span><br><span class="line">    &#125;</span><br><span class="line">    swap(nums, i, left);  <span class="comment">// å°†åŸºå‡†æ•°äº¤æ¢è‡³ä¸¤å­æ•°ç»„çš„åˆ†ç•Œçº¿</span></span><br><span class="line">    <span class="keyword">return</span> i;             <span class="comment">// è¿”å›åŸºå‡†æ•°çš„ç´¢å¼•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç®—æ³•æµç¨‹</strong></p><p>å¿«é€Ÿæ’åºçš„æ•´ä½“æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><ul><li>é¦–å…ˆï¼Œå¯¹åŸæ•°ç»„æ‰§è¡Œä¸€æ¬¡â€œå“¨å…µåˆ’åˆ†â€ï¼Œå¾—åˆ°æœªæ’åºçš„å·¦å­æ•°ç»„å’Œå³å­æ•°ç»„ã€‚</li><li>ç„¶åï¼Œå¯¹å·¦å­æ•°ç»„å’Œå³å­æ•°ç»„åˆ†åˆ«é€’å½’æ‰§è¡Œâ€œå“¨å…µåˆ’åˆ†â€ã€‚</li><li>æŒç»­é€’å½’ï¼Œç›´è‡³å­æ•°ç»„é•¿åº¦ä¸º<code>1</code>æ—¶ç»ˆæ­¢ï¼Œä»è€Œå®Œæˆæ•´ä¸ªæ•°ç»„çš„æ’åºã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_sorting/quick_sort.assets/quick_sort_overview.png"></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å¿«é€Ÿæ’åº */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">quickSort</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> left, <span class="type">int</span> right)</span> &#123;</span><br><span class="line">    <span class="comment">// å­æ•°ç»„é•¿åº¦ä¸º 1 æ—¶ç»ˆæ­¢é€’å½’</span></span><br><span class="line">    <span class="keyword">if</span> (left &gt;= right)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// å“¨å…µåˆ’åˆ†</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">pivot</span> <span class="operator">=</span> partition(nums, left, right);</span><br><span class="line">    <span class="comment">// é€’å½’å·¦å­æ•°ç»„ã€å³å­æ•°ç»„</span></span><br><span class="line">    quickSort(nums, left, pivot - <span class="number">1</span>);</span><br><span class="line">    quickSort(nums, pivot + <span class="number">1</span>, right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç®—æ³•ç‰¹æ€§</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦<code>O(nlogn)</code>ã€è‡ªé€‚åº”æ’åºï¼šåœ¨å¹³å‡æƒ…å†µä¸‹ï¼Œå“¨å…µåˆ’åˆ†çš„é€’å½’å±‚æ•°ä¸º<code>logn</code>ï¼Œæ¯å±‚ä¸­çš„æ€»å¾ªç¯æ•°ä¸º <code>n</code>ï¼Œæ€»ä½“ä½¿ç”¨<code>O(nlogn)</code>æ—¶é—´ã€‚åœ¨æœ€å·®æƒ…å†µä¸‹ï¼Œæ¯è½®å“¨å…µåˆ’åˆ†æ“ä½œéƒ½å°†é•¿åº¦ä¸º<code>n</code>çš„æ•°ç»„åˆ’åˆ†ä¸ºé•¿åº¦ä¸º<code>0</code>å’Œ<code>n - 1</code>çš„ä¸¤ä¸ªå­æ•°ç»„ï¼Œæ­¤æ—¶é€’å½’å±‚æ•°è¾¾åˆ°<code>n</code>å±‚ï¼Œæ¯å±‚ä¸­çš„å¾ªç¯æ•°ä¸º<code>n</code>ï¼Œæ€»ä½“ä½¿ç”¨<code>O(n^2)</code>æ—¶é—´ã€‚</li><li>ç©ºé—´å¤æ‚åº¦<code>O(n)</code>ã€åŸåœ°æ’åºï¼šåœ¨è¾“å…¥æ•°ç»„å®Œå…¨å€’åºçš„æƒ…å†µä¸‹ï¼Œè¾¾åˆ°æœ€å·®é€’å½’æ·±åº¦<code>n</code>ï¼Œä½¿ç”¨<code>O(n)</code>æ ˆå¸§ç©ºé—´ã€‚æ’åºæ“ä½œæ˜¯åœ¨åŸæ•°ç»„ä¸Šè¿›è¡Œçš„ï¼Œæœªå€ŸåŠ©é¢å¤–æ•°ç»„ã€‚</li><li>éç¨³å®šæ’åºï¼šåœ¨å“¨å…µåˆ’åˆ†çš„æœ€åä¸€æ­¥ï¼ŒåŸºå‡†æ•°å¯èƒ½ä¼šè¢«äº¤æ¢è‡³ç›¸ç­‰å…ƒç´ çš„å³ä¾§ã€‚</li></ul><hr><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><blockquote><p>æ–‡ä»¶è¿˜æœªä¸Šä¼  Github</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³• Algorithm â€¢ ä¸­</title>
      <link href="/posts/e90cdaa3.html"/>
      <url>/posts/e90cdaa3.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>æœ¬è¯»ä¹¦ç¬”è®°èŠ‚é€‰è‡ª<code>krahets</code>å¤§ä½¬ç¼–å†™çš„<a href="https://www.hello-algo.com/">ã€ŠHello ç®—æ³•ã€‹</a>ã€‚å‹‰åŠ±è‡ªå·±å¼€å§‹ç³»ç»Ÿçš„ç®—æ³•å­¦ä¹ ã€‚</p></blockquote><hr><h2 id="7-æ ‘"><a href="#7-æ ‘" class="headerlink" title="7. æ ‘"></a>7. æ ‘</h2><h3 id="7-1-äºŒå‰æ ‘"><a href="#7-1-äºŒå‰æ ‘" class="headerlink" title="7.1 äºŒå‰æ ‘"></a>7.1 äºŒå‰æ ‘</h3><p>ã€ŒäºŒå‰æ ‘ <code>binary tree</code>ã€æ˜¯ä¸€ç§éçº¿æ€§æ•°æ®ç»“æ„ï¼Œä»£è¡¨ç€ç¥–å…ˆä¸åä»£ä¹‹é—´çš„æ´¾ç”Ÿå…³ç³»ï¼Œä½“ç°ç€â€œä¸€åˆ†ä¸ºäºŒâ€çš„åˆ†æ²»é€»è¾‘ã€‚äºŒå‰æ ‘çš„åŸºæœ¬å•å…ƒæ˜¯èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«å€¼ã€å·¦å­èŠ‚ç‚¹å¼•ç”¨ã€å³å­èŠ‚ç‚¹å¼•ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* äºŒå‰æ ‘èŠ‚ç‚¹ç±» */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TreeNode</span> &#123;</span><br><span class="line">    <span class="type">int</span> val;         <span class="comment">// èŠ‚ç‚¹å€¼</span></span><br><span class="line">    TreeNode left;   <span class="comment">// å·¦å­èŠ‚ç‚¹å¼•ç”¨</span></span><br><span class="line">    TreeNode right;  <span class="comment">// å³å­èŠ‚ç‚¹å¼•ç”¨</span></span><br><span class="line">    TreeNode(<span class="type">int</span> x) &#123; val = x; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸¤ä¸ªå¼•ç”¨ã€‚å½“ç»™å®šä¸€ä¸ªäºŒå‰æ ‘çš„èŠ‚ç‚¹æ—¶ï¼Œè¯¥èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹åŠå…¶ä»¥ä¸‹èŠ‚ç‚¹å½¢æˆçš„æ ‘ç§°ä¸ºè¯¥èŠ‚ç‚¹çš„ã€Œå·¦å­æ ‘ <code>left subtree</code>ã€ï¼ŒåŒç†å¯å¾—ã€Œå³å­æ ‘ <code>right subtree</code>ã€ã€‚</p><p>åœ¨äºŒå‰æ ‘ä¸­ï¼Œ<ins>é™¤å¶èŠ‚ç‚¹å¤–ï¼Œå…¶ä»–æ‰€æœ‰èŠ‚ç‚¹éƒ½åŒ…å«å­èŠ‚ç‚¹å’Œéç©ºå­æ ‘</ins>ã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree.assets/binary_tree_definition.png"></p><h4 id="äºŒå‰æ ‘å¸¸è§æœ¯è¯­"><a href="#äºŒå‰æ ‘å¸¸è§æœ¯è¯­" class="headerlink" title="äºŒå‰æ ‘å¸¸è§æœ¯è¯­"></a>äºŒå‰æ ‘å¸¸è§æœ¯è¯­</h4><p>äºŒå‰æ ‘çš„å¸¸ç”¨æœ¯è¯­å¦‚ä¸‹é¢æ‰€ç¤ºã€‚</p><ul><li>æ ¹èŠ‚ç‚¹ <code>root node</code>ï¼šä½äºäºŒå‰æ ‘é¡¶å±‚çš„èŠ‚ç‚¹ï¼Œæ²¡æœ‰çˆ¶èŠ‚ç‚¹ã€‚</li><li>å¶èŠ‚ç‚¹ <code>leaf node</code>ï¼šæ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼Œå…¶ä¸¤ä¸ªæŒ‡é’ˆå‡æŒ‡å‘<code>None</code>ã€‚</li><li>è¾¹ <code>edge</code>ï¼šè¿æ¥ä¸¤ä¸ªèŠ‚ç‚¹çš„çº¿æ®µï¼Œå³èŠ‚ç‚¹å¼•ç”¨ï¼ˆ<code>left</code>ï¼Œ<code>right</code>ï¼‰ã€‚</li><li>èŠ‚ç‚¹æ‰€åœ¨çš„å±‚ <code>level</code>ï¼šä»é¡¶è‡³åº•é€’å¢ï¼Œæ ¹èŠ‚ç‚¹æ‰€åœ¨å±‚ä¸º<code>1</code>ã€‚</li><li>èŠ‚ç‚¹çš„åº¦ <code>degree</code>ï¼šèŠ‚ç‚¹çš„å­èŠ‚ç‚¹çš„æ•°é‡ã€‚åœ¨äºŒå‰æ ‘ä¸­ï¼Œåº¦çš„å–å€¼èŒƒå›´æ˜¯<code>0</code>ã€<code>1</code>ã€<code>2</code>ã€‚</li><li>äºŒå‰æ ‘çš„é«˜åº¦ <code>height</code>ï¼šä»æ ¹èŠ‚ç‚¹åˆ°æœ€è¿œå¶èŠ‚ç‚¹æ‰€ç»è¿‡çš„è¾¹çš„æ•°é‡ã€‚</li><li>èŠ‚ç‚¹çš„æ·±åº¦ <code>depth</code>ï¼šä»æ ¹èŠ‚ç‚¹åˆ°è¯¥èŠ‚ç‚¹æ‰€ç»è¿‡çš„è¾¹çš„æ•°é‡ã€‚</li><li>èŠ‚ç‚¹çš„é«˜åº¦ <code>height</code>ï¼šä»æœ€è¿œå¶èŠ‚ç‚¹åˆ°è¯¥èŠ‚ç‚¹æ‰€ç»è¿‡çš„è¾¹çš„æ•°é‡ã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree.assets/binary_tree_terminology.png"></p><blockquote><p>æ³¨æ„ï¼Œæˆ‘ä»¬é€šå¸¸å°†â€œé«˜åº¦â€å’Œâ€œæ·±åº¦â€å®šä¹‰ä¸ºâ€œèµ°è¿‡è¾¹çš„æ•°é‡â€ï¼Œä½†æœ‰äº›é¢˜ç›®æˆ–æ•™æå¯èƒ½ä¼šå°†å…¶å®šä¹‰ä¸ºâ€œèµ°è¿‡èŠ‚ç‚¹çš„æ•°é‡â€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé«˜åº¦å’Œæ·±åº¦éƒ½éœ€è¦åŠ <code>1</code>ã€‚</p></blockquote><h4 id="äºŒå‰æ ‘å¸¸è§é—®é¢˜"><a href="#äºŒå‰æ ‘å¸¸è§é—®é¢˜" class="headerlink" title="äºŒå‰æ ‘å¸¸è§é—®é¢˜"></a>äºŒå‰æ ‘å¸¸è§é—®é¢˜</h4><p>ï¼ˆ1ï¼‰äºŒå‰æ ‘æŸèŠ‚ç‚¹æ‰€åœ¨çš„æ·±åº¦ï¼ˆå±‚æ•°ï¼‰</p><p>åœ¨é€’å½’æ–¹æ¡ˆä¸­ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯ç›®æ ‡èŠ‚ç‚¹ï¼Œè¿”å›å½“å‰çš„æ·±åº¦ã€‚å¦åˆ™ï¼Œé€’å½’åœ°æœç´¢è¯¥èŠ‚ç‚¹çš„å·¦å³å­èŠ‚ç‚¹ï¼ŒåŒæ—¶æ·±åº¦åŠ ä¸€ã€‚å¦‚æœåœ¨å·¦æˆ–å³å­æ ‘ä¸­æ‰¾åˆ°äº†ç›®æ ‡èŠ‚ç‚¹ï¼Œè¿”å›æ‰¾åˆ°çš„æ·±åº¦ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">findLevel</span><span class="params">(TreeNode root, <span class="type">int</span> targetVal, <span class="type">int</span> level)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(root.val == targetVal) &#123;</span><br><span class="line">        <span class="keyword">return</span> level;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">leftLevel</span> <span class="operator">=</span> findLevel(root.left, targetVal, level + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(leftLevel != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> leftLevel;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> findLevel(root.right, targetVal, level + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">level</span> <span class="operator">=</span> findLevel(root, targetVal, <span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>é™¤äº†é€’å½’éå†æ³•ï¼Œè¿˜å¯ä»¥é€šè¿‡è¿­ä»£çš„æ–¹å¼è¿›è¡Œå±‚æ¬¡éå†ï¼ˆå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼Œ<code>BFS</code>ï¼‰æ¥æ‰¾åˆ°èŠ‚ç‚¹çš„æ·±åº¦ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">findLevelBFS</span><span class="params">(TreeNode root, <span class="type">int</span> targetVal)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    Queue&lt;Integer&gt; levels = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    queue.add(root);</span><br><span class="line">    levels.add(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(!queue.isEmpty()) &#123;</span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">currentNode</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">        <span class="type">int</span> <span class="variable">currentLevel</span> <span class="operator">=</span> levels.poll();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(currentNode.val == targetVal) &#123;</span><br><span class="line">            <span class="keyword">return</span> currentLevel;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(currentNode.left != <span class="literal">null</span>) &#123;</span><br><span class="line">            queue.add(currentNode.left);</span><br><span class="line">            levels.add(currentLevel + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(currentNode.right != <span class="literal">null</span>) &#123;</span><br><span class="line">            queue.add(currentNode.right);</span><br><span class="line">            levels.add(currentLevel + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰äºŒå‰æ ‘çš„èŠ‚ç‚¹æ€»æ•° | è¾¹æ€»æ•°</p><p>äºŒå‰æ ‘çš„èŠ‚ç‚¹æ€»æ•°ç­‰äºæ ¹èŠ‚ç‚¹åŠ ä¸Šå·¦å­æ ‘çš„èŠ‚ç‚¹æ€»æ•°å’Œå³å­æ ‘çš„èŠ‚ç‚¹æ€»æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">countNodes</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> + countNodes(root.left) + countNodes(root.right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™¤äº†é€’å½’ï¼Œè¿˜å¯ä»¥é€šè¿‡è¿­ä»£çš„æ–¹å¼æ¥è®¡ç®—èŠ‚ç‚¹æ€»æ•°ï¼Œé€šå¸¸ä½¿ç”¨å±‚æ¬¡éå†ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">countNodesIterative</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    queue.add(root);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">currentNode</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">        count++;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (currentNode.left != <span class="literal">null</span>) &#123;</span><br><span class="line">            queue.add(currentNode.left);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (currentNode.right != <span class="literal">null</span>) &#123;</span><br><span class="line">            queue.add(currentNode.right);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºè¾¹æ€»æ•°ï¼Œ<ins>ä¸€ä¸ªåŒ…å«<code>N</code>ä¸ªèŠ‚ç‚¹çš„éç©ºäºŒå‰æ ‘ï¼Œå…¶è¾¹æ•°<code>E</code>ä¸º<code>E = N âˆ’ 1</code></ins>ã€‚</p><p>ï¼ˆ3ï¼‰äºŒå‰æ ‘çš„é«˜åº¦ | æŸèŠ‚ç‚¹é«˜åº¦</p><p>äºŒå‰æ ‘çš„é«˜åº¦æ˜¯ä»æ ¹èŠ‚ç‚¹åˆ°æœ€è¿œå¶å­èŠ‚ç‚¹çš„æœ€é•¿è·¯å¾„ä¸Šçš„èŠ‚ç‚¹æ•°ã€‚å¯ä»¥ä½¿ç”¨é€’å½’æ–¹æ³•ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œé€’å½’åœ°è®¡ç®—å·¦å­æ ‘å’Œå³å­æ ‘çš„é«˜åº¦ï¼Œç„¶åå–ä¸¤è€…ä¸­çš„è¾ƒå¤§å€¼ï¼Œå¹¶åŠ ä¸Š<code>1</code>ï¼ˆæ ¹èŠ‚ç‚¹è‡ªèº«ï¼‰ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">getHeight</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">leftHeight</span> <span class="operator">=</span> getHeight(root.left);</span><br><span class="line">    <span class="type">int</span> <span class="variable">rightHeight</span> <span class="operator">=</span> getHeight(root.right);</span><br><span class="line">    <span class="keyword">return</span> Math.max(leftHeight, rightHeight) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è¿­ä»£çš„æ–¹æ³•æ¥è®¡ç®—äºŒå‰æ ‘çš„é«˜åº¦é€šå¸¸æ¶‰åŠå±‚æ¬¡éå†ï¼Œä¸‹é¢æ˜¯å®ç°æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">getHeightIterative</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    queue.offer(root);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">height</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">levelSize</span> <span class="operator">=</span> queue.size(); <span class="comment">// å½“å‰å±‚çš„èŠ‚ç‚¹æ•°é‡</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// éå†å½“å‰å±‚çš„æ‰€æœ‰èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; levelSize; i++) &#123;</span><br><span class="line">            <span class="type">TreeNode</span> <span class="variable">current</span> <span class="operator">=</span> queue.poll(); <span class="comment">// ä»é˜Ÿåˆ—ä¸­ç§»é™¤èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// å°†å­èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—</span></span><br><span class="line">            <span class="keyword">if</span> (current.left != <span class="literal">null</span>) &#123;</span><br><span class="line">                queue.offer(current.left);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (current.right != <span class="literal">null</span>) &#123;</span><br><span class="line">                queue.offer(current.right);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å®Œæˆä¸€å±‚çš„éå†ï¼Œé«˜åº¦åŠ  1</span></span><br><span class="line">        height++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> height;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ4ï¼‰äºŒå‰æ ‘çš„å­å¶æ€»æ•°</p><p>åœ¨é€’å½’æ–¹æ³•ä¸­ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹éå†ã€‚å¦‚æœé‡åˆ°ä¸€ä¸ª<code>null</code>èŠ‚ç‚¹ï¼Œè¿”å›<code>0</code>ã€‚å¦‚æœé‡åˆ°ä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼Œè¿”å›<code>1</code>ã€‚ç„¶åï¼Œé€’å½’åœ°è®¡ç®—å·¦å­æ ‘å’Œå³å­æ ‘çš„å¶å­èŠ‚ç‚¹æ•°ï¼Œå¹¶å°†å®ƒä»¬ç›¸åŠ ä»¥å¾—åˆ°æ€»æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">countLeaves</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (root.left == <span class="literal">null</span> &amp;&amp; root.right == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// æ˜¯ä¸€ä¸ªå¶å­èŠ‚ç‚¹</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> countLeaves(root.left) + countLeaves(root.right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è¿­ä»£çš„æ–¹æ³•æ¥è®¡ç®—äºŒå‰æ ‘çš„å­å¶æ€»æ•°æ¶‰åŠå±‚æ¬¡éå†ï¼Œä¸‹é¢æ˜¯å®ç°æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">countLeavesIterative</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    queue.offer(root);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">leafCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">current</span> <span class="operator">=</span> queue.poll();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (current.left == <span class="literal">null</span> &amp;&amp; current.right == <span class="literal">null</span>) &#123;</span><br><span class="line">            leafCount++; <span class="comment">// æ˜¯ä¸€ä¸ªå¶å­èŠ‚ç‚¹</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (current.left != <span class="literal">null</span>) &#123;</span><br><span class="line">            queue.offer(current.left);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (current.right != <span class="literal">null</span>) &#123;</span><br><span class="line">            queue.offer(current.right);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> leafCount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¤šå‰æ ‘ï¼ˆæ‰©å±•ï¼‰"><a href="#å¤šå‰æ ‘ï¼ˆæ‰©å±•ï¼‰" class="headerlink" title="å¤šå‰æ ‘ï¼ˆæ‰©å±•ï¼‰"></a>å¤šå‰æ ‘ï¼ˆæ‰©å±•ï¼‰</h4><p>å¤šå‰æ ‘ï¼ˆä¹Ÿç§°ä¸ºå¤šè·¯æ ‘æˆ–<code>K</code>å‰æ ‘ï¼‰æ˜¯ä¸€ç§æ ‘å½¢æ•°æ®ç»“æ„ï¼Œå…¶ä¸­æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥æœ‰å¤šäºä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚è¿™ä¸äºŒå‰æ ‘å½¢æˆå¯¹æ¯”ï¼Œåœ¨äºŒå‰æ ‘ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ€å¤šåªèƒ½æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TreeNode</span> &#123;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    List&lt;TreeNode&gt; children;</span><br><span class="line">    TreeNode(<span class="type">int</span> x) &#123;</span><br><span class="line">        val = x;</span><br><span class="line">        children = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ1ï¼‰å¤šå‰æ ‘æŸèŠ‚ç‚¹æ‰€åœ¨çš„æ·±åº¦ï¼ˆå±‚æ•°ï¼‰</p><p>åœ¨å¤šå‰æ ‘ä¸­ï¼Œä¸€ä¸ªèŠ‚ç‚¹çš„æ·±åº¦æ˜¯ä»æ ¹èŠ‚ç‚¹åˆ°è¯¥èŠ‚ç‚¹çš„å”¯ä¸€è·¯å¾„ä¸Šçš„è¾¹çš„æ•°é‡ã€‚æ ¹èŠ‚ç‚¹çš„æ·±åº¦ä¸º<code>0</code>ï¼Œå…¶ç›´æ¥å­èŠ‚ç‚¹çš„æ·±åº¦ä¸º<code>1</code>ï¼Œä¾æ­¤ç±»æ¨ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é€’å½’å†™æ³•</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">findDepth</span><span class="params">(TreeNode root, <span class="type">int</span> target, <span class="type">int</span> depth)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>; <span class="comment">// èŠ‚ç‚¹æœªæ‰¾åˆ°</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (root.val == target) &#123;</span><br><span class="line">        <span class="keyword">return</span> depth; <span class="comment">// èŠ‚ç‚¹æ‰¾åˆ°ï¼Œè¿”å›æ·±åº¦</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (TreeNode child : root.children) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> findDepth(child, target, depth + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (result != -<span class="number">1</span>) &#123; <span class="comment">// å¦‚æœåœ¨å­æ ‘ä¸­æ‰¾åˆ°èŠ‚ç‚¹ï¼Œè¿”å›ç»“æœ</span></span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>; <span class="comment">// åœ¨è¿™ä¸ªå­æ ‘ä¸­æ²¡æœ‰æ‰¾åˆ°èŠ‚ç‚¹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿­ä»£å†™æ³•</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">findNodeDepthIterative</span><span class="params">(TreeNode root, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Queue&lt;TreeNode&gt; nodeQueue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    Queue&lt;Integer&gt; depthQueue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    nodeQueue.offer(root);</span><br><span class="line">    depthQueue.offer(<span class="number">0</span>);  <span class="comment">// æ ¹èŠ‚ç‚¹çš„æ·±åº¦æ˜¯0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!nodeQueue.isEmpty()) &#123;</span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">currentNode</span> <span class="operator">=</span> nodeQueue.poll();</span><br><span class="line">        <span class="type">int</span> <span class="variable">currentDepth</span> <span class="operator">=</span> depthQueue.poll();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœæ‰¾åˆ°äº†ç›®æ ‡èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (currentNode.val == target) &#123;</span><br><span class="line">            <span class="keyword">return</span> currentDepth;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†å­èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—</span></span><br><span class="line">        <span class="keyword">for</span> (TreeNode child : currentNode.children) &#123;</span><br><span class="line">            nodeQueue.offer(child);</span><br><span class="line">            depthQueue.offer(currentDepth + <span class="number">1</span>);  <span class="comment">// å­èŠ‚ç‚¹çš„æ·±åº¦æ˜¯å½“å‰èŠ‚ç‚¹æ·±åº¦+1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;  <span class="comment">// å¦‚æœæœªæ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰å¤šå‰æ ‘çš„èŠ‚ç‚¹æ€»æ•°</p><p>å¤šå‰æ ‘çš„èŠ‚ç‚¹æ€»æ•°ç­‰äºæ ¹èŠ‚ç‚¹è‡ªèº«ï¼ˆ<code>1</code>ä¸ªèŠ‚ç‚¹ï¼‰åŠ ä¸Šæ‰€æœ‰å­æ ‘çš„èŠ‚ç‚¹æ€»æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é€’å½’å†™æ³•</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">countNodes</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">1</span>; <span class="comment">// è®¡ç®—æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">for</span> (TreeNode child : root.children) &#123;</span><br><span class="line">        count += countNodes(child); <span class="comment">// é€’å½’è®¡ç®—æ¯ä¸ªå­æ ‘çš„èŠ‚ç‚¹æ•°ï¼Œå¹¶ç´¯åŠ </span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿­ä»£å†™æ³•</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">countNodesIterative</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    queue.offer(root);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">current</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">        count++; <span class="comment">// è®¡ç®—å½“å‰èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (TreeNode child : current.children) &#123;</span><br><span class="line">            queue.offer(child); <span class="comment">// å°†å­èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—ï¼Œä»¥ä¾¿åç»­éå†</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰å¤šå‰æ ‘çš„é«˜åº¦ | æŸèŠ‚ç‚¹é«˜åº¦</p><p>åœ¨é€’å½’æ–¹æ¡ˆä¸­ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œé€’å½’åœ°è®¡ç®—æ‰€æœ‰å­æ ‘çš„é«˜åº¦ï¼Œå–å…¶ä¸­çš„æœ€å¤§å€¼ï¼Œå¹¶åŠ <code>1</code>ï¼ˆåŒ…æ‹¬å½“å‰èŠ‚ç‚¹è‡ªå·±ï¼‰ã€‚è‹¥é‡åˆ°ç©ºèŠ‚ç‚¹ï¼Œè¿”å›<code>0</code>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é€’å½’å†™æ³•</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">height</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">maxHeight</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (TreeNode child : root.children) &#123;</span><br><span class="line">        maxHeight = Math.max(maxHeight, height(child));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> + maxHeight;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿­ä»£å†™æ³•</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">findHeightIterative</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    queue.offer(root);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">height</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">levelSize</span> <span class="operator">=</span> queue.size(); <span class="comment">// å½“å‰å±‚çš„èŠ‚ç‚¹æ•°</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; levelSize; i++) &#123;</span><br><span class="line">            <span class="type">TreeNode</span> <span class="variable">current</span> <span class="operator">=</span> queue.poll();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (TreeNode child : current.children) &#123;</span><br><span class="line">                queue.offer(child);  <span class="comment">// å°†å­èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—ï¼Œä»¥ä¾¿åç»­éå†</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        height++;  <span class="comment">// å®Œæˆä¸€å±‚çš„éå†åï¼Œé«˜åº¦åŠ 1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> height;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ4ï¼‰å¤šå‰æ ‘çš„å­å¶æ€»æ•°</p><p>åœ¨é€’å½’æ–¹æ¡ˆä¸­ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œé€’å½’åœ°éå†æ¯ä¸ªå­æ ‘ã€‚å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œåˆ™å®ƒæ˜¯ä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼Œè®¡æ•°å™¨åŠ ä¸€ã€‚é€’å½’ç»“æŸåï¼Œè®¡æ•°å™¨çš„å€¼å³ä¸ºå¶å­èŠ‚ç‚¹çš„æ€»æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é€’å½’å†™æ³•</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">countLeaves</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (root.children.isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// æ˜¯ä¸€ä¸ªå¶å­èŠ‚ç‚¹</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (TreeNode child : root.children) &#123;</span><br><span class="line">        count += countLeaves(child);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿­ä»£å†™æ³•</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">countLeafNodesIterative</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    queue.offer(root);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">leafCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">current</span> <span class="operator">=</span> queue.poll();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯å¶å­èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (current.children.isEmpty()) &#123;</span><br><span class="line">            leafCount++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†å­èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—</span></span><br><span class="line">        <span class="keyword">for</span> (TreeNode child : current.children) &#123;</span><br><span class="line">            queue.offer(child);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> leafCount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="äºŒå‰æ ‘åŸºæœ¬æ“ä½œ"><a href="#äºŒå‰æ ‘åŸºæœ¬æ“ä½œ" class="headerlink" title="äºŒå‰æ ‘åŸºæœ¬æ“ä½œ"></a>äºŒå‰æ ‘åŸºæœ¬æ“ä½œ</h4><p>ï¼ˆ1ï¼‰åˆå§‹åŒ–äºŒå‰æ ‘</p><p>ä¸é“¾è¡¨ç±»ä¼¼ï¼Œé¦–å…ˆåˆå§‹åŒ–èŠ‚ç‚¹ï¼Œç„¶åæ„å»ºå¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆå§‹åŒ–èŠ‚ç‚¹</span></span><br><span class="line"><span class="type">TreeNode</span> <span class="variable">n1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">1</span>);</span><br><span class="line"><span class="type">TreeNode</span> <span class="variable">n2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">2</span>);</span><br><span class="line"><span class="type">TreeNode</span> <span class="variable">n3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">3</span>);</span><br><span class="line"><span class="type">TreeNode</span> <span class="variable">n4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">4</span>);</span><br><span class="line"><span class="type">TreeNode</span> <span class="variable">n5</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">5</span>);</span><br><span class="line"><span class="comment">// æ„å»ºå¼•ç”¨æŒ‡å‘ï¼ˆå³æŒ‡é’ˆï¼‰</span></span><br><span class="line">n1.left = n2;</span><br><span class="line">n1.right = n3;</span><br><span class="line">n2.left = n4;</span><br><span class="line">n2.right = n5;</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰æ’å…¥ä¸åˆ é™¤èŠ‚ç‚¹</p><p>ä¸é“¾è¡¨ç±»ä¼¼ï¼Œåœ¨äºŒå‰æ ‘ä¸­æ’å…¥ä¸åˆ é™¤èŠ‚ç‚¹å¯ä»¥é€šè¿‡ä¿®æ”¹æŒ‡é’ˆæ¥å®ç°ã€‚ä¸‹å›¾ç»™å‡ºäº†ä¸€ä¸ªç¤ºä¾‹ã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree.assets/binary_tree_add_remove.png"></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">TreeNode</span> <span class="variable">P</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// åœ¨ n1 -&gt; n2 ä¸­é—´æ’å…¥èŠ‚ç‚¹ P</span></span><br><span class="line">n1.left = P;</span><br><span class="line">P.left = n2;</span><br><span class="line"><span class="comment">// åˆ é™¤èŠ‚ç‚¹ P</span></span><br><span class="line">n1.left = n2;</span><br></pre></td></tr></table></figure><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ’å…¥èŠ‚ç‚¹å¯èƒ½ä¼šæ”¹å˜äºŒå‰æ ‘çš„åŸæœ‰é€»è¾‘ç»“æ„ï¼Œè€Œåˆ é™¤èŠ‚ç‚¹é€šå¸¸æ„å‘³ç€åˆ é™¤è¯¥èŠ‚ç‚¹åŠå…¶æ‰€æœ‰å­æ ‘ã€‚å› æ­¤ï¼Œåœ¨äºŒå‰æ ‘ä¸­ï¼Œæ’å…¥ä¸åˆ é™¤æ“ä½œé€šå¸¸æ˜¯ç”±ä¸€å¥—æ“ä½œé…åˆå®Œæˆçš„ï¼Œä»¥å®ç°æœ‰å®é™…æ„ä¹‰çš„æ“ä½œã€‚</p></blockquote><h4 id="å¸¸è§äºŒå‰æ ‘ç±»å‹"><a href="#å¸¸è§äºŒå‰æ ‘ç±»å‹" class="headerlink" title="å¸¸è§äºŒå‰æ ‘ç±»å‹"></a>å¸¸è§äºŒå‰æ ‘ç±»å‹</h4><p><strong>å®Œç¾äºŒå‰æ ‘</strong></p><p>ã€Œå®Œç¾äºŒå‰æ ‘ <code>perfect binary tree</code>ã€<ins>é™¤äº†æœ€åº•å±‚å¤–ï¼Œå…¶ä½™æ‰€æœ‰å±‚çš„èŠ‚ç‚¹éƒ½è¢«å®Œå…¨å¡«æ»¡</ins>ã€‚åœ¨å®Œç¾äºŒå‰æ ‘ä¸­ï¼Œå¶èŠ‚ç‚¹çš„åº¦ä¸º<code>0</code>ï¼Œå…¶ä½™æ‰€æœ‰èŠ‚ç‚¹çš„åº¦éƒ½ä¸º<code>2</code>ã€‚è‹¥æ ‘é«˜åº¦ä¸º<code>h</code>ï¼Œåˆ™èŠ‚ç‚¹æ€»æ•°ä¸º<code>2^(h + 1) - 1</code>ï¼Œå‘ˆç°æ ‡å‡†çš„æŒ‡æ•°çº§å…³ç³»ï¼Œåæ˜ äº†è‡ªç„¶ç•Œä¸­å¸¸è§çš„ç»†èƒåˆ†è£‚ç°è±¡ã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree.assets/perfect_binary_tree.png"></p><p><strong>å®Œå…¨äºŒå‰æ ‘</strong></p><p>ã€Œå®Œå…¨äºŒå‰æ ‘ <code>complete binary tree</code>ã€<ins>åªæœ‰æœ€åº•å±‚çš„èŠ‚ç‚¹æœªè¢«å¡«æ»¡ï¼Œä¸”æœ€åº•å±‚èŠ‚ç‚¹å°½é‡é å·¦å¡«å……</ins>ã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree.assets/complete_binary_tree.png"></p><p><strong>å®Œæ»¡äºŒå‰æ ‘</strong></p><p>ã€Œå®Œæ»¡äºŒå‰æ ‘ <code>full binary tree</code>ã€<ins>é™¤äº†å¶èŠ‚ç‚¹ä¹‹å¤–ï¼Œå…¶ä½™æ‰€æœ‰èŠ‚ç‚¹éƒ½æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹</ins>ã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree.assets/full_binary_tree.png"></p><p><strong>å¹³è¡¡äºŒå‰æ ‘</strong></p><p>ã€Œå¹³è¡¡äºŒå‰æ ‘ <code>balanced binary tree</code>ã€ä¸­<ins>ä»»æ„èŠ‚ç‚¹çš„å·¦å­æ ‘å’Œå³å­æ ‘é«˜åº¦ä¹‹å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡<code>1</code></ins>ã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree.assets/balanced_binary_tree.png"></p><h4 id="äºŒå‰æ ‘çš„é€€åŒ–"><a href="#äºŒå‰æ ‘çš„é€€åŒ–" class="headerlink" title="äºŒå‰æ ‘çš„é€€åŒ–"></a>äºŒå‰æ ‘çš„é€€åŒ–</h4><p>å½“äºŒå‰æ ‘çš„æ¯å±‚èŠ‚ç‚¹éƒ½è¢«å¡«æ»¡æ—¶ï¼Œè¾¾åˆ°â€œå®Œç¾äºŒå‰æ ‘â€ã€‚å®Œç¾äºŒå‰æ ‘æ˜¯ç†æƒ³æƒ…å†µï¼Œå¯ä»¥å……åˆ†å‘æŒ¥äºŒå‰æ ‘â€œåˆ†æ²»â€çš„ä¼˜åŠ¿ã€‚è€Œå½“æ‰€æœ‰èŠ‚ç‚¹éƒ½åå‘ä¸€ä¾§æ—¶ï¼ŒäºŒå‰æ ‘å°±ä¼šé€€åŒ–ä¸ºâ€œé“¾è¡¨â€ï¼Œå„é¡¹æ“ä½œéƒ½å˜ä¸ºçº¿æ€§æ“ä½œï¼Œæ—¶é—´å¤æ‚åº¦é€€åŒ–è‡³<code>O(n)</code>ã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree.assets/binary_tree_best_worst_cases.png"></p><p>å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œåœ¨æœ€ä½³å’Œæœ€å·®ç»“æ„ä¸‹ï¼ŒäºŒå‰æ ‘çš„å¶èŠ‚ç‚¹æ•°é‡ã€èŠ‚ç‚¹æ€»æ•°ã€é«˜åº¦ç­‰è¾¾åˆ°æå¤§æˆ–æå°å€¼ã€‚</p><table><thead><tr><th align="left"></th><th align="left">å®Œç¾äºŒå‰æ ‘</th><th align="left">é“¾è¡¨</th></tr></thead><tbody><tr><td align="left">ç¬¬<code>i</code>å±‚çš„èŠ‚ç‚¹æ•°é‡</td><td align="left"><code>2^(i - 1)</code></td><td align="left"><code>1</code></td></tr><tr><td align="left">é«˜åº¦<code>h</code>æ ‘çš„å¶èŠ‚ç‚¹æ•°é‡</td><td align="left"><code>2^h</code></td><td align="left"><code>1</code></td></tr><tr><td align="left">é«˜åº¦<code>h</code>æ ‘çš„èŠ‚ç‚¹æ€»æ•°</td><td align="left"><code>2^(h + 1) - 1</code></td><td align="left"><code>h + 1</code></td></tr><tr><td align="left">èŠ‚ç‚¹æ€»æ•°<code>n</code>æ ‘çš„é«˜åº¦</td><td align="left"><code>log2(n + 1) - 1</code></td><td align="left"><code>n + 1</code></td></tr></tbody></table><hr><h3 id="7-2-äºŒå‰æ ‘éå†"><a href="#7-2-äºŒå‰æ ‘éå†" class="headerlink" title="7.2 äºŒå‰æ ‘éå†"></a>7.2 äºŒå‰æ ‘éå†</h3><p>äºŒå‰æ ‘å¸¸è§çš„éå†æ–¹å¼åŒ…æ‹¬å±‚åºéå†ã€å‰åºéå†ã€ä¸­åºéå†å’Œååºéå†ç­‰ã€‚</p><h4 id="å±‚åºéå†"><a href="#å±‚åºéå†" class="headerlink" title="å±‚åºéå†"></a>å±‚åºéå†</h4><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œã€Œå±‚åºéå† <code>level-order traversal</code>ã€ä»é¡¶éƒ¨åˆ°åº•éƒ¨é€å±‚éå†äºŒå‰æ ‘ï¼Œå¹¶åœ¨æ¯ä¸€å±‚æŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºè®¿é—®èŠ‚ç‚¹ã€‚</p><p>å±‚åºéå†æœ¬è´¨ä¸Šå±äºã€Œå¹¿åº¦ä¼˜å…ˆéå† <code>breadth-first traversal</code>ã€ï¼Œå®ƒä½“ç°äº†ä¸€ç§â€œä¸€åœˆä¸€åœˆå‘å¤–æ‰©å±•â€çš„é€å±‚éå†æ–¹å¼ã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree_traversal.assets/binary_tree_bfs.png"></p><p><ins>å¹¿åº¦ä¼˜å…ˆéå†é€šå¸¸å€ŸåŠ©â€œé˜Ÿåˆ—â€æ¥å®ç°</ins>ã€‚é˜Ÿåˆ—éµå¾ªâ€œå…ˆè¿›å…ˆå‡ºâ€çš„è§„åˆ™ï¼Œè€Œå¹¿åº¦ä¼˜å…ˆéå†åˆ™éµå¾ªâ€œé€å±‚æ¨è¿›â€çš„è§„åˆ™ï¼Œä¸¤è€…èƒŒåçš„æ€æƒ³æ˜¯ä¸€è‡´çš„ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å±‚åºéå† */</span></span><br><span class="line">List&lt;Integer&gt; <span class="title function_">levelOrder</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–é˜Ÿåˆ—ï¼ŒåŠ å…¥æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    queue.add(root);</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¸€ä¸ªåˆ—è¡¨ï¼Œç”¨äºä¿å­˜éå†åºåˆ—</span></span><br><span class="line">    List&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">node</span> <span class="operator">=</span> queue.poll(); <span class="comment">// é˜Ÿåˆ—å‡ºé˜Ÿ</span></span><br><span class="line">        list.add(node.val);           <span class="comment">// ä¿å­˜èŠ‚ç‚¹å€¼</span></span><br><span class="line">        <span class="keyword">if</span> (node.left != <span class="literal">null</span>)</span><br><span class="line">            queue.offer(node.left);   <span class="comment">// å·¦å­èŠ‚ç‚¹å…¥é˜Ÿ</span></span><br><span class="line">        <span class="keyword">if</span> (node.right != <span class="literal">null</span>)</span><br><span class="line">            queue.offer(node.right);  <span class="comment">// å³å­èŠ‚ç‚¹å…¥é˜Ÿ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ—¶é—´å¤æ‚åº¦ï¼šæ‰€æœ‰èŠ‚ç‚¹è¢«è®¿é—®ä¸€æ¬¡ï¼Œä½¿ç”¨<code>O(n)</code>æ—¶é—´ï¼Œå…¶ä¸­<code>n</code>ä¸ºèŠ‚ç‚¹æ•°é‡ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼šåœ¨æœ€å·®æƒ…å†µä¸‹ï¼Œå³æ»¡äºŒå‰æ ‘æ—¶ï¼Œéå†åˆ°æœ€åº•å±‚ä¹‹å‰ï¼Œé˜Ÿåˆ—ä¸­æœ€å¤šåŒæ—¶å­˜åœ¨<code>(n + 1) / 2</code>ä¸ªèŠ‚ç‚¹ï¼Œå ç”¨<code>O(n)</code>ç©ºé—´ã€‚</li></ul><h4 id="å‰åºã€ä¸­åºã€ååºéå†"><a href="#å‰åºã€ä¸­åºã€ååºéå†" class="headerlink" title="å‰åºã€ä¸­åºã€ååºéå†"></a>å‰åºã€ä¸­åºã€ååºéå†</h4><p>ç›¸åº”åœ°ï¼Œå‰åºã€ä¸­åºå’Œååºéå†éƒ½å±äºã€Œæ·±åº¦ä¼˜å…ˆéå† <code>depth-first traversal</code>ã€ï¼Œå®ƒä½“ç°äº†ä¸€ç§â€œå…ˆèµ°åˆ°å°½å¤´ï¼Œå†å›æº¯ç»§ç»­â€çš„éå†æ–¹å¼ã€‚</p><p>ä¸‹å›¾å±•ç¤ºäº†å¯¹äºŒå‰æ ‘è¿›è¡Œæ·±åº¦ä¼˜å…ˆéå†çš„å·¥ä½œåŸç†ã€‚æ·±åº¦ä¼˜å…ˆéå†å°±åƒæ˜¯ç»•ç€æ•´ä¸ªäºŒå‰æ ‘çš„å¤–å›´â€œèµ°â€ä¸€åœˆï¼Œåœ¨æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šé‡åˆ°ä¸‰ä¸ªä½ç½®ï¼Œåˆ†åˆ«å¯¹åº”å‰åºéå†ã€ä¸­åºéå†å’Œååºéå†ã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree_traversal.assets/binary_tree_dfs.png"></p><p><ins>æ·±åº¦ä¼˜å…ˆæœç´¢é€šå¸¸åŸºäºé€’å½’å®ç°</ins>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å‰åºéå† */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">preOrder</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// è®¿é—®ä¼˜å…ˆçº§ï¼šæ ¹èŠ‚ç‚¹ -&gt; å·¦å­æ ‘ -&gt; å³å­æ ‘</span></span><br><span class="line">    list.add(root.val);</span><br><span class="line">    preOrder(root.left);</span><br><span class="line">    preOrder(root.right);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä¸­åºéå† */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">inOrder</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// è®¿é—®ä¼˜å…ˆçº§ï¼šå·¦å­æ ‘ -&gt; æ ¹èŠ‚ç‚¹ -&gt; å³å­æ ‘</span></span><br><span class="line">    inOrder(root.left);</span><br><span class="line">    list.add(root.val);</span><br><span class="line">    inOrder(root.right);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ååºéå† */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">postOrder</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// è®¿é—®ä¼˜å…ˆçº§ï¼šå·¦å­æ ‘ -&gt; å³å­æ ‘ -&gt; æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    postOrder(root.left);</span><br><span class="line">    postOrder(root.right);</span><br><span class="line">    list.add(root.val);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹å›¾å±•ç¤ºäº†å‰åºéå†äºŒå‰æ ‘çš„é€’å½’è¿‡ç¨‹ï¼Œå…¶å¯åˆ†ä¸ºâ€œé€’â€å’Œâ€œå½’â€ä¸¤ä¸ªé€†å‘çš„éƒ¨åˆ†ã€‚</p><ul><li>â€œé€’â€è¡¨ç¤ºå¼€å¯æ–°æ–¹æ³•ï¼Œç¨‹åºåœ¨æ­¤è¿‡ç¨‹ä¸­è®¿é—®ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚</li><li>â€œå½’â€è¡¨ç¤ºå‡½æ•°è¿”å›ï¼Œä»£è¡¨å½“å‰èŠ‚ç‚¹å·²ç»è®¿é—®å®Œæ¯•ã€‚</li></ul><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1">1</button></li><li class="tab"><button type="button" data-href="#placeholder-2">2</button></li><li class="tab"><button type="button" data-href="#placeholder-3">3</button></li><li class="tab"><button type="button" data-href="#placeholder-4">4</button></li><li class="tab"><button type="button" data-href="#placeholder-5">5</button></li><li class="tab"><button type="button" data-href="#placeholder-6">6</button></li><li class="tab"><button type="button" data-href="#placeholder-7">7</button></li><li class="tab"><button type="button" data-href="#placeholder-8">8</button></li><li class="tab"><button type="button" data-href="#placeholder-9">9</button></li><li class="tab"><button type="button" data-href="#placeholder-10">10</button></li><li class="tab"><button type="button" data-href="#placeholder-11">11</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree_traversal.assets/preorder_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree_traversal.assets/preorder_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree_traversal.assets/preorder_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree_traversal.assets/preorder_step4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-5"><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree_traversal.assets/preorder_step5.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-6"><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree_traversal.assets/preorder_step6.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-7"><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree_traversal.assets/preorder_step7.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-8"><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree_traversal.assets/preorder_step8.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-9"><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree_traversal.assets/preorder_step9.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-10"><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree_traversal.assets/preorder_step10.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-11"><p><img src="https://www.hello-algo.com/chapter_tree/binary_tree_traversal.assets/preorder_step11.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>æ—¶é—´å¤æ‚åº¦ï¼šæ‰€æœ‰èŠ‚ç‚¹è¢«è®¿é—®ä¸€æ¬¡ï¼Œä½¿ç”¨<code>O(n)</code>æ—¶é—´ï¼Œå…¶ä¸­<code>n</code>ä¸ºèŠ‚ç‚¹æ•°é‡ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼šåœ¨æœ€å·®æƒ…å†µä¸‹ï¼Œå³æ ‘é€€åŒ–ä¸ºé“¾è¡¨æ—¶ï¼Œé€’å½’æ·±åº¦è¾¾åˆ°<code>n</code>ï¼Œç³»ç»Ÿå ç”¨<code>O(n)</code>æ ˆå¸§ç©ºé—´ã€‚</li></ul><hr><h3 id="7-3-äºŒå‰æ ‘æ•°ç»„è¡¨ç¤º"><a href="#7-3-äºŒå‰æ ‘æ•°ç»„è¡¨ç¤º" class="headerlink" title="7.3 äºŒå‰æ ‘æ•°ç»„è¡¨ç¤º"></a>7.3 äºŒå‰æ ‘æ•°ç»„è¡¨ç¤º</h3><p>åœ¨é“¾è¡¨è¡¨ç¤ºä¸‹ï¼ŒäºŒå‰æ ‘çš„å­˜å‚¨å•å…ƒä¸ºèŠ‚ç‚¹<code>TreeNode</code>ï¼ŒèŠ‚ç‚¹ä¹‹é—´é€šè¿‡æŒ‡é’ˆç›¸è¿æ¥ã€‚é‚£ä¹ˆï¼Œèƒ½å¦ç”¨æ•°ç»„æ¥è¡¨ç¤ºäºŒå‰æ ‘å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚</p><h4 id="è¡¨ç¤ºå®Œç¾äºŒå‰æ ‘"><a href="#è¡¨ç¤ºå®Œç¾äºŒå‰æ ‘" class="headerlink" title="è¡¨ç¤ºå®Œç¾äºŒå‰æ ‘"></a>è¡¨ç¤ºå®Œç¾äºŒå‰æ ‘</h4><p>ç»™å®šä¸€ä¸ªå®Œç¾äºŒå‰æ ‘ï¼Œå°†æ‰€æœ‰èŠ‚ç‚¹æŒ‰ç…§å±‚åºéå†çš„é¡ºåºå­˜å‚¨åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œåˆ™æ¯ä¸ªèŠ‚ç‚¹éƒ½å¯¹åº”å”¯ä¸€çš„æ•°ç»„ç´¢å¼•ã€‚</p><p>æ ¹æ®å±‚åºéå†çš„ç‰¹æ€§ï¼Œå¯ä»¥æ¨å¯¼å‡ºçˆ¶èŠ‚ç‚¹ç´¢å¼•ä¸å­èŠ‚ç‚¹ç´¢å¼•ä¹‹é—´çš„â€œæ˜ å°„å…¬å¼â€ã€‚<ins>è‹¥èŠ‚ç‚¹çš„ç´¢å¼•ä¸º<code>i</code>ï¼Œåˆ™è¯¥èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ç´¢å¼•ä¸º<code>2i + 1</code>ï¼Œå³å­èŠ‚ç‚¹ç´¢å¼•ä¸º<code>2i + 2</code></ins>ã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/array_representation_of_tree.assets/array_representation_binary_tree.png"></p><h4 id="è¡¨ç¤ºä»»æ„äºŒå‰æ ‘"><a href="#è¡¨ç¤ºä»»æ„äºŒå‰æ ‘" class="headerlink" title="è¡¨ç¤ºä»»æ„äºŒå‰æ ‘"></a>è¡¨ç¤ºä»»æ„äºŒå‰æ ‘</h4><p>å®Œç¾äºŒå‰æ ‘æ˜¯ä¸€ä¸ªç‰¹ä¾‹ï¼Œåœ¨äºŒå‰æ ‘çš„ä¸­é—´å±‚é€šå¸¸å­˜åœ¨è®¸å¤š<code>None</code>ã€‚ç”±äºå±‚åºéå†åºåˆ—å¹¶ä¸åŒ…å«è¿™äº›<code>None</code>ï¼Œå› æ­¤æ— æ³•ä»…å‡­è¯¥åºåˆ—æ¥æ¨æµ‹<code>None</code>çš„æ•°é‡å’Œåˆ†å¸ƒä½ç½®ã€‚è¿™æ„å‘³ç€å­˜åœ¨å¤šç§äºŒå‰æ ‘ç»“æ„éƒ½ç¬¦åˆè¯¥å±‚åºéå†åºåˆ—ã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/array_representation_of_tree.assets/array_representation_without_empty.png"></p><p>ä¸ºäº†è§£å†³æ­¤é—®é¢˜ï¼Œ<ins>å¯ä»¥è€ƒè™‘åœ¨å±‚åºéå†åºåˆ—ä¸­æ˜¾å¼åœ°å†™å‡ºæ‰€æœ‰<code>None</code></ins>ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™æ ·å¤„ç†åï¼Œå±‚åºéå†åºåˆ—å°±å¯ä»¥å”¯ä¸€è¡¨ç¤ºäºŒå‰æ ‘äº†ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* äºŒå‰æ ‘çš„æ•°ç»„è¡¨ç¤º */</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨ int çš„åŒ…è£…ç±» Integer ï¼Œå°±å¯ä»¥ä½¿ç”¨ null æ¥æ ‡è®°ç©ºä½</span></span><br><span class="line">Integer[] tree = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="literal">null</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="number">12</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="number">15</span> &#125;;</span><br></pre></td></tr></table></figure><p><img src="https://www.hello-algo.com/chapter_tree/array_representation_of_tree.assets/array_representation_with_empty.png"></p><h4 id="è¡¨ç¤ºå®Œå…¨äºŒå‰æ ‘"><a href="#è¡¨ç¤ºå®Œå…¨äºŒå‰æ ‘" class="headerlink" title="è¡¨ç¤ºå®Œå…¨äºŒå‰æ ‘"></a>è¡¨ç¤ºå®Œå…¨äºŒå‰æ ‘</h4><p>å®Œå…¨äºŒå‰æ ‘éå¸¸é€‚åˆä½¿ç”¨æ•°ç»„æ¥è¡¨ç¤ºã€‚æ ¹æ®å®Œå…¨äºŒå‰æ ‘çš„å®šä¹‰ï¼Œ<code>None</code>åªå‡ºç°åœ¨æœ€åº•å±‚ä¸”é å³çš„ä½ç½®ï¼Œå› æ­¤æ‰€æœ‰<code>None</code>ä¸€å®šå‡ºç°åœ¨å±‚åºéå†åºåˆ—çš„æœ«å°¾ã€‚è¿™æ„å‘³ç€<ins>ä½¿ç”¨æ•°ç»„è¡¨ç¤ºå®Œå…¨äºŒå‰æ ‘æ—¶ï¼Œå¯ä»¥çœç•¥å­˜å‚¨æ‰€æœ‰<code>None</code></ins>ï¼Œéå¸¸æ–¹ä¾¿ã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/array_representation_of_tree.assets/array_representation_complete_binary_tree.png"></p><p>ä»¥ä¸‹ä»£ç å®ç°äº†ä¸€ä¸ªåŸºäºæ•°ç»„è¡¨ç¤ºçš„äºŒå‰æ ‘ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å‡ ç§æ“ä½œã€‚</p><ul><li>ç»™å®šæŸèŠ‚ç‚¹ï¼Œè·å–å®ƒçš„å€¼ã€å·¦ï¼ˆå³ï¼‰å­èŠ‚ç‚¹ã€çˆ¶èŠ‚ç‚¹ã€‚</li><li>è·å–å‰åºéå†ã€ä¸­åºéå†ã€ååºéå†ã€å±‚åºéå†åºåˆ—ã€‚</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æ•°ç»„è¡¨ç¤ºä¸‹çš„äºŒå‰æ ‘ç±» */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ArrayBinaryTree</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; tree;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ„é€ æ–¹æ³• */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ArrayBinaryTree</span><span class="params">(List&lt;Integer&gt; arr)</span> &#123;</span><br><span class="line">        tree = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(arr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* èŠ‚ç‚¹æ•°é‡ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> tree.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è·å–ç´¢å¼•ä¸º i èŠ‚ç‚¹çš„å€¼ */</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">val</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">        <span class="comment">// è‹¥ç´¢å¼•è¶Šç•Œï¼Œåˆ™è¿”å› null ï¼Œä»£è¡¨ç©ºä½</span></span><br><span class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span> || i &gt;= size())</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">return</span> tree.get(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è·å–ç´¢å¼•ä¸º i èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹çš„ç´¢å¼• */</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">left</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span> * i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è·å–ç´¢å¼•ä¸º i èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹çš„ç´¢å¼• */</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">right</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span> * i + <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è·å–ç´¢å¼•ä¸º i èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹çš„ç´¢å¼• */</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">parent</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (i - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* å±‚åºéå† */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">levelOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// ç›´æ¥éå†æ•°ç»„</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (val(i) != <span class="literal">null</span>)</span><br><span class="line">                res.add(val(i));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ·±åº¦ä¼˜å…ˆéå† */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">dfs</span><span class="params">(Integer i, String order, List&lt;Integer&gt; res)</span> &#123;</span><br><span class="line">        <span class="comment">// è‹¥ä¸ºç©ºä½ï¼Œåˆ™è¿”å›</span></span><br><span class="line">        <span class="keyword">if</span> (val(i) == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">// å‰åºéå†</span></span><br><span class="line">        <span class="keyword">if</span> (order == <span class="string">&quot;pre&quot;</span>)</span><br><span class="line">            res.add(val(i));</span><br><span class="line">        dfs(left(i), order, res);</span><br><span class="line">        <span class="comment">// ä¸­åºéå†</span></span><br><span class="line">        <span class="keyword">if</span> (order == <span class="string">&quot;in&quot;</span>)</span><br><span class="line">            res.add(val(i));</span><br><span class="line">        dfs(right(i), order, res);</span><br><span class="line">        <span class="comment">// ååºéå†</span></span><br><span class="line">        <span class="keyword">if</span> (order == <span class="string">&quot;post&quot;</span>)</span><br><span class="line">            res.add(val(i));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* å‰åºéå† */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">preOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        dfs(<span class="number">0</span>, <span class="string">&quot;pre&quot;</span>, res);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* ä¸­åºéå† */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">inOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        dfs(<span class="number">0</span>, <span class="string">&quot;in&quot;</span>, res);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* ååºéå† */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">postOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        dfs(<span class="number">0</span>, <span class="string">&quot;post&quot;</span>, res);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="7-4-äºŒå‰æœç´¢æ ‘"><a href="#7-4-äºŒå‰æœç´¢æ ‘" class="headerlink" title="7.4 äºŒå‰æœç´¢æ ‘"></a>7.4 äºŒå‰æœç´¢æ ‘</h3><p>ã€ŒäºŒå‰æœç´¢æ ‘ <code>binary search tree</code>ã€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ã€‚</p><ul><li>å¯¹äºæ ¹èŠ‚ç‚¹ï¼Œå·¦å­æ ‘ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„å€¼ <code>&lt;</code> æ ¹èŠ‚ç‚¹çš„å€¼ <code>&lt;</code> å³å­æ ‘ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„å€¼ã€‚</li><li>ä»»æ„èŠ‚ç‚¹çš„å·¦ã€å³å­æ ‘ä¹Ÿæ˜¯äºŒå‰æœç´¢æ ‘ï¼Œå³åŒæ ·æ»¡è¶³ä¸Šé¢æ¡ä»¶ã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_tree/binary_search_tree.assets/binary_search_tree.png"></p><h4 id="äºŒå‰æœç´¢æ ‘çš„æ“ä½œ"><a href="#äºŒå‰æœç´¢æ ‘çš„æ“ä½œ" class="headerlink" title="äºŒå‰æœç´¢æ ‘çš„æ“ä½œ"></a>äºŒå‰æœç´¢æ ‘çš„æ“ä½œ</h4><p>å°†äºŒå‰æœç´¢æ ‘å°è£…ä¸ºä¸€ä¸ªç±»<code>ArrayBinaryTree</code>ï¼Œå¹¶å£°æ˜ä¸€ä¸ªæˆå‘˜å˜é‡<code>root</code>ï¼ŒæŒ‡å‘æ ‘çš„æ ¹èŠ‚ç‚¹ã€‚</p><p>ï¼ˆ1ï¼‰æŸ¥æ‰¾èŠ‚ç‚¹</p><p>ç»™å®šç›®æ ‡èŠ‚ç‚¹å€¼<code>num</code>ï¼Œå¯ä»¥æ ¹æ®äºŒå‰æœç´¢æ ‘çš„æ€§è´¨æ¥æŸ¥æ‰¾ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå£°æ˜ä¸€ä¸ªèŠ‚ç‚¹<code>cur</code>ï¼Œä»äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹<code>root</code>å‡ºå‘ï¼Œå¾ªç¯æ¯”è¾ƒèŠ‚ç‚¹å€¼<code>cur.val</code>å’Œ<code>num</code>ä¹‹é—´çš„å¤§å°å…³ç³»ã€‚</p><ul><li>è‹¥<code>cur.val &lt; num</code>ï¼Œè¯´æ˜ç›®æ ‡èŠ‚ç‚¹åœ¨<code>cur</code>çš„å³å­æ ‘ä¸­ï¼Œå› æ­¤æ‰§è¡Œ<code>cur = cur.right</code>ã€‚</li><li>è‹¥<code>cur.val &gt; num</code>ï¼Œè¯´æ˜ç›®æ ‡èŠ‚ç‚¹åœ¨<code>cur</code>çš„å·¦å­æ ‘ä¸­ï¼Œå› æ­¤æ‰§è¡Œ<code>cur = cur.left</code>ã€‚</li><li>è‹¥<code>cur.val = num</code>ï¼Œè¯´æ˜æ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹ï¼Œè·³å‡ºå¾ªç¯å¹¶è¿”å›è¯¥èŠ‚ç‚¹ã€‚</li></ul><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1"><1></button></li><li class="tab"><button type="button" data-href="#placeholder-2"><2></button></li><li class="tab"><button type="button" data-href="#placeholder-3"><3></button></li><li class="tab"><button type="button" data-href="#placeholder-4"><4></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_tree/binary_search_tree.assets/bst_search_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_tree/binary_search_tree.assets/bst_search_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_tree/binary_search_tree.assets/bst_search_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_tree/binary_search_tree.assets/bst_search_step4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>äºŒå‰æœç´¢æ ‘çš„æŸ¥æ‰¾æ“ä½œä¸äºŒåˆ†æŸ¥æ‰¾ç®—æ³•çš„å·¥ä½œåŸç†ä¸€è‡´ï¼Œéƒ½æ˜¯æ¯è½®æ’é™¤ä¸€åŠæƒ…å†µã€‚å¾ªç¯æ¬¡æ•°æœ€å¤šä¸ºäºŒå‰æ ‘çš„é«˜åº¦ï¼Œå½“äºŒå‰æ ‘å¹³è¡¡æ—¶ï¼Œä½¿ç”¨<code>O(logn)</code>æ—¶é—´ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æŸ¥æ‰¾èŠ‚ç‚¹ */</span></span><br><span class="line">TreeNode <span class="title function_">search</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">cur</span> <span class="operator">=</span> root;</span><br><span class="line">    <span class="comment">// å¾ªç¯æŸ¥æ‰¾ï¼Œè¶Šè¿‡å¶èŠ‚ç‚¹åè·³å‡º</span></span><br><span class="line">    <span class="keyword">while</span> (cur != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// ç›®æ ‡èŠ‚ç‚¹åœ¨ cur çš„å³å­æ ‘ä¸­</span></span><br><span class="line">        <span class="keyword">if</span> (cur.val &lt; num)</span><br><span class="line">            cur = cur.right;</span><br><span class="line">        <span class="comment">// ç›®æ ‡èŠ‚ç‚¹åœ¨ cur çš„å·¦å­æ ‘ä¸­</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (cur.val &gt; num)</span><br><span class="line">            cur = cur.left;</span><br><span class="line">        <span class="comment">// æ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹ï¼Œè·³å‡ºå¾ªç¯</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿”å›ç›®æ ‡èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">return</span> cur;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰æ’å…¥èŠ‚ç‚¹</p><p>ç»™å®šä¸€ä¸ªå¾…æ’å…¥å…ƒç´ <code>num</code>ï¼Œæ ¹æ®äºŒå‰æœç´¢æ ‘â€œå·¦å­æ ‘ <code>&lt;</code> æ ¹èŠ‚ç‚¹ <code>&lt;</code> å³å­æ ‘â€çš„æ€§è´¨ï¼Œæ’å…¥æµç¨‹å¦‚ä¸‹ã€‚</p><ul><li>æŸ¥æ‰¾æ’å…¥ä½ç½®ï¼šä¸æŸ¥æ‰¾æ“ä½œç›¸ä¼¼ï¼Œä»æ ¹èŠ‚ç‚¹å‡ºå‘ï¼Œæ ¹æ®å½“å‰èŠ‚ç‚¹å€¼å’Œ<code>num</code>çš„å¤§å°å…³ç³»å¾ªç¯å‘ä¸‹æœç´¢ï¼Œç›´åˆ°è¶Šè¿‡å¶èŠ‚ç‚¹ï¼ˆéå†è‡³<code>None</code>ï¼‰æ—¶è·³å‡ºå¾ªç¯ã€‚</li><li>åœ¨è¯¥ä½ç½®æ’å…¥èŠ‚ç‚¹ï¼šåˆå§‹åŒ–èŠ‚ç‚¹<code>num</code>ï¼Œå°†è¯¥èŠ‚ç‚¹ç½®äº<code>None</code>çš„ä½ç½®ã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_tree/binary_search_tree.assets/bst_insert.png"></p><p>åœ¨ä»£ç å®ç°ä¸­ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹ä¸¤ç‚¹ã€‚</p><ul><li>äºŒå‰æœç´¢æ ‘ä¸å…è®¸å­˜åœ¨é‡å¤èŠ‚ç‚¹ï¼Œå¦åˆ™å°†è¿åå…¶å®šä¹‰ã€‚å› æ­¤ï¼Œè‹¥å¾…æ’å…¥èŠ‚ç‚¹åœ¨æ ‘ä¸­å·²å­˜åœ¨ï¼Œåˆ™ä¸æ‰§è¡Œæ’å…¥ï¼Œç›´æ¥è¿”å›ã€‚</li><li><ins>ä¸ºäº†å®ç°æ’å…¥èŠ‚ç‚¹ï¼Œéœ€è¦å€ŸåŠ©èŠ‚ç‚¹<code>pre</code>ä¿å­˜ä¸Šä¸€è½®å¾ªç¯çš„èŠ‚ç‚¹</ins>ã€‚è¿™æ ·åœ¨éå†è‡³<code>None</code>æ—¶ï¼Œå¯ä»¥è·å–åˆ°å…¶çˆ¶èŠ‚ç‚¹ï¼Œä»è€Œå®ŒæˆèŠ‚ç‚¹æ’å…¥æ“ä½œã€‚</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æ’å…¥èŠ‚ç‚¹ */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">    <span class="comment">// è‹¥æ ‘ä¸ºç©ºï¼Œåˆ™åˆå§‹åŒ–æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        root = <span class="keyword">new</span> <span class="title class_">TreeNode</span>(num);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">cur</span> <span class="operator">=</span> root, pre = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// å¾ªç¯æŸ¥æ‰¾ï¼Œè¶Šè¿‡å¶èŠ‚ç‚¹åè·³å‡º</span></span><br><span class="line">    <span class="keyword">while</span> (cur != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æ‰¾åˆ°é‡å¤èŠ‚ç‚¹ï¼Œç›´æ¥è¿”å›</span></span><br><span class="line">        <span class="keyword">if</span> (cur.val == num)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        pre = cur;</span><br><span class="line">        <span class="comment">// æ’å…¥ä½ç½®åœ¨ cur çš„å³å­æ ‘ä¸­</span></span><br><span class="line">        <span class="keyword">if</span> (cur.val &lt; num)</span><br><span class="line">            cur = cur.right;</span><br><span class="line">        <span class="comment">// æ’å…¥ä½ç½®åœ¨ cur çš„å·¦å­æ ‘ä¸­</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            cur = cur.left;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ’å…¥èŠ‚ç‚¹</span></span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">node</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(num);</span><br><span class="line">    <span class="keyword">if</span> (pre.val &lt; num)</span><br><span class="line">        pre.right = node;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        pre.left = node;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸æŸ¥æ‰¾èŠ‚ç‚¹ç›¸åŒï¼Œæ’å…¥èŠ‚ç‚¹ä½¿ç”¨<code>O(logn)</code>æ—¶é—´ã€‚</p><p>ï¼ˆ3ï¼‰åˆ é™¤èŠ‚ç‚¹</p><p>å…ˆåœ¨äºŒå‰æ ‘ä¸­æŸ¥æ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹ï¼Œå†å°†å…¶ä»äºŒå‰æ ‘ä¸­åˆ é™¤ã€‚ä¸æ’å…¥èŠ‚ç‚¹ç±»ä¼¼ï¼Œéœ€è¦ä¿è¯åœ¨åˆ é™¤æ“ä½œå®Œæˆåï¼ŒäºŒå‰æœç´¢æ ‘çš„â€œå·¦å­æ ‘ <code>&lt;</code> æ ¹èŠ‚ç‚¹ <code>&lt;</code> å³å­æ ‘â€çš„æ€§è´¨ä»ç„¶æ»¡è¶³ã€‚</p><p>å› æ­¤ï¼Œ<ins>éœ€è¦æ ¹æ®ç›®æ ‡èŠ‚ç‚¹çš„å­èŠ‚ç‚¹æ•°é‡ï¼Œå…±åˆ†ä¸º<code>0</code>ã€<code>1</code>å’Œ<code>2</code>è¿™ä¸‰ç§æƒ…å†µ</ins>ï¼Œæ‰§è¡Œå¯¹åº”çš„åˆ é™¤èŠ‚ç‚¹æ“ä½œã€‚</p><blockquote><p><ins>å½“å¾…åˆ é™¤èŠ‚ç‚¹çš„åº¦ä¸º<code>0</code>æ—¶ï¼Œè¡¨ç¤ºè¯¥èŠ‚ç‚¹æ˜¯å¶èŠ‚ç‚¹ï¼Œå¯ä»¥ç›´æ¥åˆ é™¤</ins>ã€‚</p></blockquote><p><img src="https://www.hello-algo.com/chapter_tree/binary_search_tree.assets/bst_remove_case1.png"></p><blockquote><p><ins>å½“å¾…åˆ é™¤èŠ‚ç‚¹çš„åº¦ä¸º<code>1</code>æ—¶ï¼Œå°†å¾…åˆ é™¤èŠ‚ç‚¹æ›¿æ¢ä¸ºå…¶å­èŠ‚ç‚¹å³å¯</ins>ã€‚</p></blockquote><p><img src="https://www.hello-algo.com/chapter_tree/binary_search_tree.assets/bst_remove_case2.png"></p><blockquote><p><ins>å½“å¾…åˆ é™¤èŠ‚ç‚¹çš„åº¦ä¸º<code>2</code>æ—¶ï¼Œæ— æ³•ç›´æ¥åˆ é™¤å®ƒï¼Œè€Œéœ€è¦ä½¿ç”¨ä¸€ä¸ªèŠ‚ç‚¹æ›¿æ¢è¯¥èŠ‚ç‚¹</ins>ã€‚ç”±äºè¦ä¿æŒäºŒå‰æœç´¢æ ‘â€œå·¦ <code>&lt;</code> æ ¹ <code>&lt;</code> å³â€çš„æ€§è´¨ï¼Œå› æ­¤<ins>è¿™ä¸ªèŠ‚ç‚¹å¯ä»¥æ˜¯å³å­æ ‘çš„æœ€å°èŠ‚ç‚¹æˆ–å·¦å­æ ‘çš„æœ€å¤§èŠ‚ç‚¹</ins>ã€‚</p></blockquote><p><ins>å‡è®¾é€‰æ‹©å³å­æ ‘çš„æœ€å°èŠ‚ç‚¹ï¼Œå³ä¸­åºéå†çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</ins>ï¼Œåˆ é™¤æ“ä½œæµç¨‹ä¸‹å›¾æ‰€ç¤ºã€‚</p><ul><li>æ‰¾åˆ°å¾…åˆ é™¤èŠ‚ç‚¹åœ¨â€œä¸­åºéå†åºåˆ—â€ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè®°ä¸º<code>tmp</code>ã€‚</li><li>å°†<code>tmp</code>çš„å€¼è¦†ç›–å¾…åˆ é™¤èŠ‚ç‚¹çš„å€¼ï¼Œå¹¶åœ¨æ ‘ä¸­é€’å½’åˆ é™¤èŠ‚ç‚¹<code>tmp</code>ã€‚</li></ul><blockquote><p>å®é™…ä¸Šï¼Œå³å­æ ‘çš„æœ€å°å€¼å’Œå·¦å­æ ‘çš„æœ€å¤§å€¼éƒ½å¯ä»¥é€šè¿‡ä¸­åºéå†æ¥æ‰¾ã€‚åªéœ€è¦æ‰¾åˆ°ç»™å®šèŠ‚ç‚¹åœ¨è¯¥åºåˆ—ä¸­çš„ä½ç½®ï¼Œç„¶åæŸ¥çœ‹å®ƒçš„å‰ä¸€ä¸ªï¼ˆå·¦å­æ ‘æœ€å¤§ï¼‰æˆ–åä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå³å­æ ‘æœ€å°ï¼‰å³å¯ã€‚åŸå› æ˜¯äºŒå‰æœç´¢æ ‘ä¸­åºéå†æœ‰åºã€‚</p></blockquote><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1"><1></button></li><li class="tab"><button type="button" data-href="#placeholder-2"><2></button></li><li class="tab"><button type="button" data-href="#placeholder-3"><3></button></li><li class="tab"><button type="button" data-href="#placeholder-4"><4></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_tree/binary_search_tree.assets/bst_remove_case3_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_tree/binary_search_tree.assets/bst_remove_case3_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_tree/binary_search_tree.assets/bst_remove_case3_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_tree/binary_search_tree.assets/bst_remove_case3_step4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>åˆ é™¤èŠ‚ç‚¹æ“ä½œåŒæ ·ä½¿ç”¨<code>O(logn)</code>æ—¶é—´ï¼Œå…¶ä¸­æŸ¥æ‰¾å¾…åˆ é™¤èŠ‚ç‚¹éœ€è¦<code>O(logn)</code>æ—¶é—´ï¼Œè·å–ä¸­åºéå†åç»§èŠ‚ç‚¹éœ€è¦<code>O(logn)</code>æ—¶é—´ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åˆ é™¤èŠ‚ç‚¹ */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">    <span class="comment">// è‹¥æ ‘ä¸ºç©ºï¼Œç›´æ¥æå‰è¿”å›</span></span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">cur</span> <span class="operator">=</span> root, pre = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// å¾ªç¯æŸ¥æ‰¾ï¼Œè¶Šè¿‡å¶èŠ‚ç‚¹åè·³å‡º</span></span><br><span class="line">    <span class="keyword">while</span> (cur != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æ‰¾åˆ°å¾…åˆ é™¤èŠ‚ç‚¹ï¼Œè·³å‡ºå¾ªç¯</span></span><br><span class="line">        <span class="keyword">if</span> (cur.val == num)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        pre = cur;</span><br><span class="line">        <span class="comment">// å¾…åˆ é™¤èŠ‚ç‚¹åœ¨ cur çš„å³å­æ ‘ä¸­</span></span><br><span class="line">        <span class="keyword">if</span> (cur.val &lt; num)</span><br><span class="line">            cur = cur.right;</span><br><span class="line">        <span class="comment">// å¾…åˆ é™¤èŠ‚ç‚¹åœ¨ cur çš„å·¦å­æ ‘ä¸­</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            cur = cur.left;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è‹¥æ— å¾…åˆ é™¤èŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥è¿”å›</span></span><br><span class="line">    <span class="keyword">if</span> (cur == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// å­èŠ‚ç‚¹æ•°é‡ = 0 or 1</span></span><br><span class="line">    <span class="keyword">if</span> (cur.left == <span class="literal">null</span> || cur.right == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// å½“å­èŠ‚ç‚¹æ•°é‡ = 0 / 1 æ—¶ï¼Œ child = null / è¯¥å­èŠ‚ç‚¹</span></span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">child</span> <span class="operator">=</span> cur.left != <span class="literal">null</span> ? cur.left : cur.right;</span><br><span class="line">        <span class="comment">// åˆ é™¤èŠ‚ç‚¹ cur</span></span><br><span class="line">        <span class="keyword">if</span> (cur != root) &#123;</span><br><span class="line">            <span class="keyword">if</span> (pre.left == cur)</span><br><span class="line">                pre.left = child;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                pre.right = child;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// è‹¥åˆ é™¤èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹ï¼Œåˆ™é‡æ–°æŒ‡å®šæ ¹èŠ‚ç‚¹</span></span><br><span class="line">            root = child;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å­èŠ‚ç‚¹æ•°é‡ = 2</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–ä¸­åºéå†ä¸­ cur çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">tmp</span> <span class="operator">=</span> cur.right;</span><br><span class="line">        <span class="keyword">while</span> (tmp.left != <span class="literal">null</span>) &#123;</span><br><span class="line">            tmp = tmp.left;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// é€’å½’åˆ é™¤èŠ‚ç‚¹ tmp</span></span><br><span class="line">        remove(tmp.val);</span><br><span class="line">        <span class="comment">// ç”¨ tmp è¦†ç›– cur</span></span><br><span class="line">        cur.val = tmp.val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä¸­åºéå†æœ‰åº"><a href="#ä¸­åºéå†æœ‰åº" class="headerlink" title="ä¸­åºéå†æœ‰åº"></a>ä¸­åºéå†æœ‰åº</h4><p>äºŒå‰æ ‘çš„ä¸­åºéå†éµå¾ªâ€œå·¦ <code>-&gt;</code> æ ¹ <code>-&gt;</code> å³â€çš„éå†é¡ºåºï¼Œè€ŒäºŒå‰æœç´¢æ ‘æ»¡è¶³â€œå·¦å­èŠ‚ç‚¹ <code>&lt;</code> æ ¹èŠ‚ç‚¹ <code>&lt;</code> å³å­èŠ‚ç‚¹â€çš„å¤§å°å…³ç³»ã€‚</p><p>è¿™æ„å‘³ç€åœ¨äºŒå‰æœç´¢æ ‘ä¸­è¿›è¡Œä¸­åºéå†æ—¶ï¼Œæ€»æ˜¯ä¼šä¼˜å…ˆéå†ä¸‹ä¸€ä¸ªæœ€å°èŠ‚ç‚¹ï¼Œä»è€Œå¾—å‡ºä¸€ä¸ªé‡è¦æ€§è´¨ï¼Œ<ins>äºŒå‰æœç´¢æ ‘çš„ä¸­åºéå†åºåˆ—æ˜¯å‡åºçš„</ins>ã€‚</p><p>åˆ©ç”¨ä¸­åºéå†å‡åºçš„æ€§è´¨ï¼Œæˆ‘ä»¬åœ¨äºŒå‰æœç´¢æ ‘ä¸­è·å–æœ‰åºæ•°æ®ä»…éœ€<code>O(n)</code>æ—¶é—´ï¼Œæ— é¡»è¿›è¡Œé¢å¤–çš„æ’åºæ“ä½œï¼Œéå¸¸é«˜æ•ˆã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/binary_search_tree.assets/bst_inorder_traversal.png"></p><h4 id="äºŒå‰æœç´¢æ ‘çš„æ•ˆç‡"><a href="#äºŒå‰æœç´¢æ ‘çš„æ•ˆç‡" class="headerlink" title="äºŒå‰æœç´¢æ ‘çš„æ•ˆç‡"></a>äºŒå‰æœç´¢æ ‘çš„æ•ˆç‡</h4><p>ç»™å®šä¸€ç»„æ•°æ®ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æ•°ç»„æˆ–äºŒå‰æœç´¢æ ‘å­˜å‚¨ã€‚äºŒå‰æœç´¢æ ‘çš„å„é¡¹æ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯å¯¹æ•°é˜¶ï¼Œå…·æœ‰ç¨³å®šä¸”é«˜æ•ˆçš„æ€§èƒ½è¡¨ç°ã€‚åªæœ‰åœ¨é«˜é¢‘æ·»åŠ ã€ä½é¢‘æŸ¥æ‰¾åˆ é™¤çš„æ•°æ®é€‚ç”¨åœºæ™¯ä¸‹ï¼Œæ•°ç»„æ¯”äºŒå‰æœç´¢æ ‘çš„æ•ˆç‡æ›´é«˜ã€‚</p><table><thead><tr><th align="left"></th><th align="left">æ— åºæ•°ç»„</th><th align="left">äºŒå‰æœç´¢æ ‘</th></tr></thead><tbody><tr><td align="left">æŸ¥æ‰¾å…ƒç´ </td><td align="left"><code>O(n)</code></td><td align="left"><code>O(logn)</code></td></tr><tr><td align="left">æ’å…¥å…ƒç´ </td><td align="left"><code>O(1)</code></td><td align="left"><code>O(logn)</code></td></tr><tr><td align="left">åˆ é™¤å…ƒç´ </td><td align="left"><code>O(n)</code></td><td align="left"><code>O(logn)</code></td></tr></tbody></table><p>åœ¨ç†æƒ³æƒ…å†µä¸‹ï¼ŒäºŒå‰æœç´¢æ ‘æ˜¯â€œå¹³è¡¡â€çš„ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨<code>logn</code>è½®å¾ªç¯å†…æŸ¥æ‰¾ä»»æ„èŠ‚ç‚¹ã€‚</p><p>ç„¶è€Œï¼Œå¦‚æœåœ¨äºŒå‰æœç´¢æ ‘ä¸­ä¸æ–­åœ°æ’å…¥å’Œåˆ é™¤èŠ‚ç‚¹ï¼Œå¯èƒ½å¯¼è‡´äºŒå‰æ ‘é€€åŒ–ä¸ºé“¾è¡¨ï¼Œè¿™æ—¶å„ç§æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¹Ÿä¼šé€€åŒ–ä¸º<code>O(n)</code>ã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/binary_search_tree.assets/bst_degradation.png"></p><hr><h3 id="7-5-AVL-æ ‘"><a href="#7-5-AVL-æ ‘" class="headerlink" title="7.5 AVL æ ‘"></a>7.5 AVL æ ‘</h3><p>åœ¨äºŒå‰æœç´¢æ ‘ç« èŠ‚ä¸­ï¼Œæåˆ°äº†åœ¨å¤šæ¬¡æ’å…¥å’Œåˆ é™¤æ“ä½œåï¼ŒäºŒå‰æœç´¢æ ‘å¯èƒ½é€€åŒ–ä¸ºé“¾è¡¨ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æ“ä½œçš„æ—¶é—´å¤æ‚åº¦å°†ä»<code>O(logn)</code>æ¶åŒ–ä¸º<code>O(n)</code>ã€‚</p><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1"><1></button></li><li class="tab"><button type="button" data-href="#placeholder-2"><2></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_tree/avl_tree.assets/avltree_degradation_from_removing_node.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_tree/avl_tree.assets/avltree_degradation_from_inserting_node.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>ä¸äºŒå‰æœç´¢æ ‘ä¸åŒï¼Œ<code>AVL</code>æ ‘ä¸ä¼šé€€åŒ–ï¼Œå„ç§æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¿æŒåœ¨<code>O(logn)</code>çº§åˆ«ã€‚æ¢å¥è¯è¯´ï¼Œåœ¨éœ€è¦é¢‘ç¹è¿›è¡Œå¢åˆ æŸ¥æ”¹æ“ä½œçš„åœºæ™¯ä¸­ï¼Œ<code>AVL</code>æ ‘èƒ½å§‹ç»ˆä¿æŒé«˜æ•ˆçš„æ•°æ®æ“ä½œæ€§èƒ½ï¼Œå…·æœ‰å¾ˆå¥½çš„åº”ç”¨ä»·å€¼ã€‚</p><h4 id="AVL-æ ‘å¸¸è§æœ¯è¯­"><a href="#AVL-æ ‘å¸¸è§æœ¯è¯­" class="headerlink" title="AVL æ ‘å¸¸è§æœ¯è¯­"></a>AVL æ ‘å¸¸è§æœ¯è¯­</h4><p><ins><code>AVL</code>æ ‘æ—¢æ˜¯äºŒå‰æœç´¢æ ‘ä¹Ÿæ˜¯å¹³è¡¡äºŒå‰æ ‘ï¼ŒåŒæ—¶æ»¡è¶³è¿™ä¸¤ç±»äºŒå‰æ ‘çš„æ‰€æœ‰æ€§è´¨</ins>ï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸ºã€Œå¹³è¡¡äºŒå‰æœç´¢æ ‘ <code>balanced binary search tree</code>ã€ã€‚</p><p>ï¼ˆ1ï¼‰èŠ‚ç‚¹é«˜åº¦</p><p>ç”±äº<code>AVL</code>æ ‘çš„ç›¸å…³æ“ä½œéœ€è¦è·å–èŠ‚ç‚¹é«˜åº¦ï¼Œå› æ­¤éœ€è¦ä¸ºèŠ‚ç‚¹ç±»æ·»åŠ <code>height</code>å˜é‡ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* AVL æ ‘èŠ‚ç‚¹ç±» */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TreeNode</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> val;        <span class="comment">// èŠ‚ç‚¹å€¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> height;     <span class="comment">// èŠ‚ç‚¹é«˜åº¦</span></span><br><span class="line">    <span class="keyword">public</span> TreeNode left;  <span class="comment">// å·¦å­èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">public</span> TreeNode right; <span class="comment">// å³å­èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TreeNode</span><span class="params">(<span class="type">int</span> x)</span> &#123; val = x; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><ins>â€œèŠ‚ç‚¹é«˜åº¦â€æ˜¯æŒ‡ä»è¯¥èŠ‚ç‚¹åˆ°æœ€è¿œå¶èŠ‚ç‚¹çš„è·ç¦»ï¼Œå³æ‰€ç»è¿‡çš„â€œè¾¹â€çš„æ•°é‡</ins>ã€‚éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œå¶èŠ‚ç‚¹çš„é«˜åº¦ä¸º<code>0</code>ï¼Œè€Œç©ºèŠ‚ç‚¹çš„é«˜åº¦ä¸º<code>-1</code>ã€‚ä¸‹é¢åˆ›å»ºä¸¤ä¸ªå·¥å…·å‡½æ•°ï¼Œåˆ†åˆ«ç”¨äºè·å–å’Œæ›´æ–°èŠ‚ç‚¹çš„é«˜åº¦ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* è·å–èŠ‚ç‚¹é«˜åº¦ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">height</span><span class="params">(TreeNode node)</span> &#123;</span><br><span class="line">    <span class="comment">// ç©ºèŠ‚ç‚¹é«˜åº¦ä¸º -1 ï¼Œå¶èŠ‚ç‚¹é«˜åº¦ä¸º 0</span></span><br><span class="line">    <span class="keyword">return</span> node == <span class="literal">null</span> ? -<span class="number">1</span> : node.height;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ›´æ–°èŠ‚ç‚¹é«˜åº¦ */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">updateHeight</span><span class="params">(TreeNode node)</span> &#123;</span><br><span class="line">    <span class="comment">// èŠ‚ç‚¹é«˜åº¦ç­‰äºæœ€é«˜å­æ ‘é«˜åº¦ + 1</span></span><br><span class="line">    node.height = Math.max(height(node.left), height(node.right)) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰èŠ‚ç‚¹å¹³è¡¡å› å­</p><p>èŠ‚ç‚¹çš„<ins>ã€Œå¹³è¡¡å› å­ <code>balance factor</code>ã€å®šä¹‰ä¸ºèŠ‚ç‚¹å·¦å­æ ‘çš„é«˜åº¦å‡å»å³å­æ ‘çš„é«˜åº¦</ins>ï¼ŒåŒæ—¶è§„å®šç©ºèŠ‚ç‚¹çš„å¹³è¡¡å› å­ä¸º<code>0</code>ã€‚åŒæ ·å°†è·å–èŠ‚ç‚¹å¹³è¡¡å› å­çš„åŠŸèƒ½å°è£…æˆå‡½æ•°ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* è·å–å¹³è¡¡å› å­ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">balanceFactor</span><span class="params">(TreeNode node)</span> &#123;</span><br><span class="line">    <span class="comment">// ç©ºèŠ‚ç‚¹å¹³è¡¡å› å­ä¸º 0</span></span><br><span class="line">    <span class="keyword">if</span> (node == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// èŠ‚ç‚¹å¹³è¡¡å› å­ = å·¦å­æ ‘é«˜åº¦ - å³å­æ ‘é«˜åº¦</span></span><br><span class="line">    <span class="keyword">return</span> height(node.left) - height(node.right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><ins>è®¾å¹³è¡¡å› å­ä¸º<code>f</code>ï¼Œåˆ™ä¸€æ£µ<code>AVL</code>æ ‘çš„ä»»æ„èŠ‚ç‚¹çš„å¹³è¡¡å› å­çš†æ»¡è¶³<code>-1 &lt;= f &lt;= 1</code></ins>ã€‚</p></blockquote><h4 id="AVL-æ ‘æ—‹è½¬"><a href="#AVL-æ ‘æ—‹è½¬" class="headerlink" title="AVL æ ‘æ—‹è½¬"></a>AVL æ ‘æ—‹è½¬</h4><p><ins><code>AVL</code>æ ‘çš„ç‰¹ç‚¹åœ¨äºâ€œæ—‹è½¬â€æ“ä½œï¼Œå®ƒèƒ½å¤Ÿåœ¨ä¸å½±å“äºŒå‰æ ‘çš„ä¸­åºéå†åºåˆ—çš„å‰æä¸‹ï¼Œä½¿å¤±è¡¡èŠ‚ç‚¹é‡æ–°æ¢å¤å¹³è¡¡</ins>ã€‚æ¢å¥è¯è¯´ï¼Œæ—‹è½¬æ“ä½œæ—¢èƒ½ä¿æŒâ€œäºŒå‰æœç´¢æ ‘â€çš„æ€§è´¨ï¼Œä¹Ÿèƒ½ä½¿æ ‘é‡æ–°å˜ä¸ºâ€œå¹³è¡¡äºŒå‰æ ‘â€ã€‚</p><p>è§„å®šï¼Œå¹³è¡¡å› å­ç»å¯¹å€¼<code>&gt; 1</code>çš„èŠ‚ç‚¹ç§°ä¸ºâ€œå¤±è¡¡èŠ‚ç‚¹â€ã€‚æ ¹æ®èŠ‚ç‚¹å¤±è¡¡æƒ…å†µçš„ä¸åŒï¼Œæ—‹è½¬æ“ä½œåˆ†ä¸ºå››ç§ï¼Œ<ins>å³æ—‹ã€å·¦æ—‹ã€å…ˆå³æ—‹åå·¦æ—‹ã€å…ˆå·¦æ—‹åå³æ—‹</ins>ã€‚ä¸‹é¢å°†è¯¦ç»†ä»‹ç»è¿™äº›æ—‹è½¬æ“ä½œã€‚</p><p>ï¼ˆ1ï¼‰å³æ—‹</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒèŠ‚ç‚¹ä¸‹æ–¹ä¸ºå¹³è¡¡å› å­ã€‚ä»åº•è‡³é¡¶çœ‹ï¼ŒäºŒå‰æ ‘ä¸­é¦–ä¸ªå¤±è¡¡èŠ‚ç‚¹æ˜¯â€œèŠ‚ç‚¹ <code>3</code>â€ï¼ˆå·¦å­æ ‘é«˜åº¦å‡å³å­æ ‘é«˜åº¦ï¼‰ã€‚<ins>æ‰¾å‡ºä»¥è¯¥å¤±è¡¡èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘ï¼Œå°†è¯¥èŠ‚ç‚¹è®°ä¸º<code>node</code>ï¼Œå…¶å·¦å­èŠ‚ç‚¹è®°ä¸º<code>child</code>ï¼Œæ‰§è¡Œâ€œå³æ—‹â€æ“ä½œã€‚å®Œæˆå³æ—‹åï¼Œå­æ ‘å·²ç»æ¢å¤å¹³è¡¡ï¼Œå¹¶ä¸”ä»ç„¶ä¿æŒäºŒå‰æœç´¢æ ‘çš„ç‰¹æ€§</ins>ã€‚</p><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1"><1></button></li><li class="tab"><button type="button" data-href="#placeholder-2"><2></button></li><li class="tab"><button type="button" data-href="#placeholder-3"><3></button></li><li class="tab"><button type="button" data-href="#placeholder-4"><4></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_tree/avl_tree.assets/avltree_right_rotate_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_tree/avl_tree.assets/avltree_right_rotate_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_tree/avl_tree.assets/avltree_right_rotate_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_tree/avl_tree.assets/avltree_right_rotate_step4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><blockquote><p>æ³¨æ„ï¼Œ<ins>å½“èŠ‚ç‚¹<code>child</code>æœ‰å³å­èŠ‚ç‚¹ï¼ˆè®°ä¸º<code>grandChild</code>ï¼‰æ—¶ï¼Œéœ€è¦åœ¨å³æ—‹ä¸­æ·»åŠ ä¸€æ­¥ï¼Œå°†<code>grandChild</code>ä½œä¸º<code>node</code>çš„å·¦å­èŠ‚ç‚¹</ins>ã€‚</p></blockquote><p><img src="https://www.hello-algo.com/chapter_tree/avl_tree.assets/avltree_right_rotate_with_grandchild.png"></p><p>â€œå‘å³æ—‹è½¬â€æ˜¯ä¸€ç§å½¢è±¡åŒ–çš„è¯´æ³•ï¼Œå®é™…ä¸Šéœ€è¦é€šè¿‡ä¿®æ”¹èŠ‚ç‚¹æŒ‡é’ˆæ¥å®ç°ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å³æ—‹æ“ä½œ */</span></span><br><span class="line">TreeNode <span class="title function_">rightRotate</span><span class="params">(TreeNode node)</span> &#123;</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">child</span> <span class="operator">=</span> node.left;</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">grandChild</span> <span class="operator">=</span> child.right;</span><br><span class="line">    <span class="comment">// ä»¥ child ä¸ºåŸç‚¹ï¼Œå°† node å‘å³æ—‹è½¬</span></span><br><span class="line">    child.right = node;</span><br><span class="line">    node.left = grandChild;</span><br><span class="line">    <span class="comment">// æ›´æ–°èŠ‚ç‚¹é«˜åº¦</span></span><br><span class="line">    updateHeight(node);</span><br><span class="line">    updateHeight(child);</span><br><span class="line">    <span class="comment">// è¿”å›æ—‹è½¬åå­æ ‘çš„æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">return</span> child;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰å·¦æ—‹</p><p>ç›¸åº”çš„ï¼Œå¦‚æœè€ƒè™‘ä¸Šè¿°å¤±è¡¡äºŒå‰æ ‘çš„â€œé•œåƒâ€ï¼Œåˆ™éœ€è¦æ‰§è¡Œä¸‹å›¾æ‰€ç¤ºçš„â€œå·¦æ—‹â€æ“ä½œã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/avl_tree.assets/avltree_left_rotate.png"></p><blockquote><p>åŒç†ï¼Œå½“èŠ‚ç‚¹<code>child</code>æœ‰å·¦å­èŠ‚ç‚¹ï¼ˆè®°ä¸º<code>grandChild</code>ï¼‰æ—¶ï¼Œéœ€è¦åœ¨å·¦æ—‹ä¸­æ·»åŠ ä¸€æ­¥ï¼Œå°†<code>grandChild</code>ä½œä¸º<code>node</code>çš„å³å­èŠ‚ç‚¹ã€‚</p></blockquote><p><img src="https://www.hello-algo.com/chapter_tree/avl_tree.assets/avltree_left_rotate_with_grandchild.png"></p><p>å®é™…ä¸Šï¼Œå³æ—‹å’Œå·¦æ—‹æ“ä½œåœ¨é€»è¾‘ä¸Šæ˜¯é•œåƒå¯¹ç§°çš„ï¼Œå®ƒä»¬åˆ†åˆ«è§£å†³çš„ä¸¤ç§å¤±è¡¡æƒ…å†µä¹Ÿæ˜¯å¯¹ç§°çš„ã€‚<ins>åŸºäºå¯¹ç§°æ€§ï¼Œåªéœ€å°†å³æ—‹çš„å®ç°ä»£ç ä¸­çš„æ‰€æœ‰çš„<code>left</code>æ›¿æ¢ä¸º<code>right</code>ï¼Œå°†æ‰€æœ‰çš„<code>right</code>æ›¿æ¢ä¸º<code>left</code>ï¼Œå³å¯å¾—åˆ°å·¦æ—‹çš„å®ç°ä»£ç </ins>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å·¦æ—‹æ“ä½œ */</span></span><br><span class="line">TreeNode <span class="title function_">leftRotate</span><span class="params">(TreeNode node)</span> &#123;</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">child</span> <span class="operator">=</span> node.right;</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">grandChild</span> <span class="operator">=</span> child.left;</span><br><span class="line">    <span class="comment">// ä»¥ child ä¸ºåŸç‚¹ï¼Œå°† node å‘å·¦æ—‹è½¬</span></span><br><span class="line">    child.left = node;</span><br><span class="line">    node.right = grandChild;</span><br><span class="line">    <span class="comment">// æ›´æ–°èŠ‚ç‚¹é«˜åº¦</span></span><br><span class="line">    updateHeight(node);</span><br><span class="line">    updateHeight(child);</span><br><span class="line">    <span class="comment">// è¿”å›æ—‹è½¬åå­æ ‘çš„æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">return</span> child;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰å…ˆå·¦æ—‹åå³æ—‹</p><p>å¯¹äºä¸‹å›¾ä¸­çš„å¤±è¡¡èŠ‚ç‚¹<code>3</code>ï¼Œä»…ä½¿ç”¨å·¦æ—‹æˆ–å³æ—‹éƒ½æ— æ³•ä½¿å­æ ‘æ¢å¤å¹³è¡¡ã€‚æ­¤æ—¶éœ€è¦<ins>å…ˆå¯¹<code>child</code>æ‰§è¡Œâ€œå·¦æ—‹â€ï¼Œå†å¯¹<code>node</code>æ‰§è¡Œâ€œå³æ—‹â€</ins>ã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/avl_tree.assets/avltree_left_right_rotate.png"></p><p>ï¼ˆ4ï¼‰å…ˆå³æ—‹åå·¦æ—‹</p><p>å¯¹äºä¸Šè¿°å¤±è¡¡äºŒå‰æ ‘çš„é•œåƒæƒ…å†µï¼Œéœ€è¦å…ˆå¯¹<code>child</code>æ‰§è¡Œâ€œå³æ—‹â€ï¼Œç„¶åå¯¹<code>node</code>æ‰§è¡Œâ€œå·¦æ—‹â€ã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/avl_tree.assets/avltree_right_left_rotate.png"></p><p>ï¼ˆ5ï¼‰æ—‹è½¬çš„é€‰æ‹©</p><p>ä¸‹é¢å±•ç¤ºçš„å››ç§å¤±è¡¡æƒ…å†µï¼Œåˆ†åˆ«éœ€è¦é‡‡ç”¨å³æ—‹ã€å·¦æ—‹ã€å…ˆå³åå·¦ã€å…ˆå·¦åå³çš„æ—‹è½¬æ“ä½œã€‚</p><p><img src="https://www.hello-algo.com/chapter_tree/avl_tree.assets/avltree_rotation_cases.png"></p><p>å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œ<ins>é€šè¿‡åˆ¤æ–­å¤±è¡¡èŠ‚ç‚¹çš„å¹³è¡¡å› å­ä»¥åŠè¾ƒé«˜ä¸€ä¾§å­èŠ‚ç‚¹çš„å¹³è¡¡å› å­çš„æ­£è´Ÿå·ï¼Œæ¥ç¡®å®šå¤±è¡¡èŠ‚ç‚¹å±äºå“ªç§æƒ…å†µ</ins>ã€‚</p><table><thead><tr><th align="left">å¤±è¡¡èŠ‚ç‚¹çš„å¹³è¡¡å› å­</th><th align="left">å­èŠ‚ç‚¹çš„å¹³è¡¡å› å­</th><th align="left">åº”é‡‡ç”¨çš„æ—‹è½¬æ–¹æ³•</th></tr></thead><tbody><tr><td align="left"><code>&gt; 1</code> å³å·¦åæ ‘</td><td align="left"><code>&gt;= 0</code></td><td align="left">å³æ—‹</td></tr><tr><td align="left"><code>&gt; 1</code> å³å·¦åæ ‘</td><td align="left"><code>&lt; 0</code></td><td align="left">å…ˆå·¦æ—‹åå³æ—‹</td></tr><tr><td align="left"><code>&lt; -1</code> å³å³åæ ‘</td><td align="left"><code>&lt;= 0</code></td><td align="left">å·¦æ—‹</td></tr><tr><td align="left"><code>&lt; -1</code> å³å³åæ ‘</td><td align="left"><code>&gt; 0</code></td><td align="left">å…ˆå³æ—‹åå·¦æ—‹</td></tr></tbody></table><p>ä¸ºäº†ä¾¿äºä½¿ç”¨ï¼Œå¯ä»¥å°†æ—‹è½¬æ“ä½œå°è£…æˆä¸€ä¸ªå‡½æ•°ã€‚æœ‰äº†è¿™ä¸ªå‡½æ•°ï¼Œå°±èƒ½å¯¹å„ç§å¤±è¡¡æƒ…å†µè¿›è¡Œæ—‹è½¬ï¼Œä½¿å¤±è¡¡èŠ‚ç‚¹é‡æ–°æ¢å¤å¹³è¡¡ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æ‰§è¡Œæ—‹è½¬æ“ä½œï¼Œä½¿è¯¥å­æ ‘é‡æ–°æ¢å¤å¹³è¡¡ */</span></span><br><span class="line">TreeNode <span class="title function_">rotate</span><span class="params">(TreeNode node)</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–èŠ‚ç‚¹ node çš„å¹³è¡¡å› å­</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">balanceFactor</span> <span class="operator">=</span> balanceFactor(node);</span><br><span class="line">    <span class="comment">// å·¦åæ ‘</span></span><br><span class="line">    <span class="keyword">if</span> (balanceFactor &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (balanceFactor(node.left) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// å³æ—‹</span></span><br><span class="line">            <span class="keyword">return</span> rightRotate(node);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å…ˆå·¦æ—‹åå³æ—‹</span></span><br><span class="line">            node.left = leftRotate(node.left);</span><br><span class="line">            <span class="keyword">return</span> rightRotate(node);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å³åæ ‘</span></span><br><span class="line">    <span class="keyword">if</span> (balanceFactor &lt; -<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (balanceFactor(node.right) &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// å·¦æ—‹</span></span><br><span class="line">            <span class="keyword">return</span> leftRotate(node);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å…ˆå³æ—‹åå·¦æ—‹</span></span><br><span class="line">            node.right = rightRotate(node.right);</span><br><span class="line">            <span class="keyword">return</span> leftRotate(node);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¹³è¡¡æ ‘ï¼Œæ— é¡»æ—‹è½¬ï¼Œç›´æ¥è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> node;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="AVL-æ ‘å¸¸ç”¨æ“ä½œ"><a href="#AVL-æ ‘å¸¸ç”¨æ“ä½œ" class="headerlink" title="AVL æ ‘å¸¸ç”¨æ“ä½œ"></a>AVL æ ‘å¸¸ç”¨æ“ä½œ</h4><p>ï¼ˆ1ï¼‰æ’å…¥èŠ‚ç‚¹</p><p><code>AVL</code>æ ‘çš„èŠ‚ç‚¹æ’å…¥æ“ä½œä¸äºŒå‰æœç´¢æ ‘åœ¨ä¸»ä½“ä¸Šç±»ä¼¼ã€‚å”¯ä¸€çš„åŒºåˆ«åœ¨äºï¼Œ<ins>åœ¨<code>AVL</code>æ ‘ä¸­æ’å…¥èŠ‚ç‚¹åï¼Œä»è¯¥èŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸Šå¯èƒ½ä¼šå‡ºç°ä¸€ç³»åˆ—å¤±è¡¡èŠ‚ç‚¹ã€‚å› æ­¤ï¼Œéœ€è¦ä»è¿™ä¸ªèŠ‚ç‚¹å¼€å§‹ï¼Œè‡ªåº•å‘ä¸Šæ‰§è¡Œæ—‹è½¬æ“ä½œï¼Œä½¿æ‰€æœ‰å¤±è¡¡èŠ‚ç‚¹æ¢å¤å¹³è¡¡</ins>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æ’å…¥èŠ‚ç‚¹ */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">    root = insertHelper(root, val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* é€’å½’æ’å…¥èŠ‚ç‚¹ï¼ˆè¾…åŠ©æ–¹æ³•ï¼‰ */</span></span><br><span class="line">TreeNode <span class="title function_">insertHelper</span><span class="params">(TreeNode node, <span class="type">int</span> val)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (node == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(val);</span><br><span class="line">    <span class="comment">/* 1. æŸ¥æ‰¾æ’å…¥ä½ç½®ï¼Œå¹¶æ’å…¥èŠ‚ç‚¹ */</span></span><br><span class="line">    <span class="keyword">if</span> (val &lt; node.val)</span><br><span class="line">        node.left = insertHelper(node.left, val);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (val &gt; node.val)</span><br><span class="line">        node.right = insertHelper(node.right, val);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> node; <span class="comment">// é‡å¤èŠ‚ç‚¹ä¸æ’å…¥ï¼Œç›´æ¥è¿”å›</span></span><br><span class="line">    updateHeight(node); <span class="comment">// æ›´æ–°èŠ‚ç‚¹é«˜åº¦</span></span><br><span class="line">    <span class="comment">/* 2. æ‰§è¡Œæ—‹è½¬æ“ä½œï¼Œä½¿è¯¥å­æ ‘é‡æ–°æ¢å¤å¹³è¡¡ */</span></span><br><span class="line">    node = rotate(node);</span><br><span class="line">    <span class="comment">// è¿”å›å­æ ‘çš„æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">return</span> node;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰åˆ é™¤èŠ‚ç‚¹</p><p><ins>åœ¨äºŒå‰æœç´¢æ ‘çš„åˆ é™¤èŠ‚ç‚¹æ–¹æ³•çš„åŸºç¡€ä¸Šï¼Œéœ€è¦ä»åº•è‡³é¡¶åœ°æ‰§è¡Œæ—‹è½¬æ“ä½œï¼Œä½¿æ‰€æœ‰å¤±è¡¡èŠ‚ç‚¹æ¢å¤å¹³è¡¡</ins>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åˆ é™¤èŠ‚ç‚¹ */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">    root = removeHelper(root, val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* é€’å½’åˆ é™¤èŠ‚ç‚¹ï¼ˆè¾…åŠ©æ–¹æ³•ï¼‰ */</span></span><br><span class="line">TreeNode <span class="title function_">removeHelper</span><span class="params">(TreeNode node, <span class="type">int</span> val)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (node == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">/* 1. æŸ¥æ‰¾èŠ‚ç‚¹ï¼Œå¹¶åˆ é™¤ä¹‹ */</span></span><br><span class="line">    <span class="keyword">if</span> (val &lt; node.val)</span><br><span class="line">        node.left = removeHelper(node.left, val);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (val &gt; node.val)</span><br><span class="line">        node.right = removeHelper(node.right, val);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node.left == <span class="literal">null</span> || node.right == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">TreeNode</span> <span class="variable">child</span> <span class="operator">=</span> node.left != <span class="literal">null</span> ? node.left : node.right;</span><br><span class="line">            <span class="comment">// å­èŠ‚ç‚¹æ•°é‡ = 0 ï¼Œç›´æ¥åˆ é™¤ node å¹¶è¿”å›</span></span><br><span class="line">            <span class="keyword">if</span> (child == <span class="literal">null</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="comment">// å­èŠ‚ç‚¹æ•°é‡ = 1 ï¼Œç›´æ¥åˆ é™¤ node</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                node = child;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å­èŠ‚ç‚¹æ•°é‡ = 2 ï¼Œåˆ™å°†ä¸­åºéå†çš„ä¸‹ä¸ªèŠ‚ç‚¹åˆ é™¤ï¼Œå¹¶ç”¨è¯¥èŠ‚ç‚¹æ›¿æ¢å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">            <span class="type">TreeNode</span> <span class="variable">temp</span> <span class="operator">=</span> node.right;</span><br><span class="line">            <span class="keyword">while</span> (temp.left != <span class="literal">null</span>) &#123;</span><br><span class="line">                temp = temp.left;</span><br><span class="line">            &#125;</span><br><span class="line">            node.right = removeHelper(node.right, temp.val);</span><br><span class="line">            node.val = temp.val;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    updateHeight(node); <span class="comment">// æ›´æ–°èŠ‚ç‚¹é«˜åº¦</span></span><br><span class="line">    <span class="comment">/* 2. æ‰§è¡Œæ—‹è½¬æ“ä½œï¼Œä½¿è¯¥å­æ ‘é‡æ–°æ¢å¤å¹³è¡¡ */</span></span><br><span class="line">    node = rotate(node);</span><br><span class="line">    <span class="comment">// è¿”å›å­æ ‘çš„æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">return</span> node;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰æŸ¥æ‰¾èŠ‚ç‚¹</p><p><code>AVL</code>æ ‘çš„èŠ‚ç‚¹æŸ¥æ‰¾æ“ä½œä¸äºŒå‰æœç´¢æ ‘ä¸€è‡´ï¼Œåœ¨æ­¤ä¸å†èµ˜è¿°ã€‚</p><hr><h2 id="8-å †"><a href="#8-å †" class="headerlink" title="8. å †"></a>8. å †</h2><h3 id="8-1-å †"><a href="#8-1-å †" class="headerlink" title="8.1 å †"></a>8.1 å †</h3><p>ã€Œå † <code>heap</code>ã€æ˜¯ä¸€ç§æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„å®Œå…¨äºŒå‰æ ‘ï¼Œä¸»è¦åˆ†ä¸ºä¸¤ç§ç±»å‹ã€‚</p><ul><li>ã€Œå¤§é¡¶å † <code>max heap</code>ã€ï¼šä»»æ„èŠ‚ç‚¹çš„å€¼<code>&gt;=</code>å…¶å­èŠ‚ç‚¹çš„å€¼ã€‚</li><li>ã€Œå°é¡¶å † <code>min heap</code>ã€ï¼šä»»æ„èŠ‚ç‚¹çš„å€¼<code>&lt;=</code>å…¶å­èŠ‚ç‚¹çš„å€¼ã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/min_heap_and_max_heap.png"></p><p>å †ä½œä¸ºå®Œå…¨äºŒå‰æ ‘çš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ã€‚</p><ul><li>æœ€åº•å±‚èŠ‚ç‚¹é å·¦å¡«å……ï¼Œå…¶ä»–å±‚çš„èŠ‚ç‚¹éƒ½è¢«å¡«æ»¡ã€‚</li><li>äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ç§°ä¸ºâ€œå †é¡¶â€ï¼Œåº•å±‚æœ€é å³çš„èŠ‚ç‚¹ç§°ä¸ºâ€œå †åº•â€ã€‚</li><li><ins>å¯¹äºå¤§é¡¶å †ï¼ˆå°é¡¶å †ï¼‰ï¼Œå †é¡¶å…ƒç´ ï¼ˆå³æ ¹èŠ‚ç‚¹ï¼‰çš„å€¼åˆ†åˆ«æ˜¯æœ€å¤§ï¼ˆæœ€å°ï¼‰çš„</ins>ã€‚</li></ul><h4 id="å †å¸¸ç”¨æ“ä½œ"><a href="#å †å¸¸ç”¨æ“ä½œ" class="headerlink" title="å †å¸¸ç”¨æ“ä½œ"></a>å †å¸¸ç”¨æ“ä½œ</h4><p><ins>å †é€šå¸¸ç”¨ä½œå®ç°ä¼˜å…ˆé˜Ÿåˆ—</ins>ï¼Œå¯ä»¥å°†â€œä¼˜å…ˆé˜Ÿåˆ—â€å’Œâ€œå †â€çœ‹ä½œç­‰ä»·çš„æ•°æ®ç»“æ„ã€‚è®¸å¤šç¼–ç¨‹è¯­è¨€æä¾›çš„æ˜¯ã€Œä¼˜å…ˆé˜Ÿåˆ— <code>priority queue</code>ã€ï¼Œè¿™æ˜¯ä¸€ç§æŠ½è±¡æ•°æ®ç»“æ„ï¼Œå®šä¹‰ä¸ºå…·æœ‰ä¼˜å…ˆçº§æ’åºçš„é˜Ÿåˆ—ã€‚</p><p>å †çš„å¸¸ç”¨æ“ä½œè§ä¸‹è¡¨ï¼Œæ–¹æ³•åéœ€è¦æ ¹æ®ç¼–ç¨‹è¯­è¨€æ¥ç¡®å®šã€‚</p><table><thead><tr><th align="left">æ–¹æ³•å</th><th align="left">æè¿°</th><th align="left">æ—¶é—´å¤æ‚åº¦</th></tr></thead><tbody><tr><td align="left"><code>push()</code></td><td align="left">å…ƒç´ å…¥å †</td><td align="left"><code>O(logn)</code></td></tr><tr><td align="left"><code>pop()</code></td><td align="left">å †é¡¶å…ƒç´ å‡ºå †</td><td align="left"><code>O(logn)</code></td></tr><tr><td align="left"><code>peek()</code></td><td align="left">è®¿é—®å †é¡¶å…ƒç´ ï¼ˆå¤§ &#x2F; å°é¡¶å †åˆ†åˆ«ä¸ºæœ€å¤§ &#x2F; å°å€¼ï¼‰</td><td align="left"><code>O(1)</code></td></tr><tr><td align="left"><code>size()</code></td><td align="left">è·å–å †çš„å…ƒç´ æ•°é‡</td><td align="left"><code>O(1)</code></td></tr><tr><td align="left"><code>isEmpty()</code></td><td align="left">åˆ¤æ–­å †æ˜¯å¦ä¸ºç©º</td><td align="left"><code>O(1)</code></td></tr></tbody></table><blockquote><p>ç±»ä¼¼äºæ’åºç®—æ³•ä¸­çš„â€œä»å°åˆ°å¤§æ’åˆ—â€å’Œâ€œä»å¤§åˆ°å°æ’åˆ—â€ï¼Œ<ins>é€šè¿‡ä¿®æ”¹<code>Comparator</code>æ¥å®ç°â€œå°é¡¶å †â€ä¸â€œå¤§é¡¶å †â€ä¹‹é—´çš„è½¬æ¢</ins>ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åˆå§‹åŒ–å † */</span></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–å°é¡¶å †</span></span><br><span class="line">Queue&lt;Integer&gt; minHeap = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;();</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–å¤§é¡¶å †ï¼ˆä½¿ç”¨ lambda è¡¨è¾¾å¼ä¿®æ”¹ Comparator å³å¯ï¼‰</span></span><br><span class="line">Queue&lt;Integer&gt; maxHeap = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;((a, b) -&gt; b - a);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å…ƒç´ å…¥å † */</span></span><br><span class="line">maxHeap.offer(<span class="number">1</span>);</span><br><span class="line">maxHeap.offer(<span class="number">3</span>);</span><br><span class="line">maxHeap.offer(<span class="number">2</span>);</span><br><span class="line">maxHeap.offer(<span class="number">5</span>);</span><br><span class="line">maxHeap.offer(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è·å–å †é¡¶å…ƒç´  */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">peek</span> <span class="operator">=</span> maxHeap.peek(); <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* å †é¡¶å…ƒç´ å‡ºå † */</span></span><br><span class="line"><span class="comment">// å‡ºå †å…ƒç´ ä¼šå½¢æˆä¸€ä¸ªä»å¤§åˆ°å°çš„åºåˆ—</span></span><br><span class="line">peek = maxHeap.poll(); <span class="comment">// 5</span></span><br><span class="line">peek = maxHeap.poll(); <span class="comment">// 4</span></span><br><span class="line">peek = maxHeap.poll(); <span class="comment">// 3</span></span><br><span class="line">peek = maxHeap.poll(); <span class="comment">// 2</span></span><br><span class="line">peek = maxHeap.poll(); <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* è·å–å †å¤§å° */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> maxHeap.size();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åˆ¤æ–­å †æ˜¯å¦ä¸ºç©º */</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">isEmpty</span> <span class="operator">=</span> maxHeap.isEmpty();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è¾“å…¥åˆ—è¡¨å¹¶å»ºå † */</span></span><br><span class="line">minHeap = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(Arrays.asList(<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">4</span>));</span><br></pre></td></tr></table></figure><h4 id="å †çš„å®ç°"><a href="#å †çš„å®ç°" class="headerlink" title="å †çš„å®ç°"></a>å †çš„å®ç°</h4><blockquote><p>ä¸‹é¢å®ç°çš„æ˜¯å¤§é¡¶å †ã€‚è‹¥è¦å°†å…¶è½¬æ¢ä¸ºå°é¡¶å †ï¼Œåªéœ€å°†æ‰€æœ‰å¤§å°é€»è¾‘åˆ¤æ–­å–é€†ã€‚</p></blockquote><p>ï¼ˆ1ï¼‰å †çš„å­˜å‚¨ä¸è¡¨ç¤º</p><p>åœ¨äºŒå‰æ ‘ç« èŠ‚ä¸­å­¦ä¹ åˆ°ï¼Œ<ins>å®Œå…¨äºŒå‰æ ‘éå¸¸é€‚åˆç”¨æ•°ç»„æ¥è¡¨ç¤ºã€‚ç”±äºå †æ­£æ˜¯ä¸€ç§å®Œå…¨äºŒå‰æ ‘ï¼Œå¯ä»¥é‡‡ç”¨æ•°ç»„æ¥å­˜å‚¨å †</ins>ã€‚å½“ä½¿ç”¨æ•°ç»„è¡¨ç¤ºäºŒå‰æ ‘æ—¶ï¼Œå…ƒç´ ä»£è¡¨èŠ‚ç‚¹å€¼ï¼Œç´¢å¼•ä»£è¡¨èŠ‚ç‚¹åœ¨äºŒå‰æ ‘ä¸­çš„ä½ç½®ã€‚èŠ‚ç‚¹æŒ‡é’ˆé€šè¿‡ç´¢å¼•æ˜ å°„å…¬å¼æ¥å®ç°ã€‚</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç»™å®šç´¢å¼•<code>i</code>ï¼Œå…¶å·¦å­èŠ‚ç‚¹ç´¢å¼•ä¸º<code>2i + 1</code>ï¼Œå³å­èŠ‚ç‚¹ç´¢å¼•ä¸º<code>2i + 2</code>ï¼Œçˆ¶èŠ‚ç‚¹ç´¢å¼•ä¸º<code>(i - 1) / 2</code>ï¼ˆå‘ä¸‹å–æ•´ï¼‰ã€‚å½“ç´¢å¼•è¶Šç•Œæ—¶ï¼Œè¡¨ç¤ºç©ºèŠ‚ç‚¹æˆ–èŠ‚ç‚¹ä¸å­˜åœ¨ã€‚</p><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/representation_of_heap.png"></p><p>å…ˆå°†ç´¢å¼•æ˜ å°„å…¬å¼å°è£…æˆå‡½æ•°ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* è·å–å·¦å­èŠ‚ç‚¹ç´¢å¼• */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">left</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span> * i + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è·å–å³å­èŠ‚ç‚¹ç´¢å¼• */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">right</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span> * i + <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è·å–çˆ¶èŠ‚ç‚¹ç´¢å¼• */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">parent</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (i - <span class="number">1</span>) / <span class="number">2</span>; <span class="comment">// å‘ä¸‹æ•´é™¤</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰è®¿é—®å †é¡¶å…ƒç´ </p><p>å †é¡¶å…ƒç´ å³ä¸ºäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯åˆ—è¡¨çš„é¦–ä¸ªå…ƒç´ ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* è®¿é—®å †é¡¶å…ƒç´  */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">peek</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> maxHeap.get(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(3) å…ƒç´ å…¥å †</p><p>ç»™å®šå…ƒç´ <code>val</code>ï¼Œé¦–å…ˆå°†å…¶æ·»åŠ åˆ°å †åº•ã€‚ç”±äº<code>val</code>å¯èƒ½å¤§äºå †ä¸­å…¶ä»–å…ƒç´ ï¼Œå †çš„æˆç«‹æ¡ä»¶å¯èƒ½å·²è¢«ç ´åã€‚å› æ­¤ï¼Œéœ€è¦ä¿®å¤ä»æ’å…¥èŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸Šçš„å„ä¸ªèŠ‚ç‚¹ï¼Œè¿™ä¸ªæ“ä½œè¢«ç§°ä¸ºã€Œå †åŒ– <code>heapify</code>ã€ã€‚</p><p><ins>ä»å…¥å †èŠ‚ç‚¹å¼€å§‹ï¼Œä»åº•è‡³é¡¶æ‰§è¡Œå †åŒ–</ins>ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ<ins>æ¯”è¾ƒæ’å…¥èŠ‚ç‚¹ä¸å…¶çˆ¶èŠ‚ç‚¹çš„å€¼ï¼Œå¦‚æœæ’å…¥èŠ‚ç‚¹æ›´å¤§ï¼Œåˆ™å°†å®ƒä»¬äº¤æ¢ã€‚ç„¶åç»§ç»­æ‰§è¡Œæ­¤æ“ä½œï¼Œä»åº•è‡³é¡¶ä¿®å¤å †ä¸­çš„å„ä¸ªèŠ‚ç‚¹</ins>ï¼Œç›´è‡³è¶Šè¿‡æ ¹èŠ‚ç‚¹æˆ–é‡åˆ°æ— é¡»äº¤æ¢çš„èŠ‚ç‚¹æ—¶ç»“æŸã€‚ï¼ˆäºŒå‰æ ‘æ•°ç»„è¡¨ç¤ºå¯ä»¥å¸®åŠ©ç†è§£ï¼‰</p><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1"><1></button></li><li class="tab"><button type="button" data-href="#placeholder-2"><2></button></li><li class="tab"><button type="button" data-href="#placeholder-3"><3></button></li><li class="tab"><button type="button" data-href="#placeholder-4"><4></button></li><li class="tab"><button type="button" data-href="#placeholder-5"><5></button></li><li class="tab"><button type="button" data-href="#placeholder-6"><6></button></li><li class="tab"><button type="button" data-href="#placeholder-7"><7></button></li><li class="tab"><button type="button" data-href="#placeholder-8"><8></button></li><li class="tab"><button type="button" data-href="#placeholder-9"><9></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_push_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_push_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_push_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_push_step4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-5"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_push_step5.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-6"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_push_step6.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-7"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_push_step7.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-8"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_push_step8.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-9"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_push_step9.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>è®¾èŠ‚ç‚¹æ€»æ•°ä¸º<code>n</code>ï¼Œåˆ™æ ‘çš„é«˜åº¦ä¸º<code>O(logn)</code>ã€‚ç”±æ­¤å¯çŸ¥ï¼Œå †åŒ–æ“ä½œçš„å¾ªç¯è½®æ•°æœ€å¤šä¸º<code>O(logn)</code>ï¼Œå…ƒç´ å…¥å †æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º<code>O(logn)</code>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å…ƒç´ å…¥å † */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">    <span class="comment">// æ·»åŠ èŠ‚ç‚¹</span></span><br><span class="line">    maxHeap.add(val);</span><br><span class="line">    <span class="comment">// ä»åº•è‡³é¡¶å †åŒ–</span></span><br><span class="line">    siftUp(size() - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä»èŠ‚ç‚¹ i å¼€å§‹ï¼Œä»åº•è‡³é¡¶å †åŒ– */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">siftUp</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="comment">// è·å–èŠ‚ç‚¹ i çš„çˆ¶èŠ‚ç‚¹</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">p</span> <span class="operator">=</span> parent(i);</span><br><span class="line">        <span class="comment">// å½“â€œè¶Šè¿‡æ ¹èŠ‚ç‚¹â€æˆ–â€œèŠ‚ç‚¹æ— é¡»ä¿®å¤â€æ—¶ï¼Œç»“æŸå †åŒ–</span></span><br><span class="line">        <span class="keyword">if</span> (p &lt; <span class="number">0</span> || maxHeap.get(i) &lt;= maxHeap.get(p))</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">// äº¤æ¢ä¸¤èŠ‚ç‚¹</span></span><br><span class="line">        swap(i, p);</span><br><span class="line">        <span class="comment">// å¾ªç¯å‘ä¸Šå †åŒ–</span></span><br><span class="line">        i = p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ4ï¼‰å †é¡¶å…ƒç´ å‡ºå †</p><p>å †é¡¶å…ƒç´ æ˜¯äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œå³åˆ—è¡¨é¦–å…ƒç´ ã€‚<ins>å¦‚æœç›´æ¥ä»åˆ—è¡¨ä¸­åˆ é™¤é¦–å…ƒç´ ï¼Œé‚£ä¹ˆäºŒå‰æ ‘ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„ç´¢å¼•éƒ½ä¼šå‘ç”Ÿå˜åŒ–</ins>ï¼Œè¿™å°†ä½¿å¾—åç»­ä½¿ç”¨å †åŒ–ä¿®å¤å˜å¾—å›°éš¾ã€‚ä¸ºäº†å°½é‡å‡å°‘å…ƒç´ ç´¢å¼•çš„å˜åŠ¨ï¼Œé‡‡ç”¨ä»¥ä¸‹æ“ä½œæ­¥éª¤ã€‚</p><ul><li>äº¤æ¢å †é¡¶å…ƒç´ ä¸å †åº•å…ƒç´ ï¼ˆå³äº¤æ¢æ ¹èŠ‚ç‚¹ä¸æœ€å³å¶èŠ‚ç‚¹ï¼‰ã€‚</li><li>äº¤æ¢å®Œæˆåï¼Œå°†å †åº•ä»åˆ—è¡¨ä¸­åˆ é™¤ï¼ˆæ³¨æ„ï¼Œç”±äºå·²ç»äº¤æ¢ï¼Œå®é™…ä¸Šåˆ é™¤çš„æ˜¯åŸæ¥çš„å †é¡¶å…ƒç´ ï¼‰ã€‚</li><li>ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œä»é¡¶è‡³åº•æ‰§è¡Œå †åŒ–ã€‚</li></ul><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ<ins>â€œä»é¡¶è‡³åº•å †åŒ–â€çš„æ“ä½œæ–¹å‘ä¸â€œä»åº•è‡³é¡¶å †åŒ–â€ç›¸å</ins>ï¼Œå°†æ ¹èŠ‚ç‚¹çš„å€¼ä¸å…¶ä¸¤ä¸ªå­èŠ‚ç‚¹çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œå°†æœ€å¤§çš„å­èŠ‚ç‚¹ä¸æ ¹èŠ‚ç‚¹äº¤æ¢ã€‚ç„¶åå¾ªç¯æ‰§è¡Œæ­¤æ“ä½œï¼Œç›´åˆ°è¶Šè¿‡å¶èŠ‚ç‚¹æˆ–é‡åˆ°æ— é¡»äº¤æ¢çš„èŠ‚ç‚¹æ—¶ç»“æŸã€‚</p><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1"><1></button></li><li class="tab"><button type="button" data-href="#placeholder-2"><2></button></li><li class="tab"><button type="button" data-href="#placeholder-3"><3></button></li><li class="tab"><button type="button" data-href="#placeholder-4"><4></button></li><li class="tab"><button type="button" data-href="#placeholder-5"><5></button></li><li class="tab"><button type="button" data-href="#placeholder-6"><6></button></li><li class="tab"><button type="button" data-href="#placeholder-7"><7></button></li><li class="tab"><button type="button" data-href="#placeholder-8"><8></button></li><li class="tab"><button type="button" data-href="#placeholder-9"><9></button></li><li class="tab"><button type="button" data-href="#placeholder-10"><10></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_pop_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_pop_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_pop_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_pop_step4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-5"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_pop_step5.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-6"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_pop_step6.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-7"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_pop_step7.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-8"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_pop_step8.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-9"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_pop_step9.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-10"><p><img src="https://www.hello-algo.com/chapter_heap/heap.assets/heap_pop_step10.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>ä¸å…ƒç´ å…¥å †æ“ä½œç›¸ä¼¼ï¼Œå †é¡¶å…ƒç´ å‡ºå †æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¹Ÿä¸º<code>O(logn)</code>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å…ƒç´ å‡ºå † */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// åˆ¤ç©ºå¤„ç†</span></span><br><span class="line">    <span class="keyword">if</span> (isEmpty())</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IndexOutOfBoundsException</span>();</span><br><span class="line">    <span class="comment">// äº¤æ¢æ ¹èŠ‚ç‚¹ä¸æœ€å³å¶èŠ‚ç‚¹ï¼ˆå³äº¤æ¢é¦–å…ƒç´ ä¸å°¾å…ƒç´ ï¼‰</span></span><br><span class="line">    swap(<span class="number">0</span>, size() - <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// åˆ é™¤èŠ‚ç‚¹</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">val</span> <span class="operator">=</span> maxHeap.remove(size() - <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// ä»é¡¶è‡³åº•å †åŒ–</span></span><br><span class="line">    siftDown(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">// è¿”å›å †é¡¶å…ƒç´ </span></span><br><span class="line">    <span class="keyword">return</span> val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä»èŠ‚ç‚¹ i å¼€å§‹ï¼Œä»é¡¶è‡³åº•å †åŒ– */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">siftDown</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="comment">// åˆ¤æ–­èŠ‚ç‚¹ i, l, r ä¸­å€¼æœ€å¤§çš„èŠ‚ç‚¹ï¼Œè®°ä¸º ma</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> left(i), r = right(i), ma = i;</span><br><span class="line">        <span class="keyword">if</span> (l &lt; size() &amp;&amp; maxHeap.get(l) &gt; maxHeap.get(ma))</span><br><span class="line">            ma = l;</span><br><span class="line">        <span class="keyword">if</span> (r &lt; size() &amp;&amp; maxHeap.get(r) &gt; maxHeap.get(ma))</span><br><span class="line">            ma = r;</span><br><span class="line">        <span class="comment">// è‹¥èŠ‚ç‚¹ i æœ€å¤§æˆ–ç´¢å¼• l, r è¶Šç•Œï¼Œåˆ™æ— é¡»ç»§ç»­å †åŒ–ï¼Œè·³å‡º</span></span><br><span class="line">        <span class="keyword">if</span> (ma == i)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">// äº¤æ¢ä¸¤èŠ‚ç‚¹</span></span><br><span class="line">        swap(i, ma);</span><br><span class="line">        <span class="comment">// å¾ªç¯å‘ä¸‹å †åŒ–</span></span><br><span class="line">        i = ma;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="8-2-å»ºå †æ“ä½œ"><a href="#8-2-å»ºå †æ“ä½œ" class="headerlink" title="8.2 å»ºå †æ“ä½œ"></a>8.2 å»ºå †æ“ä½œ</h3><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨ä¸€ä¸ªåˆ—è¡¨çš„æ‰€æœ‰å…ƒç´ æ¥æ„å»ºä¸€ä¸ªå †ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºâ€œå»ºå †æ“ä½œâ€ã€‚</p><h4 id="è‡ªä¸Šè€Œä¸‹æ„å»º"><a href="#è‡ªä¸Šè€Œä¸‹æ„å»º" class="headerlink" title="è‡ªä¸Šè€Œä¸‹æ„å»º"></a>è‡ªä¸Šè€Œä¸‹æ„å»º</h4><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªç©ºå †ï¼Œç„¶åéå†åˆ—è¡¨ï¼Œä¾æ¬¡å¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œâ€œå…¥å †æ“ä½œâ€ï¼Œå³å…ˆå°†å…ƒç´ æ·»åŠ è‡³å †çš„å°¾éƒ¨ï¼Œå†å¯¹è¯¥å…ƒç´ æ‰§è¡Œâ€œä»åº•è‡³é¡¶â€å †åŒ–ã€‚</p><p>æ¯å½“ä¸€ä¸ªå…ƒç´ å…¥å †ï¼Œå †çš„é•¿åº¦å°±åŠ ä¸€ï¼Œå› æ­¤å †æ˜¯â€œè‡ªä¸Šè€Œä¸‹â€åœ°æ„å»ºçš„ã€‚</p><p>è®¾å…ƒç´ æ•°é‡ä¸º<code>n</code>ï¼Œæ¯ä¸ªå…ƒç´ çš„å…¥å †æ“ä½œä½¿ç”¨<code>O(logn)</code>æ—¶é—´ï¼Œå› æ­¤è¯¥å»ºå †æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º<code>O(logn)</code>ã€‚</p><h4 id="è‡ªä¸‹è€Œä¸Šæ„å»º"><a href="#è‡ªä¸‹è€Œä¸Šæ„å»º" class="headerlink" title="è‡ªä¸‹è€Œä¸Šæ„å»º"></a>è‡ªä¸‹è€Œä¸Šæ„å»º</h4><p>å®é™…ä¸Šï¼Œå¯ä»¥å®ç°ä¸€ç§æ›´ä¸ºé«˜æ•ˆçš„å»ºå †æ–¹æ³•ï¼Œå…±åˆ†ä¸ºä¸¤æ­¥ã€‚</p><ul><li>å°†åˆ—è¡¨æ‰€æœ‰å…ƒç´ åŸå°ä¸åŠ¨æ·»åŠ åˆ°å †ä¸­ã€‚</li><li><ins>å€’åºéå†å †ï¼ˆå³å±‚åºéå†çš„å€’åºï¼‰ï¼Œä¾æ¬¡å¯¹æ¯ä¸ªéå¶èŠ‚ç‚¹æ‰§è¡Œâ€œä»é¡¶è‡³åº•å †åŒ–â€</ins>ã€‚</li></ul><p>åœ¨å€’åºéå†ä¸­ï¼Œå †æ˜¯â€œè‡ªä¸‹è€Œä¸Šâ€åœ°æ„å»ºçš„ï¼Œéœ€è¦é‡ç‚¹ç†è§£ä»¥ä¸‹ä¸¤ç‚¹ã€‚</p><ul><li>å¶èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œæ— éœ€å¯¹å®ƒä»¬æ‰§è¡Œå †åŒ–ã€‚<ins>æœ€åä¸€ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯æœ€åä¸€ä¸ªéå¶èŠ‚ç‚¹</ins>ã€‚</li><li>åœ¨å€’åºéå†ä¸­ï¼Œèƒ½å¤Ÿä¿è¯å½“å‰èŠ‚ç‚¹ä¹‹ä¸‹çš„å­æ ‘å·²ç»å®Œæˆå †åŒ–ï¼ˆå·²ç»æ˜¯åˆæ³•çš„å †ï¼‰ï¼Œè€Œè¿™æ˜¯å †åŒ–å½“å‰èŠ‚ç‚¹çš„å‰ç½®æ¡ä»¶ã€‚</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æ„é€ æ–¹æ³•ï¼Œæ ¹æ®è¾“å…¥åˆ—è¡¨å»ºå † */</span></span><br><span class="line">MaxHeap(List&lt;Integer&gt; nums) &#123;</span><br><span class="line">    <span class="comment">// å°†åˆ—è¡¨å…ƒç´ åŸå°ä¸åŠ¨æ·»åŠ è¿›å †</span></span><br><span class="line">    maxHeap = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(nums);</span><br><span class="line">    <span class="comment">// å †åŒ–é™¤å¶èŠ‚ç‚¹ä»¥å¤–çš„å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> parent(size() - <span class="number">1</span>); i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        siftDown(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="8-3-Top-K-é—®é¢˜"><a href="#8-3-Top-K-é—®é¢˜" class="headerlink" title="8.3 Top-K é—®é¢˜"></a>8.3 Top-K é—®é¢˜</h3><blockquote><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º<code>n</code>æ— åºæ•°ç»„<code>nums</code>ï¼Œè¯·è¿”å›æ•°ç»„ä¸­å‰<code>k</code>å¤§çš„å…ƒç´ ã€‚</p></blockquote><p><strong>éå†è§£æ³•</strong></p><p>é€šè¿‡<code>k</code>è½®éå†ï¼Œåˆ†åˆ«åœ¨æ¯è½®ä¸­æå–ç¬¬<code>1</code>ã€<code>2</code>ã€<code>...</code>ã€<code>k</code>å¤§çš„å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<code>O(nk)</code>ã€‚æ­¤æ–¹æ³•åªé€‚ç”¨äº<code>k &lt;&lt; n</code>çš„æƒ…å†µï¼Œå› ä¸ºå½“<code>k</code>ä¸<code>n</code>æ¯”è¾ƒæ¥è¿‘æ—¶ï¼Œå…¶æ—¶é—´å¤æ‚åº¦è¶‹å‘äº<code>O(n^2)</code>ã€‚</p><p><img src="https://www.hello-algo.com/chapter_heap/top_k.assets/top_k_traversal.png"></p><p><strong>æ’åºè§£æ³•</strong></p><p>å¯ä»¥å…ˆå¯¹æ•°ç»„<code>nums</code>è¿›è¡Œæ’åºï¼Œå†è¿”å›æœ€å³è¾¹çš„<code>k</code>ä¸ªå…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<code>O(nlogn)</code>ã€‚æ˜¾ç„¶ï¼Œè¯¥æ–¹æ³•â€œè¶…é¢â€å®Œæˆä»»åŠ¡äº†ï¼Œå› ä¸ºåªéœ€è¦æ‰¾å‡ºæœ€å¤§çš„<code>k</code>ä¸ªå…ƒç´ å³å¯ï¼Œè€Œä¸éœ€è¦æ’åºå…¶ä»–å…ƒç´ ã€‚</p><p><img src="https://www.hello-algo.com/chapter_heap/top_k.assets/top_k_sorting.png"></p><p><strong>å †è§£æ³•</strong></p><p>å¯ä»¥åŸºäºå †æ›´åŠ é«˜æ•ˆåœ°è§£å†³<code>Top-K</code>é—®é¢˜ï¼Œæµç¨‹å¦‚ä¸‹æ‰€ç¤ºã€‚</p><ul><li>åˆå§‹åŒ–ä¸€ä¸ªå°é¡¶å †ï¼Œå…¶å †é¡¶å…ƒç´ æœ€å°ã€‚</li><li>å…ˆå°†æ•°ç»„çš„å‰<code>k</code>ä¸ªå…ƒç´ ä¾æ¬¡å…¥å †ã€‚</li><li>ä»ç¬¬<code>k + 1</code>ä¸ªå…ƒç´ å¼€å§‹ï¼Œè‹¥å½“å‰å…ƒç´ å¤§äºå †é¡¶å…ƒç´ ï¼Œåˆ™å°†å †é¡¶å…ƒç´ å‡ºå †ï¼Œå¹¶å°†å½“å‰å…ƒç´ å…¥å †ã€‚</li><li>éå†å®Œæˆåï¼Œå †ä¸­ä¿å­˜çš„å°±æ˜¯æœ€å¤§çš„<code>k</code>ä¸ªå…ƒç´ ã€‚</li></ul><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1"><1></button></li><li class="tab"><button type="button" data-href="#placeholder-2"><2></button></li><li class="tab"><button type="button" data-href="#placeholder-3"><3></button></li><li class="tab"><button type="button" data-href="#placeholder-4"><4></button></li><li class="tab"><button type="button" data-href="#placeholder-5"><5></button></li><li class="tab"><button type="button" data-href="#placeholder-6"><6></button></li><li class="tab"><button type="button" data-href="#placeholder-7"><7></button></li><li class="tab"><button type="button" data-href="#placeholder-8"><8></button></li><li class="tab"><button type="button" data-href="#placeholder-9"><9></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_heap/top_k.assets/top_k_heap_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_heap/top_k.assets/top_k_heap_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_heap/top_k.assets/top_k_heap_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_heap/top_k.assets/top_k_heap_step4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-5"><p><img src="https://www.hello-algo.com/chapter_heap/top_k.assets/top_k_heap_step5.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-6"><p><img src="https://www.hello-algo.com/chapter_heap/top_k.assets/top_k_heap_step6.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-7"><p><img src="https://www.hello-algo.com/chapter_heap/top_k.assets/top_k_heap_step7.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-8"><p><img src="https://www.hello-algo.com/chapter_heap/top_k.assets/top_k_heap_step8.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-9"><p><img src="https://www.hello-algo.com/chapter_heap/top_k.assets/top_k_heap_step9.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>æ€»å…±æ‰§è¡Œäº†<code>n</code>è½®å…¥å †å’Œå‡ºå †ï¼Œå †çš„æœ€å¤§é•¿åº¦ä¸º<code>k</code>ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦ä¸º<code>O(nlogk)</code>ã€‚è¯¥æ–¹æ³•çš„æ•ˆç‡å¾ˆé«˜ï¼Œå½“ <code>k</code>è¾ƒå°æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦è¶‹å‘<code>O(n)</code>ã€‚å½“<code>k</code>è¾ƒå¤§æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ä¼šè¶…è¿‡<code>O(nlogn)</code>ã€‚</p><p>å¦å¤–ï¼Œè¯¥æ–¹æ³•é€‚ç”¨äºåŠ¨æ€æ•°æ®æµçš„ä½¿ç”¨åœºæ™¯ã€‚åœ¨ä¸æ–­åŠ å…¥æ•°æ®æ—¶ï¼Œå¯ä»¥æŒç»­ç»´æŠ¤å †å†…çš„å…ƒç´ ï¼Œä»è€Œå®ç°æœ€å¤§<code>k</code>ä¸ªå…ƒç´ çš„åŠ¨æ€æ›´æ–°ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åŸºäºå †æŸ¥æ‰¾æ•°ç»„ä¸­æœ€å¤§çš„ k ä¸ªå…ƒç´  */</span></span><br><span class="line">Queue&lt;Integer&gt; <span class="title function_">topKHeap</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    Queue&lt;Integer&gt; heap = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;Integer&gt;();</span><br><span class="line">    <span class="comment">// å°†æ•°ç»„çš„å‰ k ä¸ªå…ƒç´ å…¥å †</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; k; i++) &#123;</span><br><span class="line">        heap.offer(nums[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä»ç¬¬ k+1 ä¸ªå…ƒç´ å¼€å§‹ï¼Œä¿æŒå †çš„é•¿åº¦ä¸º k</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> k; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="comment">// è‹¥å½“å‰å…ƒç´ å¤§äºå †é¡¶å…ƒç´ ï¼Œåˆ™å°†å †é¡¶å…ƒç´ å‡ºå †ã€å½“å‰å…ƒç´ å…¥å †</span></span><br><span class="line">        <span class="keyword">if</span> (nums[i] &gt; heap.peek()) &#123;</span><br><span class="line">            heap.poll();</span><br><span class="line">            heap.offer(nums[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> heap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="9-å›¾"><a href="#9-å›¾" class="headerlink" title="9. å›¾"></a>9. å›¾</h2><h3 id="9-1-å›¾"><a href="#9-1-å›¾" class="headerlink" title="9.1 å›¾"></a>9.1 å›¾</h3><p>ã€Œå›¾ <code>graph</code>ã€æ˜¯ä¸€ç§éçº¿æ€§æ•°æ®ç»“æ„ï¼Œç”±ã€Œé¡¶ç‚¹ <code>vertex</code>ã€å’Œã€Œè¾¹ <code>edge</code>ã€ç»„æˆã€‚æˆ‘ä»¬å¯ä»¥å°†å›¾<code>G</code>æŠ½è±¡åœ°è¡¨ç¤ºä¸ºä¸€ç»„é¡¶ç‚¹<code>V</code>å’Œä¸€ç»„è¾¹<code>E</code>çš„é›†åˆã€‚ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†ä¸€ä¸ªåŒ…å«<code>5</code>ä¸ªé¡¶ç‚¹å’Œ<code>7</code>æ¡è¾¹çš„å›¾ã€‚</p><ul><li><code>V = &#123;1, 2, 3, 4, 5&#125;</code></li><li><code>E = &#123;(1, 2), (1, 3), (1, 5), (2, 3), (2, 4), (2, 5), (4, 5)&#125;</code></li><li><code>G = &#123;V, E&#125;</code></li></ul><p>å¦‚æœå°†é¡¶ç‚¹çœ‹ä½œèŠ‚ç‚¹ï¼Œå°†è¾¹çœ‹ä½œè¿æ¥å„ä¸ªèŠ‚ç‚¹çš„å¼•ç”¨ï¼Œå°±å¯ä»¥å°†å›¾çœ‹ä½œæ˜¯ä¸€ç§ä»é“¾è¡¨æ‹“å±•è€Œæ¥çš„æ•°æ®ç»“æ„ã€‚ç›¸è¾ƒäºçº¿æ€§å…³ç³»ï¼ˆé“¾è¡¨ï¼‰å’Œåˆ†æ²»å…³ç³»ï¼ˆæ ‘ï¼‰ï¼Œç½‘ç»œå…³ç³»ï¼ˆå›¾ï¼‰çš„è‡ªç”±åº¦æ›´é«˜ï¼Œä»è€Œæ›´ä¸ºå¤æ‚ã€‚</p><p><img src="https://www.hello-algo.com/chapter_graph/graph.assets/linkedlist_tree_graph.png"></p><h4 id="å›¾å¸¸è§ç±»å‹ä¸æœ¯è¯­"><a href="#å›¾å¸¸è§ç±»å‹ä¸æœ¯è¯­" class="headerlink" title="å›¾å¸¸è§ç±»å‹ä¸æœ¯è¯­"></a>å›¾å¸¸è§ç±»å‹ä¸æœ¯è¯­</h4><p>æ ¹æ®è¾¹æ˜¯å¦å…·æœ‰æ–¹å‘ï¼Œå¯åˆ†ä¸ºã€Œæ— å‘å›¾ <code>undirected graph</code>ã€å’Œã€Œæœ‰å‘å›¾ <code>directed graph</code>ã€ã€‚</p><ul><li>åœ¨æ— å‘å›¾ä¸­ï¼Œè¾¹è¡¨ç¤ºä¸¤é¡¶ç‚¹ä¹‹é—´çš„â€œåŒå‘â€è¿æ¥å…³ç³»ï¼Œä¾‹å¦‚å¾®ä¿¡ä¸­çš„â€œå¥½å‹å…³ç³»â€ã€‚</li><li>åœ¨æœ‰å‘å›¾ä¸­ï¼Œè¾¹å…·æœ‰æ–¹å‘æ€§ï¼Œå³<code>A -&gt; B</code>å’Œ<code>B -&gt; A</code>ä¸¤ä¸ªæ–¹å‘çš„è¾¹æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œä¾‹å¦‚å¾®åšæˆ–æŠ–éŸ³ä¸Šçš„â€œå…³æ³¨â€ä¸â€œè¢«å…³æ³¨â€å…³ç³»ã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_graph/graph.assets/directed_graph.png"></p><p>æ ¹æ®æ‰€æœ‰é¡¶ç‚¹æ˜¯å¦è¿é€šï¼Œå¯åˆ†ä¸ºã€Œè¿é€šå›¾ <code>connected graph</code>ã€å’Œã€Œéè¿é€šå›¾ <code>disconnected graph</code>ã€ã€‚</p><ul><li>å¯¹äºè¿é€šå›¾ï¼Œä»æŸä¸ªé¡¶ç‚¹å‡ºå‘ï¼Œå¯ä»¥åˆ°è¾¾å…¶ä½™ä»»æ„é¡¶ç‚¹ã€‚</li><li>å¯¹äºéè¿é€šå›¾ï¼Œä»æŸä¸ªé¡¶ç‚¹å‡ºå‘ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªé¡¶ç‚¹æ— æ³•åˆ°è¾¾ã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_graph/graph.assets/connected_graph.png"></p><p>è¿˜å¯ä»¥ä¸ºè¾¹æ·»åŠ â€œæƒé‡â€å˜é‡ï¼Œä»è€Œå¾—åˆ°ã€Œæœ‰æƒå›¾ <code>weighted graph</code>ã€ã€‚</p><p><img src="https://www.hello-algo.com/chapter_graph/graph.assets/weighted_graph.png"></p><p>å›¾æ•°æ®ç»“æ„åŒ…å«ä»¥ä¸‹å¸¸ç”¨æœ¯è¯­ã€‚</p><ul><li>ã€Œé‚»æ¥ <code>adjacency</code>ã€ï¼šå½“ä¸¤é¡¶ç‚¹ä¹‹é—´å­˜åœ¨è¾¹ç›¸è¿æ—¶ï¼Œç§°è¿™ä¸¤é¡¶ç‚¹â€œé‚»æ¥â€ã€‚ä¸Šå›¾ä¸­ï¼Œé¡¶ç‚¹<code>1</code>çš„é‚»æ¥é¡¶ç‚¹ä¸ºé¡¶ç‚¹<code>2</code>ã€<code>3</code>ã€<code>5</code>ã€‚</li><li>ã€Œè·¯å¾„ <code>path</code>ã€ï¼šä»é¡¶ç‚¹<code>A</code>åˆ°é¡¶ç‚¹<code>B</code>ç»è¿‡çš„è¾¹æ„æˆçš„åºåˆ—è¢«ç§°ä¸ºä»<code>A</code>åˆ°<code>B</code>çš„â€œè·¯å¾„â€ã€‚ä¸Šå›¾ä¸­ï¼Œè¾¹åºåˆ—<code>1-5-2-4</code>æ˜¯é¡¶ç‚¹<code>1</code>åˆ°é¡¶ç‚¹<code>4</code>çš„ä¸€æ¡è·¯å¾„ã€‚</li><li>ã€Œåº¦ <code>degree</code>ã€ï¼šä¸€ä¸ªé¡¶ç‚¹æ‹¥æœ‰çš„è¾¹æ•°ã€‚å¯¹äºæœ‰å‘å›¾ï¼Œã€Œå…¥åº¦ <code>In-Degree</code>ã€è¡¨ç¤ºæœ‰å¤šå°‘æ¡è¾¹æŒ‡å‘è¯¥é¡¶ç‚¹ï¼Œã€Œå‡ºåº¦ <code>Out-Degree</code>ã€è¡¨ç¤ºæœ‰å¤šå°‘æ¡è¾¹ä»è¯¥é¡¶ç‚¹æŒ‡å‡ºã€‚</li></ul><h4 id="å›¾çš„è¡¨ç¤º"><a href="#å›¾çš„è¡¨ç¤º" class="headerlink" title="å›¾çš„è¡¨ç¤º"></a>å›¾çš„è¡¨ç¤º</h4><p>å›¾çš„å¸¸ç”¨è¡¨ç¤ºæ–¹å¼åŒ…æ‹¬â€œé‚»æ¥çŸ©é˜µâ€å’Œâ€œé‚»æ¥è¡¨â€ã€‚ä»¥ä¸‹ä½¿ç”¨æ— å‘å›¾è¿›è¡Œä¸¾ä¾‹ã€‚</p><p><strong>ï¼ˆ1ï¼‰é‚»æ¥çŸ©é˜µ</strong></p><p>è®¾å›¾çš„é¡¶ç‚¹æ•°é‡ä¸º<code>n</code>ï¼Œã€Œé‚»æ¥çŸ©é˜µ <code>adjacency matrix</code>ã€ä½¿ç”¨ä¸€ä¸ª<code>n * n</code>å¤§å°çš„çŸ©é˜µæ¥è¡¨ç¤ºå›¾ï¼Œæ¯ä¸€è¡Œï¼ˆåˆ—ï¼‰ä»£è¡¨ä¸€ä¸ªé¡¶ç‚¹ï¼ŒçŸ©é˜µå…ƒç´ ä»£è¡¨è¾¹ï¼Œç”¨<code>1</code>æˆ–<code>0</code>è¡¨ç¤ºä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´æ˜¯å¦å­˜åœ¨è¾¹ã€‚</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè®¾é‚»æ¥çŸ©é˜µä¸º<code>M</code>ã€é¡¶ç‚¹åˆ—è¡¨ä¸º<code>V</code>ï¼Œé‚£ä¹ˆçŸ©é˜µå…ƒç´ <code>M[i, j] = 1</code>è¡¨ç¤ºé¡¶ç‚¹<code>V[i]</code>åˆ°é¡¶ç‚¹<code>V[j]</code>ä¹‹é—´å­˜åœ¨è¾¹ï¼Œåä¹‹<code>M[i, j] = 0</code>è¡¨ç¤ºä¸¤é¡¶ç‚¹ä¹‹é—´æ— è¾¹ã€‚</p><p><img src="https://www.hello-algo.com/chapter_graph/graph.assets/adjacency_matrix.png"></p><p>é‚»æ¥çŸ©é˜µå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ã€‚</p><ul><li>é¡¶ç‚¹ä¸èƒ½ä¸è‡ªèº«ç›¸è¿ï¼Œå› æ­¤é‚»æ¥çŸ©é˜µä¸»å¯¹è§’çº¿å…ƒç´ æ²¡æœ‰æ„ä¹‰ã€‚</li><li>å¯¹äºæ— å‘å›¾ï¼Œä¸¤ä¸ªæ–¹å‘çš„è¾¹ç­‰ä»·ï¼Œæ­¤æ—¶é‚»æ¥çŸ©é˜µå…³äºä¸»å¯¹è§’çº¿å¯¹ç§°ã€‚</li><li>å°†é‚»æ¥çŸ©é˜µçš„å…ƒç´ ä»<code>1</code>å’Œ<code>0</code>æ›¿æ¢ä¸ºæƒé‡ï¼Œåˆ™å¯è¡¨ç¤ºæœ‰æƒå›¾ã€‚</li></ul><p>ä½¿ç”¨é‚»æ¥çŸ©é˜µè¡¨ç¤ºå›¾æ—¶ï¼Œå¯ä»¥ç›´æ¥è®¿é—®çŸ©é˜µå…ƒç´ ä»¥è·å–è¾¹ï¼Œå› æ­¤å¢åˆ æŸ¥æ“ä½œçš„æ•ˆç‡å¾ˆé«˜ï¼Œæ—¶é—´å¤æ‚åº¦å‡ä¸º<code>O(1)</code>ã€‚ç„¶è€Œï¼ŒçŸ©é˜µçš„ç©ºé—´å¤æ‚åº¦ä¸º<code>O(n^2)</code>ï¼Œå†…å­˜å ç”¨è¾ƒå¤šã€‚</p><p><strong>ï¼ˆ2ï¼‰é‚»æ¥è¡¨</strong></p><p>ã€Œé‚»æ¥è¡¨ <code>adjacency list</code>ã€ä½¿ç”¨<code>n</code>ä¸ªé“¾è¡¨æ¥è¡¨ç¤ºå›¾ï¼Œé“¾è¡¨èŠ‚ç‚¹è¡¨ç¤ºé¡¶ç‚¹ã€‚ç¬¬<code>i</code>æ¡é“¾è¡¨å¯¹åº”é¡¶ç‚¹<code>i</code>ï¼Œå…¶ä¸­å­˜å‚¨äº†è¯¥é¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹ï¼ˆå³ä¸è¯¥é¡¶ç‚¹ç›¸è¿çš„é¡¶ç‚¹ï¼‰ã€‚</p><p><img src="https://www.hello-algo.com/chapter_graph/graph.assets/adjacency_list.png"></p><p>é‚»æ¥è¡¨ä»…å­˜å‚¨å®é™…å­˜åœ¨çš„è¾¹ï¼Œè€Œè¾¹çš„æ€»æ•°é€šå¸¸è¿œå°äº<code>n^2</code>ï¼Œå› æ­¤å®ƒæ›´åŠ èŠ‚çœç©ºé—´ã€‚ç„¶è€Œï¼Œåœ¨é‚»æ¥è¡¨ä¸­éœ€è¦é€šè¿‡éå†é“¾è¡¨æ¥æŸ¥æ‰¾è¾¹ï¼Œå› æ­¤å…¶æ—¶é—´æ•ˆç‡ä¸å¦‚é‚»æ¥çŸ©é˜µã€‚</p><p>è§‚å¯Ÿä¸Šå›¾ï¼Œé‚»æ¥è¡¨ç»“æ„ä¸å“ˆå¸Œè¡¨ä¸­çš„â€œé“¾å¼åœ°å€â€éå¸¸ç›¸ä¼¼ï¼Œå› æ­¤ä¹Ÿå¯ä»¥é‡‡ç”¨ç±»ä¼¼æ–¹æ³•æ¥ä¼˜åŒ–æ•ˆç‡ã€‚æ¯”å¦‚å½“é“¾è¡¨è¾ƒé•¿æ—¶ï¼Œå¯ä»¥å°†é“¾è¡¨è½¬åŒ–ä¸º<code>AVL</code>æ ‘æˆ–çº¢é»‘æ ‘ï¼Œä»è€Œå°†æ—¶é—´æ•ˆç‡ä»<code>O(n)</code>ä¼˜åŒ–è‡³<code>O(logn)</code>ã€‚è¿˜å¯ä»¥æŠŠé“¾è¡¨è½¬æ¢ä¸ºå“ˆå¸Œè¡¨ï¼Œä»è€Œå°†æ—¶é—´å¤æ‚åº¦é™ä½è‡³<code>O(1)</code>ã€‚</p><hr><h3 id="9-2-å›¾åŸºç¡€æ“ä½œ"><a href="#9-2-å›¾åŸºç¡€æ“ä½œ" class="headerlink" title="9.2 å›¾åŸºç¡€æ“ä½œ"></a>9.2 å›¾åŸºç¡€æ“ä½œ</h3><p>å›¾çš„åŸºç¡€æ“ä½œå¯åˆ†ä¸ºå¯¹â€œè¾¹â€çš„æ“ä½œå’Œå¯¹â€œé¡¶ç‚¹â€çš„æ“ä½œã€‚åœ¨â€œé‚»æ¥çŸ©é˜µâ€å’Œâ€œé‚»æ¥è¡¨â€ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ä¸‹ï¼Œå®ç°æ–¹å¼æœ‰æ‰€ä¸åŒã€‚</p><h4 id="åŸºäºé‚»æ¥çŸ©é˜µçš„å®ç°"><a href="#åŸºäºé‚»æ¥çŸ©é˜µçš„å®ç°" class="headerlink" title="åŸºäºé‚»æ¥çŸ©é˜µçš„å®ç°"></a>åŸºäºé‚»æ¥çŸ©é˜µçš„å®ç°</h4><p>ç»™å®šä¸€ä¸ªé¡¶ç‚¹æ•°é‡ä¸º<code>n</code>çš„æ— å‘å›¾ï¼Œåˆ™å„ç§æ“ä½œçš„å®ç°æ–¹å¼å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><ul><li>æ·»åŠ æˆ–åˆ é™¤è¾¹ï¼šç›´æ¥åœ¨é‚»æ¥çŸ©é˜µä¸­ä¿®æ”¹æŒ‡å®šçš„è¾¹å³å¯ï¼Œä½¿ç”¨<code>O(1)</code>æ—¶é—´ã€‚è€Œç”±äºæ˜¯æ— å‘å›¾ï¼Œå› æ­¤éœ€è¦åŒæ—¶æ›´æ–°ä¸¤ä¸ªæ–¹å‘çš„è¾¹ã€‚</li><li>æ·»åŠ é¡¶ç‚¹ï¼šåœ¨é‚»æ¥çŸ©é˜µçš„å°¾éƒ¨æ·»åŠ ä¸€è¡Œä¸€åˆ—ï¼Œå¹¶å…¨éƒ¨å¡«<code>0</code>å³å¯ï¼Œä½¿ç”¨<code>O(n)</code>æ—¶é—´ã€‚</li><li>åˆ é™¤é¡¶ç‚¹ï¼šåœ¨é‚»æ¥çŸ©é˜µä¸­åˆ é™¤ä¸€è¡Œä¸€åˆ—ã€‚å½“åˆ é™¤é¦–è¡Œé¦–åˆ—æ—¶è¾¾åˆ°æœ€å·®æƒ…å†µï¼Œéœ€è¦å°†<code>(n - 1)^2</code>ä¸ªå…ƒç´ â€œå‘å·¦ä¸Šç§»åŠ¨â€ï¼Œä»è€Œä½¿ç”¨<code>O(n^2)</code>æ—¶é—´ã€‚</li><li>åˆå§‹åŒ–ï¼šä¼ å…¥<code>n</code>ä¸ªé¡¶ç‚¹ï¼Œåˆå§‹åŒ–é•¿åº¦ä¸º<code>n</code>çš„é¡¶ç‚¹åˆ—è¡¨<code>vertices</code>ï¼Œä½¿ç”¨<code>O(n)</code>æ—¶é—´ã€‚åˆå§‹åŒ–<code>n * n</code>å¤§å°çš„é‚»æ¥çŸ©é˜µ<code>adjMat</code>ï¼Œä½¿ç”¨<code>O(n^2)</code>æ—¶é—´ã€‚</li></ul><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1">åˆå§‹åŒ–é‚»æ¥çŸ©é˜µ</button></li><li class="tab"><button type="button" data-href="#placeholder-2">æ·»åŠ è¾¹</button></li><li class="tab"><button type="button" data-href="#placeholder-3">åˆ é™¤è¾¹</button></li><li class="tab"><button type="button" data-href="#placeholder-4">æ·»åŠ é¡¶ç‚¹</button></li><li class="tab"><button type="button" data-href="#placeholder-5">åˆ é™¤é¡¶ç‚¹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_graph/graph_operations.assets/adjacency_matrix_initialization.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_graph/graph_operations.assets/adjacency_matrix_add_edge.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_graph/graph_operations.assets/adjacency_matrix_remove_edge.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_graph/graph_operations.assets/adjacency_matrix_add_vertex.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-5"><p><img src="https://www.hello-algo.com/chapter_graph/graph_operations.assets/adjacency_matrix_remove_vertex.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>ä»¥ä¸‹æ˜¯åŸºäºé‚»æ¥çŸ©é˜µè¡¨ç¤ºå›¾çš„å®ç°ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åŸºäºé‚»æ¥çŸ©é˜µå®ç°çš„æ— å‘å›¾ç±» */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GraphAdjMat</span> &#123;</span><br><span class="line">    List&lt;Integer&gt; vertices; <span class="comment">// é¡¶ç‚¹åˆ—è¡¨ï¼Œå…ƒç´ ä»£è¡¨â€œé¡¶ç‚¹å€¼â€ï¼Œç´¢å¼•ä»£è¡¨â€œé¡¶ç‚¹ç´¢å¼•â€</span></span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; adjMat; <span class="comment">// é‚»æ¥çŸ©é˜µï¼Œè¡Œåˆ—ç´¢å¼•å¯¹åº”â€œé¡¶ç‚¹ç´¢å¼•â€</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ„é€ æ–¹æ³• */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">GraphAdjMat</span><span class="params">(<span class="type">int</span>[] vertices, <span class="type">int</span>[][] edges)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.vertices = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="built_in">this</span>.adjMat = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// æ·»åŠ é¡¶ç‚¹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> val : vertices) &#123;</span><br><span class="line">            addVertex(val);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ·»åŠ è¾¹</span></span><br><span class="line">        <span class="comment">// è¯·æ³¨æ„ï¼Œedges å…ƒç´ ä»£è¡¨é¡¶ç‚¹ç´¢å¼•ï¼Œå³å¯¹åº” vertices å…ƒç´ ç´¢å¼•</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>[] e : edges) &#123;</span><br><span class="line">            addEdge(e[<span class="number">0</span>], e[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è·å–é¡¶ç‚¹æ•°é‡ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> vertices.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ·»åŠ é¡¶ç‚¹ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addVertex</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> size();</span><br><span class="line">        <span class="comment">// å‘é¡¶ç‚¹åˆ—è¡¨ä¸­æ·»åŠ æ–°é¡¶ç‚¹çš„å€¼</span></span><br><span class="line">        vertices.add(val);</span><br><span class="line">        <span class="comment">// åœ¨é‚»æ¥çŸ©é˜µä¸­æ·»åŠ ä¸€è¡Œ</span></span><br><span class="line">        List&lt;Integer&gt; newRow = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            newRow.add(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        adjMat.add(newRow);</span><br><span class="line">        <span class="comment">// åœ¨é‚»æ¥çŸ©é˜µä¸­æ·»åŠ ä¸€åˆ—</span></span><br><span class="line">        <span class="keyword">for</span> (List&lt;Integer&gt; row : adjMat) &#123;</span><br><span class="line">            row.add(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* åˆ é™¤é¡¶ç‚¹ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeVertex</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &gt;= size())</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IndexOutOfBoundsException</span>();</span><br><span class="line">        <span class="comment">// åœ¨é¡¶ç‚¹åˆ—è¡¨ä¸­ç§»é™¤ç´¢å¼• index çš„é¡¶ç‚¹</span></span><br><span class="line">        vertices.remove(index);</span><br><span class="line">        <span class="comment">// åœ¨é‚»æ¥çŸ©é˜µä¸­åˆ é™¤ç´¢å¼• index çš„è¡Œ</span></span><br><span class="line">        adjMat.remove(index);</span><br><span class="line">        <span class="comment">// åœ¨é‚»æ¥çŸ©é˜µä¸­åˆ é™¤ç´¢å¼• index çš„åˆ—</span></span><br><span class="line">        <span class="keyword">for</span> (List&lt;Integer&gt; row : adjMat) &#123;</span><br><span class="line">            row.remove(index);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ·»åŠ è¾¹ */</span></span><br><span class="line">    <span class="comment">// å‚æ•° i, j å¯¹åº” vertices å…ƒç´ ç´¢å¼•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addEdge</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="comment">// ç´¢å¼•è¶Šç•Œä¸ç›¸ç­‰å¤„ç†</span></span><br><span class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span> || j &lt; <span class="number">0</span> || i &gt;= size() || j &gt;= size() || i == j)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IndexOutOfBoundsException</span>();</span><br><span class="line">        <span class="comment">// åœ¨æ— å‘å›¾ä¸­ï¼Œé‚»æ¥çŸ©é˜µæ²¿ä¸»å¯¹è§’çº¿å¯¹ç§°ï¼Œå³æ»¡è¶³ (i, j) == (j, i)</span></span><br><span class="line">        adjMat.get(i).set(j, <span class="number">1</span>);</span><br><span class="line">        adjMat.get(j).set(i, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* åˆ é™¤è¾¹ */</span></span><br><span class="line">    <span class="comment">// å‚æ•° i, j å¯¹åº” vertices å…ƒç´ ç´¢å¼•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeEdge</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="comment">// ç´¢å¼•è¶Šç•Œä¸ç›¸ç­‰å¤„ç†</span></span><br><span class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span> || j &lt; <span class="number">0</span> || i &gt;= size() || j &gt;= size() || i == j)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IndexOutOfBoundsException</span>();</span><br><span class="line">        adjMat.get(i).set(j, <span class="number">0</span>);</span><br><span class="line">        adjMat.get(j).set(i, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ‰“å°é‚»æ¥çŸ©é˜µ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.print(<span class="string">&quot;é¡¶ç‚¹åˆ—è¡¨ = &quot;</span>);</span><br><span class="line">        System.out.println(vertices);</span><br><span class="line">        System.out.println(<span class="string">&quot;é‚»æ¥çŸ©é˜µ =&quot;</span>);</span><br><span class="line">        PrintUtil.printMatrix(adjMat);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åŸºäºé‚»æ¥è¡¨çš„å®ç°"><a href="#åŸºäºé‚»æ¥è¡¨çš„å®ç°" class="headerlink" title="åŸºäºé‚»æ¥è¡¨çš„å®ç°"></a>åŸºäºé‚»æ¥è¡¨çš„å®ç°</h4><p>è®¾æ— å‘å›¾çš„é¡¶ç‚¹æ€»æ•°ä¸º<code>n</code>ã€è¾¹æ€»æ•°ä¸º<code>m</code>ï¼Œåˆ™å¯æ ¹æ®ä¸‹å›¾æ‰€ç¤ºçš„æ–¹æ³•å®ç°å„ç§æ“ä½œã€‚</p><ul><li>æ·»åŠ è¾¹ï¼šåœ¨é¡¶ç‚¹å¯¹åº”é“¾è¡¨çš„æœ«å°¾æ·»åŠ è¾¹å³å¯ï¼Œä½¿ç”¨<code>O(1)</code>æ—¶é—´ã€‚å› ä¸ºæ˜¯æ— å‘å›¾ï¼Œæ‰€ä»¥éœ€è¦åŒæ—¶æ·»åŠ ä¸¤ä¸ªæ–¹å‘çš„è¾¹ã€‚</li><li>åˆ é™¤è¾¹ï¼šåœ¨é¡¶ç‚¹å¯¹åº”é“¾è¡¨ä¸­æŸ¥æ‰¾å¹¶åˆ é™¤æŒ‡å®šè¾¹ï¼Œä½¿ç”¨<code>O(m)</code>æ—¶é—´ã€‚åœ¨æ— å‘å›¾ä¸­ï¼Œéœ€è¦åŒæ—¶åˆ é™¤ä¸¤ä¸ªæ–¹å‘çš„è¾¹ã€‚</li><li>æ·»åŠ é¡¶ç‚¹ï¼šåœ¨é‚»æ¥è¡¨ä¸­æ·»åŠ ä¸€ä¸ªé“¾è¡¨ï¼Œå¹¶å°†æ–°å¢é¡¶ç‚¹ä½œä¸ºé“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œä½¿ç”¨<code>O(1)</code>æ—¶é—´ã€‚</li><li>åˆ é™¤é¡¶ç‚¹ï¼šéœ€éå†æ•´ä¸ªé‚»æ¥è¡¨ï¼Œåˆ é™¤åŒ…å«æŒ‡å®šé¡¶ç‚¹çš„æ‰€æœ‰è¾¹ï¼Œä½¿ç”¨<code>O(n + m)</code>æ—¶é—´ã€‚</li><li>åˆå§‹åŒ–ï¼šåœ¨é‚»æ¥è¡¨ä¸­åˆ›å»º<code>n</code>ä¸ªé¡¶ç‚¹å’Œ<code>m</code>æ¡è¾¹ï¼Œä½¿ç”¨<code>O(n + m)</code>æ—¶é—´ã€‚</li></ul><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1">åˆå§‹åŒ–é‚»æ¥è¡¨</button></li><li class="tab"><button type="button" data-href="#placeholder-2">æ·»åŠ è¾¹</button></li><li class="tab"><button type="button" data-href="#placeholder-3">åˆ é™¤è¾¹</button></li><li class="tab"><button type="button" data-href="#placeholder-4">æ·»åŠ é¡¶ç‚¹</button></li><li class="tab"><button type="button" data-href="#placeholder-5">åˆ é™¤é¡¶ç‚¹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_graph/graph_operations.assets/adjacency_list_initialization.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_graph/graph_operations.assets/adjacency_list_add_edge.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_graph/graph_operations.assets/adjacency_list_remove_edge.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_graph/graph_operations.assets/adjacency_list_add_vertex.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-5"><p><img src="https://www.hello-algo.com/chapter_graph/graph_operations.assets/adjacency_list_remove_vertex.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>ä¸‹é¢æ˜¯åŸºäºé‚»æ¥è¡¨å®ç°å›¾çš„ä»£ç ç¤ºä¾‹ã€‚æ³¨æ„ï¼Œåœ¨é‚»æ¥è¡¨ä¸­ä½¿ç”¨<code>Vertex</code>èŠ‚ç‚¹ç±»æ¥è¡¨ç¤ºé¡¶ç‚¹ï¼Œè¿™æ ·åšæ˜¯æœ‰åŸå› çš„ã€‚</p><ul><li>å¦‚æœé€‰æ‹©é€šè¿‡é¡¶ç‚¹å€¼æ¥åŒºåˆ†ä¸åŒé¡¶ç‚¹ï¼Œé‚£ä¹ˆå€¼é‡å¤çš„é¡¶ç‚¹å°†æ— æ³•è¢«åŒºåˆ†ã€‚</li><li>å¦‚æœç±»ä¼¼é‚»æ¥çŸ©é˜µé‚£æ ·ï¼Œä½¿ç”¨é¡¶ç‚¹åˆ—è¡¨ç´¢å¼•æ¥åŒºåˆ†ä¸åŒé¡¶ç‚¹ã€‚é‚£ä¹ˆï¼Œæƒ³è¦åˆ é™¤ç´¢å¼•ä¸º<code>i</code>çš„é¡¶ç‚¹ï¼Œåˆ™éœ€è¦éå†æ•´ä¸ªé‚»æ¥è¡¨ï¼Œå°†å…¶ä¸­<code>&gt; i</code>çš„ç´¢å¼•å…¨éƒ¨å‡<code>1</code>ï¼Œè¿™æ ·æ“ä½œæ•ˆç‡è¾ƒä½ã€‚</li><li>å¼•å…¥é¡¶ç‚¹ç±»<code>Vertex</code>ï¼Œä½¿å¾—æ¯ä¸ªé¡¶ç‚¹éƒ½æ˜¯å”¯ä¸€çš„å¯¹è±¡ï¼Œæ­¤æ—¶åˆ é™¤é¡¶ç‚¹æ—¶å°±æ— é¡»æ”¹åŠ¨å…¶ä½™é¡¶ç‚¹äº†ã€‚</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åŸºäºé‚»æ¥è¡¨å®ç°çš„æ— å‘å›¾ç±» */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GraphAdjList</span> &#123;</span><br><span class="line">    <span class="comment">// é‚»æ¥è¡¨ï¼Œkey: é¡¶ç‚¹ï¼Œvalueï¼šè¯¥é¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹</span></span><br><span class="line">    Map&lt;Vertex, List&lt;Vertex&gt;&gt; adjList;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ„é€ æ–¹æ³• */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">GraphAdjList</span><span class="params">(Vertex[][] edges)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.adjList = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// æ·»åŠ æ‰€æœ‰é¡¶ç‚¹å’Œè¾¹</span></span><br><span class="line">        <span class="keyword">for</span> (Vertex[] edge : edges) &#123;</span><br><span class="line">            addVertex(edge[<span class="number">0</span>]);</span><br><span class="line">            addVertex(edge[<span class="number">1</span>]);</span><br><span class="line">            addEdge(edge[<span class="number">0</span>], edge[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è·å–é¡¶ç‚¹æ•°é‡ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> adjList.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ·»åŠ è¾¹ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addEdge</span><span class="params">(Vertex vet1, Vertex vet2)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!adjList.containsKey(vet1) || !adjList.containsKey(vet2) || vet1 == vet2)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>();</span><br><span class="line">        <span class="comment">// æ·»åŠ è¾¹ vet1 - vet2</span></span><br><span class="line">        adjList.get(vet1).add(vet2);</span><br><span class="line">        adjList.get(vet2).add(vet1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* åˆ é™¤è¾¹ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeEdge</span><span class="params">(Vertex vet1, Vertex vet2)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!adjList.containsKey(vet1) || !adjList.containsKey(vet2) || vet1 == vet2)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>();</span><br><span class="line">        <span class="comment">// åˆ é™¤è¾¹ vet1 - vet2</span></span><br><span class="line">        adjList.get(vet1).remove(vet2);</span><br><span class="line">        adjList.get(vet2).remove(vet1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ·»åŠ é¡¶ç‚¹ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addVertex</span><span class="params">(Vertex vet)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (adjList.containsKey(vet))</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">// åœ¨é‚»æ¥è¡¨ä¸­æ·»åŠ ä¸€ä¸ªæ–°é“¾è¡¨</span></span><br><span class="line">        adjList.put(vet, <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* åˆ é™¤é¡¶ç‚¹ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeVertex</span><span class="params">(Vertex vet)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!adjList.containsKey(vet))</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>();</span><br><span class="line">        <span class="comment">// åœ¨é‚»æ¥è¡¨ä¸­åˆ é™¤é¡¶ç‚¹ vet å¯¹åº”çš„é“¾è¡¨</span></span><br><span class="line">        adjList.remove(vet);</span><br><span class="line">        <span class="comment">// éå†å…¶ä»–é¡¶ç‚¹çš„é“¾è¡¨ï¼Œåˆ é™¤æ‰€æœ‰åŒ…å« vet çš„è¾¹</span></span><br><span class="line">        <span class="keyword">for</span> (List&lt;Vertex&gt; list : adjList.values()) &#123;</span><br><span class="line">            list.remove(vet);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ‰“å°é‚»æ¥è¡¨ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é‚»æ¥è¡¨ =&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;Vertex, List&lt;Vertex&gt;&gt; pair : adjList.entrySet()) &#123;</span><br><span class="line">            List&lt;Integer&gt; tmp = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span> (Vertex vertex : pair.getValue())</span><br><span class="line">                tmp.add(vertex.val);</span><br><span class="line">            System.out.println(pair.getKey().val + <span class="string">&quot;: &quot;</span> + tmp + <span class="string">&quot;,&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ•ˆç‡å¯¹æ¯”"><a href="#æ•ˆç‡å¯¹æ¯”" class="headerlink" title="æ•ˆç‡å¯¹æ¯”"></a>æ•ˆç‡å¯¹æ¯”</h4><p>è®¾å›¾ä¸­å…±æœ‰<code>n</code>ä¸ªé¡¶ç‚¹å’Œ<code>m</code>æ¡è¾¹ï¼Œä¸‹è¡¨å¯¹æ¯”äº†é‚»æ¥çŸ©é˜µå’Œé‚»æ¥è¡¨çš„æ—¶é—´å’Œç©ºé—´æ•ˆç‡ã€‚</p><table><thead><tr><th align="left"></th><th align="left">é‚»æ¥çŸ©é˜µ</th><th align="left">é‚»æ¥è¡¨ï¼ˆé“¾è¡¨ï¼‰</th><th align="left">é‚»æ¥è¡¨ï¼ˆå“ˆå¸Œè¡¨ï¼‰</th></tr></thead><tbody><tr><td align="left">åˆ¤æ–­æ˜¯å¦é‚»æ¥</td><td align="left"><code>O(1)</code></td><td align="left"><code>O(m)</code></td><td align="left"><code>O(1)</code></td></tr><tr><td align="left">æ·»åŠ è¾¹</td><td align="left"><code>O(1)</code></td><td align="left"><code>O(1)</code></td><td align="left"><code>O(1)</code></td></tr><tr><td align="left">åˆ é™¤è¾¹</td><td align="left"><code>O(1)</code></td><td align="left"><code>O(m)</code></td><td align="left"><code>O(1)</code></td></tr><tr><td align="left">æ·»åŠ é¡¶ç‚¹</td><td align="left"><code>O(n)</code></td><td align="left"><code>O(1)</code></td><td align="left"><code>O(1)</code></td></tr><tr><td align="left">åˆ é™¤é¡¶ç‚¹</td><td align="left"><code>O(n^2)</code></td><td align="left"><code>O(n + m)</code></td><td align="left"><code>O(n)</code></td></tr><tr><td align="left">å†…å­˜ç©ºé—´å ç”¨</td><td align="left"><code>O(n^2)</code></td><td align="left"><code>O(n + m)</code></td><td align="left"><code>O(n + m)</code></td></tr></tbody></table><p>è§‚å¯Ÿä¸Šè¡¨ ï¼Œä¼¼ä¹é‚»æ¥è¡¨ï¼ˆå“ˆå¸Œè¡¨ï¼‰çš„æ—¶é—´ä¸ç©ºé—´æ•ˆç‡æœ€ä¼˜ã€‚ä½†å®é™…ä¸Šï¼Œåœ¨é‚»æ¥çŸ©é˜µä¸­æ“ä½œè¾¹çš„æ•ˆç‡æ›´é«˜ï¼Œåªéœ€è¦ä¸€æ¬¡æ•°ç»„è®¿é—®æˆ–èµ‹å€¼æ“ä½œå³å¯ã€‚ç»¼åˆæ¥çœ‹ï¼Œé‚»æ¥çŸ©é˜µä½“ç°äº†â€œä»¥ç©ºé—´æ¢æ—¶é—´â€çš„åŸåˆ™ï¼Œè€Œé‚»æ¥è¡¨ä½“ç°äº†â€œä»¥æ—¶é—´æ¢ç©ºé—´â€çš„åŸåˆ™ã€‚</p><hr><h3 id="9-3-å›¾çš„éå†"><a href="#9-3-å›¾çš„éå†" class="headerlink" title="9.3 å›¾çš„éå†"></a>9.3 å›¾çš„éå†</h3><p>æ ‘ä»£è¡¨çš„æ˜¯â€œä¸€å¯¹å¤šâ€çš„å…³ç³»ï¼Œè€Œå›¾åˆ™å…·æœ‰æ›´é«˜çš„è‡ªç”±åº¦ï¼Œå¯ä»¥è¡¨ç¤ºä»»æ„çš„â€œå¤šå¯¹å¤šâ€å…³ç³»ã€‚å› æ­¤ï¼Œå¯ä»¥æŠŠæ ‘çœ‹ä½œæ˜¯å›¾çš„ä¸€ç§ç‰¹ä¾‹ã€‚æ˜¾ç„¶ï¼Œæ ‘çš„éå†æ“ä½œä¹Ÿæ˜¯å›¾çš„éå†æ“ä½œçš„ä¸€ç§ç‰¹ä¾‹ã€‚</p><p>å›¾å’Œæ ‘éƒ½éƒ½éœ€è¦åº”ç”¨æœç´¢ç®—æ³•æ¥å®ç°éå†æ“ä½œã€‚å›¾çš„éå†æ–¹å¼å¯åˆ†ä¸ºä¸¤ç§ï¼Œã€Œå¹¿åº¦ä¼˜å…ˆæœç´¢ <code>breadth-first search</code>ã€å’Œã€Œæ·±åº¦ä¼˜å…ˆæœç´¢ <code>depth-first search</code>ã€ï¼Œç®€ç§°<code>BFS</code>å’Œ<code>DFS</code>ã€‚</p><h4 id="å¹¿åº¦ä¼˜å…ˆéå†"><a href="#å¹¿åº¦ä¼˜å…ˆéå†" class="headerlink" title="å¹¿åº¦ä¼˜å…ˆéå†"></a>å¹¿åº¦ä¼˜å…ˆéå†</h4><p>å¹¿åº¦ä¼˜å…ˆéå†æ˜¯ä¸€ç§ç”±è¿‘åŠè¿œçš„éå†æ–¹å¼ï¼Œä»æŸä¸ªèŠ‚ç‚¹å‡ºå‘ï¼Œå§‹ç»ˆä¼˜å…ˆè®¿é—®è·ç¦»æœ€è¿‘çš„é¡¶ç‚¹ï¼Œå¹¶ä¸€å±‚å±‚å‘å¤–æ‰©å¼ ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä»å·¦ä¸Šè§’é¡¶ç‚¹å‡ºå‘ï¼Œå…ˆéå†è¯¥é¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹ï¼Œç„¶åéå†ä¸‹ä¸€ä¸ªé¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´è‡³æ‰€æœ‰é¡¶ç‚¹è®¿é—®å®Œæ¯•ã€‚</p><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_bfs.png"></p><p><strong>ï¼ˆ1ï¼‰ç®—æ³•å®ç°</strong></p><p><code>BFS</code>é€šå¸¸å€ŸåŠ©é˜Ÿåˆ—æ¥å®ç°ã€‚é˜Ÿåˆ—å…·æœ‰â€œå…ˆå…¥å…ˆå‡ºâ€çš„æ€§è´¨ï¼Œè¿™ä¸<code>BFS</code>çš„â€œç”±è¿‘åŠè¿œâ€çš„æ€æƒ³å¼‚æ›²åŒå·¥ã€‚</p><ul><li>å°†éå†èµ·å§‹é¡¶ç‚¹<code>startVet</code>åŠ å…¥é˜Ÿåˆ—ï¼Œå¹¶å¼€å¯å¾ªç¯ã€‚</li><li>æ¯è½®è¿­ä»£ä¸­ï¼Œå¼¹å‡ºé˜Ÿé¦–é¡¶ç‚¹å¹¶è®°å½•è®¿é—®ï¼Œç„¶åå°†è¯¥é¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹åŠ å…¥åˆ°é˜Ÿåˆ—å°¾éƒ¨ã€‚</li><li>å¾ªç¯ä¸Šé¢æ­¥éª¤ï¼Œç›´åˆ°æ‰€æœ‰é¡¶ç‚¹è¢«è®¿é—®å®Œæˆåç»“æŸã€‚</li></ul><p>ä¸ºäº†é˜²æ­¢é‡å¤éå†é¡¶ç‚¹ï¼Œéœ€è¦å€ŸåŠ©ä¸€ä¸ªå“ˆå¸Œè¡¨<code>visited</code>æ¥è®°å½•å“ªäº›èŠ‚ç‚¹å·²è¢«è®¿é—®ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å¹¿åº¦ä¼˜å…ˆéå† BFS */</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨é‚»æ¥è¡¨æ¥è¡¨ç¤ºå›¾ï¼Œä»¥ä¾¿è·å–æŒ‡å®šé¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹</span></span><br><span class="line">List&lt;Vertex&gt; <span class="title function_">graphBFS</span><span class="params">(GraphAdjList graph, Vertex startVet)</span> &#123;</span><br><span class="line">    <span class="comment">// é¡¶ç‚¹éå†åºåˆ—</span></span><br><span class="line">    List&lt;Vertex&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// å“ˆå¸Œè¡¨ï¼Œç”¨äºè®°å½•å·²è¢«è®¿é—®è¿‡çš„é¡¶ç‚¹</span></span><br><span class="line">    Set&lt;Vertex&gt; visited = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    visited.add(startVet);</span><br><span class="line">    <span class="comment">// é˜Ÿåˆ—ç”¨äºå®ç° BFS</span></span><br><span class="line">    Queue&lt;Vertex&gt; que = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    que.offer(startVet);</span><br><span class="line">    <span class="comment">// ä»¥é¡¶ç‚¹ vet ä¸ºèµ·ç‚¹ï¼Œå¾ªç¯ç›´è‡³è®¿é—®å®Œæ‰€æœ‰é¡¶ç‚¹</span></span><br><span class="line">    <span class="keyword">while</span> (!que.isEmpty()) &#123;</span><br><span class="line">        <span class="type">Vertex</span> <span class="variable">vet</span> <span class="operator">=</span> que.poll(); <span class="comment">// é˜Ÿé¦–é¡¶ç‚¹å‡ºé˜Ÿ</span></span><br><span class="line">        res.add(vet);            <span class="comment">// è®°å½•è®¿é—®é¡¶ç‚¹</span></span><br><span class="line">        <span class="comment">// éå†è¯¥é¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹</span></span><br><span class="line">        <span class="keyword">for</span> (Vertex adjVet : graph.adjList.get(vet)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (visited.contains(adjVet))</span><br><span class="line">                <span class="keyword">continue</span>;        <span class="comment">// è·³è¿‡å·²è¢«è®¿é—®è¿‡çš„é¡¶ç‚¹</span></span><br><span class="line">            que.offer(adjVet);   <span class="comment">// åªå…¥é˜Ÿæœªè®¿é—®çš„é¡¶ç‚¹</span></span><br><span class="line">            visited.add(adjVet); <span class="comment">// æ ‡è®°è¯¥é¡¶ç‚¹å·²è¢«è®¿é—®</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿”å›é¡¶ç‚¹éå†åºåˆ—</span></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1">1</button></li><li class="tab"><button type="button" data-href="#placeholder-2">2</button></li><li class="tab"><button type="button" data-href="#placeholder-3">3</button></li><li class="tab"><button type="button" data-href="#placeholder-4">4</button></li><li class="tab"><button type="button" data-href="#placeholder-5">5</button></li><li class="tab"><button type="button" data-href="#placeholder-6">6</button></li><li class="tab"><button type="button" data-href="#placeholder-7">7</button></li><li class="tab"><button type="button" data-href="#placeholder-8">8</button></li><li class="tab"><button type="button" data-href="#placeholder-9">9</button></li><li class="tab"><button type="button" data-href="#placeholder-10">10</button></li><li class="tab"><button type="button" data-href="#placeholder-11">11</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_bfs_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_bfs_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_bfs_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_bfs_step4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-5"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_bfs_step5.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-6"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_bfs_step6.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-7"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_bfs_step7.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-8"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_bfs_step8.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-9"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_bfs_step9.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-10"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_bfs_step10.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-11"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_bfs_step11.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><blockquote><p>å¹¿åº¦ä¼˜å…ˆéå†çš„åºåˆ—æ˜¯å¦å”¯ä¸€? ç­”æ¡ˆæ˜¯ä¸å”¯ä¸€ã€‚å¹¿åº¦ä¼˜å…ˆéå†åªè¦æ±‚æŒ‰â€œç”±è¿‘åŠè¿œâ€çš„é¡ºåºéå†ï¼Œè€Œå¤šä¸ªç›¸åŒè·ç¦»çš„é¡¶ç‚¹çš„éå†é¡ºåºæ˜¯å…è®¸è¢«ä»»æ„æ‰“ä¹±çš„ã€‚é¡¶ç‚¹<code>1</code>ã€<code>3</code>çš„è®¿é—®é¡ºåºå¯ä»¥äº¤æ¢ã€‚</p></blockquote><p><strong>ï¼ˆ2ï¼‰å¤æ‚åº¦åˆ†æ</strong></p><p>æ—¶é—´å¤æ‚åº¦ï¼šæ‰€æœ‰é¡¶ç‚¹éƒ½ä¼šå…¥é˜Ÿå¹¶å‡ºé˜Ÿä¸€æ¬¡ï¼Œä½¿ç”¨<code>O(|V|)</code>æ—¶é—´ã€‚åœ¨éå†é‚»æ¥é¡¶ç‚¹çš„è¿‡ç¨‹ä¸­ï¼Œç”±äºæ˜¯æ— å‘å›¾ï¼Œå› æ­¤æ‰€æœ‰è¾¹éƒ½ä¼šè¢«è®¿é—®<code>2</code>æ¬¡ï¼Œä½¿ç”¨<code>O(2|E|)</code>æ—¶é—´ã€‚æ€»ä½“ä½¿ç”¨<code>O(|V| + |E|)</code>æ—¶é—´ã€‚</p><p>ç©ºé—´å¤æ‚åº¦ï¼šåˆ—è¡¨<code>res</code>ï¼Œå“ˆå¸Œè¡¨<code>visited</code>ï¼Œé˜Ÿåˆ—<code>queue</code>ä¸­çš„é¡¶ç‚¹æ•°é‡æœ€å¤šä¸º<code>|V|</code>ï¼Œä½¿ç”¨<code>O(|V|)</code>ç©ºé—´ã€‚</p><h4 id="æ·±åº¦ä¼˜å…ˆéå†"><a href="#æ·±åº¦ä¼˜å…ˆéå†" class="headerlink" title="æ·±åº¦ä¼˜å…ˆéå†"></a>æ·±åº¦ä¼˜å…ˆéå†</h4><p>æ·±åº¦ä¼˜å…ˆéå†æ˜¯ä¸€ç§ä¼˜å…ˆèµ°åˆ°åº•ã€æ— è·¯å¯èµ°å†å›å¤´çš„éå†æ–¹å¼ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä»å·¦ä¸Šè§’é¡¶ç‚¹å‡ºå‘ï¼Œè®¿é—®å½“å‰é¡¶ç‚¹çš„æŸä¸ªé‚»æ¥é¡¶ç‚¹ï¼Œç›´åˆ°èµ°åˆ°å°½å¤´æ—¶è¿”å›ï¼Œå†ç»§ç»­èµ°åˆ°å°½å¤´å¹¶è¿”å›ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´è‡³æ‰€æœ‰é¡¶ç‚¹éå†å®Œæˆã€‚</p><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_dfs.png"></p><p><strong>ï¼ˆ1ï¼‰ç®—æ³•å®ç°</strong></p><p>è¿™ç§â€œèµ°åˆ°å°½å¤´å†è¿”å›â€çš„ç®—æ³•èŒƒå¼é€šå¸¸åŸºäºé€’å½’æ¥å®ç°ã€‚ä¸å¹¿åº¦ä¼˜å…ˆéå†ç±»ä¼¼ï¼Œåœ¨æ·±åº¦ä¼˜å…ˆéå†ä¸­ä¹Ÿéœ€è¦å€ŸåŠ©ä¸€ä¸ªå“ˆå¸Œè¡¨<code>visited</code>æ¥è®°å½•å·²è¢«è®¿é—®çš„é¡¶ç‚¹ï¼Œä»¥é¿å…é‡å¤è®¿é—®é¡¶ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æ·±åº¦ä¼˜å…ˆéå† DFS è¾…åŠ©å‡½æ•° */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">dfs</span><span class="params">(GraphAdjList graph, Set&lt;Vertex&gt; visited, List&lt;Vertex&gt; res, Vertex vet)</span> &#123;</span><br><span class="line">    res.add(vet);     <span class="comment">// è®°å½•è®¿é—®é¡¶ç‚¹</span></span><br><span class="line">    visited.add(vet); <span class="comment">// æ ‡è®°è¯¥é¡¶ç‚¹å·²è¢«è®¿é—®</span></span><br><span class="line">    <span class="comment">// éå†è¯¥é¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹</span></span><br><span class="line">    <span class="keyword">for</span> (Vertex adjVet : graph.adjList.get(vet)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (visited.contains(adjVet))</span><br><span class="line">            <span class="keyword">continue</span>; <span class="comment">// è·³è¿‡å·²è¢«è®¿é—®è¿‡çš„é¡¶ç‚¹</span></span><br><span class="line">        <span class="comment">// é€’å½’è®¿é—®é‚»æ¥é¡¶ç‚¹</span></span><br><span class="line">        dfs(graph, visited, res, adjVet);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ·±åº¦ä¼˜å…ˆéå† DFS */</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨é‚»æ¥è¡¨æ¥è¡¨ç¤ºå›¾ï¼Œä»¥ä¾¿è·å–æŒ‡å®šé¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹</span></span><br><span class="line">List&lt;Vertex&gt; <span class="title function_">graphDFS</span><span class="params">(GraphAdjList graph, Vertex startVet)</span> &#123;</span><br><span class="line">    <span class="comment">// é¡¶ç‚¹éå†åºåˆ—</span></span><br><span class="line">    List&lt;Vertex&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// å“ˆå¸Œè¡¨ï¼Œç”¨äºè®°å½•å·²è¢«è®¿é—®è¿‡çš„é¡¶ç‚¹</span></span><br><span class="line">    Set&lt;Vertex&gt; visited = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    dfs(graph, visited, res, startVet);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ·±åº¦ä¼˜å…ˆéå†çš„ç®—æ³•æµç¨‹å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚</p><ul><li>ç›´è™šçº¿ä»£è¡¨å‘ä¸‹é€’æ¨ï¼Œè¡¨ç¤ºå¼€å¯äº†ä¸€ä¸ªæ–°çš„é€’å½’æ–¹æ³•æ¥è®¿é—®æ–°é¡¶ç‚¹ã€‚</li><li>æ›²è™šçº¿ä»£è¡¨å‘ä¸Šå›æº¯ï¼Œè¡¨ç¤ºæ­¤é€’å½’æ–¹æ³•å·²ç»è¿”å›ï¼Œå›æº¯åˆ°äº†å¼€å¯æ­¤é€’å½’æ–¹æ³•çš„ä½ç½®ã€‚</li></ul><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1">1</button></li><li class="tab"><button type="button" data-href="#placeholder-2">2</button></li><li class="tab"><button type="button" data-href="#placeholder-3">3</button></li><li class="tab"><button type="button" data-href="#placeholder-4">4</button></li><li class="tab"><button type="button" data-href="#placeholder-5">5</button></li><li class="tab"><button type="button" data-href="#placeholder-6">6</button></li><li class="tab"><button type="button" data-href="#placeholder-7">7</button></li><li class="tab"><button type="button" data-href="#placeholder-8">8</button></li><li class="tab"><button type="button" data-href="#placeholder-9">9</button></li><li class="tab"><button type="button" data-href="#placeholder-10">10</button></li><li class="tab"><button type="button" data-href="#placeholder-11">11</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_dfs_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_dfs_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_dfs_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_dfs_step4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-5"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_dfs_step5.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-6"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_dfs_step6.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-7"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_dfs_step7.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-8"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_dfs_step8.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-9"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_dfs_step9.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-10"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_dfs_step10.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-11"><p><img src="https://www.hello-algo.com/chapter_graph/graph_traversal.assets/graph_dfs_step11.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><blockquote><p>ä¸å¹¿åº¦ä¼˜å…ˆéå†ç±»ä¼¼ï¼Œæ·±åº¦ä¼˜å…ˆéå†åºåˆ—çš„é¡ºåºä¹Ÿä¸æ˜¯å”¯ä¸€çš„ã€‚ç»™å®šæŸé¡¶ç‚¹ï¼Œå…ˆå¾€å“ªä¸ªæ–¹å‘æ¢ç´¢éƒ½å¯ä»¥ï¼Œå³é‚»æ¥é¡¶ç‚¹çš„é¡ºåºå¯ä»¥ä»»æ„æ‰“ä¹±ï¼Œéƒ½æ˜¯æ·±åº¦ä¼˜å…ˆéå†ã€‚ï¼ˆæ ‘çš„å‰åºã€ä¸­åºã€ååºéå†ï¼‰</p></blockquote><p><strong>ï¼ˆ2ï¼‰å¤æ‚åº¦åˆ†æ</strong></p><p>æ—¶é—´å¤æ‚åº¦ï¼šæ‰€æœ‰é¡¶ç‚¹éƒ½ä¼šè¢«è®¿é—®<code>1</code>æ¬¡ï¼Œä½¿ç”¨<code>O(|V|)</code>æ—¶é—´ã€‚æ‰€æœ‰è¾¹éƒ½ä¼šè¢«è®¿é—®<code>2</code>æ¬¡ï¼Œä½¿ç”¨<code>O(2|E|)</code>æ—¶é—´ã€‚æ€»ä½“ä½¿ç”¨<code>O(|V| + |E|)</code>æ—¶é—´ã€‚</p><p>ç©ºé—´å¤æ‚åº¦ï¼šåˆ—è¡¨<code>res</code>ï¼Œå“ˆå¸Œè¡¨<code>visited</code>é¡¶ç‚¹æ•°é‡æœ€å¤šä¸º<code>|V|</code>ï¼Œé€’å½’æ·±åº¦æœ€å¤§ä¸º<code>|V|</code>ï¼Œå› æ­¤ä½¿ç”¨<code>O(|V|)</code>ç©ºé—´ã€‚</p><hr><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><blockquote><p>æ–‡ä»¶è¿˜æœªä¸Šä¼  Github</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³• Algorithm â€¢ ä¸Š</title>
      <link href="/posts/14dce348.html"/>
      <url>/posts/14dce348.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>æœ¬è¯»ä¹¦ç¬”è®°èŠ‚é€‰è‡ª<code>krahets</code>å¤§ä½¬ç¼–å†™çš„<a href="https://www.hello-algo.com/">ã€ŠHello ç®—æ³•ã€‹</a>ã€‚å‹‰åŠ±è‡ªå·±å¼€å§‹ç³»ç»Ÿçš„ç®—æ³•å­¦ä¹ ã€‚</p></blockquote><hr><h2 id="1-åˆè¯†ç®—æ³•"><a href="#1-åˆè¯†ç®—æ³•" class="headerlink" title="1. åˆè¯†ç®—æ³•"></a>1. åˆè¯†ç®—æ³•</h2><p>å½“æˆ‘ä»¬å¬åˆ°â€œç®—æ³•â€è¿™ä¸ªè¯æ—¶ï¼Œå¾ˆè‡ªç„¶åœ°ä¼šæƒ³åˆ°æ•°å­¦ã€‚ç„¶è€Œå®é™…ä¸Šï¼Œè®¸å¤šç®—æ³•å¹¶ä¸æ¶‰åŠå¤æ‚æ•°å­¦ï¼Œè€Œæ˜¯æ›´å¤šåœ°ä¾èµ–äºåŸºæœ¬é€»è¾‘ï¼Œè¿™äº›é€»è¾‘åœ¨æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´»ä¸­å¤„å¤„å¯è§ã€‚</p><p>ï¼ˆ1ï¼‰æŸ¥é˜…å­—å…¸</p><p>åœ¨å­—å…¸é‡Œï¼Œæ¯ä¸ªæ±‰å­—éƒ½å¯¹åº”ä¸€ä¸ªæ‹¼éŸ³ï¼Œè€Œå­—å…¸æ˜¯æŒ‰ç…§æ‹¼éŸ³çš„è‹±æ–‡å­—æ¯é¡ºåºæ’åˆ—çš„ã€‚å‡è®¾éœ€è¦æŸ¥æ‰¾ä¸€ä¸ªæ‹¼éŸ³é¦–å­—æ¯ä¸º<code>r</code>çš„å­—ï¼Œé€šå¸¸ä¼šè¿™æ ·æ“ä½œã€‚</p><ul><li>ç¿»å¼€å­—å…¸çº¦ä¸€åŠçš„é¡µæ•°ï¼ŒæŸ¥çœ‹è¯¥é¡µé¦–å­—æ¯æ˜¯ä»€ä¹ˆï¼Œå‡è®¾é¦–å­—æ¯ä¸º<code>m</code>ã€‚</li><li>ç”±äºåœ¨è‹±æ–‡å­—æ¯è¡¨ä¸­<code>r</code>ä½äº<code>m</code>ä¹‹åï¼Œæ‰€ä»¥æ’é™¤å­—å…¸å‰åŠéƒ¨åˆ†ï¼ŒæŸ¥æ‰¾èŒƒå›´ç¼©å°åˆ°ååŠéƒ¨åˆ†ã€‚</li><li>ä¸æ–­é‡å¤ä¸Šé¢ä¸¤ä¸ªæ­¥éª¤ï¼Œç›´è‡³æ‰¾åˆ°æ‹¼éŸ³é¦–å­—æ¯ä¸º<code>r</code>çš„é¡µç ä¸ºæ­¢ã€‚</li></ul><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1"><1></button></li><li class="tab"><button type="button" data-href="#placeholder-2"><2></button></li><li class="tab"><button type="button" data-href="#placeholder-3"><3></button></li><li class="tab"><button type="button" data-href="#placeholder-4"><4></button></li><li class="tab"><button type="button" data-href="#placeholder-5"><5></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/binary_search_dictionary_step1.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/binary_search_dictionary_step2.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/binary_search_dictionary_step3.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/binary_search_dictionary_step4.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-5"><p><img src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/binary_search_dictionary_step5.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>æŸ¥é˜…å­—å…¸è¿™ä¸ªå¿…å¤‡æŠ€èƒ½ï¼Œå®é™…ä¸Šå°±æ˜¯ã€ŒäºŒåˆ†æŸ¥æ‰¾ã€ã€‚ä»æ•°æ®ç»“æ„çš„è§’åº¦ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå­—å…¸è§†ä¸ºä¸€ä¸ª<ins>å·²æ’åº</ins>çš„ã€Œæ•°ç»„ã€ã€‚ä»ç®—æ³•çš„è§’åº¦ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸Šè¿°æŸ¥å­—å…¸çš„ä¸€ç³»åˆ—æ“ä½œçœ‹ä½œæ˜¯ã€ŒäºŒåˆ†æŸ¥æ‰¾ã€ç®—æ³•ã€‚</p><p>ï¼ˆ2ï¼‰æ•´ç†æ‰‘å…‹</p><p>æ‰“ç‰Œæ—¶ï¼Œæ¯å±€éƒ½éœ€è¦æ•´ç†æ‰‘å…‹ç‰Œï¼Œä½¿å…¶ä»å°åˆ°å¤§æ’åˆ—ï¼Œå®ç°æµç¨‹å¦‚ä¸‹ã€‚</p><ul><li>å°†æ‰‘å…‹ç‰Œåˆ’åˆ†ä¸ºâ€œæœ‰åºâ€å’Œâ€œæ— åºâ€ä¸¤éƒ¨åˆ†ï¼Œå¹¶å‡è®¾åˆå§‹çŠ¶æ€ä¸‹æœ€å·¦<code>1</code>å¼ æ‰‘å…‹ç‰Œå·²ç»æœ‰åºã€‚</li><li>åœ¨æ— åºéƒ¨åˆ†æŠ½å‡ºä¸€å¼ æ‰‘å…‹ç‰Œï¼Œæ’å…¥è‡³æœ‰åºéƒ¨åˆ†çš„æ­£ç¡®ä½ç½®ã€‚æ­¤æ—¶æœ€å·¦<code>2</code>å¼ æ‰‘å…‹å·²ç»æœ‰åºã€‚</li><li>ä¸æ–­å¾ªç¯ä¸Šé¢æ­¥éª¤ï¼Œæ¯ä¸€è½®å°†ä¸€å¼ æ‰‘å…‹ç‰Œä»æ— åºéƒ¨åˆ†æ’å…¥è‡³æœ‰åºéƒ¨åˆ†ï¼Œç›´è‡³æ‰€æœ‰æ‰‘å…‹ç‰Œéƒ½æœ‰åºã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_introduction/algorithms_are_everywhere.assets/playing_cards_sorting.png"></p><p>ä¸Šè¿°æ•´ç†æ‰‘å…‹ç‰Œçš„æ–¹æ³•æœ¬è´¨ä¸Šæ˜¯ã€Œæ’å…¥æ’åºã€ç®—æ³•ï¼Œå®ƒåœ¨å¤„ç†å°å‹æ•°æ®é›†æ—¶éå¸¸é«˜æ•ˆã€‚è®¸å¤šç¼–ç¨‹è¯­è¨€çš„æ’åºåº“å‡½æ•°ä¸­éƒ½å­˜åœ¨æ’å…¥æ’åºçš„èº«å½±ã€‚</p><p>ï¼ˆ3ï¼‰è´§å¸æ‰¾é›¶</p><p>å‡è®¾æˆ‘ä»¬åœ¨è¶…å¸‚è´­ä¹°äº†<code>69</code>å…ƒçš„å•†å“ï¼Œç»™æ”¶é“¶å‘˜ä»˜äº†<code>100</code>å…ƒï¼Œåˆ™æ”¶é“¶å‘˜éœ€è¦ç»™æˆ‘ä»¬æ‰¾<code>31</code>å…ƒã€‚ä»–ä¼šå¾ˆè‡ªç„¶åœ°å®Œæˆä»¥ä¸‹æ€è€ƒã€‚</p><ul><li>å¯é€‰é¡¹æ˜¯æ¯”<code>31</code>å…ƒé¢å€¼æ›´å°çš„è´§å¸ï¼ŒåŒ…æ‹¬<code>1</code>ï¼Œ<code>5</code>ï¼Œ<code>10</code>ï¼Œ<code>20</code>å…ƒã€‚</li><li>ä»å¯é€‰é¡¹ä¸­æ‹¿å‡ºæœ€å¤§çš„<code>20</code>å…ƒï¼Œå‰©ä½™<code>11</code> å…ƒã€‚</li><li>ä»å‰©ä½™å¯é€‰é¡¹ä¸­æ‹¿å‡ºæœ€å¤§çš„<code>10</code>å…ƒï¼Œå‰©ä½™<code>1</code> å…ƒã€‚</li><li>ä»å‰©ä½™å¯é€‰é¡¹ä¸­æ‹¿å‡ºæœ€å¤§çš„<code>1</code>å…ƒï¼Œå‰©ä½™<code>0</code> å…ƒã€‚</li><li>å®Œæˆæ‰¾é›¶ï¼Œæ–¹æ¡ˆä¸º<code>20 + 10 + 1 = 31</code>å…ƒã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_introduction/algorithms_are_everywhere.assets/greedy_change.png"></p><p>åœ¨ä»¥ä¸Šæ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬æ¯ä¸€æ­¥éƒ½é‡‡å–å½“å‰çœ‹æ¥æœ€å¥½çš„é€‰æ‹©ï¼ˆå°½å¯èƒ½ç”¨å¤§é¢é¢çš„è´§å¸ï¼‰ï¼Œæœ€ç»ˆå¾—åˆ°äº†å¯è¡Œçš„æ‰¾é›¶æ–¹æ¡ˆã€‚ä»æ•°æ®ç»“æ„ä¸ç®—æ³•çš„è§’åº¦çœ‹ï¼Œè¿™ç§æ–¹æ³•æœ¬è´¨ä¸Šæ˜¯ã€Œè´ªå¿ƒç®—æ³•ã€ã€‚</p><p><img src="https://www.hello-algo.com/chapter_introduction/what_is_dsa.assets/relationship_between_data_structure_and_algorithm.png"></p><hr><h2 id="2-å¤æ‚åº¦"><a href="#2-å¤æ‚åº¦" class="headerlink" title="2. å¤æ‚åº¦"></a>2. å¤æ‚åº¦</h2><h3 id="2-1-è¿­ä»£ä¸é€’å½’"><a href="#2-1-è¿­ä»£ä¸é€’å½’" class="headerlink" title="2.1 è¿­ä»£ä¸é€’å½’"></a>2.1 è¿­ä»£ä¸é€’å½’</h3><p>åœ¨æ•°æ®ç»“æ„ä¸ç®—æ³•ä¸­ï¼Œé‡å¤æ‰§è¡ŒæŸä¸ªä»»åŠ¡æ˜¯å¾ˆå¸¸è§çš„ï¼Œé€šå¸¸ä¼šé€‰ç”¨ä¸¤ç§åŸºæœ¬çš„ç¨‹åºç»“æ„ã€‚</p><p>ã€Œè¿­ä»£ <code>iteration</code>ã€æ˜¯ä¸€ç§é‡å¤æ‰§è¡ŒæŸä¸ªä»»åŠ¡çš„æ§åˆ¶ç»“æ„ã€‚åœ¨è¿­ä»£ä¸­ï¼Œç¨‹åºä¼šåœ¨æ»¡è¶³ä¸€å®šçš„æ¡ä»¶ä¸‹é‡å¤æ‰§è¡ŒæŸæ®µä»£ç ï¼Œç›´åˆ°è¿™ä¸ªæ¡ä»¶ä¸å†æ»¡è¶³ã€‚ï¼ˆä¾‹å¦‚å¸¸è§çš„<code>for</code>å¾ªç¯å’Œ<code>while</code>å¾ªç¯ï¼‰</p><p>ã€Œé€’å½’ <code>recursion</code>ã€æ˜¯ä¸€ç§ç®—æ³•ç­–ç•¥ï¼Œ<ins>é€šè¿‡å‡½æ•°è°ƒç”¨è‡ªèº«æ¥è§£å†³é—®é¢˜</ins>ã€‚å®ƒä¸»è¦åŒ…å«ä¸¤ä¸ªé˜¶æ®µã€‚</p><ul><li>é€’ï¼šç¨‹åºä¸æ–­æ·±å…¥åœ°è°ƒç”¨è‡ªèº«ï¼Œé€šå¸¸ä¼ å…¥æ›´å°æˆ–æ›´ç®€åŒ–çš„å‚æ•°ï¼Œç›´åˆ°è¾¾åˆ°â€œç»ˆæ­¢æ¡ä»¶â€ã€‚</li><li>å½’ï¼šè§¦å‘â€œç»ˆæ­¢æ¡ä»¶â€åï¼Œç¨‹åºä»æœ€æ·±å±‚çš„é€’å½’å‡½æ•°å¼€å§‹é€å±‚è¿”å›ï¼Œæ±‡èšæ¯ä¸€å±‚çš„ç»“æœã€‚</li></ul><p>ä¸‹é¢ä»£ç ä¸­ï¼Œåªéœ€è°ƒç”¨å‡½æ•°<code>recur(n)</code>ï¼Œå°±å¯ä»¥å®Œæˆ<code>1 + 2 + ... + n</code>çš„è®¡ç®—ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* é€’å½’ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">recur</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="comment">// ç»ˆæ­¢æ¡ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// é€’ï¼šé€’å½’è°ƒç”¨</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> recur(n - <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// å½’ï¼šè¿”å›ç»“æœ</span></span><br><span class="line">    <span class="keyword">return</span> n + res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.hello-algo.com/chapter_computational_complexity/iteration_and_recursion.assets/recursion_sum.png"></p><p>ä»è®¡ç®—è§’åº¦çœ‹ï¼Œè¿­ä»£ä¸é€’å½’å¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœï¼Œä½†ä»£è¡¨äº†ä¸¤ç§ä¸åŒçš„æ€è€ƒå’Œè§£å†³é—®é¢˜çš„æ–¹å¼ã€‚</p><ul><li>è¿­ä»£ï¼šä»æœ€åŸºç¡€çš„æ­¥éª¤å¼€å§‹ï¼Œç„¶åä¸æ–­é‡å¤æˆ–ç´¯åŠ è¿™äº›æ­¥éª¤ï¼Œç›´åˆ°ä»»åŠ¡å®Œæˆã€‚</li><li>é€’å½’ï¼šå°†åŸé—®é¢˜åˆ†è§£ä¸ºæ›´å°çš„å­é—®é¢˜ï¼Œè¿™äº›å­é—®é¢˜å’ŒåŸé—®é¢˜å…·æœ‰ç›¸åŒçš„å½¢å¼ã€‚æ¥ä¸‹æ¥å°†å­é—®é¢˜ç»§ç»­åˆ†è§£ä¸ºæ›´å°çš„å­é—®é¢˜ï¼Œç›´åˆ°åŸºæœ¬æƒ…å†µæ—¶åœæ­¢ã€‚</li></ul><hr><h3 id="2-2-æ—¶é—´å¤æ‚åº¦"><a href="#2-2-æ—¶é—´å¤æ‚åº¦" class="headerlink" title="2.2 æ—¶é—´å¤æ‚åº¦"></a>2.2 æ—¶é—´å¤æ‚åº¦</h3><p>ã€Œæ—¶é—´å¤æ‚åº¦åˆ†æã€ç»Ÿè®¡çš„æ˜¯ç®—æ³•è¿è¡Œæ—¶é—´éšç€æ•°æ®é‡å˜å¤§æ—¶çš„å¢é•¿è¶‹åŠ¿ã€‚ä¸‹é¢ä¾‹å­ä¸­ï¼Œå‡è®¾è¾“å…¥æ•°æ®å¤§å°ä¸º<code>n</code>ï¼Œç»™å®šä¸‰ä¸ªç®—æ³•å‡½æ•°<code>A</code>ï¼Œ<code>B</code>ï¼Œ<code>C</code>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç®—æ³• A æ—¶é—´å¤æ‚åº¦ï¼šå¸¸æ•°é˜¶</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">algorithm_A</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    System.out.println(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç®—æ³• B æ—¶é—´å¤æ‚åº¦ï¼šçº¿æ€§é˜¶</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">algorithm_B</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        System.out.println(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç®—æ³• C æ—¶é—´å¤æ‚åº¦ï¼šå¸¸æ•°é˜¶</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">algorithm_C</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000000</span>; i++) &#123;</span><br><span class="line">        System.out.println(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç®—æ³•<code>A</code>åªæœ‰<code>1</code>ä¸ªæ‰“å°æ“ä½œï¼Œç®—æ³•è¿è¡Œæ—¶é—´ä¸éšç€<code>n</code>å¢å¤§è€Œå¢é•¿ã€‚æ­¤ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºã€Œå¸¸æ•°é˜¶ã€ã€‚</li><li>ç®—æ³•<code>B</code>ä¸­çš„æ‰“å°æ“ä½œè¦å¾ªç¯<code>n</code>æ¬¡ï¼Œç®—æ³•è¿è¡Œæ—¶é—´éšç€<code>n</code>å¢å¤§å‘ˆçº¿æ€§å¢é•¿ã€‚æ­¤ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦è¢«ç§°ä¸ºã€Œçº¿æ€§é˜¶ã€ã€‚</li><li>ç®—æ³•<code>C</code>ä¸­çš„æ‰“å°æ“ä½œè¦å¾ªç¯<code>1000000</code>æ¬¡ï¼Œè™½ç„¶è¿è¡Œæ—¶é—´å¾ˆé•¿ï¼Œä½†å®ƒä¸è¾“å…¥æ•°æ®å¤§å°<code>n</code>æ— å…³ã€‚å› æ­¤<code>C</code>çš„æ—¶é—´å¤æ‚åº¦å’Œ<code>A</code>ç›¸åŒï¼Œä»ä¸ºã€Œå¸¸æ•°é˜¶ã€ã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_computational_complexity/time_complexity.assets/time_complexity_simple_example.png"></p><p>æ—¶é—´å¤æ‚åº¦åˆ†ææœ‰å“ªäº›ç‰¹ç‚¹å‘¢ï¼Ÿ</p><ul><li><p>æ—¶é—´å¤æ‚åº¦èƒ½å¤Ÿæœ‰æ•ˆè¯„ä¼°ç®—æ³•æ•ˆç‡ã€‚ç®—æ³•<code>B</code>çš„è¿è¡Œæ—¶é—´å‘ˆçº¿æ€§å¢é•¿ï¼Œåœ¨<code>n &gt; 1</code>æ—¶æ¯”ç®—æ³•<code>A</code>æ›´æ…¢ï¼Œåœ¨<code>n &gt; 1000000</code>æ—¶æ¯”ç®—æ³•<code>C</code>æ›´æ…¢ã€‚è€Œä¸”åªè¦è¾“å…¥æ•°æ®å¤§å°<code>n</code>è¶³å¤Ÿå¤§ï¼Œå¤æ‚åº¦ä¸ºâ€œå¸¸æ•°é˜¶â€çš„ç®—æ³•ä¸€å®šä¼˜äºâ€œçº¿æ€§é˜¶â€çš„ç®—æ³•ã€‚</p></li><li><p>æ—¶é—´å¤æ‚åº¦ä¹Ÿå­˜åœ¨ä¸€å®šçš„å±€é™æ€§ã€‚ç®—æ³•<code>A</code>å’Œ<code>C</code>çš„æ—¶é—´å¤æ‚åº¦ç›¸åŒï¼Œä½†å®é™…è¿è¡Œæ—¶é—´å·®åˆ«å¾ˆå¤§ã€‚åŒæ ·ï¼Œç®—æ³•<code>B</code>çš„æ—¶é—´å¤æ‚åº¦æ¯”<code>C</code>é«˜ï¼Œä½†åœ¨è¾“å…¥æ•°æ®å¤§å°<code>n</code>è¾ƒå°æ—¶ï¼Œç®—æ³•<code>B</code>æ˜æ˜¾ä¼˜äº<code>C</code>ã€‚</p></li></ul><h4 id="å‡½æ•°æ¸è¿‘ä¸Šç•Œ"><a href="#å‡½æ•°æ¸è¿‘ä¸Šç•Œ" class="headerlink" title="å‡½æ•°æ¸è¿‘ä¸Šç•Œ"></a>å‡½æ•°æ¸è¿‘ä¸Šç•Œ</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">algorithm</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">1</span>;  <span class="comment">// +1</span></span><br><span class="line">    a = a + <span class="number">1</span>;  <span class="comment">// +1</span></span><br><span class="line">    a = a * <span class="number">2</span>;  <span class="comment">// +1</span></span><br><span class="line">    <span class="comment">// å¾ªç¯ n æ¬¡</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123; <span class="comment">// +1ï¼ˆæ¯è½®éƒ½æ‰§è¡Œ i ++ï¼‰</span></span><br><span class="line">        System.out.println(<span class="number">0</span>);    <span class="comment">// +1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¾ä¸Šé¢å‡½æ•°çš„è®¡ç®—æ“ä½œæ•°é‡æ˜¯ä¸€ä¸ªå…³äºè¾“å…¥æ•°æ®å¤§å°<code>n</code>çš„å‡½æ•°ï¼Œè®°ä¸º<code>T(n)</code>ï¼Œåˆ™å…¶æ“ä½œæ•°é‡ä¸º<code>T(n) = 3 + 2n</code>ã€‚å…¶ä¸­<code>T(n)</code>æ˜¯ä¸€æ¬¡å‡½æ•°ï¼Œè¯´æ˜æ—¶é—´çš„å¢é•¿è¶‹åŠ¿æ˜¯çº¿æ€§çš„ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯çº¿æ€§é˜¶ã€‚</p><p>æˆ‘ä»¬å°†çº¿æ€§é˜¶çš„æ—¶é—´å¤æ‚åº¦è®°ä¸º<code>O(n)</code>ï¼Œè¿™ä¸ªæ•°å­¦ç¬¦å·ç§°ä¸ºã€Œ<code>Big-O Notation</code>ã€ï¼Œç”¨æ¥è¡¨ç¤ºå‡½æ•°<code>T(n)</code>çš„ã€Œæ¸è¿‘ä¸Šç•Œ <code>Asymptotic Upper Bound</code>ã€ã€‚</p><p><img src="https://www.hello-algo.com/chapter_computational_complexity/time_complexity.assets/asymptotic_upper_bound.png"></p><p>æ€»çš„æ¥è¯´ï¼Œè®¡ç®—æ¸è¿‘ä¸Šç•Œå°±æ˜¯å¯»æ‰¾ä¸€ä¸ªå‡½æ•°<code>f(n)</code>ï¼Œä½¿å¾—å½“<code>n</code>è¶‹å‘äºæ— ç©·å¤§æ—¶ï¼Œ<code>T(n)</code>å’Œ<code>f(n)</code>å¤„äºç›¸åŒçš„å¢é•¿çº§åˆ«ï¼Œä»…ç›¸å·®ä¸€ä¸ªå¸¸æ•°é¡¹<code>c</code>çš„å€æ•°ã€‚</p><h4 id="æ¨ç®—æ–¹æ³•"><a href="#æ¨ç®—æ–¹æ³•" class="headerlink" title="æ¨ç®—æ–¹æ³•"></a>æ¨ç®—æ–¹æ³•</h4><p>æ ¹æ®å®šä¹‰ï¼Œç¡®å®š<code>f(n)</code>ä¹‹åï¼Œæˆ‘ä»¬ä¾¿å¯æ¨ç®—æ—¶é—´å¤æ‚åº¦<code>O(f(n))</code>ã€‚é‚£ä¹ˆå¦‚ä½•ç¡®å®šæ¸è¿‘ä¸Šç•Œ<code>f(n)</code>å‘¢ï¼Ÿæ€»ä½“åˆ†ä¸ºä¸¤æ­¥ï¼Œç»Ÿè®¡æ“ä½œæ•°é‡ï¼Œåˆ¤æ–­æ¸è¿‘ä¸Šç•Œã€‚</p><p><strong>ç¬¬ä¸€æ­¥ï¼šç»Ÿè®¡æ“ä½œæ•°é‡</strong></p><p>é’ˆå¯¹ä»£ç ï¼Œé€è¡Œä»ä¸Šåˆ°ä¸‹è®¡ç®—å³å¯ã€‚ç„¶è€Œï¼Œç”±äºä¸Šè¿°<code>cÂ·f(n)</code>ä¸­çš„å¸¸æ•°é¡¹<code>c</code>å¯ä»¥å–ä»»æ„å¤§å°ï¼Œå› æ­¤æ“ä½œæ•°é‡ <code>T(n)</code>ä¸­çš„å„ç§ç³»æ•°ã€å¸¸æ•°é¡¹éƒ½å¯ä»¥è¢«å¿½ç•¥ã€‚</p><ul><li>å¿½ç•¥å¸¸æ•°é¡¹ã€‚å› ä¸ºå®ƒä»¬éƒ½ä¸<code>n</code>æ— å…³ï¼Œæ‰€ä»¥å¯¹æ—¶é—´å¤æ‚åº¦ä¸äº§ç”Ÿå½±å“ã€‚</li><li>çœç•¥æ‰€æœ‰ç³»æ•°ã€‚ä¾‹å¦‚ï¼Œå¾ªç¯<code>2n</code>æ¬¡ã€<code>5n + 1</code>æ¬¡ç­‰ï¼Œéƒ½å¯ä»¥ç®€åŒ–è®°ä¸º<code>n</code>æ¬¡ï¼Œå› ä¸º<code>n</code>å‰é¢çš„ç³»æ•°å¯¹æ—¶é—´å¤æ‚åº¦æ²¡æœ‰å½±å“ã€‚</li><li>å¾ªç¯åµŒå¥—æ—¶ä½¿ç”¨ä¹˜æ³•ã€‚æ€»æ“ä½œæ•°é‡ç­‰äºå¤–å±‚å¾ªç¯å’Œå†…å±‚å¾ªç¯æ“ä½œæ•°é‡ä¹‹ç§¯ï¼Œæ¯ä¸€å±‚å¾ªç¯ä¾ç„¶å¯ä»¥åˆ†åˆ«å¥—ç”¨ä¸Šè¿°ä¸¤ä¸ªæŠ€å·§ã€‚</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">algorithm</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">1</span>;  <span class="comment">// +0ï¼ˆæŠ€å·§ 1ï¼‰</span></span><br><span class="line">    a = a + n;  <span class="comment">// +0ï¼ˆæŠ€å·§ 1ï¼‰</span></span><br><span class="line">    <span class="comment">// +nï¼ˆæŠ€å·§ 2ï¼‰</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5</span> * n + <span class="number">1</span>; i++) &#123;</span><br><span class="line">        System.out.println(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// +n*nï¼ˆæŠ€å·§ 3ï¼‰</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">2</span> * n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n + <span class="number">1</span>; j++) &#123;</span><br><span class="line">            System.out.println(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å±•ç¤ºäº†ä½¿ç”¨ä¸Šè¿°æŠ€å·§å‰ã€åçš„ç»Ÿè®¡ç»“æœã€‚ä¸¤è€…æ¨å‡ºçš„æ—¶é—´å¤æ‚åº¦ç›¸åŒï¼Œå³ä¸º<code>O(n^2)</code>ã€‚</p><ul><li><code>T(n) = 2n(n + 1) + (5n + 1) + 2 = 2n^2 + 7n + 3</code>ï¼ˆå®Œæ•´ç»Ÿè®¡ï¼‰</li><li><code>T(n) = n^2 + n</code>ï¼ˆå·æ‡’ç»Ÿè®¡ï¼‰</li></ul><p><strong>ç¬¬äºŒæ­¥ï¼šåˆ¤æ–­æ¸è¿‘ä¸Šç•Œ</strong></p><p>æ—¶é—´å¤æ‚åº¦ç”±å¤šé¡¹å¼<code>T(n)</code>ä¸­æœ€é«˜é˜¶çš„é¡¹æ¥å†³å®šã€‚è¿™æ˜¯å› ä¸ºåœ¨<code>n</code>è¶‹äºæ— ç©·å¤§æ—¶ï¼Œæœ€é«˜é˜¶çš„é¡¹å°†å‘æŒ¥ä¸»å¯¼ä½œç”¨ï¼Œå…¶ä»–é¡¹çš„å½±å“éƒ½å¯ä»¥è¢«å¿½ç•¥ã€‚</p><table><thead><tr><th align="left">æ“ä½œæ•°é‡<code>T(n)</code></th><th align="left">æ—¶é—´å¤æ‚åº¦<code>O(f(n))</code></th></tr></thead><tbody><tr><td align="left"><code>100000</code></td><td align="left"><code>O(1)</code></td></tr><tr><td align="left"><code>3n + 2</code></td><td align="left"><code>O(n)</code></td></tr><tr><td align="left"><code>2n^2 + 3n + 2</code></td><td align="left"><code>O(n^2)</code></td></tr><tr><td align="left"><code>n^3 + 100000n^2</code></td><td align="left"><code>O(n^3)</code></td></tr><tr><td align="left"><code>2^n + 100000n^100000</code></td><td align="left"><code>O(2^n)</code></td></tr></tbody></table><h4 id="å¸¸è§ç±»å‹"><a href="#å¸¸è§ç±»å‹" class="headerlink" title="å¸¸è§ç±»å‹"></a>å¸¸è§ç±»å‹</h4><p>è®¾è¾“å…¥æ•°æ®å¤§å°ä¸º<code>n</code>ï¼Œå¸¸è§çš„æ—¶é—´å¤æ‚åº¦ç±»å‹åŒ…æ‹¬ï¼ˆæŒ‰ç…§ä»ä½åˆ°é«˜çš„é¡ºåºæ’åˆ—ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/pic.png"></p><p><img src="https://www.hello-algo.com/chapter_computational_complexity/time_complexity.assets/time_complexity_common_types.png"></p><p><strong>å¸¸æ•°é˜¶<code>O(1)</code></strong></p><p>å¸¸æ•°é˜¶çš„æ“ä½œæ•°é‡ä¸è¾“å…¥æ•°æ®å¤§å°<code>n</code>æ— å…³ï¼Œä¸ä¼šéšç€<code>n</code>çš„å˜åŒ–è€Œå˜åŒ–ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å¸¸æ•°é˜¶ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">constant</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">100000</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">        count++;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå°½ç®¡æ“ä½œæ•°é‡<code>size</code>å¾ˆå¤§ï¼Œä½†ç”±äºå…¶ä¸æ•°æ®å¤§å°<code>n</code>æ— å…³ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦ä»ä¸º<code>O(1)</code>ã€‚</p><p><strong>çº¿æ€§é˜¶<code>O(n)</code></strong></p><p>çº¿æ€§é˜¶çš„æ“ä½œæ•°é‡ç›¸å¯¹äºè¾“å…¥æ•°æ®å¤§å°ä»¥çº¿æ€§çº§åˆ«å¢é•¿ã€‚çº¿æ€§é˜¶é€šå¸¸å‡ºç°åœ¨å•å±‚å¾ªç¯ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* çº¿æ€§é˜¶ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">linear</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        count++;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éå†æ•°ç»„å’Œéå†é“¾è¡¨ç­‰æ“ä½œçš„æ—¶é—´å¤æ‚åº¦å‡ä¸º<code>O(n)</code>ï¼Œå…¶ä¸­<code>n</code>ä¸ºæ•°ç»„æˆ–é“¾è¡¨çš„é•¿åº¦ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* çº¿æ€§é˜¶ï¼ˆéå†æ•°ç»„ï¼‰ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">arrayTraversal</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å¾ªç¯æ¬¡æ•°ä¸æ•°ç»„é•¿åº¦æˆæ­£æ¯”</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œæ•°æ®å¤§å°<code>n</code>éœ€æ ¹æ®è¾“å…¥æ•°æ®çš„ç±»å‹æ¥å…·ä½“ç¡®å®šã€‚æ¯”å¦‚åœ¨ç¬¬ä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œå˜é‡<code>n</code>ä¸ºè¾“å…¥æ•°æ®å¤§å°ã€‚åœ¨ç¬¬äºŒä¸ªç¤ºä¾‹ä¸­ï¼Œ<code>n</code>ä¸ºæ•°ç»„é•¿åº¦å¤§å°ã€‚</p><p><strong>å¹³æ–¹é˜¶<code>O(n^2)</code></strong></p><p>å¹³æ–¹é˜¶çš„æ“ä½œæ•°é‡ç›¸å¯¹äºè¾“å…¥æ•°æ®å¤§å°ä»¥å¹³æ–¹çº§åˆ«å¢é•¿ã€‚å¹³æ–¹é˜¶é€šå¸¸å‡ºç°åœ¨åµŒå¥—å¾ªç¯ä¸­ï¼Œå¤–å±‚å¾ªç¯å’Œå†…å±‚å¾ªç¯éƒ½ä¸º<code>O(n)</code>ï¼Œå› æ­¤æ€»ä½“ä¸º<code>O(n^2)</code>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å¹³æ–¹é˜¶ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">quadratic</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å¾ªç¯æ¬¡æ•°ä¸æ•°ç»„é•¿åº¦æˆå¹³æ–¹å…³ç³»</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.hello-algo.com/chapter_computational_complexity/time_complexity.assets/time_complexity_constant_linear_quadratic.png"></p><p>ä»¥ã€Œå†’æ³¡æ’åºã€ä¸ºä¾‹ï¼Œå¤–å±‚å¾ªç¯æ‰§è¡Œ<code>n - 1</code>æ¬¡ï¼Œå†…å±‚å¾ªç¯æ‰§è¡Œ<code>n - 1, n - 2, ... , 2, 1</code>æ¬¡ï¼Œå¹³å‡ä¸º<code>n / 2</code>æ¬¡ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦ä¸º<code>O(n^2)</code>ã€‚</p><p>æ—¶é—´å¤æ‚åº¦: <code>O((n - 1) Â· n / 2) = O(n^2)</code></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å¹³æ–¹é˜¶ï¼ˆå†’æ³¡æ’åºï¼‰ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">bubbleSort</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">// è®¡æ•°å™¨</span></span><br><span class="line">    <span class="comment">// å¤–å¾ªç¯ï¼šæœªæ’åºåŒºé—´ä¸º [0, i]</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> nums.length - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="comment">// å†…å¾ªç¯ï¼šå°†æœªæ’åºåŒºé—´ [0, i] ä¸­çš„æœ€å¤§å…ƒç´ äº¤æ¢è‡³è¯¥åŒºé—´çš„æœ€å³ç«¯</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[j] &gt; nums[j + <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="comment">// äº¤æ¢ nums[j] ä¸ nums[j + 1]</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> nums[j];</span><br><span class="line">                nums[j] = nums[j + <span class="number">1</span>];</span><br><span class="line">                nums[j + <span class="number">1</span>] = tmp;</span><br><span class="line">                count += <span class="number">3</span>; <span class="comment">// å…ƒç´ äº¤æ¢åŒ…å« 3 ä¸ªå•å…ƒæ“ä½œ</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æŒ‡æ•°é˜¶<code>O(2^n)</code></strong></p><p>ç”Ÿç‰©å­¦ä¸­çš„â€œç»†èƒåˆ†è£‚â€æ˜¯æŒ‡æ•°é˜¶å¢é•¿çš„å…¸å‹ä¾‹å­ã€‚åˆå§‹çŠ¶æ€ä¸º<code>1</code>ä¸ªç»†èƒï¼Œåˆ†è£‚ä¸€è½®åå˜ä¸º<code>2</code>ä¸ªï¼Œåˆ†è£‚ä¸¤è½®åå˜ä¸º<code>4</code>ä¸ªï¼Œä»¥æ­¤ç±»æ¨ï¼Œåˆ†è£‚<code>n</code>è½®åæœ‰<code>2^n</code>ä¸ªç»†èƒã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æŒ‡æ•°é˜¶ï¼ˆå¾ªç¯å®ç°ï¼‰ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">exponential</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>, base = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// ç»†èƒæ¯è½®ä¸€åˆ†ä¸ºäºŒï¼Œå½¢æˆæ•°åˆ— 1, 2, 4, 8, ..., 2^(n-1)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; base; j++) &#123;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">        base *= <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// count = 1 + 2 + 4 + 8 + .. + 2^(n-1) = 2^n - 1</span></span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.hello-algo.com/chapter_computational_complexity/time_complexity.assets/time_complexity_exponential.png"></p><p>å®é™…ç®—æ³•ä¸­ï¼ŒæŒ‡æ•°é˜¶å¸¸å‡ºç°äºé€’å½’å‡½æ•°ã€‚ä¾‹å¦‚ä»¥ä¸‹ä»£ç ï¼Œå…¶é€’å½’åœ°ä¸€åˆ†ä¸ºäºŒï¼Œç»è¿‡<code>n</code>æ¬¡åˆ†è£‚ååœæ­¢ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æŒ‡æ•°é˜¶ï¼ˆé€’å½’å®ç°ï¼‰ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">expRecur</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> expRecur(n - <span class="number">1</span>) + expRecur(n - <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‡æ•°é˜¶å¢é•¿éå¸¸è¿…é€Ÿï¼Œåœ¨ç©·ä¸¾æ³•ï¼ˆæš´åŠ›æœç´¢ã€å›æº¯ç­‰ï¼‰ä¸­æ¯”è¾ƒå¸¸è§ã€‚å¯¹äºæ•°æ®è§„æ¨¡è¾ƒå¤§çš„é—®é¢˜ï¼ŒæŒ‡æ•°é˜¶æ˜¯ä¸å¯æ¥å—çš„ï¼Œé€šå¸¸éœ€è¦ä½¿ç”¨ã€ŒåŠ¨æ€è§„åˆ’ã€æˆ–ã€Œè´ªå¿ƒã€ç­‰ç®—æ³•æ¥è§£å†³ã€‚</p><p><strong>å¯¹æ•°é˜¶<code>O(logn)</code></strong></p><p>ä¸æŒ‡æ•°é˜¶ç›¸åï¼Œå¯¹æ•°é˜¶åæ˜ äº†â€œæ¯è½®ç¼©å‡åˆ°ä¸€åŠâ€çš„æƒ…å†µã€‚è®¾è¾“å…¥æ•°æ®å¤§å°ä¸º<code>n</code>ï¼Œç”±äºæ¯è½®ç¼©å‡åˆ°ä¸€åŠï¼Œå› æ­¤å¾ªç¯æ¬¡æ•°æ˜¯<code>log2(n)</code>ï¼Œå³<code>2^n</code>çš„åå‡½æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å¯¹æ•°é˜¶ï¼ˆå¾ªç¯å®ç°ï¼‰ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">logarithmic</span><span class="params">(<span class="type">float</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        n = n / <span class="number">2</span>;</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.hello-algo.com/chapter_computational_complexity/time_complexity.assets/time_complexity_logarithmic.png"></p><p>ä¸æŒ‡æ•°é˜¶ç±»ä¼¼ï¼Œå¯¹æ•°é˜¶ä¹Ÿå¸¸å‡ºç°äºé€’å½’å‡½æ•°ã€‚ä»¥ä¸‹ä»£ç å½¢æˆäº†ä¸€ä¸ªé«˜åº¦ä¸º<code>log2(n)</code>çš„é€’å½’æ ‘ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å¯¹æ•°é˜¶ï¼ˆé€’å½’å®ç°ï¼‰ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">logRecur</span><span class="params">(<span class="type">float</span> n)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> logRecur(n / <span class="number">2</span>) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹æ•°é˜¶å¸¸å‡ºç°äºåŸºäºã€Œåˆ†æ²»ã€çš„ç®—æ³•ä¸­ï¼Œä½“ç°äº†â€œä¸€åˆ†ä¸ºå¤šâ€å’Œâ€œåŒ–ç¹ä¸ºç®€â€çš„ç®—æ³•æ€æƒ³ã€‚å®ƒå¢é•¿ç¼“æ…¢ï¼Œæ˜¯ç†æƒ³çš„æ—¶é—´å¤æ‚åº¦ï¼Œä»…æ¬¡äºå¸¸æ•°é˜¶ã€‚</p><p><strong>çº¿æ€§å¯¹æ•°é˜¶<code>O(nlogn)</code></strong></p><p>çº¿æ€§å¯¹æ•°é˜¶å¸¸å‡ºç°äºåµŒå¥—å¾ªç¯ä¸­ï¼Œä¸¤å±‚å¾ªç¯çš„æ—¶é—´å¤æ‚åº¦åˆ†åˆ«ä¸º<code>O(logn)</code>å’Œ<code>O(n)</code>ã€‚ä¸»æµæ’åºç®—æ³•çš„æ—¶é—´å¤æ‚åº¦é€šå¸¸ä¸º<code>O(nlogn)</code>ï¼Œä¾‹å¦‚å¿«é€Ÿæ’åºã€å½’å¹¶æ’åºã€å †æ’åºç­‰ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* çº¿æ€§å¯¹æ•°é˜¶ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">linearLogRecur</span><span class="params">(<span class="type">float</span> n)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> linearLogRecur(n / <span class="number">2</span>) +</span><br><span class="line">            linearLogRecur(n / <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.hello-algo.com/chapter_computational_complexity/time_complexity.assets/time_complexity_logarithmic_linear.png"></p><p><strong>é˜¶ä¹˜é˜¶<code>O(n!)</code></strong></p><p>é˜¶ä¹˜é˜¶å¯¹åº”æ•°å­¦ä¸Šçš„â€œå…¨æ’åˆ—â€é—®é¢˜ã€‚ç»™å®š<code>n</code>ä¸ªäº’ä¸é‡å¤çš„å…ƒç´ ï¼Œæ±‚å…¶æ‰€æœ‰å¯èƒ½çš„æ’åˆ—æ–¹æ¡ˆï¼Œæ–¹æ¡ˆæ•°é‡ä¸º<code>n! = n * (n - 1) * (n - 2) * ... * 2 * 1</code>ã€‚</p><p>é˜¶ä¹˜é€šå¸¸ä½¿ç”¨é€’å½’å®ç°ã€‚ä¾‹å¦‚ä»¥ä¸‹ä»£ç ï¼Œç¬¬ä¸€å±‚åˆ†è£‚å‡º<code>n</code>ä¸ªï¼Œç¬¬äºŒå±‚åˆ†è£‚å‡º<code>n-1</code>ä¸ªï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´è‡³ç¬¬<code>n</code>å±‚æ—¶ç»ˆæ­¢åˆ†è£‚ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* é˜¶ä¹˜é˜¶ï¼ˆé€’å½’å®ç°ï¼‰ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">factorialRecur</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// ä» 1 ä¸ªåˆ†è£‚å‡º n ä¸ª</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        count += factorialRecur(n - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.hello-algo.com/chapter_computational_complexity/time_complexity.assets/time_complexity_factorial.png"></p><p>è¯·æ³¨æ„ï¼Œå› ä¸º<code>n! &gt; 2^n</code>ï¼Œæ‰€ä»¥é˜¶ä¹˜é˜¶æ¯”æŒ‡æ•°é˜¶å¢é•¿åœ°æ›´å¿«ï¼Œåœ¨<code>n</code>è¾ƒå¤§æ—¶ä¹Ÿæ˜¯ä¸å¯æ¥å—çš„ã€‚</p><h4 id="æœ€å·®ã€æœ€ä½³ã€å¹³å‡"><a href="#æœ€å·®ã€æœ€ä½³ã€å¹³å‡" class="headerlink" title="æœ€å·®ã€æœ€ä½³ã€å¹³å‡"></a>æœ€å·®ã€æœ€ä½³ã€å¹³å‡</h4><p>ç®—æ³•çš„æ—¶é—´æ•ˆç‡å¾€å¾€ä¸æ˜¯å›ºå®šçš„ï¼Œè€Œæ˜¯ä¸è¾“å…¥æ•°æ®çš„åˆ†å¸ƒæœ‰å…³ã€‚å‡è®¾è¾“å…¥ä¸€ä¸ªé•¿åº¦ä¸º<code>n</code>çš„æ•°ç»„<code>nums</code>ï¼Œå…¶ä¸­<code>nums</code>ç”±ä»<code>1</code>è‡³<code>n</code>çš„æ•°å­—ç»„æˆï¼Œä½†å…ƒç´ é¡ºåºæ˜¯éšæœºæ‰“ä¹±çš„ï¼Œä»»åŠ¡ç›®æ ‡æ˜¯è¿”å›å…ƒç´ <code>1</code>çš„ç´¢å¼•ã€‚å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºã€‚</p><ul><li>å½“æœ«å°¾å…ƒç´ æ˜¯<code>1</code>æ—¶ï¼Œéœ€è¦å®Œæ•´éå†æ•°ç»„ï¼Œè¾¾åˆ°æœ€å·®æ—¶é—´å¤æ‚åº¦<code>O(n)</code>ã€‚</li><li>å½“é¦–ä¸ªæ•°å­—ä¸º<code>1</code>æ—¶ï¼Œæ— è®ºæ•°ç»„å¤šé•¿éƒ½ä¸éœ€è¦ç»§ç»­éå†ï¼Œè¾¾åˆ°æœ€ä½³æ—¶é—´å¤æ‚åº¦<code>Î©(1)</code>ã€‚</li></ul><p>ã€Œæœ€å·®æ—¶é—´å¤æ‚åº¦ã€å¯¹åº”å‡½æ•°æ¸è¿‘ä¸Šç•Œï¼Œä½¿ç”¨<code>O</code>è®°å·è¡¨ç¤ºã€‚ç›¸åº”åœ°ï¼Œã€Œæœ€ä½³æ—¶é—´å¤æ‚åº¦ã€å¯¹åº”å‡½æ•°æ¸è¿‘ä¸‹ç•Œï¼Œç”¨<code>Î©</code>è®°å·è¡¨ç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æŸ¥æ‰¾æ•°ç»„ nums ä¸­æ•°å­— 1 æ‰€åœ¨ç´¢å¼• */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">findOne</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="comment">// å½“å…ƒç´  1 åœ¨æ•°ç»„å¤´éƒ¨æ—¶ï¼Œè¾¾åˆ°æœ€ä½³æ—¶é—´å¤æ‚åº¦ O(1)</span></span><br><span class="line">        <span class="comment">// å½“å…ƒç´  1 åœ¨æ•°ç»„å°¾éƒ¨æ—¶ï¼Œè¾¾åˆ°æœ€å·®æ—¶é—´å¤æ‚åº¦ O(n)</span></span><br><span class="line">        <span class="keyword">if</span> (nums[i] == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶è€Œï¼Œå®é™…ä¸­å¾ˆå°‘ä½¿ç”¨ã€Œæœ€ä½³æ—¶é—´å¤æ‚åº¦ã€ï¼Œå› ä¸ºé€šå¸¸åªæœ‰åœ¨å¾ˆå°æ¦‚ç‡ä¸‹æ‰èƒ½è¾¾åˆ°ï¼Œå¹¶ä¸”å¯èƒ½ä¼šå¸¦æ¥ä¸€å®šçš„è¯¯å¯¼æ€§ã€‚<ins>å› æ­¤ã€Œæœ€å·®æ—¶é—´å¤æ‚åº¦ã€æ›´ä¸ºå®ç”¨ï¼Œå› ä¸ºå®ƒç»™å‡ºäº†ä¸€ä¸ªæ•ˆç‡å®‰å…¨å€¼</ins>ã€‚</p><p>ä»ä¸Šé¢ä»£ç å¯ä»¥çœ‹å‡ºï¼Œæœ€å·®æˆ–æœ€ä½³æ—¶é—´å¤æ‚åº¦åªå‡ºç°äºâ€œç‰¹æ®Šçš„æ•°æ®åˆ†å¸ƒâ€ï¼Œè¿™äº›æƒ…å†µçš„å‡ºç°æ¦‚ç‡å¯èƒ½å¾ˆå°ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œã€Œå¹³å‡æ—¶é—´å¤æ‚åº¦ã€å¯ä»¥ä½“ç°ç®—æ³•åœ¨éšæœºè¾“å…¥æ•°æ®ä¸‹çš„è¿è¡Œæ•ˆç‡ï¼Œç”¨<code>Î˜</code>è®°å·æ¥è¡¨ç¤ºã€‚</p><ul><li>ä¸Šé¢ä»£ç ä¸­ï¼Œè¾“å…¥æ•°ç»„æ˜¯è¢«æ‰“ä¹±çš„ï¼Œå…ƒç´ <code>1</code>å‡ºç°åœ¨ä»»æ„ç´¢å¼•çš„æ¦‚ç‡éƒ½æ˜¯ç›¸ç­‰çš„ï¼Œé‚£ä¹ˆç®—æ³•çš„å¹³å‡å¾ªç¯æ¬¡æ•°åˆ™æ˜¯æ•°ç»„é•¿åº¦çš„ä¸€åŠ<code>n / 2</code>ï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦ä¸º<code>Î˜(n / 2) = Î˜(n)</code>ã€‚</li></ul><p>å€¼å¾—è¯´æ˜çš„æ˜¯ï¼Œç”±äºè®¡ç®—å¹³å‡æ—¶é—´å¤æ‚åº¦å¾€å¾€æ¯”è¾ƒå›°éš¾ï¼Œå› ä¸ºå¾ˆéš¾åˆ†æå‡ºåœ¨æ•°æ®åˆ†å¸ƒä¸‹çš„æ•´ä½“æ•°å­¦æœŸæœ›ã€‚æ‰€ä»¥ï¼Œ<ins>æˆ‘ä»¬é€šå¸¸ä½¿ç”¨æœ€å·®æ—¶é—´å¤æ‚åº¦ä½œä¸ºç®—æ³•æ•ˆç‡çš„è¯„åˆ¤æ ‡å‡†</ins>ã€‚</p><hr><h3 id="2-3-ç©ºé—´å¤æ‚åº¦"><a href="#2-3-ç©ºé—´å¤æ‚åº¦" class="headerlink" title="2.3 ç©ºé—´å¤æ‚åº¦"></a>2.3 ç©ºé—´å¤æ‚åº¦</h3><p>ã€Œç©ºé—´å¤æ‚åº¦ã€ç”¨äºè¡¡é‡ç®—æ³•å ç”¨å†…å­˜ç©ºé—´éšç€æ•°æ®é‡å˜å¤§æ—¶çš„å¢é•¿è¶‹åŠ¿ã€‚è¿™ä¸ªæ¦‚å¿µä¸æ—¶é—´å¤æ‚åº¦éå¸¸ç±»ä¼¼ï¼Œåªéœ€å°†â€œè¿è¡Œæ—¶é—´â€æ›¿æ¢ä¸ºâ€œå ç”¨å†…å­˜ç©ºé—´â€ã€‚</p><p><img src="https://www.hello-algo.com/chapter_computational_complexity/space_complexity.assets/space_types.png"></p><h4 id="æ¨ç®—æ–¹æ³•-1"><a href="#æ¨ç®—æ–¹æ³•-1" class="headerlink" title="æ¨ç®—æ–¹æ³•"></a>æ¨ç®—æ–¹æ³•</h4><p>ç©ºé—´å¤æ‚åº¦çš„æ¨ç®—æ–¹æ³•ä¸æ—¶é—´å¤æ‚åº¦å¤§è‡´ç›¸åŒï¼Œåªéœ€å°†ç»Ÿè®¡å¯¹è±¡ä»â€œæ“ä½œæ•°é‡â€è½¬ä¸ºâ€œä½¿ç”¨ç©ºé—´å¤§å°â€ã€‚</p><p>è€Œä¸æ—¶é—´å¤æ‚åº¦ä¸åŒçš„æ˜¯ï¼Œ<ins>é€šå¸¸åªå…³æ³¨æœ€å·®ç©ºé—´å¤æ‚åº¦</ins>ã€‚å› ä¸ºå†…å­˜ç©ºé—´æ˜¯ä¸€é¡¹ç¡¬æ€§è¦æ±‚ï¼Œå¿…é¡»ç¡®ä¿åœ¨æ‰€æœ‰è¾“å…¥æ•°æ®ä¸‹éƒ½æœ‰è¶³å¤Ÿçš„å†…å­˜ç©ºé—´é¢„ç•™ã€‚</p><p>ä¸‹é¢ä»£ç ä¸­ï¼Œæœ€å·®ç©ºé—´å¤æ‚åº¦ä¸­çš„â€œæœ€å·®â€æœ‰ä¸¤å±‚å«ä¹‰ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">algorithm</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">0</span>;                   <span class="comment">// O(1)</span></span><br><span class="line">    <span class="type">int</span>[] b = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">10000</span>];    <span class="comment">// O(1)</span></span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">10</span>)</span><br><span class="line">        <span class="type">int</span>[] nums = <span class="keyword">new</span> <span class="title class_">int</span>[n]; <span class="comment">// O(n)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä»¥æœ€å·®è¾“å…¥æ•°æ®ä¸ºå‡†ã€‚å½“<code>n &lt; 10</code>æ—¶ï¼Œç©ºé—´å¤æ‚åº¦ä¸º<code>O(1)</code>ã€‚å½“<code>n &gt; 10</code>æ—¶ï¼Œåˆå§‹åŒ–çš„æ•°ç»„<code>nums</code>å ç”¨<code>O(n)</code>ç©ºé—´ï¼Œå› æ­¤æœ€å·®ç©ºé—´å¤æ‚åº¦ä¸º<code>O(n)</code>ã€‚</li><li>ä»¥ç®—æ³•è¿è¡Œä¸­çš„å³°å€¼å†…å­˜ä¸ºå‡†ã€‚ç¨‹åºåœ¨æ‰§è¡Œæœ€åä¸€è¡Œä¹‹å‰ï¼Œå ç”¨<code>O(1)</code>ç©ºé—´ã€‚å½“åˆå§‹åŒ–æ•°ç»„<code>nums</code>æ—¶ï¼Œç¨‹åºå ç”¨<code>O(n)</code>ç©ºé—´ï¼›å› æ­¤æœ€å·®ç©ºé—´å¤æ‚åº¦ä¸º<code>O(n)</code>ã€‚</li></ul><p>åœ¨é€’å½’å‡½æ•°ä¸­ï¼Œåˆ™éœ€è¦æ³¨æ„ç»Ÿè®¡æ ˆå¸§ç©ºé—´ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">function</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// æ‰§è¡ŒæŸäº›æ“ä½œ</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* å¾ªç¯ O(1) */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">loop</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* é€’å½’ O(n) */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">recur</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">return</span> recur(n - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å‡½æ•°<code>loop()</code>åœ¨å¾ªç¯ä¸­è°ƒç”¨äº†<code>n</code>æ¬¡<code>function()</code>ï¼Œæ¯è½®ä¸­<code>function()</code>éƒ½è¿”å›å¹¶é‡Šæ”¾äº†æ ˆå¸§ç©ºé—´ï¼Œå› æ­¤ç©ºé—´å¤æ‚åº¦ä»ä¸º<code>O(1)</code>ã€‚</li><li>é€’å½’å‡½æ•°<code>recur()</code>åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šåŒæ—¶å­˜åœ¨<code>n</code>ä¸ªæœªè¿”å›çš„<code>recur()</code>ï¼Œä»è€Œå ç”¨<code>O(n)</code>çš„æ ˆå¸§ç©ºé—´ã€‚</li></ul><h4 id="å¸¸è§ç±»å‹-1"><a href="#å¸¸è§ç±»å‹-1" class="headerlink" title="å¸¸è§ç±»å‹"></a>å¸¸è§ç±»å‹</h4><p>è®¾è¾“å…¥æ•°æ®å¤§å°ä¸º<code>n</code>ï¼Œä¸‹å›¾å±•ç¤ºäº†å¸¸è§çš„ç©ºé—´å¤æ‚åº¦ç±»å‹ï¼ˆä»ä½åˆ°é«˜æ’åˆ—ï¼‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/pic2.png"></p><p><img src="https://www.hello-algo.com/chapter_computational_complexity/space_complexity.assets/space_complexity_common_types.png"></p><p><strong>å¸¸æ•°é˜¶<code>O(1)</code></strong></p><p>å¸¸æ•°é˜¶å¸¸è§äºæ•°é‡ä¸è¾“å…¥æ•°æ®å¤§å°<code>n</code>æ— å…³çš„å¸¸é‡ã€å˜é‡ã€å¯¹è±¡ã€‚</p><p>æ³¨æ„ï¼Œåœ¨å¾ªç¯ä¸­åˆå§‹åŒ–å˜é‡æˆ–è°ƒç”¨å‡½æ•°è€Œå ç”¨çš„å†…å­˜ï¼Œåœ¨è¿›å…¥ä¸‹ä¸€å¾ªç¯åå°±ä¼šè¢«é‡Šæ”¾ï¼Œå› æ­¤ä¸ä¼šç´¯ç§¯å ç”¨ç©ºé—´ï¼Œç©ºé—´å¤æ‚åº¦ä»ä¸º<code>O(1)</code>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å‡½æ•° */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">function</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// æ‰§è¡ŒæŸäº›æ“ä½œ</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å¸¸æ•°é˜¶ */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">constant</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="comment">// å¸¸é‡ã€å˜é‡ã€å¯¹è±¡å ç”¨ O(1) ç©ºé—´</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span>[] nums = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">10000</span>];</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">node</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">// å¾ªç¯ä¸­çš„å˜é‡å ç”¨ O(1) ç©ºé—´</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¾ªç¯ä¸­çš„å‡½æ•°å ç”¨ O(1) ç©ºé—´</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>çº¿æ€§é˜¶<code>O(n)</code></strong></p><p>çº¿æ€§é˜¶å¸¸è§äºå…ƒç´ æ•°é‡ä¸<code>n</code>æˆæ­£æ¯”çš„æ•°ç»„ã€é“¾è¡¨ã€æ ˆã€é˜Ÿåˆ—ç­‰ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* çº¿æ€§é˜¶ */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">linear</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="comment">// é•¿åº¦ä¸º n çš„æ•°ç»„å ç”¨ O(n) ç©ºé—´</span></span><br><span class="line">    <span class="type">int</span>[] nums = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">    <span class="comment">// é•¿åº¦ä¸º n çš„åˆ—è¡¨å ç”¨ O(n) ç©ºé—´</span></span><br><span class="line">    List&lt;ListNode&gt; nodes = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        nodes.add(<span class="keyword">new</span> <span class="title class_">ListNode</span>(i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é•¿åº¦ä¸º n çš„å“ˆå¸Œè¡¨å ç”¨ O(n) ç©ºé—´</span></span><br><span class="line">    Map&lt;Integer, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        map.put(i, String.valueOf(i));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸‹é¢ä»£ç çš„é€’å½’æ·±åº¦ä¸º<code>n</code>ï¼Œå³åŒæ—¶å­˜åœ¨<code>n</code>ä¸ªæœªè¿”å›çš„<code>linear_recur()</code>å‡½æ•°ï¼Œä½¿ç”¨<code>O(n)</code>å¤§å°çš„æ ˆå¸§ç©ºé—´ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* çº¿æ€§é˜¶ï¼ˆé€’å½’å®ç°ï¼‰ */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">linearRecur</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;é€’å½’ n = &quot;</span> + n);</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    linearRecur(n - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.hello-algo.com/chapter_computational_complexity/space_complexity.assets/space_complexity_recursive_linear.png"></p><p><strong>å¹³æ–¹é˜¶<code>O(n^2)</code></strong></p><p>å¹³æ–¹é˜¶å¸¸è§äºçŸ©é˜µå’Œå›¾ï¼Œå…ƒç´ æ•°é‡ä¸<code>n</code>æˆå¹³æ–¹å…³ç³»ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å¹³æ–¹é˜¶ */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">quadratic</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="comment">// çŸ©é˜µå ç”¨ O(n^2) ç©ºé—´</span></span><br><span class="line">    <span class="type">int</span>[][] numMatrix = <span class="keyword">new</span> <span class="title class_">int</span>[n][n];</span><br><span class="line">    <span class="comment">// äºŒç»´åˆ—è¡¨å ç”¨ O(n^2) ç©ºé—´</span></span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; numList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        List&lt;Integer&gt; tmp = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            tmp.add(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        numList.add(tmp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸‹é¢ä»£ç çš„é€’å½’æ·±åº¦ä¸º<code>n</code>ï¼Œæ¯ä¸ªé€’å½’å‡½æ•°ä¸­éƒ½åˆå§‹åŒ–äº†ä¸€ä¸ªæ•°ç»„ï¼Œé•¿åº¦åˆ†åˆ«ä¸º<code>n, n - 1, n - 2, ..., 2, 1</code>ï¼Œå¹³å‡é•¿åº¦ä¸º<code>n / 2</code>ï¼Œå› æ­¤æ€»ä½“å ç”¨<code>O(n^2)</code>ç©ºé—´ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* å¹³æ–¹é˜¶ï¼ˆé€’å½’å®ç°ï¼‰ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">quadraticRecur</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// æ•°ç»„ nums é•¿åº¦ä¸º n, n-1, ..., 2, 1</span></span><br><span class="line">    <span class="type">int</span>[] nums = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">    System.out.println(<span class="string">&quot;é€’å½’ n = &quot;</span> + n + <span class="string">&quot; ä¸­çš„ nums é•¿åº¦ = &quot;</span> + nums.length);</span><br><span class="line">    <span class="keyword">return</span> quadraticRecur(n - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.hello-algo.com/chapter_computational_complexity/space_complexity.assets/space_complexity_recursive_quadratic.png"></p><p><strong>æŒ‡æ•°é˜¶<code>O(2^n)</code></strong></p><p>æŒ‡æ•°é˜¶å¸¸è§äºäºŒå‰æ ‘ã€‚ä¸‹å›¾ï¼Œé«˜åº¦ä¸º<code>n</code>çš„â€œæ»¡äºŒå‰æ ‘â€çš„èŠ‚ç‚¹æ•°é‡ä¸º<code>2^n - 1</code>ï¼Œå ç”¨<code>O(2^n)</code>ç©ºé—´ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æŒ‡æ•°é˜¶ï¼ˆå»ºç«‹æ»¡äºŒå‰æ ‘ï¼‰ */</span></span><br><span class="line">TreeNode <span class="title function_">buildTree</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">root</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">0</span>);</span><br><span class="line">    root.left = buildTree(n - <span class="number">1</span>);</span><br><span class="line">    root.right = buildTree(n - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.hello-algo.com/chapter_computational_complexity/space_complexity.assets/space_complexity_exponential.png"></p><p><strong>å¯¹æ•°é˜¶<code>O(logn)</code></strong></p><p>å¯¹æ•°é˜¶å¸¸è§äºåˆ†æ²»ç®—æ³•ã€‚ä¾‹å¦‚å½’å¹¶æ’åºï¼Œè¾“å…¥é•¿åº¦ä¸º<code>n</code>çš„æ•°ç»„ï¼Œæ¯è½®é€’å½’å°†æ•°ç»„ä»ä¸­ç‚¹åˆ’åˆ†ä¸ºä¸¤åŠï¼Œå½¢æˆé«˜åº¦ä¸º<code>logn</code>çš„é€’å½’æ ‘ï¼Œä½¿ç”¨<code>O(logn)</code>æ ˆå¸§ç©ºé—´ã€‚</p><h4 id="æƒè¡¡æ—¶é—´ä¸ç©ºé—´"><a href="#æƒè¡¡æ—¶é—´ä¸ç©ºé—´" class="headerlink" title="æƒè¡¡æ—¶é—´ä¸ç©ºé—´"></a>æƒè¡¡æ—¶é—´ä¸ç©ºé—´</h4><p>ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦éƒ½èƒ½è¾¾åˆ°æœ€ä¼˜ã€‚ç„¶è€Œåœ¨å®é™…æƒ…å†µä¸­ï¼ŒåŒæ—¶ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦é€šå¸¸æ˜¯éå¸¸å›°éš¾çš„ã€‚</p><p><strong>é™ä½æ—¶é—´å¤æ‚åº¦é€šå¸¸éœ€è¦ä»¥æå‡ç©ºé—´å¤æ‚åº¦ä¸ºä»£ä»·ï¼Œåä¹‹äº¦ç„¶ã€‚</strong>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ—¶é—´æ¯”ç©ºé—´æ›´å®è´µï¼Œå› æ­¤â€œä»¥ç©ºé—´æ¢æ—¶é—´â€é€šå¸¸æ˜¯æ›´å¸¸ç”¨çš„ç­–ç•¥ã€‚å½“ç„¶ï¼Œåœ¨æ•°æ®é‡å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼Œæ§åˆ¶ç©ºé—´å¤æ‚åº¦ä¹Ÿæ˜¯éå¸¸é‡è¦çš„ã€‚</p><hr><h2 id="3-æ•°æ®ç»“æ„"><a href="#3-æ•°æ®ç»“æ„" class="headerlink" title="3. æ•°æ®ç»“æ„"></a>3. æ•°æ®ç»“æ„</h2><p>å¸¸è§çš„æ•°æ®ç»“æ„åŒ…æ‹¬æ•°ç»„ï¼ˆ<code>Array</code>ï¼‰ã€é“¾è¡¨ï¼ˆ<code>List</code>ï¼‰ã€æ ˆï¼ˆ<code>Stack</code>ï¼‰ã€é˜Ÿåˆ—ï¼ˆ<code>Queue</code>ï¼‰ã€å“ˆå¸Œè¡¨ï¼ˆ<code>Hash Table</code>ï¼‰ã€æ ‘ï¼ˆ<code>Tree</code>ï¼‰ã€å †ï¼ˆ<code>Heap</code>ï¼‰ã€å›¾ï¼ˆ<code>Graph</code>ï¼‰ï¼Œå®ƒä»¬å¯ä»¥ä»â€œé€»è¾‘ç»“æ„â€å’Œâ€œç‰©ç†ç»“æ„â€ä¸¤ä¸ªç»´åº¦è¿›è¡Œåˆ†ç±»ã€‚</p><h3 id="3-1-æ•°æ®ç»“æ„åˆ†ç±»"><a href="#3-1-æ•°æ®ç»“æ„åˆ†ç±»" class="headerlink" title="3.1 æ•°æ®ç»“æ„åˆ†ç±»"></a>3.1 æ•°æ®ç»“æ„åˆ†ç±»</h3><p><strong>é€»è¾‘ç»“æ„æ­ç¤ºäº†æ•°æ®å…ƒç´ ä¹‹é—´çš„é€»è¾‘å…³ç³»</strong>ã€‚åœ¨æ•°ç»„å’Œé“¾è¡¨ä¸­ï¼Œæ•°æ®æŒ‰ç…§é¡ºåºä¾æ¬¡æ’åˆ—ï¼Œä½“ç°äº†æ•°æ®ä¹‹é—´çš„çº¿æ€§å…³ç³»ã€‚è€Œåœ¨æ ‘ä¸­ï¼Œæ•°æ®ä»é¡¶éƒ¨å‘ä¸‹æŒ‰å±‚æ¬¡æ’åˆ—ï¼Œè¡¨ç°å‡ºç¥–å…ˆä¸åä»£ä¹‹é—´çš„æ´¾ç”Ÿå…³ç³»ã€‚å›¾åˆ™ç”±èŠ‚ç‚¹å’Œè¾¹æ„æˆï¼Œåæ˜ äº†å¤æ‚çš„ç½‘ç»œå…³ç³»ã€‚</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé€»è¾‘ç»“æ„å¯è¢«åˆ†ä¸ºâ€œçº¿æ€§â€å’Œâ€œéçº¿æ€§â€ä¸¤å¤§ç±»ã€‚çº¿æ€§ç»“æ„æ¯”è¾ƒç›´è§‚ï¼ŒæŒ‡æ•°æ®åœ¨é€»è¾‘å…³ç³»ä¸Šå‘ˆçº¿æ€§æ’åˆ—ã€‚éçº¿æ€§ç»“æ„åˆ™ç›¸åï¼Œå‘ˆéçº¿æ€§æ’åˆ—ã€‚</p><ul><li>çº¿æ€§æ•°æ®ç»“æ„ï¼šæ•°ç»„ã€é“¾è¡¨ã€æ ˆã€é˜Ÿåˆ—ã€å“ˆå¸Œè¡¨ã€‚</li><li>éçº¿æ€§æ•°æ®ç»“æ„ï¼šæ ‘ã€å †ã€å›¾ã€å“ˆå¸Œè¡¨ã€‚</li></ul><p><img src="https://www.hello-algo.com/chapter_data_structure/classification_of_data_structure.assets/classification_logic_structure.png"></p><p>éçº¿æ€§æ•°æ®ç»“æ„å¯ä»¥è¿›ä¸€æ­¥è¢«åˆ’åˆ†ä¸ºæ ‘å½¢ç»“æ„å’Œç½‘çŠ¶ç»“æ„ã€‚</p><ul><li>çº¿æ€§ç»“æ„ï¼šæ•°ç»„ã€é“¾è¡¨ã€é˜Ÿåˆ—ã€æ ˆã€å“ˆå¸Œè¡¨ï¼Œå…ƒç´ ä¹‹é—´æ˜¯ä¸€å¯¹ä¸€çš„é¡ºåºå…³ç³»ã€‚</li><li>æ ‘å½¢ç»“æ„ï¼šæ ‘ã€å †ã€å“ˆå¸Œè¡¨ï¼Œå…ƒç´ ä¹‹é—´æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ã€‚</li><li>ç½‘çŠ¶ç»“æ„ï¼šå›¾ï¼Œå…ƒç´ ä¹‹é—´æ˜¯å¤šå¯¹å¤šçš„å…³ç³»ã€‚</li></ul><p><strong>ç‰©ç†ç»“æ„åæ˜ äº†æ•°æ®åœ¨è®¡ç®—æœºå†…å­˜ä¸­çš„å­˜å‚¨æ–¹å¼</strong>ã€‚åœ¨ç®—æ³•è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ•°æ®éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œç³»ç»Ÿé€šè¿‡å†…å­˜åœ°å€æ¥è®¿é—®ç›®æ ‡ä½ç½®çš„æ•°æ®ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå­˜å‚¨æ–¹å¼å¯åˆ†ä¸ºè¿ç»­ç©ºé—´å­˜å‚¨å’Œç¦»æ•£ç©ºé—´å­˜å‚¨ã€‚</p><p><img src="https://www.hello-algo.com/chapter_data_structure/classification_of_data_structure.assets/classification_phisical_structure.png"></p><hr><h3 id="3-2-åŸºæœ¬æ•°æ®ç±»å‹"><a href="#3-2-åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="3.2 åŸºæœ¬æ•°æ®ç±»å‹"></a>3.2 åŸºæœ¬æ•°æ®ç±»å‹</h3><p>åŸºæœ¬æ•°æ®ç±»å‹æ˜¯<code>CPU</code>å¯ä»¥ç›´æ¥è¿›è¡Œè¿ç®—çš„ç±»å‹ï¼Œåœ¨ç®—æ³•ä¸­ç›´æ¥è¢«ä½¿ç”¨ã€‚</p><ul><li>æ•´æ•°ç±»å‹<code>byte</code>,<code>short</code>,<code>int</code>,<code>long</code>ã€‚</li><li>æµ®ç‚¹æ•°ç±»å‹<code>float</code>,<code>double</code>ï¼Œç”¨äºè¡¨ç¤ºå°æ•°ã€‚</li><li>å­—ç¬¦ç±»å‹<code>char</code>ï¼Œç”¨äºè¡¨ç¤ºå„ç§è¯­è¨€çš„å­—æ¯ã€æ ‡ç‚¹ç¬¦å·ã€ç”šè‡³è¡¨æƒ…ç¬¦å·ç­‰ã€‚</li><li>å¸ƒå°”ç±»å‹<code>bool</code>ï¼Œç”¨äºè¡¨ç¤ºâ€œæ˜¯â€ä¸â€œå¦â€åˆ¤æ–­ã€‚</li></ul><p>åŸºæœ¬æ•°æ®ç±»å‹ä»¥äºŒè¿›åˆ¶çš„å½¢å¼å­˜å‚¨åœ¨è®¡ç®—æœºä¸­ã€‚ä¸€ä¸ªäºŒè¿›åˆ¶ä½å³ä¸º<code>1</code>æ¯”ç‰¹ã€‚åœ¨ç»å¤§å¤šæ•°ç°ä»£ç³»ç»Ÿä¸­ï¼Œ<code>1</code>å­—èŠ‚ï¼ˆ<code>byte</code>ï¼‰ç”±<code>8</code>æ¯”ç‰¹ï¼ˆ<code>bits</code>ï¼‰ç»„æˆã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Hongda-OSU/PicGo/image/pic4.png"></p><hr><h2 id="4-æ•°ç»„ä¸é“¾è¡¨"><a href="#4-æ•°ç»„ä¸é“¾è¡¨" class="headerlink" title="4. æ•°ç»„ä¸é“¾è¡¨"></a>4. æ•°ç»„ä¸é“¾è¡¨</h2><h3 id="4-1-æ•°ç»„"><a href="#4-1-æ•°ç»„" class="headerlink" title="4.1 æ•°ç»„"></a>4.1 æ•°ç»„</h3><p>ã€Œæ•°ç»„ <code>array</code>ã€æ˜¯ä¸€ç§çº¿æ€§æ•°æ®ç»“æ„ï¼Œå…¶å°†ç›¸åŒç±»å‹å…ƒç´ å­˜å‚¨åœ¨è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ã€‚è€Œå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®ç§°ä¸ºè¯¥å…ƒç´ çš„ã€Œç´¢å¼• <code>index</code>ã€ã€‚</p><p><img src="https://www.hello-algo.com/chapter_array_and_linkedlist/array.assets/array_definition.png"></p><h4 id="æ•°ç»„å¸¸ç”¨æ“ä½œ"><a href="#æ•°ç»„å¸¸ç”¨æ“ä½œ" class="headerlink" title="æ•°ç»„å¸¸ç”¨æ“ä½œ"></a>æ•°ç»„å¸¸ç”¨æ“ä½œ</h4><p>ï¼ˆ1ï¼‰åˆå§‹åŒ–æ•°ç»„</p><p>å¯ä»¥æ ¹æ®éœ€æ±‚é€‰ç”¨æ•°ç»„çš„ä¸¤ç§åˆå§‹åŒ–æ–¹å¼ï¼Œæ— åˆå§‹å€¼ã€ç»™å®šåˆå§‹å€¼ã€‚åœ¨æœªæŒ‡å®šåˆå§‹å€¼çš„æƒ…å†µä¸‹ï¼Œå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¼šå°†æ•°ç»„å…ƒç´ åˆå§‹åŒ–ä¸º<code>0</code>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">array.java</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åˆå§‹åŒ–æ•°ç»„ */</span></span><br><span class="line"><span class="type">int</span>[] arr = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">5</span>]; <span class="comment">// &#123; 0, 0, 0, 0, 0 &#125;</span></span><br><span class="line"><span class="type">int</span>[] nums = &#123; <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">4</span> &#125;;</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰è®¿é—®å…ƒç´ </p><p>æ•°ç»„å…ƒç´ è¢«å­˜å‚¨åœ¨è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ï¼Œè¿™æ„å‘³ç€è®¡ç®—æ•°ç»„å…ƒç´ çš„å†…å­˜åœ°å€éå¸¸å®¹æ˜“ã€‚ç»™å®šæ•°ç»„å†…å­˜åœ°å€ï¼ˆå³é¦–å…ƒç´ å†…å­˜åœ°å€ï¼‰å’ŒæŸä¸ªå…ƒç´ çš„ç´¢å¼•ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å…¬å¼è®¡ç®—å¾—åˆ°è¯¥å…ƒç´ çš„å†…å­˜åœ°å€ï¼Œä»è€Œç›´æ¥è®¿é—®æ­¤å…ƒç´ ã€‚</p><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line"># å…ƒç´ å†…å­˜åœ°å€ = æ•°ç»„å†…å­˜åœ°å€ + å…ƒç´ é•¿åº¦ * å…ƒç´ ç´¢å¼•</span><br><span class="line">elementAddr = firtstElementAddr + elementLength * elementIndex</span><br></pre></td></tr></table></figure><p><img src="https://www.hello-algo.com/chapter_array_and_linkedlist/array.assets/array_memory_location_calculation.png"></p><p>åœ¨æ•°ç»„ä¸­è®¿é—®å…ƒç´ æ˜¯éå¸¸é«˜æ•ˆçš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<code>O(1)</code>æ—¶é—´å†…éšæœºè®¿é—®æ•°ç»„ä¸­çš„ä»»æ„ä¸€ä¸ªå…ƒç´ ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* éšæœºè®¿é—®å…ƒç´  */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">randomAccess</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="comment">// åœ¨åŒºé—´ [0, nums.length) ä¸­éšæœºæŠ½å–ä¸€ä¸ªæ•°å­—</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">randomIndex</span> <span class="operator">=</span> ThreadLocalRandom.current().nextInt(<span class="number">0</span>, nums.length);</span><br><span class="line">    <span class="comment">// è·å–å¹¶è¿”å›éšæœºå…ƒç´ </span></span><br><span class="line">    <span class="type">int</span> <span class="variable">randomNum</span> <span class="operator">=</span> nums[randomIndex];</span><br><span class="line">    <span class="keyword">return</span> randomNum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰æ’å…¥å…ƒç´ </p><p>æ•°ç»„å…ƒç´ åœ¨å†…å­˜ä¸­æ˜¯â€œç´§æŒ¨ç€çš„â€ï¼Œå®ƒä»¬ä¹‹é—´æ²¡æœ‰ç©ºé—´å†å­˜æ”¾ä»»ä½•æ•°æ®ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¦‚æœæƒ³è¦åœ¨æ•°ç»„ä¸­é—´æ’å…¥ä¸€ä¸ªå…ƒç´ ï¼Œåˆ™éœ€è¦å°†è¯¥å…ƒç´ ä¹‹åçš„æ‰€æœ‰å…ƒç´ éƒ½å‘åç§»åŠ¨ä¸€ä½ï¼Œä¹‹åå†æŠŠå…ƒç´ èµ‹å€¼ç»™è¯¥ç´¢å¼•ã€‚</p><p><img src="https://www.hello-algo.com/chapter_array_and_linkedlist/array.assets/array_insert_element.png"></p><p>æ³¨æ„ï¼Œç”±äºæ•°ç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œå› æ­¤æ’å…¥ä¸€ä¸ªå…ƒç´ å¿…å®šä¼šå¯¼è‡´æ•°ç»„å°¾éƒ¨å…ƒç´ çš„â€œä¸¢å¤±â€ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åœ¨æ•°ç»„çš„ç´¢å¼• index å¤„æ’å…¥å…ƒç´  num */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> num, <span class="type">int</span> index)</span> &#123;</span><br><span class="line">    <span class="comment">// æŠŠç´¢å¼• index ä»¥åŠä¹‹åçš„æ‰€æœ‰å…ƒç´ å‘åç§»åŠ¨ä¸€ä½</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> nums.length - <span class="number">1</span>; i &gt; index; i--) &#123;</span><br><span class="line">        nums[i] = nums[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å°† num èµ‹ç»™ index å¤„å…ƒç´ </span></span><br><span class="line">    nums[index] = num;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ4ï¼‰åˆ é™¤å…ƒç´ </p><p>åŒç†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè‹¥æƒ³è¦åˆ é™¤ç´¢å¼•<code>i</code>å¤„çš„å…ƒç´ ï¼Œåˆ™éœ€è¦æŠŠç´¢å¼•<code>i</code>ä¹‹åçš„å…ƒç´ éƒ½å‘å‰ç§»åŠ¨ä¸€ä½ã€‚</p><p><img src="https://www.hello-algo.com/chapter_array_and_linkedlist/array.assets/array_remove_element.png"></p><p>æ³¨æ„ï¼Œåˆ é™¤å…ƒç´ å®Œæˆåï¼ŒåŸå…ˆæœ«å°¾çš„å…ƒç´ å˜å¾—â€œæ— æ„ä¹‰â€äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— é¡»ç‰¹æ„å»ä¿®æ”¹å®ƒã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åˆ é™¤ç´¢å¼• index å¤„å…ƒç´  */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> index)</span> &#123;</span><br><span class="line">    <span class="comment">// æŠŠç´¢å¼• index ä¹‹åçš„æ‰€æœ‰å…ƒç´ å‘å‰ç§»åŠ¨ä¸€ä½</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> index; i &lt; nums.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        nums[i] = nums[i + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»çš„æ¥çœ‹ï¼Œæ•°ç»„çš„æ’å…¥ä¸åˆ é™¤æ“ä½œæœ‰ä»¥ä¸‹ç¼ºç‚¹ã€‚</p><ul><li>æ—¶é—´å¤æ‚åº¦é«˜ï¼šæ•°ç»„çš„æ’å…¥å’Œåˆ é™¤çš„å¹³å‡æ—¶é—´å¤æ‚åº¦å‡ä¸º<code>O(n)</code>ï¼Œå…¶ä¸­<code>n</code>ä¸ºæ•°ç»„é•¿åº¦ã€‚</li><li>ä¸¢å¤±å…ƒç´ ï¼šç”±äºæ•°ç»„çš„é•¿åº¦ä¸å¯å˜ï¼Œå› æ­¤åœ¨æ’å…¥å…ƒç´ åï¼Œè¶…å‡ºæ•°ç»„é•¿åº¦èŒƒå›´çš„å…ƒç´ ä¼šä¸¢å¤±ã€‚</li><li>å†…å­˜æµªè´¹ï¼šæˆ‘ä»¬å¯ä»¥åˆå§‹åŒ–ä¸€ä¸ªæ¯”è¾ƒé•¿çš„æ•°ç»„ï¼Œåªç”¨å‰é¢ä¸€éƒ¨åˆ†ï¼Œè¿™æ ·åœ¨æ’å…¥æ•°æ®æ—¶ï¼Œä¸¢å¤±çš„æœ«å°¾å…ƒç´ éƒ½æ˜¯â€œæ— æ„ä¹‰â€çš„ï¼Œä½†è¿™æ ·åšä¹Ÿä¼šé€ æˆéƒ¨åˆ†å†…å­˜ç©ºé—´çš„æµªè´¹ã€‚</li></ul><p>ï¼ˆ5ï¼‰éå†æ•°ç»„</p><p>å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥é€šè¿‡ç´¢å¼•éå†æ•°ç»„ï¼Œä¹Ÿå¯ä»¥ç›´æ¥éå†è·å–æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* éå†æ•°ç»„ */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">traverse</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// é€šè¿‡ç´¢å¼•éå†æ•°ç»„</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç›´æ¥éå†æ•°ç»„</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ6ï¼‰æŸ¥æ‰¾å…ƒç´ </p><p>åœ¨æ•°ç»„ä¸­æŸ¥æ‰¾æŒ‡å®šå…ƒç´ éœ€è¦éå†æ•°ç»„ï¼Œæ¯è½®åˆ¤æ–­å…ƒç´ å€¼æ˜¯å¦åŒ¹é…ï¼Œè‹¥åŒ¹é…åˆ™è¾“å‡ºå¯¹åº”ç´¢å¼•ã€‚å› ä¸ºæ•°ç»„æ˜¯çº¿æ€§æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥ä¸Šè¿°æŸ¥æ‰¾æ“ä½œè¢«ç§°ä¸ºâ€œçº¿æ€§æŸ¥æ‰¾â€ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åœ¨æ•°ç»„ä¸­æŸ¥æ‰¾æŒ‡å®šå…ƒç´  */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">find</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums[i] == target)</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ7ï¼‰æ‰©å®¹æ•°ç»„</p><p>å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œ<strong>æ•°ç»„çš„é•¿åº¦æ˜¯ä¸å¯å˜çš„</strong>ã€‚å¦‚æœå¸Œæœ›æ‰©å®¹æ•°ç»„ï¼Œåˆ™éœ€é‡æ–°å»ºç«‹ä¸€ä¸ªæ›´å¤§çš„æ•°ç»„ï¼Œç„¶åæŠŠåŸæ•°ç»„å…ƒç´ ä¾æ¬¡æ‹·è´åˆ°æ–°æ•°ç»„ã€‚è¿™æ˜¯ä¸€ä¸ª<code>O(n)</code>çš„æ“ä½œï¼Œåœ¨æ•°ç»„å¾ˆå¤§çš„æƒ…å†µä¸‹æ˜¯éå¸¸è€—æ—¶ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æ‰©å±•æ•°ç»„é•¿åº¦ */</span></span><br><span class="line"><span class="type">int</span>[] extend(<span class="type">int</span>[] nums, <span class="type">int</span> enlarge) &#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¸€ä¸ªæ‰©å±•é•¿åº¦åçš„æ•°ç»„</span></span><br><span class="line">    <span class="type">int</span>[] res = <span class="keyword">new</span> <span class="title class_">int</span>[nums.length + enlarge];</span><br><span class="line">    <span class="comment">// å°†åŸæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ å¤åˆ¶åˆ°æ–°æ•°ç»„</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        res[i] = nums[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿”å›æ‰©å±•åçš„æ–°æ•°ç»„</span></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="4-2-é“¾è¡¨"><a href="#4-2-é“¾è¡¨" class="headerlink" title="4.2 é“¾è¡¨"></a>4.2 é“¾è¡¨</h3><p>ã€Œé“¾è¡¨ <code>linked list</code>ã€æ˜¯ä¸€ç§çº¿æ€§æ•°æ®ç»“æ„ï¼Œå…¶ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªèŠ‚ç‚¹å¯¹è±¡ï¼Œå„ä¸ªèŠ‚ç‚¹é€šè¿‡â€œå¼•ç”¨â€ç›¸è¿æ¥ã€‚å¼•ç”¨è®°å½•äº†ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„å†…å­˜åœ°å€ï¼Œé€šè¿‡å®ƒå¯ä»¥ä»å½“å‰èŠ‚ç‚¹è®¿é—®åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><p>é“¾è¡¨çš„è®¾è®¡ä½¿å¾—å„ä¸ªèŠ‚ç‚¹å¯ä»¥è¢«åˆ†æ•£å­˜å‚¨åœ¨å†…å­˜å„å¤„ï¼Œå®ƒä»¬çš„å†…å­˜åœ°å€æ˜¯æ— é¡»è¿ç»­çš„ã€‚é“¾è¡¨çš„ç»„æˆå•ä½æ˜¯ã€ŒèŠ‚ç‚¹ <code>node</code>ã€å¯¹è±¡ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«ä¸¤é¡¹æ•°æ®ï¼ŒèŠ‚ç‚¹çš„â€œå€¼â€å’ŒæŒ‡å‘ä¸‹ä¸€èŠ‚ç‚¹çš„â€œå¼•ç”¨â€ã€‚</p><p><img src="https://www.hello-algo.com/chapter_array_and_linkedlist/linked_list.assets/linkedlist_definition.png"></p><h4 id="é“¾è¡¨å¸¸ç”¨æ“ä½œ"><a href="#é“¾è¡¨å¸¸ç”¨æ“ä½œ" class="headerlink" title="é“¾è¡¨å¸¸ç”¨æ“ä½œ"></a>é“¾è¡¨å¸¸ç”¨æ“ä½œ</h4><p>ï¼ˆ1ï¼‰åˆå§‹åŒ–é“¾è¡¨</p><p>å»ºç«‹é“¾è¡¨åˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯åˆå§‹åŒ–å„ä¸ªèŠ‚ç‚¹å¯¹è±¡ï¼Œç¬¬äºŒæ­¥æ˜¯æ„å»ºå¼•ç”¨æŒ‡å‘å…³ç³»ã€‚åˆå§‹åŒ–å®Œæˆåï¼Œå°±å¯ä»¥ä»é“¾è¡¨çš„å¤´èŠ‚ç‚¹å‡ºå‘ï¼Œé€šè¿‡å¼•ç”¨æŒ‡å‘<code>next</code>ä¾æ¬¡è®¿é—®æ‰€æœ‰èŠ‚ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åˆå§‹åŒ–é“¾è¡¨ 1 -&gt; 3 -&gt; 2 -&gt; 5 -&gt; 4 */</span></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–å„ä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="type">ListNode</span> <span class="variable">n0</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">1</span>);</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">n1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">3</span>);</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">n2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">2</span>);</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">n3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">5</span>);</span><br><span class="line"><span class="type">ListNode</span> <span class="variable">n4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">4</span>);</span><br><span class="line"><span class="comment">// æ„å»ºå¼•ç”¨æŒ‡å‘</span></span><br><span class="line">n0.next = n1;</span><br><span class="line">n1.next = n2;</span><br><span class="line">n2.next = n3;</span><br><span class="line">n3.next = n4;</span><br></pre></td></tr></table></figure><p>æ•°ç»„æ•´ä½“æ˜¯ä¸€ä¸ªå˜é‡ï¼Œæ¯”å¦‚æ•°ç»„<code>nums</code>åŒ…å«å…ƒç´ <code>nums[0]</code>ï¼Œ<code>nums[1]</code>ç­‰ï¼Œè€Œé“¾è¡¨æ˜¯ç”±å¤šä¸ªç‹¬ç«‹çš„èŠ‚ç‚¹å¯¹è±¡ç»„æˆçš„ã€‚æˆ‘ä»¬é€šå¸¸å°†å¤´èŠ‚ç‚¹å½“ä½œé“¾è¡¨çš„ä»£ç§°ï¼Œæ¯”å¦‚ä»¥ä¸Šä»£ç ä¸­çš„é“¾è¡¨å¯è¢«è®°åšé“¾è¡¨<code>n0</code>ã€‚</p><p>ï¼ˆ2ï¼‰æ’å…¥èŠ‚ç‚¹</p><p>åœ¨é“¾è¡¨ä¸­æ’å…¥èŠ‚ç‚¹éå¸¸å®¹æ˜“ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå‡è®¾æˆ‘ä»¬æƒ³åœ¨ç›¸é‚»çš„ä¸¤ä¸ªèŠ‚ç‚¹<code>n0</code>ï¼Œ<code>n1</code>ä¹‹é—´æ’å…¥ä¸€ä¸ªæ–°èŠ‚ç‚¹<code>P</code>ï¼Œåˆ™åªéœ€è¦æ”¹å˜ä¸¤ä¸ªèŠ‚ç‚¹å¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<code>O(1)</code>ã€‚</p><p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨æ•°ç»„ä¸­æ’å…¥å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸º<code>O(n)</code>ï¼Œåœ¨å¤§æ•°æ®é‡ä¸‹çš„æ•ˆç‡è¾ƒä½ã€‚</p><p><img src="https://www.hello-algo.com/chapter_array_and_linkedlist/linked_list.assets/linkedlist_insert_node.png"></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åœ¨é“¾è¡¨çš„èŠ‚ç‚¹ n0 ä¹‹åæ’å…¥èŠ‚ç‚¹ P */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(ListNode n0, ListNode P)</span> &#123;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">n1</span> <span class="operator">=</span> n0.next;</span><br><span class="line">    P.next = n1;</span><br><span class="line">    n0.next = P;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰åˆ é™¤èŠ‚ç‚¹</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨é“¾è¡¨ä¸­åˆ é™¤èŠ‚ç‚¹ä¹Ÿéå¸¸æ–¹ä¾¿ï¼Œåªéœ€æ”¹å˜ä¸€ä¸ªèŠ‚ç‚¹çš„å¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰å³å¯ã€‚</p><p>è™½ç„¶åœ¨åˆ é™¤æ“ä½œå®ŒæˆåèŠ‚ç‚¹<code>P</code>ä»ç„¶æŒ‡å‘<code>n1</code>ï¼Œä½†å®é™…ä¸Šéå†æ­¤é“¾è¡¨å·²ç»æ— æ³•è®¿é—®åˆ°<code>P</code>ï¼Œè¿™æ„å‘³ç€<code>P</code>å·²ç»ä¸å†å±äºè¯¥é“¾è¡¨äº†ã€‚</p><p><img src="https://www.hello-algo.com/chapter_array_and_linkedlist/linked_list.assets/linkedlist_remove_node.png"></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åˆ é™¤é“¾è¡¨çš„èŠ‚ç‚¹ n0 ä¹‹åçš„é¦–ä¸ªèŠ‚ç‚¹ */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(ListNode n0)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n0.next == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">// n0 -&gt; P -&gt; n1</span></span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">P</span> <span class="operator">=</span> n0.next;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">n1</span> <span class="operator">=</span> P.next;</span><br><span class="line">    n0.next = n1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ4ï¼‰è®¿é—®èŠ‚ç‚¹</p><p>é“¾è¡¨è®¿é—®èŠ‚ç‚¹çš„æ•ˆç‡è¾ƒä½ã€‚å¯ä»¥åœ¨<code>O(1)</code>æ—¶é—´ä¸‹è®¿é—®æ•°ç»„ä¸­çš„ä»»æ„å…ƒç´ ï¼Œé“¾è¡¨åˆ™ä¸è¡Œã€‚ç¨‹åºéœ€è¦ä»å¤´èŠ‚ç‚¹å‡ºå‘ï¼Œé€ä¸ªå‘åéå†ï¼Œç›´è‡³æ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹ã€‚è®¿é—®é“¾è¡¨çš„ç¬¬<code>n</code>ä¸ªèŠ‚ç‚¹éœ€è¦å¾ªç¯<code>n - 1</code>è½®ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<code>O(n)</code>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* è®¿é—®é“¾è¡¨ä¸­ç´¢å¼•ä¸º index çš„èŠ‚ç‚¹ */</span></span><br><span class="line">ListNode <span class="title function_">access</span><span class="params">(ListNode head, <span class="type">int</span> index)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (head == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        head = head.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ5ï¼‰æŸ¥æ‰¾èŠ‚ç‚¹</p><p>éå†é“¾è¡¨ï¼ŒæŸ¥æ‰¾é“¾è¡¨å†…å€¼ä¸º<code>target</code>çš„èŠ‚ç‚¹ï¼Œè¾“å‡ºèŠ‚ç‚¹åœ¨é“¾è¡¨ä¸­çš„ç´¢å¼•ã€‚æ­¤è¿‡ç¨‹ä¹Ÿå±äºçº¿æ€§æŸ¥æ‰¾ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åœ¨é“¾è¡¨ä¸­æŸ¥æ‰¾å€¼ä¸º target çš„é¦–ä¸ªèŠ‚ç‚¹ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">find</span><span class="params">(ListNode head, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (head != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (head.val == target)</span><br><span class="line">            <span class="keyword">return</span> index;</span><br><span class="line">        head = head.next;</span><br><span class="line">        index++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ•°ç»„-VS-é“¾è¡¨"><a href="#æ•°ç»„-VS-é“¾è¡¨" class="headerlink" title="æ•°ç»„ VS é“¾è¡¨"></a>æ•°ç»„ VS é“¾è¡¨</h4><p>ä¸‹é¢æ˜¯æ•°ç»„å’Œé“¾è¡¨çš„å„é¡¹ç‰¹ç‚¹ä¸æ“ä½œæ•ˆç‡ã€‚ç”±äºå®ƒä»¬é‡‡ç”¨ä¸¤ç§ç›¸åçš„å­˜å‚¨ç­–ç•¥ï¼Œå› æ­¤å„ç§æ€§è´¨å’Œæ“ä½œæ•ˆç‡ä¹Ÿå‘ˆç°å¯¹ç«‹çš„ç‰¹ç‚¹ã€‚</p><table><thead><tr><th align="left"></th><th align="left">æ•°ç»„</th><th align="left">é“¾è¡¨</th></tr></thead><tbody><tr><td align="left">å­˜å‚¨æ–¹å¼</td><td align="left">è¿ç»­å†…å­˜ç©ºé—´</td><td align="left">ç¦»æ•£å†…å­˜ç©ºé—´</td></tr><tr><td align="left">ç¼“å­˜å±€éƒ¨æ€§</td><td align="left">å‹å¥½</td><td align="left">ä¸å‹å¥½</td></tr><tr><td align="left">å®¹é‡æ‰©å±•</td><td align="left">é•¿åº¦ä¸å¯å˜</td><td align="left">å¯çµæ´»æ‰©å±•</td></tr><tr><td align="left">å†…å­˜æ•ˆç‡</td><td align="left">å ç”¨å†…å­˜å°‘ã€æµªè´¹éƒ¨åˆ†ç©ºé—´</td><td align="left">å ç”¨å†…å­˜å¤š</td></tr><tr><td align="left">è®¿é—®å…ƒç´ </td><td align="left"><code>O(1)</code></td><td align="left"><code>O(n)</code></td></tr><tr><td align="left">æ·»åŠ å…ƒç´ </td><td align="left"><code>O(n)</code></td><td align="left"><code>O(1)</code></td></tr><tr><td align="left">åˆ é™¤å…ƒç´ </td><td align="left"><code>O(n)</code></td><td align="left"><code>O(1)</code></td></tr></tbody></table><h4 id="å¸¸è§é“¾è¡¨ç±»å‹"><a href="#å¸¸è§é“¾è¡¨ç±»å‹" class="headerlink" title="å¸¸è§é“¾è¡¨ç±»å‹"></a>å¸¸è§é“¾è¡¨ç±»å‹</h4><ul><li><strong>å•å‘é“¾è¡¨</strong>ï¼šå³æ™®é€šé“¾è¡¨ã€‚å•å‘é“¾è¡¨çš„èŠ‚ç‚¹åŒ…å«å€¼å’ŒæŒ‡å‘ä¸‹ä¸€èŠ‚ç‚¹çš„å¼•ç”¨ä¸¤é¡¹æ•°æ®ã€‚æˆ‘ä»¬å°†é¦–ä¸ªèŠ‚ç‚¹ç§°ä¸ºå¤´èŠ‚ç‚¹ï¼Œå°†æœ€åä¸€ä¸ªèŠ‚ç‚¹æˆä¸ºå°¾èŠ‚ç‚¹ï¼Œå°¾èŠ‚ç‚¹æŒ‡å‘ç©º<code>Node</code>ã€‚</li><li><strong>ç¯å½¢é“¾è¡¨</strong>ï¼šå¦‚æœæˆ‘ä»¬ä»¤å•å‘é“¾è¡¨çš„å°¾èŠ‚ç‚¹æŒ‡å‘å¤´èŠ‚ç‚¹ï¼ˆå³é¦–å°¾ç›¸æ¥ï¼‰ï¼Œåˆ™å¾—åˆ°ä¸€ä¸ªç¯å½¢é“¾è¡¨ã€‚åœ¨ç¯å½¢é“¾è¡¨ä¸­ï¼Œä»»æ„èŠ‚ç‚¹éƒ½å¯ä»¥è§†ä½œå¤´èŠ‚ç‚¹ã€‚</li><li><strong>åŒå‘é“¾è¡¨</strong>ï¼šä¸å•å‘é“¾è¡¨ç›¸æ¯”ï¼ŒåŒå‘é“¾è¡¨è®°å½•äº†ä¸¤ä¸ªæ–¹å‘çš„å¼•ç”¨ã€‚åŒå‘é“¾è¡¨çš„èŠ‚ç‚¹å®šä¹‰åŒæ—¶åŒ…å«æŒ‡å‘åç»§èŠ‚ç‚¹ï¼ˆä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼‰å’Œå‰é©±èŠ‚ç‚¹ï¼ˆä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼‰çš„å¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰ã€‚ç›¸è¾ƒäºå•å‘é“¾è¡¨ï¼ŒåŒå‘é“¾è¡¨æ›´å…·çµæ´»æ€§ï¼Œå¯ä»¥æœä¸¤ä¸ªæ–¹å‘éå†é“¾è¡¨ï¼Œä½†ç›¸åº”åœ°ä¹Ÿéœ€è¦å ç”¨æ›´å¤šçš„å†…å­˜ç©ºé—´ã€‚</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åŒå‘é“¾è¡¨èŠ‚ç‚¹ç±» */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ListNode</span> &#123;</span><br><span class="line">    <span class="type">int</span> val;        <span class="comment">// èŠ‚ç‚¹å€¼</span></span><br><span class="line">    ListNode next;  <span class="comment">// æŒ‡å‘åç»§èŠ‚ç‚¹çš„å¼•ç”¨</span></span><br><span class="line">    ListNode prev;  <span class="comment">// æŒ‡å‘å‰é©±èŠ‚ç‚¹çš„å¼•ç”¨</span></span><br><span class="line">    ListNode(<span class="type">int</span> x) &#123; val = x; &#125;  <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://www.hello-algo.com/chapter_array_and_linkedlist/linked_list.assets/linkedlist_common_types.png"></p><hr><h3 id="4-3-åˆ—è¡¨"><a href="#4-3-åˆ—è¡¨" class="headerlink" title="4.3 åˆ—è¡¨"></a>4.3 åˆ—è¡¨</h3><p>ã€ŒåŠ¨æ€æ•°ç»„ <code>dynamic array</code>ã€æ˜¯é•¿åº¦å¯å˜çš„æ•°ç»„ï¼Œä¹Ÿå¸¸è¢«ç§°ä¸ºã€Œåˆ—è¡¨ <code>list</code>ã€ã€‚å®ƒåŸºäºæ•°ç»„å®ç°ï¼Œç»§æ‰¿äº†æ•°ç»„çš„ä¼˜ç‚¹ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€æ‰©å®¹ã€‚å¯ä»¥åœ¨åˆ—è¡¨ä¸­è‡ªç”±åœ°æ·»åŠ å…ƒç´ ï¼Œè€Œæ— é¡»æ‹…å¿ƒè¶…è¿‡å®¹é‡é™åˆ¶ã€‚</p><h4 id="åˆ—è¡¨å¸¸ç”¨æ“ä½œ"><a href="#åˆ—è¡¨å¸¸ç”¨æ“ä½œ" class="headerlink" title="åˆ—è¡¨å¸¸ç”¨æ“ä½œ"></a>åˆ—è¡¨å¸¸ç”¨æ“ä½œ</h4><p>ï¼ˆ1ï¼‰åˆå§‹åŒ–åˆ—è¡¨</p><p>å¯ä»¥ä½¿ç”¨â€œæ— åˆå§‹å€¼â€å’Œâ€œæœ‰åˆå§‹å€¼â€è¿™ä¸¤ç§åˆå§‹åŒ–æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åˆå§‹åŒ–åˆ—è¡¨ */</span></span><br><span class="line"><span class="comment">// æ— åˆå§‹å€¼</span></span><br><span class="line">List&lt;Integer&gt; list1 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"><span class="comment">// æœ‰åˆå§‹å€¼ï¼ˆæ³¨æ„æ•°ç»„çš„å…ƒç´ ç±»å‹éœ€ä¸º int[] çš„åŒ…è£…ç±» Integer[]ï¼‰</span></span><br><span class="line">Integer[] numbers = <span class="keyword">new</span> <span class="title class_">Integer</span>[] &#123; <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">4</span> &#125;;</span><br><span class="line">List&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(Arrays.asList(numbers));</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰è®¿é—®å…ƒç´ </p><p>åˆ—è¡¨æœ¬è´¨ä¸Šæ˜¯æ•°ç»„ï¼Œå› æ­¤å¯ä»¥åœ¨<code>O(1)</code>æ—¶é—´å†…è®¿é—®å’Œæ›´æ–°å…ƒç´ ï¼Œæ•ˆç‡å¾ˆé«˜ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* è®¿é—®å…ƒç´  */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> list.get(<span class="number">1</span>);  <span class="comment">// è®¿é—®ç´¢å¼• 1 å¤„çš„å…ƒç´ </span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ›´æ–°å…ƒç´  */</span></span><br><span class="line">list.set(<span class="number">1</span>, <span class="number">0</span>);  <span class="comment">// å°†ç´¢å¼• 1 å¤„çš„å…ƒç´ æ›´æ–°ä¸º 0</span></span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰æ’å…¥ä¸åˆ é™¤å…ƒç´ </p><p>ç›¸è¾ƒäºæ•°ç»„ï¼Œåˆ—è¡¨å¯ä»¥è‡ªç”±åœ°æ·»åŠ ä¸åˆ é™¤å…ƒç´ ã€‚åœ¨åˆ—è¡¨å°¾éƒ¨æ·»åŠ å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸º<code>O(1)</code>ï¼Œä½†æ’å…¥å’Œåˆ é™¤å…ƒç´ çš„æ•ˆç‡ä»ä¸æ•°ç»„ç›¸åŒï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<code>O(n)</code>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æ¸…ç©ºåˆ—è¡¨ */</span></span><br><span class="line">list.clear();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å°¾éƒ¨æ·»åŠ å…ƒç´  */</span></span><br><span class="line">list.add(<span class="number">1</span>);</span><br><span class="line">list.add(<span class="number">3</span>);</span><br><span class="line">list.add(<span class="number">2</span>);</span><br><span class="line">list.add(<span class="number">5</span>);</span><br><span class="line">list.add(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä¸­é—´æ’å…¥å…ƒç´  */</span></span><br><span class="line">list.add(<span class="number">3</span>, <span class="number">6</span>);  <span class="comment">// åœ¨ç´¢å¼• 3 å¤„æ’å…¥æ•°å­— 6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* åˆ é™¤å…ƒç´  */</span></span><br><span class="line">list.remove(<span class="number">3</span>);  <span class="comment">// åˆ é™¤ç´¢å¼• 3 å¤„çš„å…ƒç´ </span></span><br></pre></td></tr></table></figure><p>ï¼ˆ4ï¼‰éå†åˆ—è¡¨</p><p>ä¸æ•°ç»„ä¸€æ ·ï¼Œåˆ—è¡¨å¯ä»¥æ ¹æ®ç´¢å¼•éå†ï¼Œä¹Ÿå¯ä»¥ç›´æ¥éå†å„å…ƒç´ ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* é€šè¿‡ç´¢å¼•éå†åˆ—è¡¨ */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; list.size(); i++) &#123;</span><br><span class="line">    count++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ç›´æ¥éå†åˆ—è¡¨å…ƒç´  */</span></span><br><span class="line">count = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> n : list) &#123;</span><br><span class="line">    count++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ5ï¼‰æ‹¼æ¥åˆ—è¡¨</p><p>ç»™å®šä¸€ä¸ªæ–°åˆ—è¡¨<code>list1</code>ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯¥åˆ—è¡¨æ‹¼æ¥åˆ°åŸåˆ—è¡¨çš„å°¾éƒ¨ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æ‹¼æ¥ä¸¤ä¸ªåˆ—è¡¨ */</span></span><br><span class="line">List&lt;Integer&gt; list1 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(Arrays.asList(<span class="keyword">new</span> <span class="title class_">Integer</span>[] &#123; <span class="number">6</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">9</span> &#125;));</span><br><span class="line">list.addAll(list1);  <span class="comment">// å°†åˆ—è¡¨ list1 æ‹¼æ¥åˆ° list ä¹‹å</span></span><br></pre></td></tr></table></figure><p>ï¼ˆ6ï¼‰æ’åºåˆ—è¡¨</p><p>å®Œæˆåˆ—è¡¨æ’åºåï¼Œä¾¿å¯ä»¥ä½¿ç”¨åœ¨æ•°ç»„ç±»ç®—æ³•é¢˜ä¸­ç»å¸¸è€ƒå¯Ÿçš„â€œäºŒåˆ†æŸ¥æ‰¾â€å’Œâ€œåŒæŒ‡é’ˆâ€ç®—æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* æ’åºåˆ—è¡¨ */</span></span><br><span class="line">Collections.sort(list);  <span class="comment">// æ’åºåï¼Œåˆ—è¡¨å…ƒç´ ä»å°åˆ°å¤§æ’åˆ—</span></span><br></pre></td></tr></table></figure><hr><h2 id="5-æ ˆä¸é˜Ÿåˆ—"><a href="#5-æ ˆä¸é˜Ÿåˆ—" class="headerlink" title="5. æ ˆä¸é˜Ÿåˆ—"></a>5. æ ˆä¸é˜Ÿåˆ—</h2><h3 id="5-1-æ ˆ"><a href="#5-1-æ ˆ" class="headerlink" title="5.1 æ ˆ"></a>5.1 æ ˆ</h3><p>ã€Œæ ˆ <code>stack</code>ã€æ˜¯ä¸€ç§éµå¾ªå…ˆå…¥åå‡º<code>First Inï¼ŒLast Out</code>çš„é€»è¾‘çš„çº¿æ€§æ•°æ®ç»“æ„ã€‚æˆ‘ä»¬å¯ä»¥å°†æ ˆç±»æ¯”ä¸ºæ¡Œé¢ä¸Šçš„ä¸€æ‘ç›˜å­ï¼Œ<ins>å¦‚æœéœ€è¦æ‹¿å‡ºåº•éƒ¨çš„ç›˜å­ï¼Œåˆ™éœ€è¦å…ˆå°†ä¸Šé¢çš„ç›˜å­ä¾æ¬¡å–å‡º</ins>ã€‚</p><p><img src="https://www.hello-algo.com/chapter_stack_and_queue/stack.assets/stack_operations.png"></p><h4 id="æ ˆå¸¸ç”¨æ“ä½œ"><a href="#æ ˆå¸¸ç”¨æ“ä½œ" class="headerlink" title="æ ˆå¸¸ç”¨æ“ä½œ"></a>æ ˆå¸¸ç”¨æ“ä½œ</h4><p>æ ˆçš„å¸¸ç”¨æ“ä½œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œå…·ä½“çš„æ–¹æ³•åéœ€è¦æ ¹æ®æ‰€ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€æ¥ç¡®å®šã€‚æˆ‘ä»¬ä»¥å¸¸è§çš„<code>push()</code>ã€<code>pop()</code>ã€<code>peek()</code>å‘½åä¸ºä¾‹ã€‚</p><table><thead><tr><th align="left">æ–¹æ³•</th><th align="left">æè¿°</th><th align="left">æ—¶é—´å¤æ‚åº¦</th></tr></thead><tbody><tr><td align="left"><code>push()</code></td><td align="left">å…ƒç´ å…¥æ ˆï¼ˆæ·»åŠ è‡³æ ˆé¡¶ï¼‰</td><td align="left"><code>O(1)</code></td></tr><tr><td align="left"><code>pop()</code></td><td align="left">æ ˆé¡¶å…ƒç´ å‡ºæ ˆ</td><td align="left"><code>O(1)</code></td></tr><tr><td align="left"><code>peek()</code></td><td align="left">è®¿é—®æ ˆé¡¶å…ƒç´ </td><td align="left"><code>O(1)</code></td></tr></tbody></table><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åˆå§‹åŒ–æ ˆ */</span></span><br><span class="line">Stack&lt;Integer&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å…ƒç´ å…¥æ ˆ */</span></span><br><span class="line">stack.push(<span class="number">1</span>);</span><br><span class="line">stack.push(<span class="number">3</span>);</span><br><span class="line">stack.push(<span class="number">2</span>);</span><br><span class="line">stack.push(<span class="number">5</span>);</span><br><span class="line">stack.push(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è®¿é—®æ ˆé¡¶å…ƒç´  */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">peek</span> <span class="operator">=</span> stack.peek();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å…ƒç´ å‡ºæ ˆ */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">pop</span> <span class="operator">=</span> stack.pop();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è·å–æ ˆçš„é•¿åº¦ */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> stack.size();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åˆ¤æ–­æ˜¯å¦ä¸ºç©º */</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">isEmpty</span> <span class="operator">=</span> stack.isEmpty();</span><br></pre></td></tr></table></figure><h4 id="æ ˆç®€å•å®ç°"><a href="#æ ˆç®€å•å®ç°" class="headerlink" title="æ ˆç®€å•å®ç°"></a>æ ˆç®€å•å®ç°</h4><p>æ ˆéµå¾ªå…ˆå…¥åå‡ºçš„åŸåˆ™ï¼Œå› æ­¤åªèƒ½åœ¨æ ˆé¡¶æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨é“¾è¡¨æ¥å®ç°æ ˆã€‚å°†é“¾è¡¨çš„å¤´èŠ‚ç‚¹è§†ä¸ºæ ˆé¡¶ï¼Œå°¾èŠ‚ç‚¹è§†ä¸ºæ ˆåº•ã€‚å¯¹äºå…¥æ ˆæ“ä½œï¼Œåªéœ€å°†å…ƒç´ æ’å…¥é“¾è¡¨å¤´éƒ¨ï¼Œè¿™ç§èŠ‚ç‚¹æ’å…¥æ–¹æ³•è¢«ç§°ä¸ºâ€œå¤´æ’æ³•â€ã€‚è€Œå¯¹äºå‡ºæ ˆæ“ä½œï¼Œåªéœ€å°†å¤´èŠ‚ç‚¹ä»é“¾è¡¨ä¸­åˆ é™¤å³å¯ã€‚</p><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1">LinkedListStack</button></li><li class="tab"><button type="button" data-href="#placeholder-2">push()</button></li><li class="tab"><button type="button" data-href="#placeholder-3">pop()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_stack_and_queue/stack.assets/linkedlist_stack.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_stack_and_queue/stack.assets/linkedlist_stack_push.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_stack_and_queue/stack.assets/linkedlist_stack_pop.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åŸºäºé“¾è¡¨å®ç°çš„æ ˆ */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LinkedListStack</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> ListNode stackPeek; <span class="comment">// å°†å¤´èŠ‚ç‚¹ä½œä¸ºæ ˆé¡¶</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">stkSize</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">// æ ˆçš„é•¿åº¦</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LinkedListStack</span><span class="params">()</span> &#123;</span><br><span class="line">        stackPeek = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è·å–æ ˆçš„é•¿åº¦ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stkSize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©º */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size() == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* å…¥æ ˆ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">node</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(num);</span><br><span class="line">        node.next = stackPeek;</span><br><span class="line">        stackPeek = node;</span><br><span class="line">        stkSize++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* å‡ºæ ˆ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> peek();</span><br><span class="line">        stackPeek = stackPeek.next;</span><br><span class="line">        stkSize--;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è®¿é—®æ ˆé¡¶å…ƒç´  */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">peek</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (size() == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IndexOutOfBoundsException</span>();</span><br><span class="line">        <span class="keyword">return</span> stackPeek.val;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* å°† List è½¬åŒ–ä¸º Array å¹¶è¿”å› */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] toArray() &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">node</span> <span class="operator">=</span> stackPeek;</span><br><span class="line">        <span class="type">int</span>[] res = <span class="keyword">new</span> <span class="title class_">int</span>[size()];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> res.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            res[i] = node.val;</span><br><span class="line">            node = node.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="5-2-é˜Ÿåˆ—"><a href="#5-2-é˜Ÿåˆ—" class="headerlink" title="5.2 é˜Ÿåˆ—"></a>5.2 é˜Ÿåˆ—</h3><p>ã€Œé˜Ÿåˆ— <code>queue</code>ã€æ˜¯ä¸€ç§éµå¾ªå…ˆå…¥å…ˆå‡º<code>First In, First Out</code>è§„åˆ™çš„çº¿æ€§æ•°æ®ç»“æ„ã€‚é¡¾åæ€ä¹‰ï¼Œ<ins>é˜Ÿåˆ—æ¨¡æ‹Ÿäº†æ’é˜Ÿç°è±¡ï¼Œå³æ–°æ¥çš„äººä¸æ–­åŠ å…¥é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œè€Œä½äºé˜Ÿåˆ—å¤´éƒ¨çš„äººé€ä¸ªç¦»å¼€</ins>ã€‚</p><p><img src="https://www.hello-algo.com/chapter_stack_and_queue/queue.assets/queue_operations.png"></p><h4 id="é˜Ÿåˆ—å¸¸ç”¨æ“ä½œ"><a href="#é˜Ÿåˆ—å¸¸ç”¨æ“ä½œ" class="headerlink" title="é˜Ÿåˆ—å¸¸ç”¨æ“ä½œ"></a>é˜Ÿåˆ—å¸¸ç”¨æ“ä½œ</h4><p>é˜Ÿåˆ—çš„å¸¸ç”¨æ“ä½œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œå…·ä½“çš„æ–¹æ³•åéœ€è¦æ ¹æ®æ‰€ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€æ¥ç¡®å®šã€‚æˆ‘ä»¬ä»¥å¸¸è§çš„<code>push()</code>ã€<code>pop()</code>ã€<code>peek()</code>å‘½åä¸ºä¾‹ã€‚</p><table><thead><tr><th align="left">æ–¹æ³•</th><th align="left">æè¿°</th><th align="left">æ—¶é—´å¤æ‚åº¦</th></tr></thead><tbody><tr><td align="left"><code>push()</code></td><td align="left">å…ƒç´ å…¥é˜Ÿï¼Œå³å°†å…ƒç´ æ·»åŠ è‡³é˜Ÿå°¾</td><td align="left"><code>O(1)</code></td></tr><tr><td align="left"><code>pop()</code></td><td align="left">é˜Ÿé¦–å…ƒç´ å‡ºé˜Ÿ</td><td align="left"><code>O(1)</code></td></tr><tr><td align="left"><code>peek()</code></td><td align="left">è®¿é—®é˜Ÿé¦–å…ƒç´ </td><td align="left"><code>O(1)</code></td></tr></tbody></table><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åˆå§‹åŒ–é˜Ÿåˆ— */</span></span><br><span class="line">Queue&lt;Integer&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å…ƒç´ å…¥é˜Ÿ */</span></span><br><span class="line">queue.offer(<span class="number">1</span>);</span><br><span class="line">queue.offer(<span class="number">3</span>);</span><br><span class="line">queue.offer(<span class="number">2</span>);</span><br><span class="line">queue.offer(<span class="number">5</span>);</span><br><span class="line">queue.offer(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è®¿é—®é˜Ÿé¦–å…ƒç´  */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">peek</span> <span class="operator">=</span> queue.peek();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å…ƒç´ å‡ºé˜Ÿ */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">pop</span> <span class="operator">=</span> queue.poll();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è·å–é˜Ÿåˆ—çš„é•¿åº¦ */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> queue.size();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º */</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">isEmpty</span> <span class="operator">=</span> queue.isEmpty();</span><br></pre></td></tr></table></figure><h4 id="é˜Ÿåˆ—ç®€å•å®ç°"><a href="#é˜Ÿåˆ—ç®€å•å®ç°" class="headerlink" title="é˜Ÿåˆ—ç®€å•å®ç°"></a>é˜Ÿåˆ—ç®€å•å®ç°</h4><p>ä¸ºäº†å®ç°é˜Ÿåˆ—ï¼Œéœ€è¦ä¸€ç§æ•°æ®ç»“æ„ï¼Œå¯ä»¥åœ¨ä¸€ç«¯æ·»åŠ å…ƒç´ ï¼Œå¹¶åœ¨å¦ä¸€ç«¯åˆ é™¤å…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨é“¾è¡¨æ¥å®ç°é˜Ÿåˆ—ã€‚å°†é“¾è¡¨çš„â€œå¤´èŠ‚ç‚¹â€å’Œâ€œå°¾èŠ‚ç‚¹â€åˆ†åˆ«è§†ä¸ºâ€œé˜Ÿé¦–â€å’Œâ€œé˜Ÿå°¾â€ï¼Œè§„å®šé˜Ÿå°¾ä»…å¯æ·»åŠ èŠ‚ç‚¹ï¼Œé˜Ÿé¦–ä»…å¯åˆ é™¤èŠ‚ç‚¹ã€‚</p><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1">LinkedListQueue</button></li><li class="tab"><button type="button" data-href="#placeholder-2">push()</button></li><li class="tab"><button type="button" data-href="#placeholder-3">pop()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_stack_and_queue/queue.assets/linkedlist_queue.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_stack_and_queue/queue.assets/linkedlist_queue_push.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_stack_and_queue/queue.assets/linkedlist_queue_pop.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åŸºäºé“¾è¡¨å®ç°çš„é˜Ÿåˆ— */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LinkedListQueue</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> ListNode front, rear; <span class="comment">// å¤´èŠ‚ç‚¹ front ï¼Œå°¾èŠ‚ç‚¹ rear</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">queSize</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LinkedListQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        front = <span class="literal">null</span>;</span><br><span class="line">        rear = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è·å–é˜Ÿåˆ—çš„é•¿åº¦ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queSize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size() == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* å…¥é˜Ÿ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="comment">// å°¾èŠ‚ç‚¹åæ·»åŠ  num</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">node</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(num);</span><br><span class="line">        <span class="comment">// å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™ä»¤å¤´ã€å°¾èŠ‚ç‚¹éƒ½æŒ‡å‘è¯¥èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (front == <span class="literal">null</span>) &#123;</span><br><span class="line">            front = node;</span><br><span class="line">            rear = node;</span><br><span class="line">        <span class="comment">// å¦‚æœé˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œåˆ™å°†è¯¥èŠ‚ç‚¹æ·»åŠ åˆ°å°¾èŠ‚ç‚¹å</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            rear.next = node;</span><br><span class="line">            rear = node;</span><br><span class="line">        &#125;</span><br><span class="line">        queSize++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* å‡ºé˜Ÿ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> peek();</span><br><span class="line">        <span class="comment">// åˆ é™¤å¤´èŠ‚ç‚¹</span></span><br><span class="line">        front = front.next;</span><br><span class="line">        queSize--;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è®¿é—®é˜Ÿé¦–å…ƒç´  */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">peek</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (size() == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IndexOutOfBoundsException</span>();</span><br><span class="line">        <span class="keyword">return</span> front.val;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* å°†é“¾è¡¨è½¬åŒ–ä¸º Array å¹¶è¿”å› */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] toArray() &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">node</span> <span class="operator">=</span> front;</span><br><span class="line">        <span class="type">int</span>[] res = <span class="keyword">new</span> <span class="title class_">int</span>[size()];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; res.length; i++) &#123;</span><br><span class="line">            res[i] = node.val;</span><br><span class="line">            node = node.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="5-3-åŒå‘é˜Ÿåˆ—"><a href="#5-3-åŒå‘é˜Ÿåˆ—" class="headerlink" title="5.3 åŒå‘é˜Ÿåˆ—"></a>5.3 åŒå‘é˜Ÿåˆ—</h3><p>åœ¨é˜Ÿåˆ—ä¸­ï¼Œæˆ‘ä»¬ä»…èƒ½åœ¨å¤´éƒ¨åˆ é™¤æˆ–åœ¨å°¾éƒ¨æ·»åŠ å…ƒç´ ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œã€ŒåŒå‘é˜Ÿåˆ— <code>deque</code>ã€æä¾›äº†æ›´é«˜çš„çµæ´»æ€§ï¼Œ<ins>å…è®¸åœ¨å¤´éƒ¨å’Œå°¾éƒ¨æ‰§è¡Œå…ƒç´ çš„æ·»åŠ æˆ–åˆ é™¤æ“ä½œ</ins>ã€‚</p><p><img src="https://www.hello-algo.com/chapter_stack_and_queue/deque.assets/deque_operations.png"></p><h4 id="åŒå‘é˜Ÿåˆ—å¸¸ç”¨æ“ä½œ"><a href="#åŒå‘é˜Ÿåˆ—å¸¸ç”¨æ“ä½œ" class="headerlink" title="åŒå‘é˜Ÿåˆ—å¸¸ç”¨æ“ä½œ"></a>åŒå‘é˜Ÿåˆ—å¸¸ç”¨æ“ä½œ</h4><p>åŒå‘é˜Ÿåˆ—çš„å¸¸ç”¨æ“ä½œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><table><thead><tr><th align="left">æ–¹æ³•</th><th align="left">æè¿°</th><th align="left">æ—¶é—´å¤æ‚åº¦</th></tr></thead><tbody><tr><td align="left"><code>pushFirst()</code></td><td align="left">å°†å…ƒç´ æ·»åŠ è‡³é˜Ÿé¦–</td><td align="left"><code>O(1)</code></td></tr><tr><td align="left"><code>pushLast()</code></td><td align="left">å°†å…ƒç´ æ·»åŠ è‡³é˜Ÿå°¾</td><td align="left"><code>O(1)</code></td></tr><tr><td align="left"><code>popFirst()</code></td><td align="left">åˆ é™¤é˜Ÿé¦–å…ƒç´ </td><td align="left"><code>O(1)</code></td></tr><tr><td align="left"><code>popLast()</code></td><td align="left">åˆ é™¤é˜Ÿå°¾å…ƒç´ </td><td align="left"><code>O(1)</code></td></tr><tr><td align="left"><code>peekFirst()</code></td><td align="left">è®¿é—®é˜Ÿé¦–å…ƒç´ </td><td align="left"><code>O(1)</code></td></tr><tr><td align="left"><code>peekLast()</code></td><td align="left">è®¿é—®é˜Ÿå°¾å…ƒç´ </td><td align="left"><code>O(1)</code></td></tr></tbody></table><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åˆå§‹åŒ–åŒå‘é˜Ÿåˆ— */</span></span><br><span class="line">Deque&lt;Integer&gt; deque = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å…ƒç´ å…¥é˜Ÿ */</span></span><br><span class="line">deque.offerLast(<span class="number">2</span>);   <span class="comment">// æ·»åŠ è‡³é˜Ÿå°¾</span></span><br><span class="line">deque.offerLast(<span class="number">5</span>);</span><br><span class="line">deque.offerLast(<span class="number">4</span>);</span><br><span class="line">deque.offerFirst(<span class="number">3</span>);  <span class="comment">// æ·»åŠ è‡³é˜Ÿé¦–</span></span><br><span class="line">deque.offerFirst(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è®¿é—®å…ƒç´  */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">peekFirst</span> <span class="operator">=</span> deque.peekFirst();  <span class="comment">// é˜Ÿé¦–å…ƒç´ </span></span><br><span class="line"><span class="type">int</span> <span class="variable">peekLast</span> <span class="operator">=</span> deque.peekLast();    <span class="comment">// é˜Ÿå°¾å…ƒç´ </span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* å…ƒç´ å‡ºé˜Ÿ */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">popFirst</span> <span class="operator">=</span> deque.pollFirst();  <span class="comment">// é˜Ÿé¦–å…ƒç´ å‡ºé˜Ÿ</span></span><br><span class="line"><span class="type">int</span> <span class="variable">popLast</span> <span class="operator">=</span> deque.pollLast();    <span class="comment">// é˜Ÿå°¾å…ƒç´ å‡ºé˜Ÿ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* è·å–åŒå‘é˜Ÿåˆ—çš„é•¿åº¦ */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> deque.size();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åˆ¤æ–­åŒå‘é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º */</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">isEmpty</span> <span class="operator">=</span> deque.isEmpty();</span><br></pre></td></tr></table></figure><h4 id="åŒå‘é˜Ÿåˆ—ç®€å•å®ç°"><a href="#åŒå‘é˜Ÿåˆ—ç®€å•å®ç°" class="headerlink" title="åŒå‘é˜Ÿåˆ—ç®€å•å®ç°"></a>åŒå‘é˜Ÿåˆ—ç®€å•å®ç°</h4><p>å¯¹äºåŒå‘é˜Ÿåˆ—è€Œè¨€ï¼Œå¤´éƒ¨å’Œå°¾éƒ¨éƒ½å¯ä»¥æ‰§è¡Œå…¥é˜Ÿå’Œå‡ºé˜Ÿæ“ä½œã€‚æ¢å¥è¯è¯´ï¼ŒåŒå‘é˜Ÿåˆ—éœ€è¦å®ç°å¦ä¸€ä¸ªå¯¹ç§°æ–¹å‘çš„æ“ä½œã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é‡‡ç”¨â€œåŒå‘é“¾è¡¨â€ä½œä¸ºåŒå‘é˜Ÿåˆ—çš„åº•å±‚æ•°æ®ç»“æ„ã€‚</p><div class="tabs" id="placeholder"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#placeholder-1">LinkedListDeque</button></li><li class="tab"><button type="button" data-href="#placeholder-2">pushLast()</button></li><li class="tab"><button type="button" data-href="#placeholder-3">pushFirst()</button></li><li class="tab"><button type="button" data-href="#placeholder-4">popLast()</button></li><li class="tab"><button type="button" data-href="#placeholder-5">popFirst()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="placeholder-1"><p><img src="https://www.hello-algo.com/chapter_stack_and_queue/deque.assets/linkedlist_deque.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-2"><p><img src="https://www.hello-algo.com/chapter_stack_and_queue/deque.assets/linkedlist_deque_push_last.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-3"><p><img src="https://www.hello-algo.com/chapter_stack_and_queue/deque.assets/linkedlist_deque_push_first.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-4"><p><img src="https://www.hello-algo.com/chapter_stack_and_queue/deque.assets/linkedlist_deque_pop_last.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="placeholder-5"><p><img src="https://www.hello-algo.com/chapter_stack_and_queue/deque.assets/linkedlist_deque_pop_first.png"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>ç”±äºå®ç°æ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œæš‚æ—¶ä¸è®°å®ç°æ–¹æ³•ã€‚</p><hr><h2 id="6-å“ˆå¸Œè¡¨"><a href="#6-å“ˆå¸Œè¡¨" class="headerlink" title="6. å“ˆå¸Œè¡¨"></a>6. å“ˆå¸Œè¡¨</h2><h3 id="6-1-å“ˆå¸Œè¡¨"><a href="#6-1-å“ˆå¸Œè¡¨" class="headerlink" title="6.1 å“ˆå¸Œè¡¨"></a>6.1 å“ˆå¸Œè¡¨</h3><p>ã€Œå“ˆå¸Œè¡¨ <code>hash table</code>ã€ï¼Œé€šè¿‡å»ºç«‹é”®<code>key</code>ä¸å€¼<code>value</code>ä¹‹é—´çš„æ˜ å°„ï¼Œå®ç°é«˜æ•ˆçš„å…ƒç´ æŸ¥è¯¢ã€‚ç®€å•æ¥è¯´ï¼Œå‘å“ˆå¸Œè¡¨è¾“å…¥ä¸€ä¸ªé”®<code>key</code>ï¼Œå°±å¯ä»¥åœ¨<code>O(1)</code>æ—¶é—´å†…è·å–å¯¹åº”çš„å€¼<code>value</code>ã€‚</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç»™å®š<code>n</code>ä¸ªå­¦ç”Ÿï¼Œæ¯ä¸ªå­¦ç”Ÿéƒ½æœ‰â€œå§“åâ€å’Œâ€œå­¦å·â€ä¸¤é¡¹æ•°æ®ã€‚å‡å¦‚æˆ‘ä»¬å¸Œæœ›å®ç°â€œè¾“å…¥ä¸€ä¸ªå­¦å·ï¼Œè¿”å›å¯¹åº”çš„å§“åâ€çš„æŸ¥è¯¢åŠŸèƒ½ï¼Œåˆ™å¯ä»¥é‡‡ç”¨ä¸‹å›¾æ‰€ç¤ºçš„å“ˆå¸Œè¡¨æ¥å®ç°ã€‚</p><p><img src="https://www.hello-algo.com/chapter_hashing/hash_map.assets/hash_table_lookup.png"></p><p>é™¤å“ˆå¸Œè¡¨å¤–ï¼Œæ•°ç»„å’Œé“¾è¡¨ä¹Ÿå¯ä»¥å®ç°æŸ¥è¯¢åŠŸèƒ½ï¼Œå®ƒä»¬çš„æ•ˆç‡å¯¹æ¯”å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><table><thead><tr><th align="left"></th><th align="left">æ•°ç»„</th><th align="left">é“¾è¡¨</th><th align="left">å“ˆå¸Œè¡¨</th></tr></thead><tbody><tr><td align="left">æŸ¥æ‰¾å…ƒç´ </td><td align="left"><code>O(n)</code></td><td align="left"><code>O(n)</code></td><td align="left"><code>O(1)</code></td></tr><tr><td align="left">æ·»åŠ å…ƒç´ </td><td align="left"><code>O(1)</code></td><td align="left"><code>O(1)</code></td><td align="left"><code>O(1)</code></td></tr><tr><td align="left">åˆ é™¤å…ƒç´ </td><td align="left"><code>O(n)</code></td><td align="left"><code>O(n)</code></td><td align="left"><code>O(1)</code></td></tr></tbody></table><p>è§‚å¯Ÿå‘ç°ï¼Œåœ¨å“ˆå¸Œè¡¨ä¸­è¿›è¡Œå¢åˆ æŸ¥æ”¹çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯<code>O(1)</code>ï¼Œéå¸¸é«˜æ•ˆã€‚</p><h4 id="å“ˆå¸Œè¡¨å¸¸ç”¨æ“ä½œ"><a href="#å“ˆå¸Œè¡¨å¸¸ç”¨æ“ä½œ" class="headerlink" title="å“ˆå¸Œè¡¨å¸¸ç”¨æ“ä½œ"></a>å“ˆå¸Œè¡¨å¸¸ç”¨æ“ä½œ</h4><p>å“ˆå¸Œè¡¨çš„å¸¸è§æ“ä½œåŒ…æ‹¬ï¼Œåˆå§‹åŒ–ã€æŸ¥è¯¢æ“ä½œ<code>get(key)</code>ã€æ·»åŠ é”®å€¼å¯¹<code>put(key, value)</code>å’Œåˆ é™¤é”®å€¼å¯¹<code>remove(key)</code>ç­‰ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* åˆå§‹åŒ–å“ˆå¸Œè¡¨ */</span></span><br><span class="line">Map&lt;Integer, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ·»åŠ æ“ä½œ */</span></span><br><span class="line"><span class="comment">// åœ¨å“ˆå¸Œè¡¨ä¸­æ·»åŠ é”®å€¼å¯¹ (key, value)</span></span><br><span class="line">map.put(<span class="number">12836</span>, <span class="string">&quot;å°å“ˆ&quot;</span>);</span><br><span class="line">map.put(<span class="number">15937</span>, <span class="string">&quot;å°å•°&quot;</span>);</span><br><span class="line">map.put(<span class="number">16750</span>, <span class="string">&quot;å°ç®—&quot;</span>);</span><br><span class="line">map.put(<span class="number">13276</span>, <span class="string">&quot;å°æ³•&quot;</span>);</span><br><span class="line">map.put(<span class="number">10583</span>, <span class="string">&quot;å°é¸­&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æŸ¥è¯¢æ“ä½œ */</span></span><br><span class="line"><span class="comment">// å‘å“ˆå¸Œè¡¨è¾“å…¥é”® key ï¼Œå¾—åˆ°å€¼ value</span></span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> map.get(<span class="number">15937</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åˆ é™¤æ“ä½œ */</span></span><br><span class="line"><span class="comment">// åœ¨å“ˆå¸Œè¡¨ä¸­åˆ é™¤é”®å€¼å¯¹ (key, value)</span></span><br><span class="line">map.remove(<span class="number">10583</span>);</span><br></pre></td></tr></table></figure><p>å“ˆå¸Œè¡¨æœ‰ä¸‰ç§å¸¸ç”¨éå†æ–¹å¼ï¼Œéå†é”®å€¼å¯¹ã€éå†é”®å’Œéå†å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* éå†å“ˆå¸Œè¡¨ */</span></span><br><span class="line"><span class="comment">// éå†é”®å€¼å¯¹ key-&gt;value</span></span><br><span class="line"><span class="keyword">for</span> (Map.Entry &lt;Integer, String&gt; kv: map.entrySet()) &#123;</span><br><span class="line">    System.out.println(kv.getKey() + <span class="string">&quot; -&gt; &quot;</span> + kv.getValue());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å•ç‹¬éå†é”® key</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> key: map.keySet()) &#123;</span><br><span class="line">    System.out.println(key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å•ç‹¬éå†å€¼ value</span></span><br><span class="line"><span class="keyword">for</span> (String val: map.values()) &#123;</span><br><span class="line">    System.out.println(val);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å“ˆå¸Œè¡¨ç®€å•å®ç°"><a href="#å“ˆå¸Œè¡¨ç®€å•å®ç°" class="headerlink" title="å“ˆå¸Œè¡¨ç®€å•å®ç°"></a>å“ˆå¸Œè¡¨ç®€å•å®ç°</h4><p>æˆ‘ä»¬å¯ä»¥ç”¨æ•°ç»„æ¥å®ç°å“ˆå¸Œè¡¨ã€‚åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªç©ºä½ç§°ä¸ºã€Œæ¡¶ <code>bucket</code>ã€ï¼Œæ¯ä¸ªæ¡¶å¯å­˜å‚¨ä¸€ä¸ªé”®å€¼å¯¹ã€‚å› æ­¤ï¼ŒæŸ¥è¯¢æ“ä½œå°±æ˜¯æ‰¾åˆ°<code>key</code>å¯¹åº”çš„æ¡¶ï¼Œå¹¶åœ¨æ¡¶ä¸­è·å–<code>value</code>ã€‚</p><p>é‚£æ€ä¹ˆåŸºäº<code>key</code>æ¥å®šä½å¯¹åº”çš„æ¡¶å‘¢ï¼Ÿè¿™æ˜¯é€šè¿‡ã€Œå“ˆå¸Œå‡½æ•° <code>hash function</code>ã€å®ç°çš„ã€‚åœ¨å“ˆå¸Œè¡¨ä¸­è¾“å…¥ä¸€ä¸ª<code>key</code>ï¼Œå¯ä»¥é€šè¿‡å“ˆå¸Œå‡½æ•°å¾—åˆ°è¯¥<code>key</code>å¯¹åº”çš„é”®å€¼å¯¹åœ¨æ•°ç»„ä¸­çš„å­˜å‚¨ä½ç½®ã€‚è®¡ç®—è¿‡ç¨‹åˆ†ä¸ºä¸¤æ­¥ã€‚</p><ul><li>é€šè¿‡æŸç§å“ˆå¸Œç®—æ³•<code>hash()</code>è®¡ç®—å¾—åˆ°å“ˆå¸Œå€¼ã€‚</li><li>å°†å“ˆå¸Œå€¼å¯¹æ¡¶æ•°é‡ï¼ˆæ•°ç»„é•¿åº¦ï¼‰<code>capacity</code>å–æ¨¡ï¼Œä»è€Œè·å–è¯¥<code>key</code>å¯¹åº”çš„æ•°ç»„ç´¢å¼•<code>index</code>ã€‚</li></ul><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">index = hash(key) % capacity</span><br></pre></td></tr></table></figure><p>éšåï¼Œå°±å¯ä»¥åˆ©ç”¨<code>index</code>åœ¨å“ˆå¸Œè¡¨ä¸­è®¿é—®å¯¹åº”çš„æ¡¶ï¼Œä»è€Œè·å–<code>value</code>ã€‚</p><p>è®¾æ•°ç»„é•¿åº¦<code>capacity = 100</code>ã€å“ˆå¸Œç®—æ³•<code>hash(key) = key</code>ï¼Œå“ˆå¸Œå‡½æ•°ä¸º<code>key % 100</code>ã€‚ä¸‹å›¾ä»¥<code>key</code>å­¦å·å’Œ<code>value</code>å§“åä¸ºä¾‹ï¼Œå±•ç¤ºäº†å“ˆå¸Œå‡½æ•°çš„å·¥ä½œåŸç†ã€‚</p><p><img src="https://www.hello-algo.com/chapter_hashing/hash_map.assets/hash_function.png"></p><p>ä¸‹é¢ä»£ç å®ç°äº†ä¸€ä¸ªç®€å•å“ˆå¸Œè¡¨ã€‚å°†<code>key</code>å’Œ<code>value</code>å°è£…æˆä¸€ä¸ªç±»<code>Pair</code>ï¼Œä»¥è¡¨ç¤ºé”®å€¼å¯¹ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* é”®å€¼å¯¹ */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Pair</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> key;</span><br><span class="line">    <span class="keyword">public</span> String val;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Pair</span><span class="params">(<span class="type">int</span> key, String val)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.key = key;</span><br><span class="line">        <span class="built_in">this</span>.val = val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åŸºäºæ•°ç»„ç®€æ˜“å®ç°çš„å“ˆå¸Œè¡¨ */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ArrayHashMap</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Pair&gt; buckets;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ArrayHashMap</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–æ•°ç»„ï¼ŒåŒ…å« 100 ä¸ªæ¡¶</span></span><br><span class="line">        buckets = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            buckets.add(<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* å“ˆå¸Œå‡½æ•° */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">hashFunc</span><span class="params">(<span class="type">int</span> key)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> key % <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">return</span> index;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æŸ¥è¯¢æ“ä½œ */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">get</span><span class="params">(<span class="type">int</span> key)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> hashFunc(key);</span><br><span class="line">        <span class="type">Pair</span> <span class="variable">pair</span> <span class="operator">=</span> buckets.get(index);</span><br><span class="line">        <span class="keyword">if</span> (pair == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">return</span> pair.val;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ·»åŠ æ“ä½œ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(<span class="type">int</span> key, String val)</span> &#123;</span><br><span class="line">        <span class="type">Pair</span> <span class="variable">pair</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Pair</span>(key, val);</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> hashFunc(key);</span><br><span class="line">        buckets.set(index, pair);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* åˆ é™¤æ“ä½œ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">(<span class="type">int</span> key)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> hashFunc(key);</span><br><span class="line">        <span class="comment">// ç½®ä¸º null ï¼Œä»£è¡¨åˆ é™¤</span></span><br><span class="line">        buckets.set(index, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è·å–æ‰€æœ‰é”®å€¼å¯¹ */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Pair&gt; <span class="title function_">pairSet</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Pair&gt; pairSet = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Pair pair : buckets) &#123;</span><br><span class="line">            <span class="keyword">if</span> (pair != <span class="literal">null</span>)</span><br><span class="line">                pairSet.add(pair);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pairSet;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è·å–æ‰€æœ‰é”® */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">keySet</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; keySet = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Pair pair : buckets) &#123;</span><br><span class="line">            <span class="keyword">if</span> (pair != <span class="literal">null</span>)</span><br><span class="line">                keySet.add(pair.key);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> keySet;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è·å–æ‰€æœ‰å€¼ */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">valueSet</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;String&gt; valueSet = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Pair pair : buckets) &#123;</span><br><span class="line">            <span class="keyword">if</span> (pair != <span class="literal">null</span>)</span><br><span class="line">                valueSet.add(pair.val);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> valueSet;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ‰“å°å“ˆå¸Œè¡¨ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (Pair kv : pairSet()) &#123;</span><br><span class="line">            System.out.println(kv.key + <span class="string">&quot; -&gt; &quot;</span> + kv.val);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å“ˆå¸Œå†²çªä¸æ‰©å®¹"><a href="#å“ˆå¸Œå†²çªä¸æ‰©å®¹" class="headerlink" title="å“ˆå¸Œå†²çªä¸æ‰©å®¹"></a>å“ˆå¸Œå†²çªä¸æ‰©å®¹</h4><p>æœ¬è´¨ä¸Šçœ‹ï¼Œå“ˆå¸Œå‡½æ•°çš„ä½œç”¨æ˜¯å°†æ‰€æœ‰<code>key</code>æ„æˆçš„è¾“å…¥ç©ºé—´æ˜ å°„åˆ°æ•°ç»„æ‰€æœ‰ç´¢å¼•æ„æˆçš„è¾“å‡ºç©ºé—´ï¼Œè€Œè¾“å…¥ç©ºé—´å¾€å¾€è¿œå¤§äºè¾“å‡ºç©ºé—´ã€‚å› æ­¤ï¼Œç†è®ºä¸Šä¸€å®šå­˜åœ¨â€œå¤šä¸ªè¾“å…¥å¯¹åº”ç›¸åŒè¾“å‡ºâ€çš„æƒ…å†µã€‚</p><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">12836 % 100 = 36</span><br><span class="line">20336 % 100 = 36</span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸¤ä¸ªå­¦å·æŒ‡å‘äº†åŒä¸€ä¸ªå§“åï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¯¹çš„ã€‚æˆ‘ä»¬å°†è¿™ç§å¤šä¸ªè¾“å…¥å¯¹åº”åŒä¸€è¾“å‡ºçš„æƒ…å†µç§°ä¸ºã€Œå“ˆå¸Œå†²çª <code>hash collision</code>ã€ã€‚</p><p><img src="https://www.hello-algo.com/chapter_hashing/hash_map.assets/hash_collision.png"></p><p>ç®€å•æ¥è¯´ï¼Œå¯ä»¥é€šè¿‡æ‰©å®¹å“ˆå¸Œè¡¨æ¥å‡å°‘å“ˆå¸Œå†²çªã€‚å› ä¸ºå“ˆå¸Œè¡¨å®¹é‡<code>n</code>è¶Šå¤§ï¼Œå¤šä¸ª<code>key</code>è¢«åˆ†é…åˆ°åŒä¸€ä¸ªæ¡¶ä¸­çš„æ¦‚ç‡å°±è¶Šä½ï¼Œå†²çªå°±è¶Šå°‘ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ‰©å®¹å‰é”®å€¼å¯¹<code>(136, A)</code>å’Œ<code>(236, D)</code>å‘ç”Ÿå†²çªï¼Œæ‰©å®¹åå†²çªæ¶ˆå¤±ã€‚</p><p><img src="https://www.hello-algo.com/chapter_hashing/hash_map.assets/hash_table_reshash.png"></p><p>ç±»ä¼¼äºæ•°ç»„æ‰©å®¹ï¼Œå“ˆå¸Œè¡¨æ‰©å®¹éœ€å°†æ‰€æœ‰é”®å€¼å¯¹ä»åŸå“ˆå¸Œè¡¨è¿ç§»è‡³æ–°å“ˆå¸Œè¡¨ï¼Œéå¸¸è€—æ—¶ã€‚å¹¶ä¸”ç”±äºå“ˆå¸Œè¡¨å®¹é‡<code>capacity</code>æ”¹å˜ï¼Œéœ€è¦é€šè¿‡å“ˆå¸Œå‡½æ•°æ¥é‡æ–°è®¡ç®—æ‰€æœ‰é”®å€¼å¯¹çš„å­˜å‚¨ä½ç½®ï¼Œè¿™è¿›ä¸€æ­¥æé«˜äº†æ‰©å®¹è¿‡ç¨‹çš„è®¡ç®—å¼€é”€ã€‚</p><p>ç”±äº<a href="https://www.hello-algo.com/chapter_hashing/hash_collision/">å“ˆå¸Œå†²çª</a>å’Œ<a href="https://www.hello-algo.com/chapter_hashing/hash_algorithm/">å“ˆå¸Œç®—æ³•</a>æ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œå°±ä¸åšè¿‡å¤šè§£é‡Šï¼Œå¯ä»¥è‡ªè¡Œé˜…è¯»ã€‚</p><hr><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><blockquote><p>æ–‡ä»¶è¿˜æœªä¸Šä¼  Github</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C# å…³é”®å­—è§£æ</title>
      <link href="/posts/cd5cb147.html"/>
      <url>/posts/cd5cb147.html</url>
      
        <content type="html"><![CDATA[<h2 id="C-ä¸­çš„å…³é”®å­—è§£æ"><a href="#C-ä¸­çš„å…³é”®å­—è§£æ" class="headerlink" title="C# ä¸­çš„å…³é”®å­—è§£æ"></a>C# ä¸­çš„å…³é”®å­—è§£æ</h2><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><blockquote><p>æœ€è¿‘åœ¨ä¸€ä¸ªåˆåˆ›å…¬å¸é‡Œåšå…¨æ ˆå¼€å‘ã€‚ä¸€å¼€å§‹ä»¥ä¸ºå»åš<code>ASP.NET</code>ï¼Œç»“æœå¾®ä¿¡å°ç¨‹åºå¼€å‘ç¼ºäººï¼ˆæ±—ï¼‰ã€‚åæ­£é—²ç€ä¹Ÿæ˜¯é—²ç€ï¼Œè¶è¿™ä¸ªæœºä¼šå­¦ä¹ ç‚¹<code>C#</code>ä¸­çš„åŸºç¡€çŸ¥è¯†ã€‚</p></blockquote><ul><li><p>ç»“åˆ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/">å¾®è½¯æ–‡æ¡£</a>ï¼Œå¯¹<code>C#</code>ä¸­çš„å…³é”®å­—è¿›è¡Œè§£æã€‚</p></li><li><p>æ–‡ç« ä¸­ï¼Œæ´¾ç”Ÿç±»é»˜è®¤ä¸ºå­ç±»ï¼ŒåŸºç±»é»˜è®¤ä¸ºçˆ¶ç±»ã€‚</p></li><li><p>éƒ¨åˆ†å¸¸è§å…³é”®å­—çœç•¥ï¼š<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/builtin-types/bool">bool</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/statements/jump-statements#the-break-statement">break</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/statements/selection-statements#the-switch-statement">case</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/builtin-types/char">char</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/const">const</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/statements/jump-statements#the-continue-statement">continue</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/default">default</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/statements/iteration-statements#the-do-statement">do</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/builtin-types/floating-point-numeric-types">double</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/statements/selection-statements#the-if-statement">else</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/builtin-types/bool">false</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/builtin-types/floating-point-numeric-types">float</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/statements/iteration-statements#the-for-statement">for</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/statements/selection-statements#the-if-statement">if</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/builtin-types/integral-numeric-types">int</a></p></li><li><p>ä¸å¸¸ç”¨å…³é”®å­—çœç•¥ï¼ˆæ„Ÿè§‰ä¸ä¼šç”¨åˆ°ï¼‰ï¼š<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/statements/checked-and-unchecked">checked</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/extern">extern</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/statements/fixed">fixed</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/statements/jump-statements#the-goto-statement">goto</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/operators/user-defined-conversion-operators">implicit</a>ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/in">in</a>ï¼Œ</p></li></ul><hr><h3 id="1-abstract-å…³é”®å­—"><a href="#1-abstract-å…³é”®å­—" class="headerlink" title="1. abstract å…³é”®å­—"></a>1. abstract å…³é”®å­—</h3><p>åœ¨<code>C#</code>ä¸­ï¼Œå…³é”®å­—<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/abstract"><code>abstract</code></a>ç”¨äº<ins>å£°æ˜æŠ½è±¡ç±»æˆ–ç±»ä¸­çš„æŠ½è±¡æˆå‘˜</ins>ã€‚</p><p>æŠ½è±¡ç±»ç‰¹ç‚¹ï¼š</p><ol><li>æŠ½è±¡ç±»ä¸èƒ½å®ä¾‹åŒ–ã€‚</li><li>æŠ½è±¡ç±»å¯èƒ½åŒ…å«æŠ½è±¡æˆå‘˜ï¼ˆæ–¹æ³•ã€å±æ€§ï¼‰å’ŒéæŠ½è±¡æˆå‘˜çš„å®ç°ã€‚</li><li>åªæœ‰æŠ½è±¡ç±»ä¸­æ‰å…è®¸æŠ½è±¡æ–¹æ³•å£°æ˜ã€‚</li><li>æŠ½è±¡ç±»ä¸èƒ½ä½¿ç”¨<code>new</code>å…³é”®å­—ã€‚</li><li>æŠ½è±¡ç±»é€šå¸¸ä½œä¸ºåŸºç±»è¢«å­ç±»ç»§æ‰¿ï¼Œå­ç±»å¿…é¡»ä½¿ç”¨<code>override</code>å®ç°æŠ½è±¡ç±»ä¸­å£°æ˜çš„æŠ½è±¡æˆå‘˜ã€‚</li></ol><p>æŠ½è±¡æ–¹æ³•ç‰¹ç‚¹ï¼š</p><ol><li>å‡¡æ˜¯åŒ…å«æŠ½è±¡æ–¹æ³•çš„ç±»éƒ½æ˜¯æŠ½è±¡ç±»ã€‚</li><li>æŠ½è±¡æ–¹æ³•å£°æ˜ä¸æä¾›å®é™…çš„å®ç°ï¼Œå› æ­¤æ²¡æœ‰æ–¹æ³•ä¸»ä½“ã€‚ï¼ˆæŠ½è±¡å±æ€§åŒç†ï¼‰</li><li>åœ¨æŠ½è±¡æ–¹æ³•å£°æ˜ä¸­ä¸èƒ½ä½¿ç”¨<code>static</code>æˆ–<code>virtual</code>å…³é”®å­—ã€‚<ul><li>æŠ½è±¡æ–¹æ³•æ²¡æœ‰å…·ä½“å®ç°ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨<code>static</code>å…³é”®å­—æ¥å£°æ˜ä¸ºé™æ€æ–¹æ³•ã€‚</li><li>æŠ½è±¡æ–¹æ³•æ˜¯éšå¼çš„è™šæ‹Ÿæ–¹æ³•ï¼Œæ‰€ä»¥ä¸éœ€è¦<code>virtual</code>å…³é”®å­—ã€‚</li></ul></li></ol><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><ul><li>æªï¼ˆæŠ½è±¡åŸºç±»ï¼‰æ˜¯å¯ä»¥ Shoot å’Œ Reload çš„ï¼ˆæŠ½è±¡æ–¹æ³•ï¼‰ã€‚</li><li>æ¯”å¦‚ AK47 å’Œ M4ï¼ˆéæŠ½è±¡ç±»å­ç±»ï¼‰ï¼Œå®ƒä»¬æ‹¥æœ‰ Shoot å’Œ Reload çš„åŠŸèƒ½ã€‚</li><li>ä½†å…·ä½“æ˜¯æ€ä¹ˆ Shoot å’Œ Reloadï¼ŒAK47 å’Œ M4 æ˜¯ä¸ä¸€æ ·çš„ï¼ˆå…·ä½“å®ç°ï¼‰ã€‚</li></ul><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŠ½è±¡ç±»ï¼šFirearms</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">Firearms</span></span><br><span class="line"> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">Shoot</span>()</span>; <span class="comment">// æŠ½è±¡æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">Reload</span>()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">Init</span>()</span> &#123;...&#125; <span class="comment">// éæŠ½è±¡æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="built_in">string</span> FireRate &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">// æŠ½è±¡å±æ€§</span></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å­ç±»ï¼šAK47</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AK47</span> : <span class="title">Firearms</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> fireRate;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Shoot</span>()</span> &#123;...&#125; <span class="comment">// å…·ä½“å®ç°</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Reload</span>()</span> &#123;...&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">override</span> <span class="built_in">string</span> FireRate</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> fireRate; &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; fireRate = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆè¦ç”¨æŠ½è±¡ç±»ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¸€èˆ¬ç±»æˆ–è€…æ¥å£<code>interface</code>ï¼Ÿ</p><ol><li>å…±äº«ä»£ç ï¼š<ins>æŠ½è±¡ç±»å¯ä»¥å®šä¹‰ä¸€ç»„ç›¸å…³ç±»çš„é€šç”¨è¡Œä¸ºå’Œå±æ€§ï¼Œå¹¶æä¾›é»˜è®¤çš„å®ç°ã€‚é€šè¿‡ç»§æ‰¿æŠ½è±¡ç±»ï¼Œå­ç±»å¯ä»¥ç»§æ‰¿å’Œé‡ç”¨æŠ½è±¡ç±»ä¸­çš„ä»£ç </ins>ï¼Œå‡å°‘ä»£ç çš„é‡å¤ç¼–å†™ã€‚è¿™æ ·å¯ä»¥æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚</li><li>ä»£ç æ‰©å±•æ€§ï¼šæŠ½è±¡ç±»å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•åœ¨æŠ½è±¡ç±»ä¸­æ²¡æœ‰å…·ä½“çš„å®ç°ã€‚é€šè¿‡ç»§æ‰¿æŠ½è±¡ç±»å¹¶å®ç°è¿™äº›æŠ½è±¡æ–¹æ³•ï¼Œå­ç±»å¯ä»¥åœ¨å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ä¸­å®ç°è‡ªå·±çš„ä»£ç ã€‚è¿™ç§æ–¹å¼ä½¿å¾—ä»£ç å…·æœ‰æ‰©å±•æ€§ï¼Œå¯ä»¥é€‚åº”æœªæ¥éœ€æ±‚çš„å˜åŒ–ã€‚</li><li>éƒ¨åˆ†å®ç°ï¼šæŠ½è±¡ç±»æ—¢å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥åŒ…å«å…·ä½“çš„å®ç°ã€‚è¿™ä½¿å¾—æŠ½è±¡ç±»å¯ä»¥æä¾›ä¸€äº›é»˜è®¤çš„è¡Œä¸ºï¼ŒåŒæ—¶ä¹Ÿç»™å­ç±»æä¾›äº†ä¸€å®šçš„çµæ´»æ€§ã€‚å­ç±»å¯ä»¥é€‰æ‹©æ€§åœ°è¦†ç›–æŠ½è±¡ç±»ä¸­çš„æ–¹æ³•ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨æŠ½è±¡ç±»ä¸­çš„å®ç°ã€‚</li><li>ï¼ˆå¾…è¡¥å……ï¼‰</li></ol><hr><h3 id="2-as-å…³é”®å­—"><a href="#2-as-å…³é”®å­—" class="headerlink" title="2. as å…³é”®å­—"></a>2. as å…³é”®å­—</h3><p>åœ¨<code>C#</code>ä¸­ï¼Œå…³é”®å­—<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/operators/type-testing-and-cast#as-operator"><code>as</code></a>ç”¨äºç±»å‹è½¬æ¢ã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé€šå¸¸ä¼šä¸<code>null</code>æ£€æŸ¥ä¸€èµ·ä½¿ç”¨<code>as</code>å…³é”®å­—ã€‚è¿™æ˜¯å› ä¸ºï¼Œå¦‚æœè½¬æ¢ä¸æˆåŠŸï¼Œ<code>as</code>ä¼šè¿”å›<code>null</code>ï¼Œè€Œä¸æ˜¯æŠ›å‡ºå¼‚å¸¸ã€‚è¿™ä½¿å¾—<code>as</code>å…³é”®å­—åœ¨é¢å¯¹ç±»å‹è½¬æ¢å¤±è´¥æ—¶çš„è¡Œä¸ºæ›´åŠ æ¸©å’Œã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Animal</span> &#123; ... &#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Dog</span> : <span class="title">Animal</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">Animal animal = <span class="keyword">new</span> Dog();</span><br><span class="line">Dog dog = animal <span class="keyword">as</span> Dog;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (dog != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Successful&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Failed&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>as</code>å…³é”®å­—å°è¯•å°†<code>animal</code>è½¬æ¢ä¸º<code>Dog</code>ç±»å‹ã€‚ç”±äº<code>animal</code>å¯¹è±¡å®é™…ä¸Šæ˜¯ä¸€ä¸ª<code>Dog</code>ç±»å‹çš„å¯¹è±¡ï¼Œæ‰€ä»¥è½¬æ¢æˆåŠŸã€‚å¦‚æœ<code>animal</code>å¯¹è±¡æ˜¯<code>Animal</code>ç±»å‹çš„å¯¹è±¡ï¼Œåˆ™ä¸Šé¢ä»£ç ä¼šè½¬æ¢å¤±è´¥ã€‚</p><hr><h3 id="3-base-å…³é”®å­—"><a href="#3-base-å…³é”®å­—" class="headerlink" title="3. base å…³é”®å­—"></a>3. base å…³é”®å­—</h3><p>åœ¨<code>C#</code>ä¸­ï¼Œ<code>base</code>å…³é”®å­—ç”¨äº<ins>åœ¨å­ç±»ä¸­å¼•ç”¨åŸºç±»çš„æˆå‘˜æˆ–è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°</ins>ã€‚</p><ul><li><code>base</code>å…³é”®å­—åªèƒ½ç”¨äºå­ç±»ï¼Œè€Œä¸æ˜¯åŸºç±»ä¸­ã€‚</li><li>å¦‚æœåŸºç±»æˆå‘˜æ˜¯ç§æœ‰çš„ï¼Œå³ä½¿ä½¿ç”¨<code>base</code>å…³é”®å­—ä¹Ÿæ— æ³•è®¿é—®ã€‚</li><li>åœ¨é™æ€æ–¹æ³•ä¸­ä½¿ç”¨ <code>base</code> å…³é”®å­—å°†äº§ç”Ÿé”™è¯¯ã€‚</li><li>å¦‚æœåŸºç±»ä¸­æœ‰å¤šä¸ªæ„é€ å‡½æ•°é‡è½½ï¼Œå­ç±»åœ¨ä½¿ç”¨<code>base</code>å…³é”®å­—è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°æ—¶ï¼Œéœ€è¦é€‰æ‹©è¦è°ƒç”¨çš„å…·ä½“æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”æä¾›ä¸æ‰€é€‰åŸºç±»æ„é€ å‡½æ•°åŒ¹é…çš„å‚æ•°åˆ—è¡¨ã€‚</li></ul><p>ä¸‹é¢æ˜¯<code>base</code>å…³é”®å­—çš„å‡ ç§å¸¸è§ç”¨æ³•ï¼š</p><p>ï¼ˆ1ï¼‰è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°</p><p>åœ¨æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°ä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>base</code>å…³é”®å­—è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BaseClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// åŸºç±»çš„æ„é€ å‡½æ•° 1</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BaseClass</span>(<span class="params"><span class="built_in">int</span> x</span>)</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åŸºç±»çš„æ„é€ å‡½æ•° 2</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BaseClass</span>(<span class="params"><span class="built_in">int</span> x, <span class="built_in">int</span> y</span>)</span> &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DerivedClass</span> : <span class="title">BaseClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="comment">// æ‰§è¡Œå…¶ä»–æ´¾ç”Ÿç±»çš„æ„é€ é€»è¾‘</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DerivedClass</span>(<span class="params"><span class="built_in">int</span> x</span>) : <span class="title">base</span>(<span class="params">x</span>)</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DerivedClass</span>(<span class="params"><span class="built_in">int</span> x, <span class="built_in">int</span> y</span>) : <span class="title">base</span>(<span class="params">x, y</span>)</span> &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> x = <span class="keyword">new</span> DerivedClass(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">var</span> y = <span class="keyword">new</span> DerivedClass(<span class="number">1</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>DerivedClass</code>ç»§æ‰¿è‡ª<code>BaseClass</code>ã€‚åœ¨<code>DerivedClass</code>çš„æ„é€ å‡½æ•°ä¸­ï¼Œä½¿ç”¨<code>base(x)</code>è°ƒç”¨äº†åŸºç±»<code>BaseClass</code>çš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¼ é€’å‚æ•°<code>x</code>ã€‚</p><p>ï¼ˆ2ï¼‰å¼•ç”¨åŸºç±»çš„æˆå‘˜</p><p>å½“<ins>æ´¾ç”Ÿç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªä¸åŸºç±»ç›¸åŒåç§°çš„æˆå‘˜å˜é‡æˆ–æ–¹æ³•</ins>æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>base</code>å…³é”®å­—æ¥è®¿é—®å®ƒã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BaseClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// åŸºç±»çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SomeMethod</span>()</span> &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DerivedClass</span> : <span class="title">BaseClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨åŸºç±»çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SomeMethod</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">base</span>.SomeMethod();</span><br><span class="line">        <span class="comment">// ... å…¶ä»–é€»è¾‘</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>DerivedClass</code>ç»§æ‰¿è‡ª<code>BaseClass</code>ã€‚åœ¨<code>DerivedClass</code>ä¸­çš„<code>SomeMethod</code>æ–¹æ³•ä¸­ï¼Œä½¿ç”¨<code>base.SomeMethod()</code>è°ƒç”¨äº†åŸºç±»<code>BaseClass</code>çš„æ–¹æ³•ã€‚</p><p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨<code>base</code>å»è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°ï¼Ÿ</p><ol><li>ç»§æ‰¿åŸºç±»çš„è¡Œä¸ºå’ŒçŠ¶æ€ï¼šé€šè¿‡è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°ï¼Œå­ç±»å¯ä»¥ç»§æ‰¿åŸºç±»çš„è¡Œä¸ºå’ŒçŠ¶æ€ã€‚åŸºç±»å¯èƒ½åŒ…å«ä¸€äº›é‡è¦çš„åˆå§‹åŒ–é€»è¾‘ï¼Œä»¥ç¡®ä¿å®ƒçš„æˆå‘˜å’Œå±æ€§å¤„äºæ­£ç¡®çš„çŠ¶æ€ã€‚</li><li>æä¾›åŸºç±»æ‰€éœ€çš„åˆå§‹åŒ–å‚æ•°ï¼šå¦‚æœåŸºç±»çš„æ„é€ å‡½æ•°éœ€è¦æ¥æ”¶å‚æ•°æ¥è¿›è¡Œåˆå§‹åŒ–ï¼Œæ´¾ç”Ÿç±»å¯ä»¥é€šè¿‡è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°å¹¶ä¼ é€’é€‚å½“çš„å‚æ•°ï¼Œæ¥æä¾›å¿…è¦çš„ä¿¡æ¯ã€‚</li><li>é¿å…å†—ä½™ä»£ç ï¼šå¦‚æœåŸºç±»çš„æ„é€ å‡½æ•°å·²ç»åŒ…å«äº†ä¸€äº›é€šç”¨çš„ã€æ‰€æœ‰æ´¾ç”Ÿç±»éƒ½éœ€è¦çš„åˆå§‹åŒ–ä»£ç ï¼Œé‚£ä¹ˆåœ¨æ´¾ç”Ÿç±»ä¸­é€šè¿‡ä½¿ç”¨ base å…³é”®å­—è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°ï¼Œå¯ä»¥é¿å…é‡å¤ç¼–å†™è¿™äº›åˆå§‹åŒ–ä»£ç ã€‚</li><li>ï¼ˆå¾…è¡¥å……ï¼‰</li></ol><hr><h3 id="4-byte-å…³é”®å­—"><a href="#4-byte-å…³é”®å­—" class="headerlink" title="4. byte å…³é”®å­—"></a>4. byte å…³é”®å­—</h3><p>åœ¨<code>C#</code>ä¸­ï¼Œ<code>byte</code>å…³é”®å­—ç”¨äºå£°æ˜ä¸€ä¸ª<code>8</code>ä½æ— ç¬¦å·ï¼ˆ<code>unsigned</code>ï¼‰æ•´æ•°ç±»å‹çš„å˜é‡ã€‚</p><p><code>byte</code>å…³é”®å­—åœ¨<code>C#</code>ä¸­å…·æœ‰å¤šç§ç”¨é€”å’Œåº”ç”¨åœºæ™¯ï¼š</p><ul><li>å­˜å‚¨å’Œå¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼š<code>byte</code>ç±»å‹æ˜¯ä¸€ä¸ª<code>8</code>ä½æ— ç¬¦å·æ•´æ•°ï¼ŒèŒƒå›´ä»<code>0</code>åˆ°<code>255</code>ã€‚å› æ­¤ï¼Œå®ƒéå¸¸é€‚åˆç”¨äºå­˜å‚¨å’Œå¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œå¦‚å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ã€æ–‡ä»¶ç­‰ã€‚</li><li>ç½‘ç»œç¼–ç¨‹ï¼šåœ¨ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œå¸¸å¸¸éœ€è¦ä½¿ç”¨<code>byte</code>ç±»å‹æ¥è¯»å–å’Œå†™å…¥æ•°æ®æµã€å¤„ç†ç½‘ç»œå­—èŠ‚åºç­‰ã€‚</li><li>æ•°æ®åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼šåºåˆ—åŒ–æ˜¯å°†å¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—çš„è¿‡ç¨‹ï¼Œè€Œååºåˆ—åŒ–åˆ™æ˜¯å°†å­—èŠ‚åºåˆ—è½¬æ¢å›å¯¹è±¡ã€‚åœ¨æ•°æ®åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œ<code>byte</code>ç±»å‹é€šå¸¸ç”¨äºè¡¨ç¤ºå’Œæ“ä½œå­—èŠ‚æ•°æ®ã€‚</li><li>â€¦</li></ul><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¯»å–å›¾åƒæ–‡ä»¶çš„å­—èŠ‚æ•°æ®</span></span><br><span class="line"><span class="built_in">byte</span>[] imageData = File.ReadAllBytes(<span class="string">&quot;image.jpg&quot;</span>);</span><br><span class="line"><span class="comment">// å¯¹æ•°æ®è¿›è¡Œå‹ç¼©ï¼Œè¿”å›å‹ç¼©åçš„å­—èŠ‚æ•°æ®</span></span><br><span class="line"><span class="built_in">byte</span>[] compressedData = CompressData(originalData);</span><br></pre></td></tr></table></figure><hr><h3 id="5-å¼‚å¸¸å¤„ç†å…³é”®å­—"><a href="#5-å¼‚å¸¸å¤„ç†å…³é”®å­—" class="headerlink" title="5. å¼‚å¸¸å¤„ç†å…³é”®å­—"></a>5. å¼‚å¸¸å¤„ç†å…³é”®å­—</h3><p>åœ¨<code>C#</code>ä¸­ï¼Œ<code>try</code>å…³é”®å­—ç”¨äºå®šä¹‰ä¸€ä¸ª<code>try</code>å—ï¼Œè¡¨ç¤ºå…¶ä¸­å¯èƒ½ä¼šå‡ºç°å¼‚å¸¸ã€‚</p><p><code>try</code>å—åé¢é€šå¸¸è·Ÿéšä¸€ä¸ªæˆ–å¤šä¸ª<code>catch</code>å—ï¼Œç”¨äºå¤„ç†å¯èƒ½æŠ›å‡ºçš„ç‰¹å®šå¼‚å¸¸ã€‚æœ€åè¿˜å¯ä»¥é€‰æ‹©æ€§åœ°åŒ…å«ä¸€ä¸ª<code>finally</code>å—ï¼Œå®ƒåŒ…å«çš„ä»£ç æ— è®ºæ˜¯å¦æŠ›å‡ºå¼‚å¸¸éƒ½ä¼šè¢«æ‰§è¡Œã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"></span><br><span class="line">StreamReader reader = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    reader = <span class="keyword">new</span> StreamReader(<span class="string">&quot;nonexistent_file.txt&quot;</span>);</span><br><span class="line">    Console.WriteLine(reader.ReadToEnd());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (FileNotFoundException ex)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å¤„ç†æ–‡ä»¶æ‰¾ä¸åˆ°çš„å¼‚å¸¸</span></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;File not found: &quot;</span> + ex.FileName);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (Exception ex)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å¤„ç†å…¶ä»–ç±»å‹çš„å¼‚å¸¸</span></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;An error occurred: &quot;</span> + ex.Message);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">finally</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ç¡®ä¿å…³é—­StreamReaderå¯¹è±¡ï¼Œé‡Šæ”¾ç³»ç»Ÿèµ„æº</span></span><br><span class="line">    <span class="keyword">if</span> (reader != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        reader.Close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœ<code>try</code>å—ä¸­çš„ä»£ç å¼•å‘äº†å¼‚å¸¸ï¼Œç¨‹åºä¼šç«‹å³è·³è½¬åˆ°<code>catch</code>å—ï¼Œå¯»æ‰¾ä¸å¼‚å¸¸ç±»å‹åŒ¹é…çš„<code>catch</code>å—ï¼Œå¹¶æ‰§è¡Œç›¸åº”çš„ä»£ç å—ã€‚æ¯ä¸ª<code>catch</code>å—å¯ä»¥æ•è·å¹¶å¤„ç†ç‰¹å®šç±»å‹çš„å¼‚å¸¸ã€‚</p><p>å¤„ç†å¼‚æ­¥å‡½æ•°çš„å¼‚å¸¸ï¼š</p><p>å¼‚æ­¥å‡½æ•°é€šå¸¸è¿”å›ä¸€ä¸ª<code>Task</code>æˆ–<code>Task&lt;T&gt;</code>å¯¹è±¡ã€‚å¯ä»¥åœ¨<code>try</code>å—ä¸­<code>await</code>è¿™ä¸ªä»»åŠ¡ï¼Œå¹¶åœ¨<code>catch</code>å—ä¸­å¤„ç†å¯èƒ½çš„å¼‚å¸¸ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æœ‰å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„å¼‚æ­¥æ“ä½œ</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">SomeAsyncOperation</span>()</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">HandleAsyncOperation</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> SomeAsyncOperation();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;An exception occurred: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼Œä¸æ˜¯æ‰€æœ‰çš„å¼‚å¸¸éƒ½åº”è¯¥è¢«æ•è·ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåªåº”è¯¥æ•è·çŸ¥é“å¦‚ä½•å¤„ç†çš„å¼‚å¸¸ã€‚å¯¹äºä¸çŸ¥é“å¦‚ä½•å¤„ç†çš„å¼‚å¸¸ï¼Œæœ€å¥½è®©å®ƒä»¬ä¼ æ’­å‡ºå»ï¼Œè¿™æ ·è°ƒç”¨è€…æˆ–è€…å…¨å±€å¼‚å¸¸å¤„ç†å™¨å¯ä»¥æ•è·å¹¶å¤„ç†å®ƒä»¬ã€‚</p><p>ï¼ˆè¿™é‡Œæš‚æ—¶çœç•¥å¤„ç†è¿­ä»£å™¨æ–¹æ³•ä¸­çš„å¼‚å¸¸ï¼Œå¾…è¡¥å……ï¼‰</p><hr><h3 id="6-class-å…³é”®å­—"><a href="#6-class-å…³é”®å­—" class="headerlink" title="6. class å…³é”®å­—"></a>6. class å…³é”®å­—</h3><p>åœ¨<code>C#</code>ä¸­ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/class"><code>class</code></a>å…³é”®å­—ç”¨äºå®šä¹‰ä¸€ä¸ªç±»ã€‚</p><p>ç±»æ˜¯ä¸€ç§å¼•ç”¨ç±»å‹ï¼Œå®ƒå®šä¹‰äº†ä¸€ç»„å±æ€§ï¼ˆå­—æ®µã€å¸¸é‡å’Œäº‹ä»¶ï¼‰ã€æ–¹æ³•å’Œç´¢å¼•å™¨çš„ç»„åˆã€‚ç±»å¯ä»¥ç›´æ¥å®ä¾‹åŒ–ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºåŸºç±»ç»§æ‰¿ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ç±»çš„æˆå‘˜å˜é‡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> myInt;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyClass</span>(<span class="params"><span class="built_in">int</span> <span class="keyword">value</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        myInt = <span class="keyword">value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç±»çš„æˆå‘˜æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PrintValue</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;MyInt = &quot;</span> + myInt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><ins><code>C#</code> ä¸­ä»…å…è®¸å•ä¸€ç»§æ‰¿ï¼Œå³ä¸€ä¸ªç±»ä»…èƒ½ä»ä¸€ä¸ªåŸºç±»ç»§æ‰¿å®ç°ã€‚ä½†æ˜¯ï¼Œä¸€ä¸ªç±»å¯æ‹¥æœ‰å¤šä¸ªæ¥å£</ins>ã€‚</p><table><thead><tr><th align="left">ç»§æ‰¿</th><th align="left">ç¤ºä¾‹</th></tr></thead><tbody><tr><td align="left">æ— </td><td align="left">class ClassA { }</td></tr><tr><td align="left">å•ä¸€</td><td align="left">class DerivedClass : BaseClass { }</td></tr><tr><td align="left">æ— ï¼Œå®ç°ä¸¤ä¸ªæ¥å£</td><td align="left">class ImplClass : IFace1, IFace2 { }</td></tr><tr><td align="left">å•ä¸€ï¼Œå®ç°ä¸€ä¸ªæ¥å£</td><td align="left">class ImplDerivedClass : BaseClass, IFace1 { }</td></tr></tbody></table><p>ä¸‹é¢æ˜¯ä¸€äº›ç±»çš„ä½¿ç”¨æ–¹æ³•ï¼š</p><p>ï¼ˆ1ï¼‰è®¿é—®ä¿®é¥°ç¬¦ï¼šç±»çš„è®¿é—®ä¿®é¥°ç¬¦å†³å®šäº†å®ƒåœ¨ä»£ç ä¸­çš„å¯è§æ€§ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç±»æ˜¯<code>internal</code>çš„ï¼Œæ„å‘³ç€å®ƒåªåœ¨åŒä¸€ç¨‹åºé›†ä¸­å¯è§ã€‚ç±»çš„æˆå‘˜é»˜è®¤æ˜¯<code>private</code>çš„ï¼Œåªèƒ½åœ¨ç±»çš„å†…éƒ¨è®¿é—®ã€‚</p><p>ï¼ˆ2ï¼‰é™æ€ç±»ï¼šä½¿ç”¨<code>static</code>å…³é”®å­—å¯ä»¥å®šä¹‰é™æ€ç±»å’Œé™æ€æˆå‘˜ã€‚é™æ€ç±»ä¸èƒ½å®ä¾‹åŒ–ï¼Œä¸èƒ½è¢«ç»§æ‰¿ï¼Œä¸”åªèƒ½åŒ…å«é™æ€æˆå‘˜ã€‚é™æ€æˆå‘˜åªæœ‰ä¸€ä»½ï¼Œå±äºç±»æœ¬èº«ï¼Œè€Œä¸å±äºç±»çš„ä»»ä½•å®ä¾‹ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">MathUtils</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Add</span>(<span class="params"><span class="built_in">int</span> a, <span class="built_in">int</span> b</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">double</span> <span class="title">SquareRoot</span>(<span class="params"><span class="built_in">double</span> <span class="keyword">value</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.Sqrt(<span class="keyword">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MathUtils.Add(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">MathUtils.SquareRoot(<span class="number">4.0</span>)</span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰æ„é€ å‡½æ•°ï¼šç±»å¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæ„é€ å‡½æ•°ï¼Œç”¨äºåˆ›å»ºç±»çš„å®ä¾‹ã€‚æ„é€ å‡½æ•°çš„åç§°å¿…é¡»ä¸ç±»åç›¸åŒï¼Œä¸”ä¸è¿”å›ä»»ä½•å€¼ã€‚</p><p>ï¼ˆ4ï¼‰é™æ€æ„é€ å‡½æ•°ï¼š<ins>ç”¨äºåˆå§‹åŒ–é™æ€æˆå‘˜æˆ–æ‰§è¡Œé™æ€åˆå§‹åŒ–ä»£ç </ins>ã€‚å®ƒæ²¡æœ‰å‚æ•°åˆ—è¡¨ï¼Œä¹Ÿä¸èƒ½ç›´æ¥è°ƒç”¨ã€‚<ins>é™æ€æ„é€ å‡½æ•°åœ¨ç±»çš„ç¬¬ä¸€ä¸ªå®ä¾‹æˆ–é™æ€æˆå‘˜è¢«è®¿é—®ä¹‹å‰è‡ªåŠ¨è°ƒç”¨ï¼Œå¹¶ä¸”åªæ‰§è¡Œä¸€æ¬¡</ins>ã€‚</p><ul><li>è®¿é—®é™æ€æˆå‘˜æ—¶è°ƒç”¨</li></ul><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">int</span> myStaticField;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">int</span> myStaticReadOnlyField;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="title">MyClass</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// é™æ€æ„é€ å‡½æ•°ç”¨äºåˆå§‹åŒ–é™æ€æˆå‘˜</span></span><br><span class="line">        myStaticField = <span class="number">10</span>;</span><br><span class="line">        myStaticReadOnlyField = <span class="number">20</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">MyMethod</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;MyStaticField: &quot;</span> + myStaticField);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;MyStaticReadOnlyField: &quot;</span> + myStaticReadOnlyField);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨é™æ€æ–¹æ³•ï¼Œé™æ€æ„é€ å‡½æ•°ä¼šåœ¨æ­¤æ—¶è‡ªåŠ¨æ‰§è¡Œ</span></span><br><span class="line">MyClass.MyMethod();</span><br><span class="line"></span><br><span class="line"><span class="comment">// MyStaticField: 10</span></span><br><span class="line"><span class="comment">// MyStaticReadOnlyField: 20</span></span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºç±»çš„å®ä¾‹æ—¶è°ƒç”¨</li></ul><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">int</span> myStaticField;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">int</span> myStaticReadOnlyField;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="title">MyClass</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        myStaticField = <span class="number">10</span>;</span><br><span class="line">        myStaticReadOnlyField = <span class="number">20</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyClass</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;MyStaticField: &quot;</span> + myStaticField);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;MyStaticReadOnlyField: &quot;</span> + myStaticReadOnlyField);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºç±»çš„ç¬¬ä¸€ä¸ªå®ä¾‹ï¼Œé™æ€æ„é€ å‡½æ•°ä¼šåœ¨æ­¤æ—¶è‡ªåŠ¨è°ƒç”¨</span></span><br><span class="line">MyClass obj = <span class="keyword">new</span> MyClass();</span><br><span class="line"></span><br><span class="line"><span class="comment">// MyStaticField: 10</span></span><br><span class="line"><span class="comment">// MyStaticReadOnlyField: 20</span></span><br></pre></td></tr></table></figure><p>ï¼ˆ5ï¼‰å†…éƒ¨ç±»ï¼šå†…éƒ¨ç±»æ˜¯å®šä¹‰åœ¨å¦ä¸€ä¸ªç±»å†…éƒ¨çš„ç±»ã€‚å†…éƒ¨ç±»æ‹¥æœ‰è®¿é—®å¤–éƒ¨ç±»æˆå‘˜çš„ç‰¹æƒï¼Œå¯ä»¥ç”¨äºå®ç°æ›´å¤æ‚çš„é€»è¾‘å’Œå°è£…ã€‚ï¼ˆæ³¨æ„ï¼Œè™½ç„¶å†…éƒ¨ç±»å¯ä»¥è®¿é—®å…¶å¤–éƒ¨ç±»çš„æ‰€æœ‰æˆå‘˜ï¼Œä½†åè¿‡æ¥ä¸æˆç«‹ã€‚ï¼‰</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">OuterClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> outerField = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">InnerClass</span></span><br><span class="line">    &#123;</span><br><span class="line">        OuterClass outer;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ„é€ å‡½æ•°ï¼Œé€šè¿‡å‚æ•°å°†å¤–éƒ¨ç±»å®ä¾‹ä¼ å…¥</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">InnerClass</span>(<span class="params">OuterClass outer</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.outer = outer;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">InnerMethod</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(outer.outerField);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> InnerClass <span class="title">CreateInnerClass</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> InnerClass(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">OuterClass outer = <span class="keyword">new</span> OuterClass();</span><br><span class="line">OuterClass.InnerClass inner = outer.CreateInnerClass();</span><br><span class="line">inner.InnerMethod(); <span class="comment">// 10</span></span><br></pre></td></tr></table></figure><p>ï¼ˆ6ï¼‰æ³›å‹ç±»ï¼šæ³›å‹ç±»å…·æœ‰åœ¨å®ä¾‹åŒ–æ—¶å¯ä»¥æŒ‡å®šå‚æ•°ç±»å‹çš„ç‰¹æ€§ï¼Œä»è€Œæä¾›äº†æ›´çµæ´»å’Œç±»å‹å®‰å…¨çš„ä»£ç é‡ç”¨æ–¹å¼ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyGenericClass</span>&lt;<span class="title">T</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> T myField;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyGenericClass</span>(<span class="params">T <span class="keyword">value</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        myField = <span class="keyword">value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">MyMethod</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> myField;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyGenericClass&lt;<span class="built_in">int</span>&gt; intObj = <span class="keyword">new</span> MyGenericClass&lt;<span class="built_in">int</span>&gt;(<span class="number">10</span>);</span><br><span class="line"><span class="built_in">int</span> <span class="keyword">value</span> = intObj.MyMethod(); <span class="comment">// è¿”å›å€¼ä¸º 10</span></span><br><span class="line"></span><br><span class="line">MyGenericClass&lt;<span class="built_in">string</span>&gt; stringObj = <span class="keyword">new</span> MyGenericClass&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> text = stringObj.MyMethod(); <span class="comment">// è¿”å›å€¼ä¸º &quot;Hello&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ï¼ˆ7ï¼‰<code>C#</code>è¿˜æœ‰è®¸å¤šå…¶ä»–ä¸åŒçš„ç±»ï¼Œæ¯”å¦‚ä¹‹å‰ä»‹ç»çš„æŠ½è±¡ç±»ï¼Œè¿˜æœ‰æ¥å£ï¼Œå¯†å°ç±»ï¼Œæšä¸¾ç±»ï¼Œéƒ¨åˆ†ç±»ï¼Œç‰¹æ€§ç±»ï¼Œå§”æ‰˜ç±»ç­‰ç­‰ã€‚ï¼ˆå¾…è¡¥å……ï¼‰</p><hr><h3 id="7-decimal-å…³é”®å­—"><a href="#7-decimal-å…³é”®å­—" class="headerlink" title="7. decimal å…³é”®å­—"></a>7. decimal å…³é”®å­—</h3><p>åœ¨<code>C#</code>ä¸­ï¼Œå½“æ‰€éœ€çš„ç²¾åº¦ç”±å°æ•°ç‚¹å³ä¾§çš„ä½æ•°å†³å®šæ—¶ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/builtin-types/floating-point-numeric-types"><code>decimal</code></a>å…³é”®å­—æ˜¯åˆé€‚çš„ã€‚</p><p>å®ƒæ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œç”¨äºå­˜å‚¨ç²¾ç¡®çš„åè¿›åˆ¶æ•°å€¼ï¼ˆæ”¯æŒå°æ•°ç‚¹å<code>28</code>çš„ç²¾ç¡®åº¦ï¼‰ï¼Œé€‚ç”¨äºéœ€è¦é«˜ç²¾åº¦è®¡ç®—çš„åœºæ™¯ï¼Œä¾‹å¦‚è´¢åŠ¡å’Œè´§å¸è®¡ç®—ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="built_in">decimal</span> myDecimal = <span class="number">3.14</span>m; <span class="comment">// ä½¿ç”¨åç¼€ &quot;m&quot; è¡¨ç¤º decimal ç±»å‹</span></span><br><span class="line"><span class="built_in">float</span> myFloat = <span class="number">3.14f</span>; <span class="comment">// ä½¿ç”¨åç¼€ &quot;f&quot; è¡¨ç¤º float ç±»å‹</span></span><br><span class="line"><span class="built_in">double</span> myDouble = <span class="number">3.14</span>; <span class="comment">// é»˜è®¤ä¸º double ç±»å‹</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œ<code>decimal</code>ç±»å‹è™½ç„¶å…·æœ‰è¾ƒé«˜çš„ç²¾åº¦å’Œå‡†ç¡®æ€§ï¼Œå®ƒçš„è®¡ç®—é€Ÿåº¦é€šå¸¸æ¯”å…¶ä»–æµ®ç‚¹ç±»å‹ï¼ˆå¦‚ <code>float</code> å’Œ <code>double</code>ï¼‰æ…¢ã€‚</p><hr><h3 id="8-delegate-å…³é”®å­—"><a href="#8-delegate-å…³é”®å­—" class="headerlink" title="8. delegate å…³é”®å­—"></a>8. delegate å…³é”®å­—</h3><p>åœ¨<code>C#</code>ä¸­ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/programming-guide/delegates/"><code>delegate</code></a>å…³é”®å­—ç”¨äºå£°æ˜å’Œä½¿ç”¨å§”æ‰˜ã€‚</p><p>å®ƒç±»ä¼¼äºä¸€ä¸ªè£…ç€æ–¹æ³•çš„å®¹å™¨ï¼Œå¯ä»¥å°†æ–¹æ³•ï¼ˆå®ä¾‹æ–¹æ³•ï¼Œé™æ€æ–¹æ³•ï¼‰ä½œä¸ºå¯¹è±¡è¿›è¡Œä¼ é€’ï¼Œä½†<ins>å‰ææ˜¯å§”æ‰˜å’Œå¯¹åº”ä¼ é€’æ–¹æ³•çš„ç­¾åå¾—æ˜¯ç›¸åŒçš„ï¼Œç­¾åæŒ‡çš„æ˜¯ä»–ä»¬çš„å‚æ•°ç±»å‹å’Œè¿”å›å€¼ç±»å‹</ins>ã€‚ï¼ˆç±»ä¼¼å›è°ƒå‡½æ•°æˆ–è€…<code>Thunk</code>å‡½æ•°ï¼‰</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å§”æ‰˜çš„å£°æ˜ï¼ŒæŒ‡å®šäº†è¿”å›å€¼ç±»å‹ä¸º intï¼Œæ¥æ”¶ä¸¤ä¸ª int ç±»å‹çš„å‚æ•°ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="built_in">int</span> <span class="title">MyDelegate</span>(<span class="params"><span class="built_in">int</span> num1, <span class="built_in">int</span> num2</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Calculator</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨å§”æ‰˜çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™é‡Œçš„ method å‚æ•°æ˜¯ä¸€ä¸ª Operation ç±»å‹çš„å§”æ‰˜</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Calculate</span>(<span class="params"><span class="built_in">int</span> num1, <span class="built_in">int</span> num2, MyDelegate callback</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// åœ¨Calculateæ–¹æ³•ä¸­è°ƒç”¨å§”æ‰˜</span></span><br><span class="line">        <span class="keyword">return</span> callback(num1, num2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸¤ä¸ªç¬¦åˆ Operation å§”æ‰˜ç­¾åçš„æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Add</span>(<span class="params"><span class="built_in">int</span> num1, <span class="built_in">int</span> num2</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> num1 + num2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Subtract</span>(<span class="params"><span class="built_in">int</span> num1, <span class="built_in">int</span> num2</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> num1 - num2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Calculator calculator = <span class="keyword">new</span> Calculator();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨å§”æ‰˜å°† Add æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ å…¥</span></span><br><span class="line"><span class="built_in">int</span> result = calculator.Calculate(<span class="number">10</span>, <span class="number">5</span>, Add);</span><br><span class="line">Console.WriteLine(result);  <span class="comment">// è¾“å‡ºï¼š15</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨å§”æ‰˜å°† Subtract æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ å…¥</span></span><br><span class="line">result = calculator.Calculate(<span class="number">10</span>, <span class="number">5</span>, Subtract);</span><br><span class="line">Console.WriteLine(result);  <span class="comment">// è¾“å‡ºï¼š5</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œåœ¨<code>C#</code>ä¸­åˆ›å»ºå§”æ‰˜å¯¹è±¡æ—¶ï¼Œå¹¶ä¸ä¸€å®šéœ€è¦ä½¿ç”¨<code>new</code>å…³é”®å­—æ¥å®ä¾‹åŒ–å§”æ‰˜ã€‚</p><p>ï¼ˆ1ï¼‰ä½¿ç”¨<code>new</code>å…³é”®å­—å’Œå§”æ‰˜ç±»å‹çš„æ„é€ å‡½æ•°åˆ›å»ºå§”æ‰˜å¯¹è±¡</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">MyDelegate myDelegate = <span class="keyword">new</span> MyDelegate(ShowMessage);</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>new MyDelegate</code>è¯­æ³•åˆ›å»ºäº†ä¸€ä¸ªå§”æ‰˜å¯¹è±¡<code>myDelegate</code>ï¼Œå¹¶å°†<code>ShowMessage</code>æ–¹æ³•ç»‘å®šåˆ°å§”æ‰˜ä¸Šã€‚</p><p>ï¼ˆ2ï¼‰ä½¿ç”¨éšå¼æ–¹æ³•ç»„è½¬æ¢æ¥åˆ›å»ºå§”æ‰˜å¯¹è±¡</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">MyDelegate myDelegate = ShowMessage;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç›´æ¥å°†æ–¹æ³•å<code>ShowMessage</code>èµ‹å€¼ç»™å§”æ‰˜å¯¹è±¡<code>myDelegate</code>ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è¿›è¡Œéšå¼æ–¹æ³•ç»„è½¬æ¢ï¼Œå°†æ–¹æ³•è½¬æ¢ä¸ºå§”æ‰˜å¯¹è±¡ã€‚</p><p>ï¼ˆ3ï¼‰ä½¿ç”¨åŒ¿åæ–¹æ³•åˆ›å»ºå§”æ‰˜å¯¹è±¡</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">MyDelegate myDelegate = <span class="built_in">delegate</span>(<span class="built_in">string</span> message)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(message);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åŒ¿åæ–¹æ³•çš„è¯­æ³•æ˜¯ä½¿ç”¨å…³é”®å­—<code>delegate</code>åè·Ÿä¸€ä¸ªå‚æ•°åˆ—è¡¨å’Œæ–¹æ³•ä½“ã€‚</p><p>ï¼ˆ4ï¼‰ä½¿ç”¨ Lambda è¡¨è¾¾å¼åˆ›å»ºå§”æ‰˜å¯¹è±¡</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Lambdaè¡¨è¾¾å¼çš„å‚æ•°éƒ¨åˆ†åªä½¿ç”¨äº†å‚æ•°å&quot;message&quot;ï¼Œè€Œæ²¡æœ‰æŒ‡å®šå‚æ•°ç±»å‹ã€‚</span></span><br><span class="line"><span class="comment">// ç¼–è¯‘å™¨ä¼šæ ¹æ®å§”æ‰˜ç±»å‹æ¨æ–­å‡ºå‚æ•°ç±»å‹ã€‚</span></span><br><span class="line">MyDelegate myDelegate = (message) =&gt; Console.WriteLine(message);</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>Lambda</code>è¡¨è¾¾å¼å®šä¹‰äº†ä¸€ä¸ªåŒ¿åæ–¹æ³•ï¼Œå°†å…¶èµ‹å€¼ç»™å§”æ‰˜å¯¹è±¡<code>myDelegate</code>ã€‚</p><p>é‚£ä»€ä¹ˆæƒ…å†µä¸‹åº”è¯¥ä½¿ç”¨å§”æ‰˜<code>delegate</code>ï¼Ÿ</p><p>ï¼ˆ1ï¼‰äº‹ä»¶å¤„ç†ï¼šå§”æ‰˜å¹¿æ³›ç”¨äºäº‹ä»¶å¤„ç†æ¨¡å‹ä¸­ã€‚é€šè¿‡å®šä¹‰å§”æ‰˜ç±»å‹å’Œäº‹ä»¶ï¼Œå¯ä»¥å°†äº‹ä»¶ä¸ç‰¹å®šçš„å¤„ç†æ–¹æ³•å…³è”èµ·æ¥ã€‚å½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå§”æ‰˜ä¼šè°ƒç”¨ç»‘å®šçš„æ–¹æ³•ï¼Œä»è€Œå®ç°äº‹ä»¶çš„å¤„ç†å’Œå“åº”ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªå§”æ‰˜</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="keyword">void</span> <span class="title">EventHandler</span>(<span class="params"><span class="built_in">string</span> message</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EventPublisher</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å£°æ˜ä¸€ä¸ªäº‹ä»¶ï¼Œä½¿ç”¨ä¹‹å‰å®šä¹‰çš„å§”æ‰˜</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">event</span> EventHandler Event;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TriggerEvent</span>(<span class="params"><span class="built_in">string</span> message</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è§¦å‘äº‹ä»¶</span></span><br><span class="line">        Event?.Invoke(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EventSubscriber</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Subscribe</span>(<span class="params">EventPublisher publisher</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è®¢é˜…äº‹ä»¶</span></span><br><span class="line">        publisher.Event += HandleEvent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">HandleEvent</span>(<span class="params"><span class="built_in">string</span> message</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†äº‹ä»¶</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Event received: &quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºäº‹ä»¶å‘å¸ƒè€…å’Œè®¢é˜…è€…</span></span><br><span class="line">EventPublisher publisher = <span class="keyword">new</span> EventPublisher();</span><br><span class="line">EventSubscriber subscriber = <span class="keyword">new</span> EventSubscriber();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢é˜…äº‹ä»¶</span></span><br><span class="line">subscriber.Subscribe(publisher);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§¦å‘äº‹ä»¶</span></span><br><span class="line">publisher.TriggerEvent(<span class="string">&quot;Hello, World!&quot;</span>);</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰å›è°ƒå‡½æ•°ï¼šå§”æ‰˜å¯ç”¨ä½œå›è°ƒå‡½æ•°çš„ä¸€ç§æ–¹å¼ã€‚å½“ä¸€ä¸ªæ–¹æ³•éœ€è¦åœ¨å®Œæˆåé€šçŸ¥å¦ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œå¯ä»¥å°†å§”æ‰˜ä½œä¸ºå‚æ•°ä¼ é€’ç»™è¯¥æ–¹æ³•ï¼Œå¹¶åœ¨é€‚å½“çš„æ—¶å€™è°ƒç”¨å§”æ‰˜ä»¥æ‰§è¡Œå›è°ƒæ“ä½œã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="keyword">void</span> <span class="title">MyCallbackDelegate</span>(<span class="params"><span class="built_in">string</span> message</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Processor</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> MyCallbackDelegate callback;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Processor</span>(<span class="params">MyCallbackDelegate callback</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.callback = callback;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Process</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Processing...</span></span><br><span class="line">        <span class="comment">// Once processing is done, callback is called:</span></span><br><span class="line">        callback(<span class="string">&quot;Processing completed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create a new processor, passing it a callback function:</span></span><br><span class="line">Processor processor = <span class="keyword">new</span> Processor(MyCallback);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Start the processing:</span></span><br><span class="line">processor.Process();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">MyCallback</span>(<span class="params"><span class="built_in">string</span> message</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰å¤šæ’­å§”æ‰˜ï¼ˆå§”æ‰˜é“¾ï¼‰ï¼šå§”æ‰˜è¿˜æ”¯æŒå¤šæ’­ï¼ˆ<code>multicast</code>ï¼‰çš„åŠŸèƒ½ï¼Œå³ä¸€ä¸ªå§”æ‰˜å¯ä»¥ç»‘å®šå¤šä¸ªæ–¹æ³•ã€‚è¿™ä½¿å¾—å¯ä»¥å°†å¤šä¸ªæ–¹æ³•ä½œä¸ºå§”æ‰˜çš„è°ƒç”¨åˆ—è¡¨ï¼Œå¹¶æŒ‰é¡ºåºä¾æ¬¡è°ƒç”¨å®ƒä»¬ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="built_in">delegate</span> <span class="keyword">void</span> <span class="title">MyDelegate</span>()</span>;</span><br><span class="line"></span><br><span class="line">MyDelegate myDelegate = Method1;</span><br><span class="line">myDelegate += Method2;</span><br><span class="line">myDelegate += Method3;</span><br><span class="line">myDelegate -= Method4; <span class="comment">// åˆ é™¤è°ƒç”¨åˆ—è¡¨ä¸­çš„æ–¹æ³•</span></span><br><span class="line">myDelegate();  <span class="comment">// è°ƒç”¨å§”æ‰˜ï¼Œä¾æ¬¡æ‰§è¡Œç»‘å®šçš„æ–¹æ³•</span></span><br></pre></td></tr></table></figure><p>ï¼ˆ4ï¼‰æ³›å‹å§”æ‰˜ï¼š<code>C#</code>ä¸­çš„å§”æ‰˜æ”¯æŒæ³›å‹ï¼Œå¯ä»¥æ›´å¥½åœ°æ”¯æŒç±»å‹å®‰å…¨æ€§å’Œä»£ç é‡ç”¨ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="built_in">delegate</span> T <span class="title">MyGenericDelegate</span>&lt;<span class="title">T</span>&gt;(<span class="params">T <span class="keyword">value</span></span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Square</span>(<span class="params"><span class="built_in">int</span> x</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> x * x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyGenericDelegate&lt;<span class="built_in">int</span>&gt; squareDelegate = Square;</span><br><span class="line"><span class="built_in">int</span> result = squareDelegate(<span class="number">5</span>);</span><br></pre></td></tr></table></figure><p>ï¼ˆ5ï¼‰LINQ å’Œ Lambda è¡¨è¾¾å¼ï¼šåœ¨<code>LINQ</code>ï¼ˆLanguage Integrated Queryï¼‰ä¸­ï¼Œå§”æ‰˜ç”¨äºå®šä¹‰æŸ¥è¯¢æ“ä½œã€‚è€Œ<code>Lambda</code>è¡¨è¾¾å¼å®è´¨ä¸Šæ˜¯ä¸€ç§ç‰¹æ®Šçš„å§”æ‰˜ï¼Œä»¥ä¸€ç§æ›´ç®€æ´å’Œå¼ºå¤§çš„æ–¹å¼å®šä¹‰åŒ¿åå‡½æ•°ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        List&lt;<span class="built_in">int</span>&gt; numbers = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt; &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span> &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å®šä¹‰ä¸€ä¸ªå§”æ‰˜ï¼Œæ£€æŸ¥ä¸€ä¸ªæ•°æ˜¯å¦ä¸ºå¶æ•°</span></span><br><span class="line">        Func&lt;<span class="built_in">int</span>, <span class="built_in">bool</span>&gt; isEven = x =&gt; x % <span class="number">2</span> == <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä½¿ç”¨LINQå’Œå§”æ‰˜æ‰¾å‡ºæ‰€æœ‰å¶æ•°</span></span><br><span class="line">        IEnumerable&lt;<span class="built_in">int</span>&gt; evens = numbers.Where(isEven);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‰“å°æ‰€æœ‰çš„å¶æ•°</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="built_in">int</span> number <span class="keyword">in</span> evens)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(number);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œåœ¨<code>C#</code>ä¸­ï¼Œä¸ä¸€å®šéè¦ä½¿ç”¨<code>delegate</code>å…³é”®å­—æ¥å®šä¹‰å§”æ‰˜ã€‚å…¶å®ï¼Œ<code>Func&lt;T, TResult&gt;</code>ã€<code>Action&lt;T&gt;</code>ç­‰éƒ½æ˜¯å†…ç½®çš„å§”æ‰˜ç±»å‹ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒä»¬ï¼Œè€Œæ— éœ€ä½¿ç”¨<code>delegate</code>å…³é”®å­—ã€‚ï¼ˆ<code>C#</code>ä¸­å†…ç½®çš„å§”æ‰˜ç±»å‹ï¼‰</p><p>ï¼ˆ6ï¼‰å®šåˆ¶æˆ–æ‰©å±•æ–¹æ³•ï¼šåœ¨<code>C#</code>ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å§”æ‰˜å»å®šåˆ¶æˆ–æ‰©å±•æ–¹æ³•ï¼Œæ”¹å˜å…¶è¡Œä¸ºæˆ–å¢åŠ æ–°çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å§”æ‰˜æ¥å®šåˆ¶æ¯”è¾ƒæ–¹æ³•ï¼Œä»è€Œå¯¹é›†åˆè¿›è¡Œè‡ªå®šä¹‰æ’åºã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="built_in">int</span> <span class="title">Comparison</span>&lt;<span class="keyword">in</span> <span class="title">T</span>&gt;(<span class="params">T x, T y</span>)</span>;</span><br><span class="line"></span><br><span class="line">List&lt;<span class="built_in">int</span>&gt; numbers = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt; &#123; <span class="number">5</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">6</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªå§”æ‰˜å®ä¾‹ï¼Œä¼ å…¥ä¸€ä¸ªæ¯”è¾ƒæ–¹æ³•</span></span><br><span class="line">Comparison&lt;<span class="built_in">int</span>&gt; comparison = (x, y) =&gt; y.CompareTo(x);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ List&lt;T&gt; ç±»çš„ Sort æ–¹æ³•ï¼Œå°†å§”æ‰˜ä½œä¸ºå‚æ•°ä¼ å…¥</span></span><br><span class="line">numbers.Sort(comparison);</span><br><span class="line"></span><br><span class="line"><span class="comment">// numbers: &#123; 10, 8, 6, 5, 3 &#125;</span></span><br></pre></td></tr></table></figure><p>ï¼ˆ7ï¼‰ï¼ˆå¾…è¡¥å……ï¼‰</p><hr><h3 id="9-enum-å…³é”®å­—"><a href="#9-enum-å…³é”®å­—" class="headerlink" title="9. enum å…³é”®å­—"></a>9. enum å…³é”®å­—</h3><p>åœ¨ <code>C#</code> ä¸­ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/builtin-types/enum"><code>enum</code></a> å…³é”®å­—ç”¨äºå£°æ˜æšä¸¾ç±»å‹ã€‚</p><ul><li>æšä¸¾æ˜¯ä¸€ç§å€¼ç±»å‹ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªå›ºå®šçš„å€¼é›†åˆã€‚è¿™äº›å€¼è¢«ç§°ä¸ºæšä¸¾æˆå‘˜ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªéƒ½æœ‰ä¸€ä¸ªå…³è”çš„å¸¸é‡å€¼ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç¬¬ä¸€ä¸ªæšä¸¾æˆå‘˜çš„å€¼æ˜¯<code>0</code>ï¼Œåç»­çš„æˆå‘˜å€¼ä¾æ¬¡é€’å¢<code>1</code>ï¼Œä½†æ˜¯å¯ä»¥æ˜¾å¼åœ°æ”¹å˜è¿™ä¸ªé¡ºåºã€‚</li></ul><p>å‡è®¾æœ‰ä¸€ä¸ªæšä¸¾ç±»å‹å®šä¹‰äº†ä¸€å‘¨çš„å¤©æ•°ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> DayOfWeek</span><br><span class="line">&#123;</span><br><span class="line">    Sunday = <span class="number">0</span>,</span><br><span class="line">    Monday = <span class="number">1</span>,</span><br><span class="line">    Tuesday = <span class="number">2</span>,</span><br><span class="line">    Wednesday = <span class="number">3</span>,</span><br><span class="line">    Thursday = <span class="number">4</span>,</span><br><span class="line">    Friday = <span class="number">5</span>,</span><br><span class="line">    Saturday = <span class="number">6</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ1ï¼‰å¯ä»¥åˆ›å»ºä¸€ä¸ªå˜é‡æ¥å­˜å‚¨å½“å‰çš„æ˜ŸæœŸå‡ </p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">DayOfWeek today = DayOfWeek.Monday;</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰å¯ä»¥å°†æšä¸¾å€¼è½¬æ¢ä¸ºå…¶ä»–ç±»å‹ï¼Œä¾‹å¦‚æ•´æ•°æˆ–å­—ç¬¦ä¸²</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span> dayNumber = (<span class="built_in">int</span>)DayOfWeek.Friday;  <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">string</span> dayName = DayOfWeek.Friday.ToString();  <span class="comment">// &quot;Friday&quot;</span></span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰åè¿‡æ¥ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å…¶ä»–ç±»å‹è½¬æ¢ä¸ºæšä¸¾å€¼</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">DayOfWeek day = (DayOfWeek)<span class="number">5</span>;  <span class="comment">// DayOfWeek.Friday</span></span><br><span class="line">DayOfWeek day = Enum.Parse&lt;DayOfWeek&gt;(<span class="string">&quot;Friday&quot;</span>);  <span class="comment">// DayOfWeek.Friday</span></span><br><span class="line"></span><br><span class="line">DayOfWeek day;</span><br><span class="line"><span class="built_in">bool</span> success = Enum.TryParse&lt;DayOfWeek&gt;(<span class="string">&quot;Sunday&quot;</span>, <span class="keyword">out</span> day); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæšä¸¾è¡¨ç¤ºçš„æ˜¯ä¸€ç»„ä½æ ‡å¿—ï¼Œé‚£ä¹ˆåº”è¯¥ä½¿ç”¨<code>[Flags]</code>å±æ€§ï¼Œå¹¶ä¸ºæšä¸¾æˆå‘˜æŒ‡å®š<code>2</code>çš„å¹‚æ¬¡æ–¹å€¼ã€‚è¿™æ ·å°±å¯ä»¥ä½¿ç”¨ä½è¿ç®—ç¬¦æ¥ç»„åˆã€æ·»åŠ æˆ–ç§»é™¤æšä¸¾å€¼ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">[<span class="meta">Flags</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> AccessRights</span><br><span class="line">&#123;</span><br><span class="line">    None = <span class="number">0</span>,     <span class="comment">// 0000</span></span><br><span class="line">    Read = <span class="number">1</span>,     <span class="comment">// 0001</span></span><br><span class="line">    Write = <span class="number">2</span>,    <span class="comment">// 0010</span></span><br><span class="line">    Execute = <span class="number">4</span>,  <span class="comment">// 0100</span></span><br><span class="line">    FullControl = Read | Write | Execute <span class="comment">// 0111</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>AccessRights</code>æšä¸¾å®šä¹‰äº†ä¸€ç»„è®¿é—®æƒé™ï¼Œæ¯ä¸ªæƒé™æ˜¯äºŒè¿›åˆ¶ä½çš„ä¸€ä¸ªæ ‡å¿—ã€‚è¿™å…è®¸æˆ‘ä»¬å°†ä¸åŒçš„æƒé™ç»„åˆåˆ°ä¸€èµ·ï¼Œç„¶åé€šè¿‡ä½è¿ç®—æ£€æŸ¥ç‰¹å®šçš„æƒé™æ˜¯å¦å­˜åœ¨ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è®¾ç½®è¯»å’Œå†™æƒé™</span></span><br><span class="line">AccessRights rights = AccessRights.Read | AccessRights.Write;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥æ˜¯å¦æœ‰å†™æƒé™</span></span><br><span class="line"><span class="keyword">if</span> ((rights &amp; AccessRights.Write) == AccessRights.Write)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;æœ‰å†™æƒé™&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;æ— å†™æƒé™&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™¤äº†ä½è¿ç®—ç¬¦çš„ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨<code>HasFlag</code>æ–¹æ³•æ¥æ£€æŸ¥ç‰¹å®šçš„æƒé™æ˜¯å¦å­˜åœ¨ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">AccessRights rights = AccessRights.Read | AccessRights.Write;</span><br><span class="line"></span><br><span class="line">rights.HasFlag(AccessRights.Write) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><hr><h3 id="10-event-å…³é”®å­—"><a href="#10-event-å…³é”®å­—" class="headerlink" title="10. event å…³é”®å­—"></a>10. event å…³é”®å­—</h3><p>åœ¨<code>C#</code>ä¸­ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/keywords/event"><code>event</code></a>å…³é”®å­—ç”¨äºå£°æ˜ä¸€ä¸ªäº‹ä»¶ã€‚ï¼ˆ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/programming-guide/events/how-to-publish-events-that-conform-to-net-framework-guidelines">å¦‚ä½•å‘å¸ƒç¬¦åˆ .NET å‡†åˆ™çš„äº‹ä»¶</a>ï¼‰</p><ul><li>äº‹ä»¶æ˜¯ç”±å¯¹è±¡åœ¨ç‰¹æ®Šæƒ…å†µä¸‹è§¦å‘çš„ä¸€ç§æœºåˆ¶ï¼Œä¾‹å¦‚ç”¨æˆ·ç‚¹å‡»äº†ä¸€ä¸ªæŒ‰é’®ï¼Œæˆ–è€…æŸä¸ªæ“ä½œå·²ç»å®Œæˆã€‚å¯¹è±¡å¯ä»¥è®¢é˜…è¿™ä¸ªäº‹ä»¶ï¼Œè¿™æ ·å½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå°±ä¼šè°ƒç”¨è®¢é˜…è€…å®šä¹‰çš„äº‹ä»¶å¤„ç†ç¨‹åºã€‚</li></ul><p>åœ¨äº‹ä»¶çš„å®šä¹‰ä¸­ï¼Œé€šå¸¸ä¼šæœ‰ä¸¤éƒ¨åˆ†ç»„æˆã€‚ä¸€éƒ¨åˆ†æ˜¯å£°æ˜äº‹ä»¶çš„å§”æ‰˜ï¼ˆ<code>delegate</code>ï¼‰ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯äº‹ä»¶æœ¬èº«ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„<code>event</code>ä½¿ç”¨ä¾‹å­ï¼š</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªå§”æ‰˜</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="keyword">void</span> <span class="title">MyEventHandler</span>(<span class="params"><span class="built_in">string</span> message</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Publisher</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å£°æ˜ä¸€ä¸ªäº‹ä»¶</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">event</span> MyEventHandler MyEvent;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RaiseEvent</span>(<span class="params"><span class="built_in">string</span> message</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è§¦å‘äº‹ä»¶</span></span><br><span class="line">        MyEvent?.Invoke(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Subscriber</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Subscribe</span>(<span class="params">Publisher publisher</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è®¢é˜…äº‹ä»¶</span></span><br><span class="line">        publisher.MyEvent += HandleEvent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">HandleEvent</span>(<span class="params"><span class="built_in">string</span> message</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;æ”¶åˆ°äº†æ¥è‡ªPublisherçš„æ¶ˆæ¯ï¼š <span class="subst">&#123;message&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> publisher = <span class="keyword">new</span> Publisher();</span><br><span class="line">        <span class="keyword">var</span> subscriber = <span class="keyword">new</span> Subscriber();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¢é˜…äº‹ä»¶</span></span><br><span class="line">        subscriber.Subscribe(publisher);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å‘å¸ƒäº‹ä»¶</span></span><br><span class="line">        publisher.RaiseEvent(<span class="string">&quot;Hello, World!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œäº‹ä»¶å¸®åŠ©äº†äº‹ä»¶å‘å¸ƒè€…å’Œè®¢é˜…è€…ä¹‹é—´çš„è§£è€¦ã€‚å‘å¸ƒè€…å¹¶ä¸éœ€è¦çŸ¥é“è°è®¢é˜…äº†å®ƒçš„äº‹ä»¶ï¼Œä¹Ÿä¸éœ€è¦çŸ¥é“äº‹ä»¶å°†å¦‚ä½•è¢«å¤„ç†ã€‚è¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥ç‹¬ç«‹åœ°ä¿®æ”¹å‘å¸ƒè€…å’Œè®¢é˜…è€…çš„ä»£ç ï¼Œè€Œä¸éœ€è¦æ‹…å¿ƒå®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</p><p><code>event</code>å…³é”®å­—ä½¿ç”¨æ³¨æ„ç‚¹ï¼š</p><p>ï¼ˆ1ï¼‰å¦‚æœä¸€ä¸ªå¯¹è±¡è®¢é˜…äº†å¦ä¸€ä¸ªå¯¹è±¡çš„äº‹ä»¶ï¼Œé‚£ä¹ˆåœ¨ä¸éœ€è¦è®¢é˜…äº‹ä»¶æ—¶åº”å½“åŠæ—¶å–æ¶ˆè®¢é˜…ï¼Œä»¥é¿å…å‘ç”Ÿå†…å­˜æ³„æ¼ã€‚ï¼ˆåªè¦äº‹ä»¶å‘å¸ƒè€…è¿˜åœ¨å†…å­˜ä¸­ï¼Œè®¢é˜…è€…å°±ä¸ä¼šè¢«åƒåœ¾å›æ”¶ï¼Œå³ä½¿è®¢é˜…è€…å·²ç»ä¸å†ä½¿ç”¨ï¼‰</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Subscriber</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Subscribe</span>(<span class="params">Publisher publisher</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        publisher.MyEvent += HandleEvent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Unsubscribe</span>(<span class="params">Publisher publisher</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        publisher.MyEvent -= HandleEvent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">HandleEvent</span>(<span class="params"><span class="built_in">object</span> sender, MyEventArgs e</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;æ”¶åˆ°äº†æ¥è‡ªPublisherçš„æ¶ˆæ¯ï¼š <span class="subst">&#123;e.Message&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰è¿˜æœ‰äº‹ä»¶çš„è®¿é—®å™¨ï¼ˆEvent Accessorsï¼‰ï¼Œå§”æ‰˜ç±»å‹ï¼ˆSystem.EventHandlerï¼‰ç­‰ç­‰ï¼ˆå¾…è¡¥å……ï¼‰</p><hr><h3 id="11-explicit-å…³é”®å­—"><a href="#11-explicit-å…³é”®å­—" class="headerlink" title="11. explicit å…³é”®å­—"></a>11. explicit å…³é”®å­—</h3><p>åœ¨<code>C#</code>ä¸­ï¼Œ<a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/language-reference/operators/user-defined-conversion-operators"><code>explicit</code></a>å…³é”®å­—ç”¨äºç±»å‹è½¬æ¢ã€‚</p><ul><li><p><code>explicit</code>å…³é”®å­—é€šå¸¸ç”¨åœ¨ç”¨æˆ·å®šä¹‰çš„ç±»å‹è½¬æ¢æ“ä½œä¸­ï¼Œå…è®¸ä»ä¸€ç§æ•°æ®ç±»å‹è½¬æ¢åˆ°å¦ä¸€ç§æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚ä»ç±»åˆ°æ¥å£ï¼Œæˆ–è€…ä»çˆ¶ç±»åˆ°å­ç±»ç­‰ç­‰ã€‚</p></li><li><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè½¬æ¢æ“ä½œå¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±æˆ–æŠ›å‡ºå¼‚å¸¸ã€‚ä½¿ç”¨<code>explicit</code>å…³é”®å­—å¯ä»¥å¼ºåˆ¶å¼€å‘è€…æ˜ç¡®åœ°å¤„ç†è½¬æ¢ï¼Œä»è€Œå‡å°‘åœ¨è½¬æ¢è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯çš„å¯èƒ½æ€§ã€‚</p></li></ul><p>ä¸‹é¢æ˜¯ä¸€ä¸ª<code>explicit</code>å…³é”®å­—çš„ä¾‹å­ï¼š</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Fahrenheit</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> Temperature &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨èç”¨ lambda è¡¨è¾¾å¼å†™</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">explicit</span> <span class="keyword">operator</span> <span class="title">Celsius</span>(<span class="params">Fahrenheit f</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ConvertToFahrenheit(f);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Celsius <span class="title">ConvertToFahrenheit</span>(<span class="params">Fahrenheit f</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">float</span> celsiusTemperature = (<span class="number">5.0f</span> / <span class="number">9.0f</span>) * (f.Temperature - <span class="number">32</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Celsius(celsiusTemperature);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Celsius</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> Temperature &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Celsius</span>(<span class="params"><span class="built_in">float</span> temp</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Temperature = temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Fahrenheit f = <span class="keyword">new</span> Fahrenheit &#123; Temperature = <span class="number">100</span> &#125;;</span><br><span class="line">Celsius c = (Celsius)f;  <span class="comment">// æ˜¾å¼è½¬æ¢</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä¾‹å­ä¸­ï¼Œä¸èƒ½ç›´æ¥å°†<code>Fahrenheit</code>å¯¹è±¡è½¬æ¢ä¸º<code>Celsius</code>ï¼Œå¿…é¡»æ˜ç¡®åœ°è¿›è¡Œè½¬æ¢ã€‚</p><hr><h3 id="12-foreach-å…³é”®å­—"><a href="#12-foreach-å…³é”®å­—" class="headerlink" title="12. foreach å…³é”®å­—"></a>12. foreach å…³é”®å­—</h3><p>åœ¨<code>C#</code>ä¸­ï¼Œ<code>foreach</code>å…³é”®å­—ç”¨äºéå†é›†åˆï¼ˆå¦‚æ•°ç»„ï¼Œåˆ—è¡¨ç­‰ï¼‰ä¸­çš„å…ƒç´ ã€‚</p><ul><li>å®ƒçš„å·¥ä½œåŸç†æ˜¯é€šè¿‡è°ƒç”¨é›†åˆå¯¹è±¡çš„<code>GetEnumerator</code>æ–¹æ³•æ¥è·å–<code>IEnumerator</code>æˆ–<code>IEnumerator&lt;T&gt;</code>å¯¹è±¡ï¼Œç„¶ååœ¨æ¯æ¬¡è¿­ä»£ä¸­è°ƒç”¨<code>MoveNext</code>æ–¹æ³•å’Œ<code>Current</code>å±æ€§ã€‚</li></ul><p>ï¼ˆæ³¨æ„ï¼Œåé¢<code>IEnumerator</code>å’Œ<code>IEnumerator&lt;T&gt;</code>ç»Ÿç§°ä¸ºæšä¸¾å™¨ï¼‰</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fibNumbers = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt; &#123; <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span> &#125;;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="built_in">int</span> element <span class="keyword">in</span> fibNumbers)</span><br><span class="line">&#123;</span><br><span class="line">    Console.Write(<span class="string">$&quot;<span class="subst">&#123;element&#125;</span> &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Output:</span></span><br><span class="line"><span class="comment">// 0 1 1 2 3 5 8 13</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯ä¸€äº›<code>foreach</code>å…³é”®å­—çš„ä½¿ç”¨æ–¹æ³•ï¼š</p><p>ï¼ˆ1ï¼‰å®ç°æšä¸¾å™¨æ¥å£çš„é›†åˆ</p><p>åœ¨<code>C#</code>ä¸­ï¼Œè®¸å¤šå†…ç½®é›†åˆç±»å‹éƒ½å®ç°äº†æšä¸¾å™¨æ¥å£ï¼Œè¿™ä½¿å¾—å®ƒä»¬å¯ä»¥ä½¿ç”¨<code>foreach</code>å¾ªç¯è¿›è¡Œè¿­ä»£ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">int</span>&gt; dictionary = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">int</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    &#123; <span class="string">&quot;One&quot;</span>, <span class="number">1</span> &#125;,</span><br><span class="line">    &#123; <span class="string">&quot;Two&quot;</span>, <span class="number">2</span> &#125;,</span><br><span class="line">    &#123; <span class="string">&quot;Three&quot;</span>, <span class="number">3</span> &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (KeyValuePair&lt;<span class="built_in">string</span>, <span class="built_in">int</span>&gt; item <span class="keyword">in</span> dictionary)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;Key: <span class="subst">&#123;item.Key&#125;</span>, Value: <span class="subst">&#123;item.Value&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼ç»“æ„ï¼šæ•°ç»„ï¼Œåˆ—è¡¨(List<T>)ï¼Œå­—å…¸(Dictionary&lt;TKey, TValue&gt;)ï¼Œå“ˆå¸Œé›†(HashSet<T>)ï¼Œé˜Ÿåˆ—(Queue<T>)ï¼Œå †æ ˆ(Stack<T>)ï¼Œé“¾è¡¨(LinkedList<T>)ç­‰ç­‰ã€‚</p><p>ï¼ˆ2ï¼‰å®ç°æšä¸¾å™¨æ¥å£çš„è‡ªå®šä¹‰ç±»</p><p>å¦‚æœæƒ³è¦è‡ªå®šä¹‰ç±»èƒ½å¤Ÿè¢«<code>foreach</code>å¾ªç¯éå†ï¼Œéœ€è¦å®ç°æšä¸¾å™¨æ¥å£ã€‚è¿™ä¸ªæ¥å£å®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•ï¼Œ<code>GetEnumerator</code>ï¼Œè¿”å›ä¸€ä¸ªå®ç°äº†æšä¸¾å™¨æ¥å£çš„å¯¹è±¡ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyCollection</span> : <span class="title">IEnumerable</span>&lt;<span class="title">int</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span>[] data = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IEnumerator&lt;<span class="built_in">int</span>&gt; <span class="title">GetEnumerator</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; data.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">yield</span> <span class="keyword">return</span> data[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    IEnumerator IEnumerable.GetEnumerator()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> GetEnumerator();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨è‡ªå®šä¹‰é›†åˆ</span></span><br><span class="line">MyCollection collection = <span class="keyword">new</span> MyCollection();</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="built_in">int</span> number <span class="keyword">in</span> collection)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(number);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰å¼‚æ­¥æµçš„è¿­ä»£<br>å¼‚æ­¥æµçš„è¿­ä»£æ˜¯<code>C# 8.0</code>æ–°å¢çš„ç‰¹æ€§ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿåœ¨å¤„ç†å¼‚æ­¥æ“ä½œæ—¶ï¼Œå†™å‡ºæ›´é«˜æ•ˆå’Œæ›´æ˜“äºç†è§£çš„ä»£ç ã€‚å¼‚æ­¥æµçš„è¿­ä»£é€šè¿‡<code>await foreach</code>å…³é”®å­—å®ç°ã€‚å®ƒèƒ½å¤Ÿå¼‚æ­¥åœ°è¿­ä»£è¿™æ ·çš„åºåˆ—ï¼Œè€Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚</p><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">async</span> IAsyncEnumerable&lt;<span class="built_in">int</span>&gt; <span class="title">GenerateSequence</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> Task.Delay(<span class="number">100</span>);  <span class="comment">// æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ</span></span><br><span class="line">        <span class="keyword">yield</span> <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">TestAsyncStream</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">foreach</span> (<span class="function"><span class="keyword">var</span> number <span class="keyword">in</span> <span class="title">GenerateSequence</span>())</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(number);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œ<code>GenerateSequence</code>æ–¹æ³•ç”Ÿæˆäº†ä¸€ä¸ªå¼‚æ­¥åºåˆ—ã€‚æ¯ä¸ªå…ƒç´ éƒ½æ˜¯åœ¨ç­‰å¾…ä¸€æ®µæ—¶é—´åç”Ÿæˆçš„ï¼Œä»¥æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œã€‚<code>TestAsyncStream</code>æ–¹æ³•ä½¿ç”¨<code>await foreach</code>è¯­å¥æ¥å¼‚æ­¥åœ°è¿­ä»£è¿™ä¸ªåºåˆ—ã€‚æ¯æ¬¡è¿­ä»£éƒ½ä¼šå¼‚æ­¥åœ°ç­‰å¾…ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚</p><hr><h3 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h3><blockquote><p>æ–‡ä»¶è¿˜æœªä¸Šä¼  Github</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES6å­¦ä¹ ç¬”è®° â€¢ ä¸‹</title>
      <link href="/posts/461e57d3.html"/>
      <url>/posts/461e57d3.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>æœ¬è¯»ä¹¦ç¬”è®°èŠ‚é€‰è‡ªé˜®ä¸€å³°ç¼–å†™çš„ <a href="https://es6.ruanyifeng.com/">ã€ŠECMAScript 6 å…¥é—¨æ•™ç¨‹ã€‹</a>ã€‚é€‚åˆå·²ç»æŒæ¡ <code>ES5</code> çš„è¯»è€…ï¼Œç”¨æ¥äº†è§£è¿™é—¨è¯­è¨€çš„æœ€æ–°å‘å±•ã€‚ç¬”è®°å†…å®¹ä»…åŒ…æ‹¬æ—¥å¸¸å¼€å‘ä¸­å¯èƒ½ä¼šç”¨åˆ°çš„æ¦‚å¿µï¼Œå‰©ä½™éƒ¨åˆ†è¯·è‡ªè¡Œé˜…è¯»ã€‚</p></blockquote><hr><h2 id="20-async-å‡½æ•°"><a href="#20-async-å‡½æ•°" class="headerlink" title="20. async å‡½æ•°"></a>20. async å‡½æ•°</h2><h3 id="20-1-å«ä¹‰"><a href="#20-1-å«ä¹‰" class="headerlink" title="20.1 å«ä¹‰"></a>20.1 å«ä¹‰</h3><p><code>ES6</code>å¼•å…¥çš„ <code>async</code> å‡½æ•°ï¼Œä½¿å¾—å¼‚æ­¥æ“ä½œå˜å¾—æ›´åŠ æ–¹ä¾¿ã€‚ç®€å•æ¥è¯´ï¼Œ<code>async</code> å‡½æ•°å°±æ˜¯ <code>Generator</code> å‡½æ•°çš„è¯­æ³•ç³–ã€‚å®ƒå°† <code>Generator</code>å‡½æ•°çš„æ˜Ÿå·<code>*</code>æ›¿æ¢æˆ<code>async</code>ï¼Œ<code>yield</code>æ›¿æ¢æˆ<code>await</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> readFile = <span class="keyword">function</span> (<span class="params">fileName</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    fs.<span class="title function_">readFile</span>(fileName, <span class="keyword">function</span>(<span class="params">error, data</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (error) <span class="keyword">return</span> <span class="title function_">reject</span>(error);</span><br><span class="line">      <span class="title function_">resolve</span>(data);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> gen = <span class="keyword">function</span>* () &#123;</span><br><span class="line">  <span class="keyword">const</span> f1 = <span class="keyword">yield</span> <span class="title function_">readFile</span>(<span class="string">&#x27;/etc/fstab&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> f2 = <span class="keyword">yield</span> <span class="title function_">readFile</span>(<span class="string">&#x27;/etc/shells&#x27;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(f1.<span class="title function_">toString</span>());</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(f2.<span class="title function_">toString</span>());</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>gen</code>ä¾æ¬¡è¯»å–ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¦‚æœå†™æˆ<code>async</code>å‡½æ•°ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> asyncReadFile = <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> f1 = <span class="keyword">await</span> <span class="title function_">readFile</span>(<span class="string">&#x27;/etc/fstab&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> f2 = <span class="keyword">await</span> <span class="title function_">readFile</span>(<span class="string">&#x27;/etc/shells&#x27;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(f1.<span class="title function_">toString</span>());</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(f2.<span class="title function_">toString</span>());</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>async</code>å‡½æ•°å¯¹ <code>Generator</code> å‡½æ•°çš„æ”¹è¿›ï¼Œä½“ç°åœ¨ä»¥ä¸‹å››ç‚¹ï¼š</p><ol><li>å†…ç½®æ‰§è¡Œå™¨: <code>Generator</code> å‡½æ•°çš„æ‰§è¡Œå¿…é¡»é æ‰§è¡Œå™¨ï¼ˆ<code>co</code>æ¨¡å—ï¼‰ï¼Œè€Œ<code>async</code>å‡½æ•°è‡ªå¸¦æ‰§è¡Œå™¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>async</code>å‡½æ•°çš„æ‰§è¡Œï¼Œä¸æ™®é€šå‡½æ•°ä¸€æ¨¡ä¸€æ ·ã€‚</li><li>æ›´å¥½çš„è¯­ä¹‰: <code>async</code>å’Œ<code>await</code>ï¼Œæ¯”èµ·æ˜Ÿå·å’Œ<code>yield</code>ï¼Œè¯­ä¹‰æ›´æ¸…æ¥šäº†ã€‚<code>async</code>è¡¨ç¤ºå‡½æ•°é‡Œæœ‰å¼‚æ­¥æ“ä½œï¼Œ<code>await</code>è¡¨ç¤ºç´§è·Ÿåœ¨åé¢çš„è¡¨è¾¾å¼éœ€è¦ç­‰å¾…ç»“æœã€‚</li><li>æ›´å¹¿çš„é€‚ç”¨æ€§: <code>co</code>æ¨¡å—çº¦å®šï¼Œ<code>yield</code>å‘½ä»¤åé¢åªèƒ½æ˜¯ <code>Thunk</code> å‡½æ•°æˆ– <code>Promise</code> å¯¹è±¡ï¼Œè€Œ<code>async</code>å‡½æ•°çš„<code>await</code>å‘½ä»¤åé¢ï¼Œå¯ä»¥æ˜¯ <code>Promise</code> å¯¹è±¡å’ŒåŸå§‹ç±»å‹çš„å€¼ã€‚ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼ï¼Œä½†ä¼šè‡ªåŠ¨è½¬æˆç«‹å³ <code>resolved</code> çš„ <code>Promise</code> å¯¹è±¡ï¼‰</li><li>è¿”å›å€¼æ˜¯ Promise: <ins><code>async</code>å‡½æ•°çš„è¿”å›å€¼æ˜¯ <code>Promise</code> å¯¹è±¡</ins>ï¼Œè¿™æ¯” <code>Generator</code> å‡½æ•°çš„è¿”å›å€¼æ˜¯ <code>Iterator</code> å¯¹è±¡æ–¹ä¾¿ï¼Œå¯ä»¥ç”¨<code>then</code>æ–¹æ³•æŒ‡å®šä¸‹ä¸€æ­¥çš„æ“ä½œã€‚</li></ol><p>è¿›ä¸€æ­¥è¯´ï¼Œ<code>async</code>å‡½æ•°å¯ä»¥çœ‹ä½œå¤šä¸ªå¼‚æ­¥æ“ä½œï¼ŒåŒ…è£…æˆçš„ä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼Œè€Œ<code>await</code>å‘½ä»¤å°±æ˜¯å¯ä»¥æ›¿ä»£<code>then</code>çš„è¯­æ³•ç³–ã€‚ä¸‹é¢çš„ <code>Promise</code> é“¾å¯ä»¥è¢«é‡å†™ä¸ºä¸€ä¸ª <code>async</code> å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;https://api.example.com/data&#x27;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(data))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error:&#x27;</span>, error));</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;https://api.example.com/data&#x27;</span>);</span><br><span class="line">    <span class="keyword">let</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error:&#x27;</span>, error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="20-2-åŸºæœ¬ç”¨æ³•"><a href="#20-2-åŸºæœ¬ç”¨æ³•" class="headerlink" title="20.2 åŸºæœ¬ç”¨æ³•"></a>20.2 åŸºæœ¬ç”¨æ³•</h3><p><ins><code>async</code>å‡½æ•°è¿”å›ä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨<code>then</code>æ–¹æ³•æ·»åŠ å›è°ƒå‡½æ•°</ins>ã€‚å½“å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œ<ins>é‡åˆ°<code>await</code>å°±ä¼šæš‚åœå½“å‰çš„<code>async</code>å‡½æ•°æ‰§è¡Œï¼Œç­‰åˆ°å¼‚æ­¥æ“ä½œå®Œæˆï¼Œå†æ¥ç€æ‰§è¡Œå‡½æ•°ä½“å†…åé¢çš„è¯­å¥</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchUserData</span>(<span class="params">userId</span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè¿”å›Promiseçš„fetchå‡½æ•°</span></span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`https://api.example.com/user/<span class="subst">$&#123;userId&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éœ€è¦æ£€æŸ¥å“åº”æ˜¯å¦okï¼Œå¦‚æœä¸okåˆ™æŠ›å‡ºé”™è¯¯</span></span><br><span class="line">    <span class="keyword">if</span> (!response.<span class="property">ok</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`HTTP error! status: <span class="subst">$&#123;response.status&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> response.<span class="title function_">json</span>(); <span class="comment">// å‡è®¾æœåŠ¡å™¨å“åº”çš„æ˜¯JSONæ•°æ®</span></span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`There was a problem with the fetch operation: <span class="subst">$&#123;error.message&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨è¿™ä¸ªå‡½æ•°</span></span><br><span class="line"><span class="title function_">fetchUserData</span>(<span class="number">123</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">user</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(user))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(error));</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>fetchUserData</code>æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œå®ƒä½¿ç”¨<code>fetchAPI</code>ä»æœåŠ¡å™¨è·å–æ•°æ®ï¼Œç„¶åä½¿ç”¨<code>await</code>å…³é”®å­—ç­‰å¾…<code>Promise</code>è§£å†³ã€‚æ³¨æ„ï¼Œåœ¨å¼‚æ­¥å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥å§‹ç»ˆä½¿ç”¨<code>try/catch</code>æ¥æ•è·å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚</p><p><code>async</code>å‡½æ•°æœ‰å¤šç§ä½¿ç”¨å½¢å¼ã€‚å®ƒå¯ä»¥ä½œä¸ºå£°æ˜ï¼Œä½œä¸ºè¡¨è¾¾å¼ï¼Œè¿˜å¯ä»¥ç”¨æ¥å®šä¹‰å¯¹è±¡æˆ–ç±»çš„æ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‡½æ•°å£°æ˜</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°è¡¨è¾¾å¼</span></span><br><span class="line"><span class="keyword">const</span> foo = <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹è±¡çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123; <span class="keyword">async</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;&#125; &#125;;</span><br><span class="line">obj.<span class="title function_">foo</span>().<span class="title function_">then</span>(...)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Class çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Storage</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cachePromise</span> = caches.<span class="title function_">open</span>(<span class="string">&#x27;avatars&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getAvatar</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> cache = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">cachePromise</span>;</span><br><span class="line">    <span class="keyword">return</span> cache.<span class="title function_">match</span>(<span class="string">`/avatars/<span class="subst">$&#123;name&#125;</span>.jpg`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> storage = <span class="keyword">new</span> <span class="title class_">Storage</span>();</span><br><span class="line">storage.<span class="title function_">getAvatar</span>(<span class="string">&#x27;jake&#x27;</span>).<span class="title function_">then</span>(â€¦);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç®­å¤´å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">foo</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;&#125;;</span><br></pre></td></tr></table></figure><hr><h3 id="20-3-è¯­æ³•"><a href="#20-3-è¯­æ³•" class="headerlink" title="20.3 è¯­æ³•"></a>20.3 è¯­æ³•</h3><p><code>async</code>å‡½æ•°çš„è¯­æ³•è§„åˆ™æ€»ä½“ä¸Šæ¯”è¾ƒç®€å•ï¼Œéš¾ç‚¹æ˜¯é”™è¯¯å¤„ç†æœºåˆ¶ã€‚</p><p><strong>ï¼ˆ1ï¼‰è¿”å› Promise å¯¹è±¡</strong></p><p><ins><code>async</code>å‡½æ•°è¿”å›ä¸€ä¸ª <code>Promise</code> å¯¹è±¡</ins>ï¼ˆä¸ç®¡æœ‰æ²¡æœ‰<code>return</code>è¯­å¥ï¼Œæ€»æ˜¯è¿”å›ä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼‰ã€‚<ins><code>async</code>å‡½æ•°å†…éƒ¨<code>return</code>è¯­å¥è¿”å›çš„å€¼ï¼Œä¼šæˆä¸º<code>then</code>æ–¹æ³•å›è°ƒå‡½æ•°çš„å‚æ•°</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;hello world&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">f</span>().<span class="title function_">then</span>(<span class="function"><span class="params">v</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(v))</span><br><span class="line"><span class="comment">// &quot;hello world&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>f</code>å†…éƒ¨<code>return</code>å‘½ä»¤è¿”å›çš„å€¼ï¼Œä¼šè¢«<code>then</code>æ–¹æ³•å›è°ƒå‡½æ•°æ¥æ”¶åˆ°ã€‚</p><p><ins><code>async</code>å‡½æ•°å†…éƒ¨æŠ›å‡ºé”™è¯¯ï¼Œä¼šå¯¼è‡´è¿”å›çš„ <code>Promise</code> å¯¹è±¡å˜ä¸º<code>reject</code>çŠ¶æ€</ins>ã€‚æŠ›å‡ºçš„é”™è¯¯å¯¹è±¡ä¼šè¢«<code>catch</code>æ–¹æ³•å›è°ƒå‡½æ•°æ¥æ”¶åˆ°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;å‡ºé”™äº†&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">f</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">v</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;resolve&#x27;</span>, v))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;reject&#x27;</span>, e))</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ2ï¼‰Promise å¯¹è±¡çš„çŠ¶æ€å˜åŒ–</strong></p><p><code>async</code>å‡½æ•°è¿”å›çš„ <code>Promise</code> å¯¹è±¡ï¼Œå¿…é¡»ç­‰åˆ°å†…éƒ¨æ‰€æœ‰<code>await</code>å‘½ä»¤åé¢çš„ <code>Promise</code> å¯¹è±¡æ‰§è¡Œå®Œï¼Œæ‰ä¼šå‘ç”ŸçŠ¶æ€æ”¹å˜ï¼Œé™¤éé‡åˆ°<code>return</code>è¯­å¥æˆ–è€…æŠ›å‡ºé”™è¯¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<ins>åªæœ‰<code>async</code>å‡½æ•°å†…éƒ¨çš„å¼‚æ­¥æ“ä½œæ‰§è¡Œå®Œï¼Œæ‰ä¼šæ‰§è¡Œ<code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">asyncFunc</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;https://api.example.com/data&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">asyncFunc</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(data))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(error));</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>then</code>æ–¹æ³•çš„å›è°ƒå‡½æ•°ä¼šç­‰åˆ°<code>asyncFunc</code>å‡½æ•°å†…éƒ¨çš„ä¸¤ä¸ª<code>await</code>æ“ä½œéƒ½å®Œæˆåæ‰ä¼šè¢«è°ƒç”¨ã€‚</p><p><strong>ï¼ˆ3ï¼‰await å‘½ä»¤</strong></p><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œ<ins><code>await</code>å‘½ä»¤åé¢æ˜¯ä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼Œè¿”å›è¯¥å¯¹è±¡çš„ç»“æœã€‚å¦‚æœä¸æ˜¯ <code>Promise</code> å¯¹è±¡ï¼Œå°±ç›´æ¥è¿”å›å¯¹åº”çš„å€¼</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// ç­‰åŒäº</span></span><br><span class="line">  <span class="comment">// return 123;</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> <span class="number">123</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">f</span>().<span class="title function_">then</span>(<span class="function"><span class="params">v</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(v))</span><br><span class="line"><span class="comment">// 123</span></span><br></pre></td></tr></table></figure><p>å¦ä¸€ç§æƒ…å†µæ˜¯ï¼Œ<code>await</code>å‘½ä»¤åé¢æ˜¯ä¸€ä¸ª<code>thenable</code>å¯¹è±¡ï¼ˆå³å®šä¹‰äº†<code>then</code>æ–¹æ³•çš„å¯¹è±¡ï¼Œè¯¦ç»†è¯·çœ‹<code>Promise</code>ç« èŠ‚çš„<code>resolve()</code>æ–¹æ³•ï¼‰ï¼Œé‚£ä¹ˆ<code>await</code>ä¼šå°†å…¶ç­‰åŒäº <code>Promise</code> å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> thenable = &#123;</span><br><span class="line">  <span class="attr">then</span>: <span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="string">&#x27;Resolved!&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">asyncFunc</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="keyword">await</span> thenable;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(result);  <span class="comment">// &#x27;Resolved!&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">asyncFunc</span>();</span><br><span class="line"><span class="comment">// 1000</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>thenable</code>å¯¹è±¡æœ‰ä¸€ä¸ª<code>then</code>æ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥åœ¨<code>asyncFunc</code>å‡½æ•°ä¸­ä½¿ç”¨<code>await</code>æ¥ç­‰å¾…å®ƒã€‚<ins>å½“<code>JS</code>å¼•æ“çœ‹åˆ°æˆ‘ä»¬è¯•å›¾ç­‰å¾…ä¸€ä¸ª<code>thenable</code>å¯¹è±¡æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨è°ƒç”¨è¯¥å¯¹è±¡çš„<code>then</code>æ–¹æ³•</ins>ï¼Œå¹¶ç­‰å¾…è¯¥æ–¹æ³•è°ƒç”¨å…¶<code>resolve</code>å‚æ•°æ‰€ä¼ å…¥çš„å€¼ã€‚</p><p>å¦‚æœ<ins><code>await</code>å‘½ä»¤åé¢çš„ <code>Promise</code> å¯¹è±¡å¦‚æœå˜ä¸º<code>reject</code>çŠ¶æ€ï¼Œåˆ™<code>reject</code>çš„å‚æ•°ä¼šè¢«<code>catch</code>æ–¹æ³•çš„å›è°ƒå‡½æ•°æ¥æ”¶åˆ°</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&#x27;å‡ºé”™äº†&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">f</span>()</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">v</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(v))</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(e))</span><br><span class="line"><span class="comment">// å‡ºé”™äº†</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œä¸Šé¢ä»£ç ä¸­<code>await</code>è¯­å¥å‰é¢æ²¡æœ‰<code>return</code>ï¼Œä½†æ˜¯<code>reject</code>æ–¹æ³•çš„å‚æ•°ä¾ç„¶ä¼ å…¥äº†<code>catch</code>æ–¹æ³•çš„å›è°ƒå‡½æ•°ã€‚è¿™é‡Œå¦‚æœåœ¨<code>await</code>å‰é¢åŠ ä¸Š<code>return</code>ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚</p><p><ins>ä»»ä½•ä¸€ä¸ª<code>await</code>è¯­å¥åé¢çš„ <code>Promise</code> å¯¹è±¡å˜ä¸º<code>reject</code>çŠ¶æ€ï¼Œä¸ä¼šå¯¼è‡´æ•´ä¸ª <code>async</code> å‡½æ•°ç«‹å³åœæ­¢æ‰§è¡Œï¼Œè€Œæ˜¯ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ <code>try/catch</code> è¯­å¥æ¥æ•è·è¿™ä¸ªå¼‚å¸¸å¹¶å¤„ç†å®ƒã€‚</ins>ï¼ˆå¦‚æœæ²¡æœ‰é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œ<code>async</code>å‡½æ•°ä¼šä¸­æ–­æ‰§è¡Œï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æƒ…å†µ 1</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&#x27;å‡ºé”™äº†&#x27;</span>);</span><br><span class="line">  <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="string">&#x27;hello world&#x27;</span>); <span class="comment">// ä¸ä¼šæ‰§è¡Œ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æƒ…å†µ 2</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">asyncFunc</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;https://api.example.com/data&#x27;</span>);</span><br><span class="line">    <span class="keyword">let</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error:&#x27;</span>, error);</span><br><span class="line">    <span class="comment">// è¿™é‡Œå¯ä»¥å¤„ç†é”™è¯¯ï¼Œå¹¶å†³å®šå¦‚ä½•ç»§ç»­æ‰§è¡Œ</span></span><br><span class="line">    <span class="comment">// æ¯”å¦‚å¯ä»¥é‡æ–°æŠ›å‡ºé”™è¯¯ï¼Œæˆ–è€…è¿”å›ä¸€ä¸ªé»˜è®¤å€¼ï¼Œç­‰ç­‰</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›<ins>å³ä½¿å‰ä¸€ä¸ªå¼‚æ­¥æ“ä½œå¤±è´¥ï¼Œä¹Ÿä¸è¦ä¸­æ–­åé¢çš„å¼‚æ­¥æ“ä½œ</ins>ã€‚æˆ‘ä»¬å¯ä»¥å°†<code>await</code>æ”¾åœ¨<code>try...catch</code>ç»“æ„é‡Œé¢ï¼Œè¿™æ ·ä¸ç®¡è¿™ä¸ªå¼‚æ­¥æ“ä½œæ˜¯å¦æˆåŠŸï¼Œä¸‹ä¸€ä¸ª<code>await</code>éƒ½ä¼šæ‰§è¡Œã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&#x27;å‡ºé”™äº†&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="string">&#x27;hello world&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">f</span>()</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">v</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(v))</span><br><span class="line"><span class="comment">// å‡ºé”™äº†</span></span><br><span class="line"><span class="comment">// hello world</span></span><br></pre></td></tr></table></figure><p>å¦ä¸€ç§æ–¹æ³•æ˜¯<code>await</code>åé¢çš„ <code>Promise</code> å¯¹è±¡å†è·Ÿä¸€ä¸ª<code>catch</code>æ–¹æ³•ï¼Œå¤„ç†å‰é¢å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&#x27;å‡ºé”™äº†&#x27;</span>)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(e));</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="string">&#x27;hello world&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">f</span>()</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">v</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(v))</span><br><span class="line"><span class="comment">// å‡ºé”™äº†</span></span><br><span class="line"><span class="comment">// hello world</span></span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å®ƒæ›´åŠ ç´§å‡‘ï¼Œä¸éœ€è¦æ˜¾å¼åœ°ä½¿ç”¨<code>try/catch</code>ã€‚ä½†å®ƒçš„ç¼ºç‚¹æ˜¯éœ€è¦ç¡®ä¿æ¯ä¸ªå¯èƒ½äº§ç”Ÿé”™è¯¯çš„<code>await</code>éƒ½æœ‰ä¸€ä¸ª<code>catch</code>æ–¹æ³•ï¼Œå¦åˆ™é”™è¯¯å¯èƒ½ä¼šè¢«å¿½è§†ã€‚</p><p><strong>ï¼ˆ4ï¼‰é”™è¯¯å¤„ç†</strong></p><p>å¦‚æœ<ins><code>await</code>åé¢çš„å¼‚æ­¥æ“ä½œå‡ºé”™ï¼Œé‚£ä¹ˆç­‰åŒäº<code>async</code>å‡½æ•°è¿”å›çš„ <code>Promise</code> å¯¹è±¡è¢«<code>reject</code></ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">asyncFunc</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;https://api.example.com/data&#x27;</span>);</span><br><span class="line">  <span class="comment">// å¦‚æœ fetch å‡ºé”™ï¼ˆä¾‹å¦‚ï¼Œç”±äºç½‘ç»œé—®é¢˜ï¼‰ï¼Œé‚£ä¹ˆä¸‹é¢çš„ä»£ç å°†ä¸ä¼šè¢«æ‰§è¡Œ</span></span><br><span class="line">  <span class="keyword">let</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">asyncFunc</span>()</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(data))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error:&#x27;</span>, error));</span><br><span class="line">  <span class="comment">// å¦‚æœ asyncFunc åœ¨ä»»ä½•åœ°æ–¹æŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯ï¼Œé‚£ä¹ˆè¿™ä¸ª .catch å°†ä¼šæ•è·åˆ°</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœ<code>fetch</code>å‡½æ•°æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œé‚£ä¹ˆ<code>asyncFunc</code>ä¼šç«‹å³åœæ­¢æ‰§è¡Œå¹¶æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå¯¼è‡´å®ƒè¿”å›çš„<code>Promise</code>å˜ä¸º<code>rejected</code>çŠ¶æ€ã€‚è¿™ä¸ªé”™è¯¯ç„¶åè¢«<code>catch</code>æ•è·å¹¶å¤„ç†ã€‚</p><p>é˜²æ­¢å‡ºé”™çš„æ–¹æ³•ï¼Œå°±æ˜¯å°†å…¶æ”¾åœ¨<code>try...catch</code>ä»£ç å—ä¹‹ä¸­ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;å‡ºé”™äº†&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">await</span>(<span class="string">&#x27;hello world&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæœ‰å¤šä¸ª<code>await</code>å‘½ä»¤ï¼Œå¯ä»¥ç»Ÿä¸€æ”¾åœ¨<code>try...catch</code>ç»“æ„ä¸­ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> val1 = <span class="keyword">await</span> <span class="title function_">firstStep</span>();</span><br><span class="line">    <span class="keyword">const</span> val2 = <span class="keyword">await</span> <span class="title function_">secondStep</span>(val1);</span><br><span class="line">    <span class="keyword">const</span> val3 = <span class="keyword">await</span> <span class="title function_">thirdStep</span>(val1, val2);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Final: &#x27;</span>, val3);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(err);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œä¸Šé¢ä¸‰ä¸ªå¼‚æ­¥æ“ä½œæ˜¯ä¸²è¡Œå¤„ç†ï¼Œå³<code>secondStep</code>å°†åœ¨<code>firstStep</code>å®Œæˆåå¼€å§‹ã€‚å¦‚æœè¿™ä¸‰ä¸ªæ“ä½œä¹‹é—´æ²¡æœ‰ä¾èµ–å…³ç³»ï¼Œå¯ä»¥ä½¿ç”¨<code>Promise.all()</code>å¹¶è¡Œæ‰§è¡Œä»¥æé«˜æ•ˆç‡ã€‚</p><p><strong>ï¼ˆ5ï¼‰ä½¿ç”¨æ³¨æ„ç‚¹</strong></p><p>ç¬¬ä¸€ç‚¹ï¼Œ<code>await</code>å‘½ä»¤åé¢çš„<code>Promise</code>å¯¹è±¡ï¼Œè¿è¡Œç»“æœå¯èƒ½æ˜¯<code>rejected</code>ï¼Œæ‰€ä»¥<ins>æœ€å¥½æŠŠ<code>await</code>å‘½ä»¤æ”¾åœ¨<code>try...catch</code>ä»£ç å—ä¸­</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">myFunction</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">somethingThatReturnsAPromise</span>();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦ä¸€ç§å†™æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">myFunction</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">somethingThatReturnsAPromise</span>()</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="keyword">function</span> (<span class="params">err</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç‚¹ï¼Œ<ins>å¤šä¸ª<code>await</code>å‘½ä»¤åé¢çš„å¼‚æ­¥æ“ä½œï¼Œå¦‚æœä¸å­˜åœ¨ç»§å‘å…³ç³»ï¼Œæœ€å¥½è®©å®ƒä»¬åŒæ—¶è§¦å‘</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> foo = <span class="keyword">await</span> <span class="title function_">getFoo</span>();</span><br><span class="line"><span class="keyword">let</span> bar = <span class="keyword">await</span> <span class="title function_">getBar</span>();</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>getFoo</code>å’Œ<code>getBar</code>æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„å¼‚æ­¥æ“ä½œï¼ˆå³äº’ä¸ä¾èµ–ï¼‰ï¼Œè¢«å†™æˆç»§å‘å…³ç³»ã€‚è¿™æ ·æ¯”è¾ƒè€—æ—¶ï¼Œå› ä¸ºåªæœ‰<code>getFoo</code>å®Œæˆä»¥åï¼Œæ‰ä¼šæ‰§è¡Œ<code>getBar</code>ï¼Œå®Œå…¨å¯ä»¥è®©å®ƒä»¬åŒæ—¶è§¦å‘ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å†™æ³•ä¸€</span></span><br><span class="line"><span class="keyword">let</span> [foo, bar] = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>([<span class="title function_">getFoo</span>(), <span class="title function_">getBar</span>()]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†™æ³•äºŒ</span></span><br><span class="line"><span class="keyword">let</span> fooPromise = <span class="title function_">getFoo</span>();</span><br><span class="line"><span class="keyword">let</span> barPromise = <span class="title function_">getBar</span>();</span><br><span class="line"><span class="keyword">let</span> foo = <span class="keyword">await</span> fooPromise;</span><br><span class="line"><span class="keyword">let</span> bar = <span class="keyword">await</span> barPromise;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä¸¤ç§å†™æ³•ï¼Œ<code>getFoo</code>å’Œ<code>getBar</code>éƒ½æ˜¯åŒæ—¶è§¦å‘ï¼Œè¿™æ ·å°±ä¼šç¼©çŸ­ç¨‹åºçš„æ‰§è¡Œæ—¶é—´ã€‚</p><p>ç¬¬ä¸‰ç‚¹ï¼Œ<code>await</code>å‘½ä»¤åªèƒ½ç”¨åœ¨<code>async</code>å‡½æ•°ä¹‹ä¸­ï¼Œå¦‚æœç”¨åœ¨æ™®é€šå‡½æ•°ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">dbFuc</span>(<span class="params">db</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> docs = [&#123;&#125;, &#123;&#125;, &#123;&#125;];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æŠ¥é”™</span></span><br><span class="line">  docs.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">doc</span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> db.<span class="title function_">post</span>(doc);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸º<code>await</code>ç”¨åœ¨æ™®é€šå‡½æ•°ä¹‹ä¸­ã€‚ä½†æ˜¯ï¼Œå°±ç®—å°†<code>forEach</code>æ–¹æ³•çš„å‚æ•°æ”¹æˆ<code>async</code>å‡½æ•°ä¹Ÿæœ‰é—®é¢˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">dbFuc</span>(<span class="params">db</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> docs = [&#123;&#125;, &#123;&#125;, &#123;&#125;];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¯èƒ½å¾—åˆ°é”™è¯¯ç»“æœ</span></span><br><span class="line">  docs.<span class="title function_">forEach</span>(<span class="keyword">async</span> <span class="keyword">function</span> (<span class="params">doc</span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> db.<span class="title function_">post</span>(doc);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç å¯èƒ½ä¸ä¼šæ­£å¸¸å·¥ä½œï¼ŒåŸå› æ˜¯è¿™æ—¶ä¸‰ä¸ª<code>db.post()</code>æ“ä½œå°†æ˜¯å¹¶å‘æ‰§è¡Œï¼ˆ<code>forEach</code> ä¸ä¼šç­‰å¾…å›è°ƒå‡½æ•°ï¼‰ï¼Œä¹Ÿå°±æ˜¯åŒæ—¶æ‰§è¡Œï¼Œè€Œä¸æ˜¯ç»§å‘æ‰§è¡Œã€‚æ­£ç¡®çš„å†™æ³•æ˜¯é‡‡ç”¨<code>for</code>å¾ªç¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">dbFuc</span>(<span class="params">db</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> docs = [&#123;&#125;, &#123;&#125;, &#123;&#125;];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> doc <span class="keyword">of</span> docs) &#123;</span><br><span class="line">    <span class="keyword">await</span> db.<span class="title function_">post</span>(doc);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨æ•°ç»„çš„<a href="https://www.javascripttutorial.net/javascript-array-reduce/"><code>reduce()</code></a>æ–¹æ³•æ¥é€ä¸ªé¡ºåºå¤„ç†æ•°ç»„ä¸­çš„å…ƒç´ ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">dbFunc</span>(<span class="params">db</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> docs = [&#123;&#125;, &#123;&#125;, &#123;&#125;];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> docs.<span class="title function_">reduce</span>(<span class="keyword">async</span> (prevPromise, doc) =&gt; &#123;</span><br><span class="line">        <span class="keyword">await</span> prevPromise;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">await</span> db.<span class="title function_">post</span>(doc);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;An error occurred: &quot;</span>, error);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="title class_">Promise</span>.<span class="title function_">resolve</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¼ é€’ç»™<code>reduce()</code>çš„å‡½æ•°è¿”å›ä¸€ä¸ª<code>Promise</code>ï¼Œè¿™ä¸ª<code>Promise</code>åœ¨å‰ä¸€ä¸ª <code>Promise</code>è§£æä¹‹åå¼€å§‹å¦ä¸€é¡¹æ•°æ®åº“æ“ä½œã€‚æˆ‘ä»¬ä½¿ç”¨<code>Promise.resolve()</code>ä½œä¸ºåˆå§‹å€¼ï¼Œä»¥å¼€å§‹ <code>Promise</code>é“¾ã€‚</p><p>å¦‚æœå¸Œæœ›<ins>å¤šä¸ªè¯·æ±‚å¹¶å‘æ‰§è¡Œï¼Œå¯ä»¥ä½¿ç”¨<code>Promise.all()</code>æ–¹æ³•</ins>ã€‚ä¸‹é¢ä¸¤ç§å†™æ³•æ•ˆæœç›¸åŒã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">dbFuc</span>(<span class="params">db</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> docs = [&#123;&#125;, &#123;&#125;, &#123;&#125;];</span><br><span class="line">  <span class="keyword">let</span> promises = docs.<span class="title function_">map</span>(<span class="function">(<span class="params">doc</span>) =&gt;</span> db.<span class="title function_">post</span>(doc));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> results = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(promises);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(results);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…ä½¿ç”¨ä¸‹é¢çš„å†™æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">dbFuc</span>(<span class="params">db</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> docs = [&#123;&#125;, &#123;&#125;, &#123;&#125;];</span><br><span class="line">  <span class="keyword">let</span> promises = docs.<span class="title function_">map</span>(<span class="function">(<span class="params">doc</span>) =&gt;</span> db.<span class="title function_">post</span>(doc));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> results = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> promise <span class="keyword">of</span> promises) &#123;</span><br><span class="line">    results.<span class="title function_">push</span>(<span class="keyword">await</span> promise);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(results);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬å››ç‚¹ï¼Œ<code>async</code> å‡½æ•°å¯ä»¥ä¿ç•™è¿è¡Œå †æ ˆã€‚å®ƒä¼šåœ¨ç­‰å¾…<code>Promise</code>è§£ææœŸé—´æš‚åœå‡½æ•°çš„æ‰§è¡Œï¼Œè€Œä¸æ˜¯åœ¨å…¨å±€èŒƒå›´å†…é˜»æ­¢æ‰§è¡Œï¼Œè¿™ä½¿å¾—è°ƒè¯•å·¥å…·èƒ½å¤Ÿåœ¨å¯èƒ½å‘ç”Ÿé”™è¯¯çš„åœ°æ–¹åœä¸‹æ¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">a</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">b</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="title function_">c</span>());</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡å®šå‡½æ•°<code>a</code>å†…éƒ¨è¿è¡Œäº†ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡<code>b()</code>ã€‚å½“<code>b()</code>è¿è¡Œçš„æ—¶å€™ï¼Œå‡½æ•°<code>a()</code>ä¸ä¼šä¸­æ–­ï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œã€‚<ins>ç­‰åˆ°<code>b()</code>è¿è¡Œç»“æŸï¼Œå¯èƒ½<code>a()</code>æ—©å°±è¿è¡Œç»“æŸäº†ï¼Œ<code>b()</code>æ‰€åœ¨çš„ä¸Šä¸‹æ–‡ç¯å¢ƒå·²ç»æ¶ˆå¤±äº†</ins>ã€‚å¦‚æœ<code>b()</code>æˆ–<code>c()</code>æŠ¥é”™ï¼Œ<a href="https://zhuanlan.zhihu.com/p/26637923">é”™è¯¯å †æ ˆ</a>å°†ä¸åŒ…æ‹¬<code>a()</code>ã€‚</p><p>ç°åœ¨å°†è¿™ä¸ªä¾‹å­æ”¹æˆ<code>async</code>å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">a</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">b</span>();</span><br><span class="line">  <span class="title function_">c</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>b()</code>è¿è¡Œçš„æ—¶å€™ï¼Œ<code>a()</code>æ˜¯æš‚åœæ‰§è¡Œï¼Œä¸Šä¸‹æ–‡ç¯å¢ƒéƒ½ä¿å­˜ç€ã€‚ä¸€æ—¦<code>b()</code>æˆ–<code>c()</code>æŠ¥é”™ï¼Œé”™è¯¯å †æ ˆå°†åŒ…æ‹¬<code>a()</code>ã€‚</p><hr><h3 id="20-4-async-å‡½æ•°å®ç°åŸç†"><a href="#20-4-async-å‡½æ•°å®ç°åŸç†" class="headerlink" title="20.4 async å‡½æ•°å®ç°åŸç†"></a>20.4 async å‡½æ•°å®ç°åŸç†</h3><p><code>async</code> å‡½æ•°çš„å®ç°åŸç†ï¼Œå°±æ˜¯å°† <code>Generator</code> å‡½æ•°å’Œè‡ªåŠ¨æ‰§è¡Œå™¨ï¼ŒåŒ…è£…åœ¨ä¸€ä¸ªå‡½æ•°é‡Œã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">args</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">args</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">spawn</span>(<span class="keyword">function</span>* () &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€æœ‰çš„<code>async</code>å‡½æ•°éƒ½å¯ä»¥å†™æˆä¸Šé¢çš„ç¬¬äºŒç§å½¢å¼ï¼Œå…¶ä¸­çš„<code>spawn</code>å‡½æ•°å°±æ˜¯è‡ªåŠ¨æ‰§è¡Œå™¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">spawn</span>(<span class="params">genF</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> gen = <span class="title function_">genF</span>(); <span class="comment">// å»ºç«‹ Generater å‡½æ•°</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">step</span>(<span class="params">nextF</span>) &#123; <span class="comment">// nextF æ˜¯ä¸€ä¸ª Generater å‡½æ•°</span></span><br><span class="line">      <span class="keyword">let</span> next;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        next = <span class="title function_">nextF</span>(); <span class="comment">// å¯åŠ¨ Generaterï¼Œè¿”å›å½“å‰çŠ¶æ€ï¼Œè¿è¡Œè‡³ä¸‹ä¸€ä¸ª yield</span></span><br><span class="line">      &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">reject</span>(e);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(next.<span class="property">done</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">resolve</span>(next.<span class="property">value</span>); <span class="comment">// ç»“æŸæ‰§è¡Œå™¨</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(next.<span class="property">value</span>).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">v</span>) &#123;</span><br><span class="line">        <span class="title function_">step</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> gen.<span class="title function_">next</span>(v); &#125;); <span class="comment">// å¼€å§‹é€’å½’</span></span><br><span class="line">      &#125;, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="title function_">step</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> gen.<span class="keyword">throw</span>(e); &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä¼ é€’ä¸€ä¸ª functionï¼Œç”¨æ¥å¯åŠ¨ Generaterï¼Œç¬¬ä¸€æ¬¡ä¼ å‚æ˜¯æ— æ•ˆçš„</span></span><br><span class="line">    <span class="title function_">step</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> gen.<span class="title function_">next</span>(<span class="literal">undefined</span>); &#125;); </span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="20-5-å¼‚æ­¥å¤„ç†æ–¹æ³•çš„æ¯”è¾ƒ"><a href="#20-5-å¼‚æ­¥å¤„ç†æ–¹æ³•çš„æ¯”è¾ƒ" class="headerlink" title="20.5 å¼‚æ­¥å¤„ç†æ–¹æ³•çš„æ¯”è¾ƒ"></a>20.5 å¼‚æ­¥å¤„ç†æ–¹æ³•çš„æ¯”è¾ƒ</h3><p>é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ <code>async</code> å‡½æ•°ä¸ <code>Promise</code>ã€<code>Generator</code> å‡½æ•°çš„æ¯”è¾ƒã€‚</p><ul><li>å‡å®šæŸä¸ª <code>DOM</code> å…ƒç´ ä¸Šé¢ï¼Œéƒ¨ç½²äº†ä¸€ç³»åˆ—çš„åŠ¨ç”»ï¼Œå‰ä¸€ä¸ªåŠ¨ç”»ç»“æŸï¼Œæ‰èƒ½å¼€å§‹åä¸€ä¸ªã€‚å¦‚æœå½“ä¸­æœ‰ä¸€ä¸ªåŠ¨ç”»å‡ºé”™ï¼Œå°±ä¸å†å¾€ä¸‹æ‰§è¡Œï¼Œè¿”å›ä¸Šä¸€ä¸ªæˆåŠŸæ‰§è¡Œçš„åŠ¨ç”»çš„è¿”å›å€¼ã€‚</li></ul><p>é¦–å…ˆæ˜¯ <code>Promise</code> çš„å†™æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">chainAnimationsPromise</span>(<span class="params">elem, animations</span>) &#123;</span><br><span class="line">  <span class="comment">// å˜é‡ ret ç”¨æ¥ä¿å­˜ä¸Šä¸€ä¸ªåŠ¨ç”»çš„è¿”å›å€¼</span></span><br><span class="line">  <span class="keyword">let</span> ret = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–ä¸€ä¸ªå·²è§£å†³çš„ Promise</span></span><br><span class="line">  <span class="keyword">let</span> p = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// éå† animations æ•°ç»„ä¸­çš„æ¯ä¸ªåŠ¨ç”»</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> anim <span class="keyword">of</span> animations) &#123;</span><br><span class="line">    <span class="comment">// å°†æ¯ä¸ªåŠ¨ç”»é“¾æ¥åˆ° Promise é“¾</span></span><br><span class="line">    p = p.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">val</span>) &#123; </span><br><span class="line">      <span class="comment">// ä¿å­˜å‰ä¸€ä¸ªåŠ¨ç”»çš„è§£å†³å€¼</span></span><br><span class="line">      ret = val; </span><br><span class="line">      <span class="comment">// æ‰§è¡Œå½“å‰åŠ¨ç”»å¹¶è¿”å›æ–°çš„ Promise</span></span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">anim</span>(elem);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä»»ä½•ä¸€ä¸ªåŠ¨ç”»çš„ Promise è¢«æ‹’ç»ï¼Œå°†è¢« catch æ•æ‰</span></span><br><span class="line">  <span class="keyword">return</span> p.<span class="title function_">catch</span>(<span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="comment">/* å¿½ç•¥é”™è¯¯ï¼Œç»§ç»­æ‰§è¡Œ */</span></span><br><span class="line">  &#125;).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶ <code>Promise</code> çš„å†™æ³•æ¯”å›è°ƒå‡½æ•°çš„å†™æ³•å¤§å¤§æ”¹è¿›ï¼Œä½†æ˜¯ä¸€çœ¼çœ‹ä¸Šå»ï¼Œä»£ç å®Œå…¨éƒ½æ˜¯ <code>Promise</code> çš„ <code>API</code>ï¼Œæ“ä½œæœ¬èº«çš„è¯­ä¹‰åè€Œä¸å®¹æ˜“çœ‹å‡ºæ¥ã€‚</p><p>æ¥ç€æ˜¯ <code>Generator</code> å‡½æ•°çš„å†™æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">chainAnimationsGenerator</span>(<span class="params">elem, animations</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">spawn</span>(<span class="keyword">function</span>*() &#123;</span><br><span class="line">    <span class="keyword">let</span> ret = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> anim <span class="keyword">of</span> animations) &#123;</span><br><span class="line">        ret = <span class="keyword">yield</span> <span class="title function_">anim</span>(elem);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="comment">/* å¿½ç•¥é”™è¯¯ï¼Œç»§ç»­æ‰§è¡Œ */</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä½¿ç”¨ <code>Generator</code> å‡½æ•°éå†äº†æ¯ä¸ªåŠ¨ç”»ï¼Œè¯­ä¹‰æ¯” <code>Promise</code> å†™æ³•æ›´æ¸…æ™°ï¼Œç”¨æˆ·å®šä¹‰çš„æ“ä½œå…¨éƒ¨éƒ½å†™åœ¨<code>spawn</code>å‡½æ•°çš„å†…éƒ¨ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªå†™æ³•å¿…é¡»æä¾›ä¸€ä¸ªä»»åŠ¡è¿è¡Œå™¨ï¼Œè‡ªåŠ¨æ‰§è¡Œ <code>Generator</code> å‡½æ•°ï¼Œè€Œä¸”å¿…é¡»ä¿è¯<code>yield</code>è¯­å¥åé¢çš„è¡¨è¾¾å¼è¿”å›ä¸€ä¸ª <code>Promise</code>ã€‚</p><p>æœ€åæ˜¯ <code>async</code> å‡½æ•°çš„å†™æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">chainAnimationsAsync</span>(<span class="params">elem, animations</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> ret = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> anim <span class="keyword">of</span> animations) &#123;</span><br><span class="line">      ret = <span class="keyword">await</span> <span class="title function_">anim</span>(elem);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">    <span class="comment">/* å¿½ç•¥é”™è¯¯ï¼Œç»§ç»­æ‰§è¡Œ */</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° <code>Async</code> å‡½æ•°çš„å®ç°æœ€ç®€æ´ï¼Œæœ€ç¬¦åˆè¯­ä¹‰ã€‚å®ƒå°† <code>Generator</code> å†™æ³•ä¸­çš„è‡ªåŠ¨æ‰§è¡Œå™¨ï¼Œæ”¹åœ¨è¯­è¨€å±‚é¢æä¾›ï¼Œä¸æš´éœ²ç»™ç”¨æˆ·ï¼Œå› æ­¤ä»£ç é‡æœ€å°‘ã€‚</p><hr><h3 id="20-6-æŒ‰é¡ºåºå®Œæˆå¼‚æ­¥æ“ä½œ"><a href="#20-6-æŒ‰é¡ºåºå®Œæˆå¼‚æ­¥æ“ä½œ" class="headerlink" title="20.6 æŒ‰é¡ºåºå®Œæˆå¼‚æ­¥æ“ä½œ"></a>20.6 æŒ‰é¡ºåºå®Œæˆå¼‚æ­¥æ“ä½œ</h3><p>å®é™…å¼€å‘ä¸­ï¼Œä¼šé‡åˆ°ä¸€ç»„å¼‚æ­¥æ“ä½œéœ€è¦æŒ‰ç…§é¡ºåºå®Œæˆçš„æƒ…å†µã€‚æ¯”å¦‚ï¼Œä¾æ¬¡è¿œç¨‹è¯»å–ä¸€ç»„ <code>URL</code>ï¼Œç„¶åæŒ‰ç…§è¯»å–çš„é¡ºåºè¾“å‡ºç»“æœã€‚</p><p><code>Promise</code> çš„å†™æ³•å¦‚ä¸‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">logInOrder</span>(<span class="params">urls</span>) &#123;</span><br><span class="line">  <span class="comment">// è¿œç¨‹è¯»å–æ‰€æœ‰URL</span></span><br><span class="line">  <span class="keyword">const</span> textPromises = urls.<span class="title function_">map</span>(<span class="function"><span class="params">url</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fetch</span>(url).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">text</span>());</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æŒ‰æ¬¡åºè¾“å‡º</span></span><br><span class="line">  <span class="comment">// chain ä»£è¡¨å½“å‰çš„ Promise é“¾ï¼Œåˆå§‹å€¼æ˜¯ Promise.resolve()</span></span><br><span class="line">  textPromises.<span class="title function_">reduce</span>(<span class="function">(<span class="params">chain, textPromise</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°çš„ Promise</span></span><br><span class="line">    <span class="keyword">return</span> chain.<span class="title function_">then</span>(<span class="function">() =&gt;</span> textPromise) <span class="comment">// è¿”å›å½“å‰æ­£åœ¨å¤„ç†çš„ textPromise</span></span><br><span class="line">      .<span class="title function_">then</span>(<span class="function"><span class="params">text</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(text));</span><br><span class="line">  &#125;, <span class="title class_">Promise</span>.<span class="title function_">resolve</span>()); <span class="comment">// åˆå§‹åŒ– Promise é“¾</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä½¿ç”¨<code>fetch</code>æ–¹æ³•ï¼ŒåŒæ—¶è¿œç¨‹è¯»å–ä¸€ç»„ <code>URL</code>ã€‚æ¯ä¸ª<code>fetch</code>æ“ä½œéƒ½è¿”å›ä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼Œæ”¾å…¥<code>textPromises</code>æ•°ç»„ã€‚ç„¶åï¼Œ<code>reduce</code>æ–¹æ³•ä¾æ¬¡å¤„ç†æ¯ä¸ª <code>Promise</code> å¯¹è±¡ï¼Œç„¶åä½¿ç”¨<code>then</code>ï¼Œå°†æ‰€æœ‰ <code>Promise</code> å¯¹è±¡è¿èµ·æ¥ï¼Œå› æ­¤å°±å¯ä»¥ä¾æ¬¡è¾“å‡ºç»“æœã€‚</p><p>è¿™ç§å†™æ³•å¯è¯»æ€§æ¯”è¾ƒå·®ã€‚ä¸‹é¢æ˜¯ <code>async</code> å‡½æ•°å®ç°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">logInOrder</span>(<span class="params">urls</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> url <span class="keyword">of</span> urls) &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(url);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">await</span> response.<span class="title function_">text</span>());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ç¡®å®å¤§å¤§ç®€åŒ–ï¼Œ<ins>é—®é¢˜æ˜¯æ‰€æœ‰è¿œç¨‹æ“ä½œéƒ½æ˜¯ç»§å‘ã€‚åªæœ‰å‰ä¸€ä¸ª <code>URL</code> è¿”å›ç»“æœï¼Œæ‰ä¼šå»è¯»å–ä¸‹ä¸€ä¸ª <code>URL</code></ins>ï¼Œè¿™æ ·åšæ•ˆç‡å¾ˆå·®ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯å¹¶å‘å‘å‡ºè¿œç¨‹è¯·æ±‚ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">logInOrder</span>(<span class="params">urls</span>) &#123;</span><br><span class="line">  <span class="comment">// å¹¶å‘è¯»å–è¿œç¨‹URL</span></span><br><span class="line">  <span class="keyword">const</span> textPromises = urls.<span class="title function_">map</span>(<span class="keyword">async</span> url =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(url);</span><br><span class="line">    <span class="keyword">return</span> response.<span class="title function_">text</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æŒ‰æ¬¡åºè¾“å‡º</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> textPromise <span class="keyword">of</span> textPromises) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">await</span> textPromise);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>urls.map</code> æ–¹æ³•ä¼šå¯¹ <code>urls</code> æ•°ç»„çš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œè¿™ä¸ªå¼‚æ­¥å‡½æ•°ä¼šè¿œç¨‹è¯»å–<code>URL</code>ï¼Œç„¶åç­‰å¾…å“åº”ã€‚æ‰€æœ‰çš„è¿™äº›æ“ä½œéƒ½åœ¨ <code>map</code> æ–¹æ³•è°ƒç”¨çš„åŒæ—¶å¼€å§‹ï¼Œæ‰€ä»¥è¿™äº›æ“ä½œæ˜¯å¹¶å‘çš„ã€‚</p><p>æ³¨æ„ï¼Œåœ¨è¿™ä¸ªå¼‚æ­¥å‡½æ•°ä¸­ï¼Œ<code>await fetch(url)</code> ä¼šæš‚åœå‡½æ•°çš„æ‰§è¡Œï¼Œç›´åˆ° <code>fetch</code> æ“ä½œå®Œæˆã€‚ä½†æ˜¯ï¼Œè¿™å¹¶ä¸ä¼šé˜»æ­¢å…¶ä»–æ“ä½œï¼Œå› ä¸ºæ¯ä¸ªå…ƒç´ éƒ½åœ¨è‡ªå·±çš„å¼‚æ­¥å‡½æ•°ä¸­å¤„ç†ã€‚å› æ­¤ï¼Œ<code>textPromises</code> æ˜¯ä¸€ä¸ªåŒ…å«<code>Promise</code>çš„æ•°ç»„ï¼Œæ¯ä¸ª<code>Promise</code>éƒ½ä»£è¡¨ä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„å¼‚æ­¥æ“ä½œã€‚</p><hr><h3 id="20-7-å¼‚æ­¥æ“ä½œç»§å‘ä¸å¹¶å‘"><a href="#20-7-å¼‚æ­¥æ“ä½œç»§å‘ä¸å¹¶å‘" class="headerlink" title="20.7 å¼‚æ­¥æ“ä½œç»§å‘ä¸å¹¶å‘"></a>20.7 å¼‚æ­¥æ“ä½œç»§å‘ä¸å¹¶å‘</h3><p>ç»§å‘æ‰§è¡Œå¼‚æ­¥æ“ä½œæ„å‘³ç€ç­‰å¾…ä¸€ä¸ªæ“ä½œå®Œæˆåå†æ‰§è¡Œä¸‹ä¸€ä¸ªæ“ä½œã€‚</p><p>ï¼ˆ1ï¼‰ä½¿ç”¨ Promise é“¾</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>();</span><br><span class="line"></span><br><span class="line">[func1, func2, func3].<span class="title function_">forEach</span>(<span class="function"><span class="params">func</span> =&gt;</span> &#123;</span><br><span class="line">    promise = promise.<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="title function_">func</span>());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;All async operations finished.&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>func1</code>, <code>func2</code> å’Œ <code>func3</code> æ˜¯è¿”å›<code>Promise</code>çš„å¼‚æ­¥å‡½æ•°ã€‚è¿™ä¸ªä»£ç æ®µåˆ›å»ºäº†ä¸€ä¸ª<code>Promise</code>é“¾ï¼Œä¾æ¬¡è°ƒç”¨æ¯ä¸ªå‡½æ•°ï¼Œå¹¶åœ¨æ‰€æœ‰å‡½æ•°éƒ½å®Œæˆåè¾“å‡ºä¸€æ¡æ¶ˆæ¯ã€‚</p><p>ï¼ˆ2ï¼‰ä½¿ç”¨ Promise é“¾ II</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">doAsyncOperation1</span>()</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">result1</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(result1);</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">doAsyncOperation2</span>();</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">result2</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(result2);</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">doAsyncOperation3</span>();</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">result3</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(result3);</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ¯ä¸€ä¸ª <code>then</code> é‡Œé¢è¿”å›ä¸€ä¸ªæ–°çš„ <code>Promise</code>ï¼Œè¿™æ ·åªæœ‰å‰ä¸€ä¸ª <code>Promise</code> çŠ¶æ€å˜ä¸º <code>resolved</code>ï¼Œåä¸€ä¸ª <code>Promise</code> æ‰ä¼šå¼€å§‹æ‰§è¡Œã€‚</p><p>ï¼ˆ3ï¼‰ä½¿ç”¨ async&#x2F;await</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">runInSequence</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">func1</span>();</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">func2</span>();</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">func3</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;All async operations finished.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">runInSequence</span>();</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>func1</code>, <code>func2</code> å’Œ <code>func3</code>ä¹Ÿæ˜¯è¿”å›<code>Promise</code>çš„å¼‚æ­¥å‡½æ•°ã€‚<code>runInSequence</code>å‡½æ•°ä½¿ç”¨<code>await</code>å…³é”®å­—ä¾æ¬¡ç­‰å¾…æ¯ä¸ªå‡½æ•°å®Œæˆï¼Œç„¶åè¾“å‡ºä¸€æ¡æ¶ˆæ¯ã€‚</p><p>ï¼ˆ4ï¼‰ä½¿ç”¨ forâ€¦of å¾ªç¯</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">runInSequence</span>(<span class="params">functions</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> func <span class="keyword">of</span> functions) &#123;</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">func</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;All async operations finished.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">runInSequence</span>([func1, func2, func3]);</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­å’Œå‰ä¸€ä¸ªä¾‹å­ç±»ä¼¼ï¼Œä½†æ˜¯<code>runInSequence</code>å‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°æ•°ç»„ï¼Œå¹¶ä½¿ç”¨<code>for...of</code>å¾ªç¯æ¥ä¾æ¬¡è°ƒç”¨å®ƒä»¬ã€‚</p><p>å¹¶å‘æ‰§è¡Œå¼‚æ­¥æ“ä½œæ˜¯æŒ‡åŒæ—¶å¼€å§‹å¤šä¸ªå¼‚æ­¥æ“ä½œï¼Œå¹¶åœ¨å®ƒä»¬éƒ½å®Œæˆåè¿›è¡Œä¸‹ä¸€æ­¥ã€‚</p><p>ï¼ˆ1ï¼‰ä½¿ç”¨ Promise.all() </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> promise1 = <span class="title function_">doAsyncOperation1</span>();</span><br><span class="line"><span class="keyword">let</span> promise2 = <span class="title function_">doAsyncOperation2</span>();</span><br><span class="line"><span class="keyword">let</span> promise3 = <span class="title function_">doAsyncOperation3</span>();</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>([promise1, promise2, promise3])</span><br><span class="line">.<span class="title function_">then</span>(<span class="function">(<span class="params">[result1, result2, result3]</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(result1, result2, result3);</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">error</span>(err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¸‰ä¸ª<code>promise</code>ä¼šåŒæ—¶å¼€å§‹ï¼Œå¹¶è¡Œæ‰§è¡Œã€‚åªæœ‰å½“è¿™ä¸‰ä¸ªæ“ä½œéƒ½æˆåŠŸå®Œæˆï¼Œ<code>Promise.all()</code> æ‰ä¼šè§£å†³ã€‚å¦‚æœä»»ä½•ä¸€ä¸ªæ“ä½œå¤±è´¥ï¼Œé‚£ä¹ˆ <code>Promise.all()</code> ä¹Ÿä¼šç«‹å³è¢« <code>reject</code>ï¼Œä¸å†ç­‰å¾…å…¶ä»–æ“ä½œã€‚</p><p>ï¼ˆ2ï¼‰ä½¿ç”¨ Promise.allSettled() </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> promise1 = <span class="title function_">doAsyncOperation1</span>();</span><br><span class="line"><span class="keyword">let</span> promise2 = <span class="title function_">doAsyncOperation2</span>();</span><br><span class="line"><span class="keyword">let</span> promise3 = <span class="title function_">doAsyncOperation3</span>();</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">allSettled</span>([promise1, promise2, promise3])</span><br><span class="line">.<span class="title function_">then</span>(<span class="function">(<span class="params">results</span>) =&gt;</span> &#123;</span><br><span class="line">  results.<span class="title function_">forEach</span>(<span class="function">(<span class="params">result, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (result.<span class="property">status</span> === <span class="string">&quot;fulfilled&quot;</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Operation <span class="subst">$&#123;index + <span class="number">1</span>&#125;</span> succeeded with <span class="subst">$&#123;result.value&#125;</span>`</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Operation <span class="subst">$&#123;index + <span class="number">1</span>&#125;</span> failed with <span class="subst">$&#123;result.reason&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>Promise.allSettled()</code> çš„è¡Œä¸ºä¸ <code>Promise.all()</code> ç±»ä¼¼ï¼Œä½†æ˜¯å®ƒä¼šç­‰å¾…æ‰€æœ‰æ“ä½œå®Œæˆï¼Œæ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚è¿™å¯¹äºå¸Œæœ›äº†è§£æ‰€æœ‰æ“ä½œçš„ç»“æœï¼Œè€Œä¸ä»…ä»…æ˜¯ç¬¬ä¸€ä¸ªå¤±è´¥çš„æ“ä½œå¾ˆæœ‰ç”¨ã€‚</p><p>ï¼ˆ3ï¼‰ä½¿ç”¨ async&#x2F;await ç»“åˆ for..of</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> urls = [<span class="string">&#x27;url1&#x27;</span>, <span class="string">&#x27;url2&#x27;</span>, <span class="string">&#x27;url3&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> requests = urls.<span class="title function_">map</span>(<span class="function"><span class="params">url</span> =&gt;</span> <span class="title function_">fetch</span>(url));</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> request <span class="keyword">of</span> requests) &#123;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="keyword">await</span> request;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•å¯ä»¥å¹¶å‘å¯åŠ¨å¤šä¸ªå¼‚æ­¥æ“ä½œï¼Œä½†ç­‰å¾…ç»“æœçš„é¡ºåºä¾ç„¶æ˜¯ä¸²è¡Œçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ç§æ–¹æ³•ä¸ä¼šé˜»æ­¢å¼‚æ­¥æ“ä½œçš„å¯åŠ¨ï¼Œä½†ä¼šæŒ‰é¡ºåºç­‰å¾…æ¯ä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœã€‚</p><hr><h3 id="20-8-é¡¶å±‚-await"><a href="#20-8-é¡¶å±‚-await" class="headerlink" title="20.8 é¡¶å±‚ await"></a>20.8 é¡¶å±‚ await</h3><p>æ—©æœŸçš„è¯­æ³•è§„å®šï¼Œ<code>await</code>å‘½ä»¤åªèƒ½å‡ºç°åœ¨ <code>async</code> å‡½æ•°å†…éƒ¨ï¼Œå¦åˆ™æŠ¥é”™ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŠ¥é”™</span></span><br><span class="line"><span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;https://api.example.com&#x27;</span>);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>await</code>å‘½ä»¤ç‹¬ç«‹ä½¿ç”¨ï¼Œæ²¡æœ‰æ”¾åœ¨ <code>async</code> å‡½æ•°é‡Œé¢ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p><p>ä» <a href="https://github.com/tc39/proposal-top-level-await">ES6</a> å¼€å§‹ï¼Œå…è®¸åœ¨æ¨¡å—çš„é¡¶å±‚ç‹¬ç«‹ä½¿ç”¨<code>await</code>å‘½ä»¤ï¼Œä½¿å¾—ä¸Šé¢é‚£è¡Œä»£ç ä¸ä¼šæŠ¥é”™äº†ã€‚å®ƒçš„ä¸»è¦ç›®çš„æ˜¯ä½¿ç”¨<code>await</code>è§£å†³æ¨¡å—å¼‚æ­¥åŠ è½½çš„é—®é¢˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// awaiting.js</span></span><br><span class="line"><span class="keyword">let</span> output;</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> dynamic = <span class="keyword">await</span> <span class="keyword">import</span>(someMission);</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">fetch</span>(url);</span><br><span class="line">  output = <span class="title function_">someProcess</span>(dynamic.<span class="property">default</span>, data);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">main</span>();</span><br><span class="line"><span class="keyword">export</span> &#123; output &#125;;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ¨¡å—<code>awaiting.js</code>çš„è¾“å‡ºå€¼<code>output</code>ï¼Œå–å†³äºå¼‚æ­¥æ“ä½œã€‚æˆ‘ä»¬æŠŠå¼‚æ­¥æ“ä½œåŒ…è£…åœ¨ä¸€ä¸ª <code>async</code> å‡½æ•°é‡Œé¢ï¼Œç„¶åè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œåªæœ‰ç­‰é‡Œé¢çš„å¼‚æ­¥æ“ä½œéƒ½æ‰§è¡Œï¼Œå˜é‡<code>output</code>æ‰ä¼šæœ‰å€¼ï¼Œå¦åˆ™å°±è¿”å›<code>undefined</code>ã€‚</p><p>ä¸‹é¢æ˜¯åŠ è½½è¿™ä¸ªæ¨¡å—çš„å†™æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// usage.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; output &#125; <span class="keyword">from</span> <span class="string">&quot;./awaiting.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">outputPlusValue</span>(<span class="params">value</span>) &#123; <span class="keyword">return</span> output + value &#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">outputPlusValue</span>(<span class="number">100</span>));</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">outputPlusValue</span>(<span class="number">100</span>)), <span class="number">1000</span>);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<ins><code>outputPlusValue()</code>çš„æ‰§è¡Œç»“æœï¼Œå®Œå…¨å–å†³äºæ‰§è¡Œçš„æ—¶é—´ã€‚å¦‚æœ<code>awaiting.js</code>é‡Œé¢çš„å¼‚æ­¥æ“ä½œæ²¡æ‰§è¡Œå®Œï¼ŒåŠ è½½è¿›æ¥çš„<code>output</code>çš„å€¼å°±æ˜¯<code>undefined</code></ins>ã€‚</p><p>ç›®å‰çš„è§£å†³æ–¹æ³•ï¼Œå°±æ˜¯è®©åŸå§‹æ¨¡å—è¾“å‡ºä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼Œä»è¿™ä¸ª <code>Promise</code> å¯¹è±¡åˆ¤æ–­å¼‚æ­¥æ“ä½œæœ‰æ²¡æœ‰ç»“æŸï¼ˆæ£€æŸ¥å½“å‰çŠ¶æ€æ˜¯å¦ä¸º<code>resolved</code>ï¼Œå³ä½¿ç”¨<code>then</code>çš„å›è°ƒå‡½æ•°ï¼‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// awaiting.js</span></span><br><span class="line"><span class="keyword">let</span> output;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (<span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> dynamic = <span class="keyword">await</span> <span class="keyword">import</span>(someMission);</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">fetch</span>(url);</span><br><span class="line">  output = <span class="title function_">someProcess</span>(dynamic.<span class="property">default</span>, data);</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="keyword">export</span> &#123; output &#125;;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>awaiting.js</code>é™¤äº†è¾“å‡º<code>output</code>ï¼Œè¿˜é»˜è®¤è¾“å‡ºä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼ˆ<code>async</code> å‡½æ•°ç«‹å³æ‰§è¡Œåï¼Œè¿”å›ä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼‰ï¼Œä»è¿™ä¸ªå¯¹è±¡åˆ¤æ–­å¼‚æ­¥æ“ä½œæ˜¯å¦ç»“æŸã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// usage.js</span></span><br><span class="line"><span class="keyword">import</span> promise, &#123; output &#125; <span class="keyword">from</span> <span class="string">&quot;./awaiting.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">outputPlusValue</span>(<span class="params">value</span>) &#123; <span class="keyword">return</span> output + value &#125;</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">outputPlusValue</span>(<span class="number">100</span>));</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">outputPlusValue</span>(<span class="number">100</span>)), <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå°†<code>awaiting.js</code>å¯¹è±¡çš„è¾“å‡ºï¼Œæ”¾åœ¨<code>promise.then()</code>é‡Œé¢ï¼Œè¿™æ ·å°±èƒ½ä¿è¯å¼‚æ­¥æ“ä½œå®Œæˆä»¥åï¼Œæ‰å»è¯»å–<code>output</code>ã€‚</p><p>è¿™ç§å†™æ³•æ¯”è¾ƒéº»çƒ¦ï¼Œ<ins>ç­‰äºè¦æ±‚æ¨¡å—çš„ä½¿ç”¨è€…éµå®ˆä¸€ä¸ªé¢å¤–çš„ä½¿ç”¨åè®®</ins>ï¼ŒæŒ‰ç…§ç‰¹æ®Šçš„æ–¹æ³•ä½¿ç”¨è¿™ä¸ªæ¨¡å—ã€‚ä¸€æ—¦å¿˜è®°ä½¿ç”¨ <code>Promise</code> åŠ è½½ï¼Œè¿™ä¸ªæ¨¡å—çš„ä»£ç å°±å¯èƒ½å‡ºé”™ã€‚</p><p><ins>é¡¶å±‚çš„<code>await</code>å‘½ä»¤ï¼Œå°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å®ƒä¿è¯åªæœ‰å¼‚æ­¥æ“ä½œå®Œæˆï¼Œæ¨¡å—æ‰ä¼šè¾“å‡ºå€¼</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// awaiting.js</span></span><br><span class="line"><span class="keyword">const</span> dynamic = <span class="keyword">import</span>(someMission);</span><br><span class="line"><span class="keyword">const</span> data = <span class="title function_">fetch</span>(url);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> output = <span class="title function_">someProcess</span>((<span class="keyword">await</span> dynamic).<span class="property">default</span>, <span class="keyword">await</span> data);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<ins>ä¸¤ä¸ªå¼‚æ­¥æ“ä½œåœ¨è¾“å‡ºçš„æ—¶å€™ï¼Œéƒ½åŠ ä¸Šäº†<code>await</code>å‘½ä»¤ã€‚åªæœ‰ç­‰åˆ°å¼‚æ­¥æ“ä½œå®Œæˆï¼Œè¿™ä¸ªæ¨¡å—æ‰ä¼šè¾“å‡ºå€¼</ins>ã€‚åŠ è½½è¿™ä¸ªæ¨¡å—çš„å†™æ³•å¦‚ä¸‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// usage.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; output &#125; <span class="keyword">from</span> <span class="string">&quot;./awaiting.js&quot;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">outputPlusValue</span>(<span class="params">value</span>) &#123; <span class="keyword">return</span> output + value &#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">outputPlusValue</span>(<span class="number">100</span>));</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">outputPlusValue</span>(<span class="number">100</span>)), <span class="number">1000</span>);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç çš„å†™æ³•ï¼Œä¸æ™®é€šçš„æ¨¡å—åŠ è½½å®Œå…¨ä¸€æ ·ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¨¡å—çš„ä½¿ç”¨è€…å®Œå…¨ä¸ç”¨å…³å¿ƒï¼Œä¾èµ–æ¨¡å—çš„å†…éƒ¨æœ‰æ²¡æœ‰å¼‚æ­¥æ“ä½œï¼Œæ­£å¸¸åŠ è½½å³å¯ã€‚</p><p>è¿™æ—¶ï¼Œæ¨¡å—çš„åŠ è½½ä¼šç­‰å¾…ä¾èµ–æ¨¡å—çš„å¼‚æ­¥æ“ä½œå®Œæˆï¼Œæ‰æ‰§è¡Œåé¢çš„ä»£ç ã€‚æ‰€ä»¥ï¼Œå®ƒæ€»æ˜¯ä¼šå¾—åˆ°æ­£ç¡®çš„<code>output</code>ï¼Œä¸ä¼šå› ä¸ºåŠ è½½æ—¶æœºçš„ä¸åŒï¼Œè€Œå¾—åˆ°ä¸ä¸€æ ·çš„å€¼ã€‚</p><p>æ³¨æ„ï¼Œé¡¶å±‚<code>await</code>åªèƒ½ç”¨åœ¨ <code>ES6</code> æ¨¡å—ã€‚</p><hr><h2 id="21-Class-çš„åŸºæœ¬è¯­æ³•"><a href="#21-Class-çš„åŸºæœ¬è¯­æ³•" class="headerlink" title="21. Class çš„åŸºæœ¬è¯­æ³•"></a>21. Class çš„åŸºæœ¬è¯­æ³•</h2><h3 id="21-1-ç±»çš„ç”±æ¥"><a href="#21-1-ç±»çš„ç”±æ¥" class="headerlink" title="21.1 ç±»çš„ç”±æ¥"></a>21.1 ç±»çš„ç”±æ¥</h3><p>åœ¨<code>JS</code>ä¸­ï¼Œç”Ÿæˆå®ä¾‹å¯¹è±¡çš„ä¼ ç»Ÿæ–¹æ³•æ˜¯é€šè¿‡æ„é€ å‡½æ•°ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Point</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">x</span> = x;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">y</span> = y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Point</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;(&#x27;</span> + <span class="variable language_">this</span>.<span class="property">x</span> + <span class="string">&#x27;, &#x27;</span> + <span class="variable language_">this</span>.<span class="property">y</span> + <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="title class_">Point</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™ç§å†™æ³•è·Ÿä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è¯­è¨€ï¼ˆæ¯”å¦‚ <code>C++</code> å’Œ <code>Java</code>ï¼‰å·®å¼‚å¾ˆå¤§ï¼Œå¾ˆå®¹æ˜“æ„Ÿåˆ°å›°æƒ‘ã€‚</p><p><code>ES6</code> å¼•å…¥äº† <code>Class</code>ï¼ˆç±»ï¼‰è¿™ä¸ªæ¦‚å¿µã€‚é€šè¿‡<code>class</code>å…³é”®å­—ï¼Œå¯ä»¥å®šä¹‰ç±»ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">x</span> = x;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">y</span> = y;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">toString</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;(&#x27;</span> + <span class="variable language_">this</span>.<span class="property">x</span> + <span class="string">&#x27;, &#x27;</span> + <span class="variable language_">this</span>.<span class="property">y</span> + <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ªâ€œç±»â€ï¼Œ<ins>å¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰ä¸€ä¸ª<code>constructor()</code>æ–¹æ³•ï¼Œè¿™å°±æ˜¯æ„é€ æ–¹æ³•ï¼Œè€Œ<code>this</code>å…³é”®å­—åˆ™ä»£è¡¨å®ä¾‹å¯¹è±¡</ins>ã€‚æ–°çš„<code>class</code>å†™æ³•è®©å¯¹è±¡åŸå‹çš„å†™æ³•æ›´åŠ æ¸…æ™°ã€æ›´åƒé¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚</p><p><code>Point</code>ç±»é™¤äº†æ„é€ æ–¹æ³•ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ª<code>toString()</code>æ–¹æ³•ã€‚æ³¨æ„ï¼Œå®šä¹‰<code>toString()</code>æ–¹æ³•çš„æ—¶å€™ï¼Œå‰é¢ä¸éœ€è¦åŠ ä¸Š<code>function</code>è¿™ä¸ªå…³é”®å­—ï¼Œç›´æ¥æŠŠå‡½æ•°å®šä¹‰æ”¾è¿›å»äº†å°±å¯ä»¥äº†ã€‚</p><p>ä½¿ç”¨çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯ç›´æ¥å¯¹ç±»ä½¿ç”¨<code>new</code>å‘½ä»¤ï¼Œè·Ÿæ„é€ å‡½æ•°çš„ç”¨æ³•å®Œå…¨ä¸€è‡´ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">x</span> = x;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">y</span> = y;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">toString</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;(&#x27;</span> + <span class="variable language_">this</span>.<span class="property">x</span> + <span class="string">&#x27;, &#x27;</span> + <span class="variable language_">this</span>.<span class="property">y</span> + <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> point = <span class="keyword">new</span> <span class="title class_">Point</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">point.<span class="title function_">toString</span>();</span><br></pre></td></tr></table></figure><p>äº‹å®ä¸Šï¼Œç±»çš„æ‰€æœ‰æ–¹æ³•éƒ½å®šä¹‰åœ¨ç±»çš„<code>prototype</code>å±æ€§ä¸Šé¢ï¼ˆä¹Ÿç§°ä¸ºåŸå‹å¯¹è±¡ï¼‰ã€‚å› æ­¤ï¼Œåœ¨ç±»çš„å®ä¾‹ä¸Šé¢è°ƒç”¨æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨åŸå‹ä¸Šçš„æ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Car</span>(<span class="params">make, model, year</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">make</span> = make;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">model</span> = model;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">year</span> = year;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Car</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">start</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">make</span> + <span class="string">&quot; &quot;</span> + <span class="variable language_">this</span>.<span class="property">model</span> + <span class="string">&quot; engine started.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> car1 = <span class="keyword">new</span> <span class="title class_">Car</span>(<span class="string">&#x27;Eagle&#x27;</span>, <span class="string">&#x27;Talon TSi&#x27;</span>, <span class="number">1993</span>);</span><br><span class="line">car1.<span class="title function_">start</span>();  <span class="comment">// è¾“å‡ºï¼š&quot;Eagle Talon TSi engine started.&quot;</span></span><br></pre></td></tr></table></figure><p>ç”±äºç±»çš„æ–¹æ³•éƒ½å®šä¹‰åœ¨<code>prototype</code>å¯¹è±¡ä¸Šé¢ï¼Œæ‰€ä»¥ç±»çš„æ–°æ–¹æ³•å¯ä»¥æ·»åŠ åœ¨<code>prototype</code>å¯¹è±¡ä¸Šé¢ã€‚<code>Object.assign()</code>æ–¹æ³•å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä¸€æ¬¡å‘ç±»æ·»åŠ å¤šä¸ªæ–¹æ³•ã€‚ï¼ˆ<code>class</code> ç›´æ¥æ·»åŠ å°±è¡Œï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Car</span>(<span class="params">make, model, year</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">make</span> = make;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">model</span> = model;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">year</span> = year;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="title class_">Car</span>.<span class="property"><span class="keyword">prototype</span></span>, &#123;</span><br><span class="line">  <span class="attr">start</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">make</span> + <span class="string">&quot; &quot;</span> + <span class="variable language_">this</span>.<span class="property">model</span> + <span class="string">&quot; engine started.&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">stop</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">make</span> + <span class="string">&quot; &quot;</span> + <span class="variable language_">this</span>.<span class="property">model</span> + <span class="string">&quot; engine stopped.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> car1 = <span class="keyword">new</span> <span class="title class_">Car</span>(<span class="string">&#x27;Eagle&#x27;</span>, <span class="string">&#x27;Talon TSi&#x27;</span>, <span class="number">1993</span>);</span><br><span class="line">car1.<span class="title function_">start</span>();  <span class="comment">// è¾“å‡ºï¼š&quot;Eagle Talon TSi engine started.&quot;</span></span><br><span class="line">car1.<span class="title function_">stop</span>();   <span class="comment">// è¾“å‡ºï¼š&quot;Eagle Talon TSi engine stopped.&quot;</span></span><br></pre></td></tr></table></figure><p>åœ¨<code>JS</code>ä¸­ï¼Œæ¯ä¸€ä¸ªå‡½æ•°ï¼ˆåŒ…æ‹¬ç±»ï¼Œå› ä¸ºåœ¨<code>JS</code>ä¸­ç±»ä¹Ÿæ˜¯å‡½æ•°ï¼‰éƒ½æœ‰ä¸€ä¸ª<code>prototype</code>å±æ€§ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æœ‰ä¸€ä¸ª<code>constructor</code>å±æ€§ï¼Œé»˜è®¤æŒ‡å‘å‡½æ•°æœ¬èº«ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>prototype</code>å¯¹è±¡çš„ <code>constructor</code>å±æ€§ç›´æ¥æŒ‡å‘â€œç±»â€çš„æœ¬èº«ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">make, model, year</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">make</span> = make;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">model</span> = model;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">year</span> = year;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Car</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> === <span class="title class_">Car</span>);  <span class="comment">// è¾“å‡ºï¼štrue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> car = <span class="keyword">new</span> <span class="title class_">Car</span>(<span class="string">&#x27;Eagle&#x27;</span>, <span class="string">&#x27;Talon TSi&#x27;</span>, <span class="number">1993</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(car.<span class="property">constructor</span> === <span class="title class_">Car</span>);  <span class="comment">// è¾“å‡ºï¼štrue</span></span><br></pre></td></tr></table></figure><hr><h3 id="21-2-constructor-æ–¹æ³•"><a href="#21-2-constructor-æ–¹æ³•" class="headerlink" title="21.2 constructor æ–¹æ³•"></a>21.2 constructor æ–¹æ³•</h3><p><code>constructor()</code>æ–¹æ³•æ˜¯ç±»çš„é»˜è®¤æ–¹æ³•ï¼Œ<ins>é€šè¿‡<code>new</code>å‘½ä»¤ç”Ÿæˆå¯¹è±¡å®ä¾‹æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•</ins>ã€‚ä¸€ä¸ªç±»å¿…é¡»æœ‰<code>constructor()</code>æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼å®šä¹‰ï¼Œä¸€ä¸ªç©ºçš„<code>constructor()</code>æ–¹æ³•ä¼šè¢«é»˜è®¤æ·»åŠ ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæƒ³åœ¨åˆ›å»ºå¯¹è±¡æ—¶è¿›è¡Œä¸€äº›åˆå§‹åŒ–æ“ä½œï¼Œæ¯”å¦‚è®¾ç½®å¯¹è±¡çš„å±æ€§ï¼Œé‚£ä¹ˆéœ€è¦æ˜¾å¼å®šä¹‰ä½ è‡ªå·±çš„ <code>constructor()</code>æ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">make, model, year</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">make</span> = make;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">model</span> = model;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">year</span> = year;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">start</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">make</span> + <span class="string">&quot; &quot;</span> + <span class="variable language_">this</span>.<span class="property">model</span> + <span class="string">&quot; engine started.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> car = <span class="keyword">new</span> <span class="title class_">Car</span>(<span class="string">&#x27;Eagle&#x27;</span>, <span class="string">&#x27;Talon TSi&#x27;</span>, <span class="number">1993</span>);</span><br><span class="line">car.<span class="title function_">start</span>();  <span class="comment">// è¾“å‡ºï¼š&quot;Eagle Talon TSi engine started.&quot;</span></span><br></pre></td></tr></table></figure><p><code>constructor()</code>æ–¹æ³•é»˜è®¤è¿”å›å®ä¾‹å¯¹è±¡ï¼ˆå³<code>this</code>ï¼‰ï¼Œä½†å®Œå…¨å¯ä»¥æŒ‡å®šè¿”å›å¦å¤–ä¸€ä¸ªå¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">make, model, year</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">make</span> = make;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">model</span> = model;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">year</span> = year;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶è¿”å›å®ƒ</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">make</span>: <span class="string">&#x27;Ford&#x27;</span>,</span><br><span class="line">      <span class="attr">model</span>: <span class="string">&#x27;F-150&#x27;</span>,</span><br><span class="line">      <span class="attr">year</span>: <span class="number">2020</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> car = <span class="keyword">new</span> <span class="title class_">Car</span>(<span class="string">&#x27;Eagle&#x27;</span>, <span class="string">&#x27;Talon TSi&#x27;</span>, <span class="number">1993</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(car.<span class="property">make</span>);  <span class="comment">// è¾“å‡ºï¼š&quot;Ford&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>constructor()</code>æ–¹æ³•è¿”å›äº†ä¸€ä¸ªå®Œå…¨ä¸åŒçš„å¯¹è±¡ã€‚å› æ­¤ï¼Œå½“æˆ‘ä»¬æ‰“å°<code>car.make</code>æ—¶ï¼Œè¾“å‡ºçš„æ˜¯<code>&#39;Ford&#39;</code>è€Œä¸æ˜¯<code>&#39;Eagle&#39;</code>ã€‚</p><hr><h3 id="21-3-ç±»çš„å®ä¾‹"><a href="#21-3-ç±»çš„å®ä¾‹" class="headerlink" title="21.3 ç±»çš„å®ä¾‹"></a>21.3 ç±»çš„å®ä¾‹</h3><p>ç”Ÿæˆç±»çš„å®ä¾‹çš„å†™æ³•ï¼Œä¸<code>ES5</code>å®Œå…¨ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä½¿ç”¨<code>new</code>å‘½ä»¤ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ¥é”™</span></span><br><span class="line"><span class="keyword">let</span> point = <span class="title class_">Point</span>(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­£ç¡®</span></span><br><span class="line"><span class="keyword">let</span> point = <span class="keyword">new</span> <span class="title class_">Point</span>(<span class="number">2</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure><p><ins>ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œé™¤éæ˜¾å¼å®šä¹‰åœ¨å…¶æœ¬èº«ï¼ˆå³å®šä¹‰åœ¨<code>this</code>å¯¹è±¡ä¸Šï¼Œé€šè¿‡å®ä¾‹è®¿é—®ï¼‰ï¼Œå¦åˆ™éƒ½æ˜¯å®šä¹‰åœ¨åŸå‹ä¸Šï¼ˆå³å®šä¹‰åœ¨<code>class</code>ä¸Šï¼Œé™æ€å±æ€§æˆ–è€…é™æ€æ–¹æ³•ï¼‰</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">make, model, year</span>) &#123;</span><br><span class="line">    <span class="comment">// å®ä¾‹å±æ€§</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">make</span> = make;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">model</span> = model;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">year</span> = year;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åŸå‹æ–¹æ³•</span></span><br><span class="line">  <span class="title function_">start</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">make</span> + <span class="string">&quot; &quot;</span> + <span class="variable language_">this</span>.<span class="property">model</span> + <span class="string">&quot; engine started.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é™æ€æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">isCar</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> obj <span class="keyword">instanceof</span> <span class="title class_">Car</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é™æ€å±æ€§</span></span><br><span class="line"><span class="title class_">Car</span>.<span class="property">manu</span> = <span class="string">&quot;Unknown&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> car = <span class="keyword">new</span> <span class="title class_">Car</span>(<span class="string">&#x27;Eagle&#x27;</span>, <span class="string">&#x27;Talon TSi&#x27;</span>, <span class="number">1993</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(car.<span class="property">make</span>);  <span class="comment">// è¾“å‡ºï¼š&quot;Eagle&quot;</span></span><br><span class="line">car.<span class="title function_">start</span>();  <span class="comment">// è¾“å‡ºï¼š&quot;Eagle Talon TSi engine started.&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Car</span>.<span class="title function_">isCar</span>(car));  <span class="comment">// è¾“å‡ºï¼štrue</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Car</span>.<span class="property">manu</span>);  <span class="comment">// è¾“å‡ºï¼š&quot;Unknown&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>make</code>ã€<code>model</code>å’Œ<code>year</code>æ˜¯å®ä¾‹å±æ€§ï¼Œ<code>start</code>æ˜¯åŸå‹æ–¹æ³•ï¼Œ<code>isCar</code>æ˜¯é™æ€æ–¹æ³•ï¼Œ<code>manu</code>æ˜¯é™æ€å±æ€§ã€‚å¯ä»¥çœ‹åˆ°ï¼Œ<code>make</code>å’Œ<code>start</code>å¯ä»¥é€šè¿‡å®ä¾‹<code>car</code>è®¿é—®ï¼Œè€Œ<code>isCar</code>å’Œ<code>manu</code>åªèƒ½é€šè¿‡ç±»å<code>Car</code>è®¿é—®ã€‚</p><p>ä¸<code>ES5</code>ä¸€æ ·ï¼Œ<ins>ç±»çš„æ‰€æœ‰å®ä¾‹å…±äº«ä¸€ä¸ªåŸå‹å¯¹è±¡</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="title class_">Point</span>(<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="title class_">Point</span>(<span class="number">3</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">p1.<span class="property">__proto__</span> === p2.<span class="property">__proto__</span></span><br><span class="line"><span class="comment">//true</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>p1</code>å’Œ<code>p2</code>éƒ½æ˜¯<code>Point</code>çš„å®ä¾‹ï¼Œå®ƒä»¬çš„åŸå‹éƒ½æ˜¯<code>Point.prototype</code>ï¼Œæ‰€ä»¥<code>__proto__</code>å±æ€§æ˜¯ç›¸ç­‰çš„ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œå¯ä»¥é€šè¿‡å®ä¾‹çš„<code>__proto__</code>å±æ€§ä¸ºâ€œç±»â€æ·»åŠ æ–¹æ³•ã€‚</p><p>ç„¶è€Œï¼Œä½¿ç”¨ <code>__proto__</code> é€šå¸¸æ˜¯ä¸æ¨èçš„ï¼Œå› ä¸ºè¿™å¹¶ä¸æ˜¯è¯­è¨€çš„ä¸€ä¸ªæ ‡å‡†ç‰¹æ€§ï¼Œè€Œä¸”åœ¨ä¸åŒçš„ <code>JS</code> ç¯å¢ƒä¸­å¯èƒ½è¡¨ç°ä¸åŒã€‚æ›´å¥½çš„æ–¹å¼æ˜¯ç›´æ¥ä½¿ç”¨ <code>Object.getPrototypeOf(obj)</code> å‡½æ•°è·å–ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œæˆ–è€…ä½¿ç”¨ <code>Object.setPrototypeOf(obj, prototype)</code> å‡½æ•°è®¾ç½®ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="title class_">Point</span>(<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="title class_">Point</span>(<span class="number">3</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">p1.<span class="property">__proto__</span>.<span class="property">printName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123; <span class="keyword">return</span> <span class="string">&#x27;Oops&#x27;</span> &#125;;</span><br><span class="line"></span><br><span class="line">p1.<span class="title function_">printName</span>() <span class="comment">// &quot;Oops&quot;</span></span><br><span class="line">p2.<span class="title function_">printName</span>() <span class="comment">// &quot;Oops&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p3 = <span class="keyword">new</span> <span class="title class_">Point</span>(<span class="number">4</span>,<span class="number">2</span>);</span><br><span class="line">p3.<span class="title function_">printName</span>() <span class="comment">// &quot;Oops&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç åœ¨<code>p1</code>çš„åŸå‹ä¸Šæ·»åŠ äº†ä¸€ä¸ª<code>printName()</code>æ–¹æ³•ï¼Œç”±äº<code>p1</code>çš„åŸå‹å°±æ˜¯<code>p2</code>çš„åŸå‹ï¼Œå› æ­¤<code>p2</code>ä¹Ÿå¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚è€Œä¸”ï¼Œæ­¤åæ–°å»ºçš„å®ä¾‹<code>p3</code>ä¹Ÿå¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚<ins>è¿™æ„å‘³ç€ï¼Œä½¿ç”¨å®ä¾‹çš„<code>__proto__</code>å±æ€§æ”¹å†™åŸå‹ï¼Œå¿…é¡»ç›¸å½“è°¨æ…ï¼Œä¸æ¨èä½¿ç”¨ï¼Œå› ä¸ºè¿™ä¼šæ”¹å˜â€œç±»â€çš„åŸå§‹å®šä¹‰ï¼Œå½±å“åˆ°æ‰€æœ‰å®ä¾‹</ins>ã€‚</p><hr><h3 id="21-4-å®ä¾‹å±æ€§çš„æ–°å†™æ³•"><a href="#21-4-å®ä¾‹å±æ€§çš„æ–°å†™æ³•" class="headerlink" title="21.4 å®ä¾‹å±æ€§çš„æ–°å†™æ³•"></a>21.4 å®ä¾‹å±æ€§çš„æ–°å†™æ³•</h3><p><a href="https://github.com/tc39/proposal-class-fields">ES6</a> ä¸ºç±»çš„å®ä¾‹å±æ€§ï¼Œåˆè§„å®šäº†ä¸€ç§æ–°å†™æ³•ã€‚å®ä¾‹å±æ€§ç°åœ¨é™¤äº†å¯ä»¥å®šä¹‰åœ¨<code>constructor()</code>æ–¹æ³•é‡Œé¢çš„<code>this</code>ä¸Šé¢ï¼Œ<ins>ä¹Ÿå¯ä»¥å®šä¹‰åœ¨ç±»å†…éƒ¨çš„æœ€é¡¶å±‚</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŸæ¥çš„å†™æ³•</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IncreasingCounter</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_count</span> = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">value</span>() &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Getting the current value!&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_count</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_count</span>++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå®ä¾‹å±æ€§<code>_count</code>å®šä¹‰åœ¨<code>constructor()</code>æ–¹æ³•é‡Œé¢çš„<code>this</code>ä¸Šé¢ã€‚ç°åœ¨çš„æ–°å†™æ³•æ˜¯ï¼Œè¿™ä¸ªå±æ€§ä¹Ÿå¯ä»¥å®šä¹‰åœ¨ç±»çš„æœ€é¡¶å±‚ï¼Œå…¶ä»–éƒ½ä¸å˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">IncreasingCounter</span> &#123;</span><br><span class="line">  _count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">value</span>() &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Getting the current value!&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_count</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_count</span>++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå®ä¾‹å±æ€§<code>_count</code>ä¸å–å€¼å‡½æ•°<code>value()</code>å’Œ<code>increment()</code>æ–¹æ³•ï¼Œå¤„äºåŒä¸€ä¸ªå±‚çº§ã€‚è¿™æ—¶ï¼Œä¸éœ€è¦åœ¨å®ä¾‹å±æ€§å‰é¢åŠ ä¸Š<code>this</code>ã€‚</p><p>æ³¨æ„ï¼Œ<ins>æ–°å†™æ³•å®šä¹‰çš„å±æ€§æ˜¯å®ä¾‹å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œè€Œä¸æ˜¯å®šä¹‰åœ¨å®ä¾‹å¯¹è±¡çš„åŸå‹<code>prototype</code>ä¸Šé¢</ins>ã€‚å› ä¸ºå¦‚æœåŸå‹å˜äº†ï¼Œæ¯”å¦‚è¿™é‡Œçš„<code>_count</code>æˆ‘ä»¬åšè®¡æ•°å¤„ç†ï¼Œé‚£ä¹ˆæ‰€æœ‰å®ä¾‹çš„<code>_count</code>å±æ€§éƒ½ä¼šæ”¹å˜ï¼Œè¿™å°±ä¼šå‡ºç°ä¸æˆ‘ä»¬é¢„æœŸä¸åŒçš„ç»“æœã€‚</p><p>è¿™ç§æ–°å†™æ³•çš„å¥½å¤„æ˜¯ï¼Œæ‰€æœ‰å®ä¾‹å¯¹è±¡è‡ªèº«çš„å±æ€§éƒ½å®šä¹‰åœ¨ç±»çš„å¤´éƒ¨ï¼Œçœ‹ä¸Šå»æ¯”è¾ƒæ•´é½ï¼Œä¸€çœ¼å°±èƒ½çœ‹å‡ºè¿™ä¸ªç±»æœ‰å“ªäº›å®ä¾‹å±æ€§ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">foo</span> &#123;</span><br><span class="line">  bar = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">  baz = <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ï¼Œ<code>foo</code>ç±»æœ‰ä¸¤ä¸ªå®ä¾‹å±æ€§ï¼Œä¸€ç›®äº†ç„¶ã€‚å¦å¤–ï¼Œå†™èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€æ´ã€‚</p><hr><h3 id="21-5-å–å€¼å‡½æ•°-getter-å’Œå­˜å€¼å‡½æ•°-setter"><a href="#21-5-å–å€¼å‡½æ•°-getter-å’Œå­˜å€¼å‡½æ•°-setter" class="headerlink" title="21.5 å–å€¼å‡½æ•° getter å’Œå­˜å€¼å‡½æ•° setter"></a>21.5 å–å€¼å‡½æ•° getter å’Œå­˜å€¼å‡½æ•° setter</h3><p>ä¸<code>ES5</code>ä¸€æ ·ï¼Œ<ins>åœ¨â€œç±»â€çš„å†…éƒ¨å¯ä»¥ä½¿ç”¨<code>get</code>å’Œ<code>set</code>å…³é”®å­—ï¼Œå¯¹æŸä¸ªå±æ€§è®¾ç½®å­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°ï¼Œæ‹¦æˆªè¯¥å±æ€§çš„å­˜å–è¡Œä¸º</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_myProperty</span> = <span class="string">&#x27;Default value&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Getter</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">myProperty</span>() &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Getting myProperty&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_myProperty</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Setter</span></span><br><span class="line">  <span class="keyword">set</span> <span class="title function_">myProperty</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Setting myProperty&#x27;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_myProperty</span> = value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">myProperty</span>);  <span class="comment">// è¾“å‡ºï¼š&quot;Getting myProperty&quot; å’Œ &quot;Default value&quot;</span></span><br><span class="line">obj.<span class="property">myProperty</span> = <span class="string">&#x27;New value&#x27;</span>; <span class="comment">// è¾“å‡ºï¼š&quot;Setting myProperty&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">myProperty</span>);  <span class="comment">// è¾“å‡ºï¼š&quot;Getting myProperty&quot; å’Œ &quot;New value&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>myProperty</code>å±æ€§æœ‰å¯¹åº”çš„å­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°ï¼Œå› æ­¤èµ‹å€¼å’Œè¯»å–è¡Œä¸ºéƒ½è¢«è‡ªå®šä¹‰äº†ã€‚æ³¨æ„ï¼Œ<ins>å­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°æ˜¯è®¾ç½®åœ¨å±æ€§çš„ <code>Descriptor</code> å¯¹è±¡ä¸Šçš„</ins>ã€‚</p><hr><h3 id="21-6-Class-è¡¨è¾¾å¼"><a href="#21-6-Class-è¡¨è¾¾å¼" class="headerlink" title="21.6 Class è¡¨è¾¾å¼"></a>21.6 Class è¡¨è¾¾å¼</h3><p>ä¸å‡½æ•°ä¸€æ ·ï¼Œç±»ä¹Ÿå¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼çš„å½¢å¼å®šä¹‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‘½åç±»è¡¨è¾¾å¼</span></span><br><span class="line"><span class="keyword">let</span> <span class="title class_">User</span> = <span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">sayHello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> user = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&#x27;Alice&#x27;</span>);</span><br><span class="line">user.<span class="title function_">sayHello</span>(); <span class="comment">// è¾“å‡º &quot;Hello, my name is Alice&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">MyClass</span>); <span class="comment">// æŠ¥é”™ï¼ŒMyClass åœ¨ç±»å¤–éƒ¨ä¸å¯ç”¨</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä½¿ç”¨è¡¨è¾¾å¼å®šä¹‰äº†ä¸€ä¸ªç±»ã€‚<ins>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªç±»çš„åå­—æ˜¯<code>MyClass</code>ï¼Œä½†æ˜¯<code>MyClass</code>åªåœ¨ <code>Class</code> çš„å†…éƒ¨å¯ç”¨ï¼ŒæŒ‡ä»£å½“å‰ç±»ã€‚åœ¨ <code>Class</code> å¤–éƒ¨ï¼Œè¿™ä¸ªç±»åªèƒ½ç”¨<code>User</code>å¼•ç”¨</ins>ã€‚</p><p>å¦‚æœç±»çš„å†…éƒ¨æ²¡ç”¨åˆ°çš„è¯ï¼Œå¯ä»¥çœç•¥<code>MyClass</code>ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŒ¿åç±»è¡¨è¾¾å¼</span></span><br><span class="line"><span class="keyword">let</span> <span class="title class_">User</span> = <span class="keyword">class</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">sayHello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> user = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&#x27;Alice&#x27;</span>);</span><br><span class="line">user.<span class="title function_">sayHello</span>(); <span class="comment">// è¾“å‡º &quot;Hello, my name is Alice&quot;</span></span><br></pre></td></tr></table></figure><p>é‡‡ç”¨ <code>Class</code> è¡¨è¾¾å¼ï¼Œå¯ä»¥å†™å‡ºç«‹å³æ‰§è¡Œçš„ <code>Class</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> user = <span class="keyword">new</span> <span class="keyword">class</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">sayHello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;(<span class="string">&#x27;Alice&#x27;</span>);</span><br><span class="line"></span><br><span class="line">user.<span class="title function_">sayHello</span>(); <span class="comment">// è¾“å‡º &quot;Hello, my name is Alice&quot;</span></span><br></pre></td></tr></table></figure><hr><h3 id="21-7-é™æ€æ–¹æ³•"><a href="#21-7-é™æ€æ–¹æ³•" class="headerlink" title="21.7 é™æ€æ–¹æ³•"></a>21.7 é™æ€æ–¹æ³•</h3><p>ç±»ç›¸å½“äºå®ä¾‹çš„åŸå‹ï¼Œæ‰€æœ‰åœ¨ç±»ä¸­å®šä¹‰çš„æ–¹æ³•éƒ½ä¼šè¢«å®ä¾‹ç»§æ‰¿ã€‚<ins>å¦‚æœåœ¨ä¸€ä¸ªæ–¹æ³•å‰ï¼ŒåŠ ä¸Š<code>static</code>å…³é”®å­—ï¼Œå°±è¡¨ç¤ºè¯¥æ–¹æ³•ä¸ä¼šè¢«å®ä¾‹ç»§æ‰¿ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡ç±»æ¥è°ƒç”¨ï¼Œè¿™å°±ç§°ä¸ºâ€œé™æ€æ–¹æ³•â€</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">classMethod</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Foo</span>.<span class="title function_">classMethod</span>() <span class="comment">// &#x27;hello&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> foo = <span class="keyword">new</span> <span class="title class_">Foo</span>();</span><br><span class="line">foo.<span class="title function_">classMethod</span>()</span><br><span class="line"><span class="comment">// TypeError: foo.classMethod is not a function</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Foo</code>ç±»çš„<code>classMethod</code>æ–¹æ³•å‰æœ‰<code>static</code>å…³é”®å­—ï¼Œè¡¨æ˜è¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨<code>Foo</code>ç±»ä¸Šè°ƒç”¨ï¼Œè€Œä¸æ˜¯åœ¨<code>Foo</code>ç±»çš„å®ä¾‹ä¸Šè°ƒç”¨ã€‚å¦‚æœåœ¨å®ä¾‹ä¸Šè°ƒç”¨é™æ€æ–¹æ³•ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¡¨ç¤ºä¸å­˜åœ¨è¯¥æ–¹æ³•ã€‚</p><p>æ³¨æ„ï¼Œ<ins>å¦‚æœé™æ€æ–¹æ³•åŒ…å«<code>this</code>å…³é”®å­—ï¼Œè¿™ä¸ª<code>this</code>æŒ‡çš„æ˜¯ç±»ï¼Œè€Œä¸æ˜¯å®ä¾‹</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">myStaticMethod</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">myInstanceMethod</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">MyClass</span>.<span class="title function_">myStaticMethod</span>(); <span class="comment">// è¾“å‡º MyClass [Function: MyClass]ï¼Œthis æŒ‡å‘ç±»</span></span><br><span class="line"><span class="keyword">let</span> instance = <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line">instance.<span class="title function_">myInstanceMethod</span>(); <span class="comment">// è¾“å‡º MyClass &#123;&#125;ï¼Œthis æŒ‡å‘å®ä¾‹</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>myStaticMethod</code>æ˜¯<code>MyClass</code>çš„é™æ€æ–¹æ³•ï¼Œ<code>this</code>æŒ‡å‘çš„æ˜¯ç±»<code>MyClass</code>ã€‚<code>myInstanceMethod</code>æ˜¯å®ä¾‹æ–¹æ³•ï¼Œ<code>this</code>æŒ‡å‘çš„æ˜¯ç±»çš„å®ä¾‹ã€‚å¦å¤–ï¼Œä»è¿™ä¸ªä¾‹å­è¿˜å¯ä»¥çœ‹å‡ºï¼Œ<ins>é™æ€æ–¹æ³•å¯ä»¥ä¸éé™æ€æ–¹æ³•é‡å</ins>ã€‚</p><p><ins>çˆ¶ç±»çš„é™æ€æ–¹æ³•ï¼Œå¯ä»¥è¢«å­ç±»ç»§æ‰¿</ins>ã€‚åŒæ—¶ï¼Œ<ins>é™æ€æ–¹æ³•ä¹Ÿæ˜¯å¯ä»¥ä»<code>super</code>å¯¹è±¡ä¸Šè°ƒç”¨çš„</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ParentClass</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">greeting</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hello from ParentClass&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ChildClass</span> <span class="keyword">extends</span> <span class="title class_ inherited__">ParentClass</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ChildClass</span>.<span class="title function_">greeting</span>(); <span class="comment">// è¾“å‡º &quot;Hello from ParentClass&quot;</span></span><br><span class="line"></span><br><span class="line">-----------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ParentClass</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">greeting</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hello from ParentClass&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ChildClass</span> <span class="keyword">extends</span> <span class="title class_ inherited__">ParentClass</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">greeting</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>.<span class="title function_">greeting</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hello from ChildClass&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ChildClass</span>.<span class="title function_">greeting</span>(); </span><br><span class="line"><span class="comment">// è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment">// &quot;Hello from ParentClass&quot;</span></span><br><span class="line"><span class="comment">// &quot;Hello from ChildClass&quot;</span></span><br></pre></td></tr></table></figure><hr><h3 id="21-8-ç§æœ‰æ–¹æ³•å’Œç§æœ‰å±æ€§"><a href="#21-8-ç§æœ‰æ–¹æ³•å’Œç§æœ‰å±æ€§" class="headerlink" title="21.8 ç§æœ‰æ–¹æ³•å’Œç§æœ‰å±æ€§"></a>21.8 ç§æœ‰æ–¹æ³•å’Œç§æœ‰å±æ€§</h3><p><a href="https://github.com/tc39/proposal-class-fields">ES6</a>ä¸º<code>class</code>æ·»åŠ äº†ç§æœ‰å±æ€§ï¼Œ<ins>æ–¹æ³•æ˜¯åœ¨å±æ€§åä¹‹å‰ä½¿ç”¨<code>#</code>è¡¨ç¤º</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">IncreasingCounter</span> &#123;</span><br><span class="line">  #count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">value</span>() &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Getting the current value!&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#count;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#count++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> counter = <span class="keyword">new</span> <span class="title class_">IncreasingCounter</span>();</span><br><span class="line">counter.#count <span class="comment">// æŠ¥é”™</span></span><br><span class="line">counter.#count = <span class="number">42</span> <span class="comment">// æŠ¥é”™</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>#count</code>å°±æ˜¯ç§æœ‰å±æ€§ï¼Œåªèƒ½åœ¨ç±»çš„å†…éƒ¨ä½¿ç”¨ï¼ˆ<code>this.#count</code>ï¼‰ã€‚å¦‚æœåœ¨ç±»çš„å¤–éƒ¨ä½¿ç”¨ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p><p>å¦å¤–ï¼Œ<ins>ä¸ç®¡åœ¨ç±»çš„å†…éƒ¨æˆ–å¤–éƒ¨ï¼Œè¯»å–ä¸€ä¸ªä¸å­˜åœ¨çš„ç§æœ‰å±æ€§ï¼Œéƒ½ä¼šæŠ¥é”™</ins>ã€‚è¿™è·Ÿå…¬å¼€å±æ€§çš„è¡Œä¸ºå®Œå…¨ä¸åŒï¼Œå¦‚æœè¯»å–ä¸€ä¸ªä¸å­˜åœ¨çš„å…¬å¼€å±æ€§ï¼Œä¸ä¼šæŠ¥é”™ï¼Œåªä¼šè¿”å›<code>undefined</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">IncreasingCounter</span> &#123;</span><br><span class="line">  #count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">value</span>() &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Getting the current value!&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#myCount; <span class="comment">// æŠ¥é”™</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#count++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> counter = <span class="keyword">new</span> <span class="title class_">IncreasingCounter</span>();</span><br><span class="line">counter.#myCount <span class="comment">// æŠ¥é”™</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ<code>#myCount</code>æ˜¯ä¸€ä¸ªä¸å­˜åœ¨çš„ç§æœ‰å±æ€§ï¼Œä¸ç®¡åœ¨å‡½æ•°å†…éƒ¨æˆ–å¤–éƒ¨ï¼Œè¯»å–è¯¥å±æ€§éƒ½ä¼šå¯¼è‡´æŠ¥é”™ã€‚æ³¨æ„ï¼Œç§æœ‰å±æ€§çš„å±æ€§åå¿…é¡»åŒ…æ‹¬<code>#</code>ï¼Œå¦‚æœä¸å¸¦<code>#</code>ï¼Œä¼šè¢«å½“ä½œå¦ä¸€ä¸ªå±æ€§ã€‚</p><p><code>ES6</code>ä¸­<ins>ä¸ä»…å¯ä»¥å†™ç§æœ‰å±æ€§ï¼Œè¿˜å¯ä»¥ç”¨æ¥å†™ç§æœ‰æ–¹æ³•</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line">  #a;</span><br><span class="line">  #b;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#a = a;</span><br><span class="line">    <span class="variable language_">this</span>.#b = b;</span><br><span class="line">  &#125;</span><br><span class="line">  #<span class="title function_">sum</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#a + <span class="variable language_">this</span>.#b;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">printSum</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.#<span class="title function_">sum</span>());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼Œ<ins>ç§æœ‰å±æ€§ä¹Ÿå¯ä»¥è®¾ç½® <code>getter</code> å’Œ <code>setter</code> æ–¹æ³•</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Counter</span> &#123;</span><br><span class="line">  #xValue = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.#x);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  get #<span class="title function_">x</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> <span class="variable language_">this</span>.#xValue; &#125;</span><br><span class="line">  set #<span class="title function_">x</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.#xValue = value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>#x</code>æ˜¯ä¸€ä¸ªç§æœ‰å±æ€§ï¼Œå®ƒçš„è¯»å†™éƒ½é€šè¿‡<code>get #x()</code>å’Œ<code>set #x()</code>æ“ä½œå¦ä¸€ä¸ªç§æœ‰å±æ€§<code>#xValue</code>æ¥å®Œæˆã€‚</p><p><ins>ç§æœ‰å±æ€§ä¸é™äºä»<code>this</code>å¼•ç”¨ï¼Œåªè¦æ˜¯åœ¨ç±»çš„å†…éƒ¨ï¼Œå®ä¾‹ä¹Ÿå¯ä»¥å¼•ç”¨ç§æœ‰å±æ€§</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  #privateProperty = <span class="string">&quot;I&#x27;m private&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">checkPrivateProperty</span>(<span class="params">otherInstance</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> otherInstance.#privateProperty;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance1 = <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line"><span class="keyword">const</span> instance2 = <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(instance1.<span class="title function_">checkPrivateProperty</span>(instance2)); </span><br><span class="line"><span class="comment">// è¾“å‡º &quot;I&#x27;m private&quot;</span></span><br></pre></td></tr></table></figure><p><ins>ç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•ä¹Ÿå¯ä»¥åŠ ä¸Š<code>static</code>å…³é”®å­—ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªé™æ€çš„ç§æœ‰å±æ€§æˆ–ç§æœ‰æ–¹æ³•</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> #<span class="title function_">privateStaticMethod</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello from private static method&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">callPrivateStaticMethod</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#<span class="title function_">privateStaticMethod</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">MyClass</span>.<span class="title function_">callPrivateStaticMethod</span>()); </span><br><span class="line"><span class="comment">// è¾“å‡º &quot;Hello from private static method&quot;</span></span><br></pre></td></tr></table></figure><hr><h3 id="21-9-in-è¿ç®—ç¬¦"><a href="#21-9-in-è¿ç®—ç¬¦" class="headerlink" title="21.9 in è¿ç®—ç¬¦"></a>21.9 in è¿ç®—ç¬¦</h3><p>å‰é¢è¯´è¿‡ï¼Œ<ins>ç›´æ¥è®¿é—®æŸä¸ªç±»ä¸å­˜åœ¨çš„ç§æœ‰å±æ€§ä¼šæŠ¥é”™ï¼Œä½†æ˜¯è®¿é—®ä¸å­˜åœ¨çš„å…¬å¼€å±æ€§ä¸ä¼šæŠ¥é”™ã€‚è¿™ä¸ªç‰¹æ€§å¯ä»¥ç”¨æ¥åˆ¤æ–­ï¼ŒæŸä¸ªå¯¹è±¡æ˜¯å¦ä¸ºç±»çš„å®ä¾‹</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> &#123;</span><br><span class="line">  #brand;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">isC</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      obj.#brand;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç±»<code>C</code>çš„é™æ€æ–¹æ³•<code>isC()</code>å°±ç”¨æ¥åˆ¤æ–­ï¼ŒæŸä¸ªå¯¹è±¡æ˜¯å¦ä¸º<code>C</code>çš„å®ä¾‹ã€‚å®ƒé‡‡ç”¨çš„æ–¹æ³•å°±æ˜¯ï¼Œè®¿é—®è¯¥å¯¹è±¡çš„ç§æœ‰å±æ€§<code>#brand</code>ã€‚å¦‚æœä¸æŠ¥é”™ï¼Œå°±ä¼šè¿”å›<code>true</code>ï¼›å¦‚æœæŠ¥é”™ï¼Œå°±è¯´æ˜è¯¥å¯¹è±¡ä¸æ˜¯å½“å‰ç±»çš„å®ä¾‹ï¼Œä»è€Œ<code>catch</code>éƒ¨åˆ†è¿”å›<code>false</code>ã€‚</p><p>å› æ­¤ï¼Œ<code>try...catch</code>ç»“æ„å¯ä»¥ç”¨æ¥åˆ¤æ–­æŸä¸ªç§æœ‰å±æ€§æ˜¯å¦å­˜åœ¨ã€‚ä½†æ˜¯ï¼Œè¿™æ ·çš„å†™æ³•å¾ˆéº»çƒ¦ï¼Œä»£ç å¯è¯»æ€§å¾ˆå·®ï¼Œ<a href="https://github.com/tc39/proposal-private-fields-in-in">ES6</a> æ”¹è¿›äº†<ins><code>in</code>è¿ç®—ç¬¦ï¼Œä½¿å®ƒä¹Ÿå¯ä»¥ç”¨æ¥åˆ¤æ–­ç§æœ‰å±æ€§ã€‚å®ƒä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> &#123;</span><br><span class="line">  #brand;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">isC</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (#brand <span class="keyword">in</span> obj) &#123;</span><br><span class="line">      <span class="comment">// ç§æœ‰å±æ€§ #brand å­˜åœ¨</span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// ç§æœ‰å±æ€§ #foo ä¸å­˜åœ¨</span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>in</code>ä¹Ÿå¯ä»¥è·Ÿ<code>this</code>ä¸€èµ·é…åˆä½¿ç”¨ï¼Œç”¨æ¥æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ‹¥æœ‰æŸä¸ªå±æ€§çš„ï¼Œæ— è®ºè¿™ä¸ªå±æ€§æ˜¯åœ¨å®ä¾‹æœ¬èº«è¿˜æ˜¯åœ¨å®ƒçš„åŸå‹é“¾ä¸­ã€‚æ³¨æ„ï¼Œ<ins>åˆ¤æ–­ç§æœ‰å±æ€§æ—¶ï¼Œ<code>in</code>åªèƒ½ç”¨åœ¨ç±»çš„å†…éƒ¨</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">  #foo = <span class="number">0</span>;</span><br><span class="line">  <span class="title function_">m</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(#foo <span class="keyword">in</span> <span class="variable language_">this</span>); <span class="comment">// true</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(#bar <span class="keyword">in</span> <span class="variable language_">this</span>); <span class="comment">// false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="21-10-é™æ€å—"><a href="#21-10-é™æ€å—" class="headerlink" title="21.10 é™æ€å—"></a>21.10 é™æ€å—</h3><p>é™æ€å±æ€§çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚æœå®ƒæœ‰åˆå§‹åŒ–é€»è¾‘ï¼Œè¿™ä¸ªé€»è¾‘è¦ä¹ˆå†™åœ¨ç±»çš„å¤–éƒ¨ï¼Œè¦ä¹ˆå†™åœ¨<code>constructor()</code>æ–¹æ³•é‡Œé¢ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">MyClass</span>.<span class="property">myStaticProperty</span> = <span class="string">&quot;some value&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title class_">MyClass</span>.<span class="property">myStaticProperty</span>) &#123;</span><br><span class="line">      <span class="title class_">MyClass</span>.<span class="property">myStaticProperty</span> = <span class="string">&quot;some value&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ<code>ES2022</code> å¼•å…¥äº†<a href="https://github.com/tc39/proposal-class-static-block">é™æ€å—</a>ï¼ˆ<code>static block</code>ï¼‰ï¼Œå…è®¸åœ¨ç±»çš„å†…éƒ¨è®¾ç½®ä¸€ä¸ªä»£ç å—ï¼Œ<ins>åœ¨ç±»ç”Ÿæˆæ—¶è¿è¡Œä¸”åªè¿è¡Œä¸€æ¬¡ï¼Œä¸»è¦ä½œç”¨æ˜¯å¯¹é™æ€å±æ€§è¿›è¡Œåˆå§‹åŒ–</ins>ã€‚ä»¥åï¼Œ<ins>æ–°å»ºç±»çš„å®ä¾‹æ—¶ï¼Œè¿™ä¸ªå—å°±ä¸è¿è¡Œäº†</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> a;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">a</span> = <span class="title function_">doSomethingThatMightFail</span>();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">a</span> = <span class="string">&quot;default value&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯ä¸ªç±»å…è®¸æœ‰å¤šä¸ªé™æ€å—ï¼Œæ¯ä¸ªé™æ€å—ä¸­åªèƒ½è®¿é—®ä¹‹å‰å£°æ˜çš„é™æ€å±æ€§ã€‚åŒæ—¶ï¼Œé™æ€å—çš„å†…éƒ¨ä¸èƒ½æœ‰<code>return</code>è¯­å¥ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ç±»åæˆ–<code>this</code>ï¼ŒæŒ‡ä»£å½“å‰ç±»ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> prop1;</span><br><span class="line">  <span class="keyword">static</span> prop2;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> &#123;</span><br><span class="line">    <span class="comment">// ç¬¬ä¸€ä¸ªé™æ€å—</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">prop1</span> = <span class="string">&quot;value1&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> &#123;</span><br><span class="line">    <span class="comment">// ç¬¬äºŒä¸ªé™æ€å—</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">prop2</span> = <span class="variable language_">this</span>.<span class="property">prop1</span> + <span class="string">&quot; value2&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">MyClass</span>.<span class="property">prop1</span>); <span class="comment">// è¾“å‡º &quot;value1&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">MyClass</span>.<span class="property">prop2</span>); <span class="comment">// è¾“å‡º &quot;value1 value2&quot;</span></span><br></pre></td></tr></table></figure><p>é™¤äº†é™æ€å±æ€§çš„åˆå§‹åŒ–ï¼Œé™æ€å—è¿˜æœ‰ä¸€ä¸ªä½œç”¨ï¼Œå°±æ˜¯<ins>å°†ç§æœ‰å±æ€§ä¸ç±»çš„å¤–éƒ¨ä»£ç åˆ†äº«</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  <span class="comment">// ç§æœ‰å±æ€§</span></span><br><span class="line">  <span class="keyword">static</span> #privateProp = <span class="string">&quot;private value&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> &#123;</span><br><span class="line">    <span class="comment">// åœ¨é™æ€å—ä¸­å®šä¹‰å…¬å¼€æ–¹æ³•</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">getPrivateProp</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">MyClass</span>.#privateProp;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">MyClass</span>.<span class="title function_">getPrivateProp</span>()); <span class="comment">// è¾“å‡º &quot;private value&quot;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç‰¹æ€§æä¾›äº†ä¸€ç§çµæ´»çš„æ–¹å¼æ¥æ§åˆ¶ç±»çš„ç§æœ‰å±æ€§çš„è®¿é—®ï¼Œå¯ä»¥æ ¹æ®éœ€è¦å†³å®šå“ªäº›ç§æœ‰å±æ€§åº”è¯¥å¯¹å¤–éƒ¨ä»£ç å¼€æ”¾ï¼Œä»¥åŠåœ¨ä½•ç§æ¡ä»¶ä¸‹å¼€æ”¾ã€‚</p><hr><h3 id="21-11-ç±»çš„æ³¨æ„ç‚¹"><a href="#21-11-ç±»çš„æ³¨æ„ç‚¹" class="headerlink" title="21.11 ç±»çš„æ³¨æ„ç‚¹"></a>21.11 ç±»çš„æ³¨æ„ç‚¹</h3><p><strong>ï¼ˆ1ï¼‰Generator æ–¹æ³•</strong></p><p>å¦‚æœæŸä¸ªæ–¹æ³•ä¹‹å‰åŠ ä¸Šæ˜Ÿå·<code>*</code>ï¼Œå°±è¡¨ç¤ºè¯¥æ–¹æ³•æ˜¯ä¸€ä¸ª <code>Generator</code> å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">lass <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  * <span class="title function_">generatorMethod</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;Hello,&#x27;</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;world!&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myInstance = <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line"><span class="keyword">const</span> gen = myInstance.<span class="title function_">generatorMethod</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(gen.<span class="title function_">next</span>().<span class="property">value</span>); <span class="comment">// è¾“å‡º &quot;Hello,&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(gen.<span class="title function_">next</span>().<span class="property">value</span>); <span class="comment">// è¾“å‡º &quot;world!&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(gen.<span class="title function_">next</span>().<span class="property">value</span>); <span class="comment">// è¾“å‡º undefined</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ2ï¼‰this çš„æŒ‡å‘</strong></p><p>ç±»çš„æ–¹æ³•å†…éƒ¨å¦‚æœå«æœ‰<code>this</code>ï¼Œå®ƒé»˜è®¤æŒ‡å‘ç±»çš„å®ä¾‹ã€‚ä½†æ˜¯ï¼Œå¦‚æœå°†ç±»çš„æ–¹æ³•æå–å‡ºæ¥å•ç‹¬ä½¿ç”¨ï¼Œé‚£ä¹ˆ<code>this</code>å¯èƒ½å°±ä¸å†æŒ‡å‘åŸæ¥çš„å¯¹è±¡äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  <span class="title function_">myMethod</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myInstance = <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line">myInstance.<span class="title function_">myMethod</span>();  <span class="comment">// MyClassçš„å®ä¾‹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; method &#125; = myInstance</span><br><span class="line"><span class="title function_">method</span>();  <span class="comment">// undefinedæˆ–è€…å…¨å±€å¯¹è±¡ï¼ˆåœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼‰</span></span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>myMethod</code>æ–¹æ³•ä¸­çš„<code>this</code>é»˜è®¤æŒ‡å‘<code>MyClass</code>çš„å®ä¾‹ã€‚ä½†å½“æˆ‘ä»¬å°†<code>myMethod</code>æ–¹æ³•èµ‹å€¼ç»™å˜é‡<code>method</code>ï¼Œå¹¶å•ç‹¬è°ƒç”¨<code>method()</code>æ—¶ï¼Œ<code>this</code>å°±å˜æˆäº†<code>undefined</code>ã€‚</p><p>è§£å†³æ–¹æ³•æ˜¯ï¼Œ<ins>åœ¨æ„é€ æ–¹æ³•ä¸­ç»‘å®š<code>this</code></ins>ï¼Œæˆ–è€…ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">myMethod</span> = <span class="variable language_">this</span>.<span class="property">myMethod</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">myMethod</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">  myMethod = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="22-Class-çš„ç»§æ‰¿"><a href="#22-Class-çš„ç»§æ‰¿" class="headerlink" title="22. Class çš„ç»§æ‰¿"></a>22. Class çš„ç»§æ‰¿</h2><p><a href="https://es6.ruanyifeng.com/#docs/class-extends">æœ¬ç« </a>å†…å®¹å¤æ‚ï¼Œæ•…å…ˆè·³è¿‡ä¸€éƒ¨åˆ†ã€‚</p><h3 id="22-1-ç®€ä»‹"><a href="#22-1-ç®€ä»‹" class="headerlink" title="22.1 ç®€ä»‹"></a>22.1 ç®€ä»‹</h3><p><ins><code>Class</code> å¯ä»¥é€šè¿‡<code>extends</code>å…³é”®å­—å®ç°ç»§æ‰¿ï¼Œè®©å­ç±»ç»§æ‰¿çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•</ins>ã€‚<code>extends</code> çš„å†™æ³•æ¯” <code>ES5</code> çš„åŸå‹é“¾ç»§æ‰¿ï¼Œè¦æ¸…æ™°å’Œæ–¹ä¾¿å¾ˆå¤šã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ColorPoint</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Point</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ<ins><code>Point</code>æ˜¯çˆ¶ç±»ï¼Œ<code>ColorPoint</code>æ˜¯å­ç±»ï¼Œå®ƒé€šè¿‡<code>extends</code>å…³é”®å­—ï¼Œç»§æ‰¿äº†<code>Point</code>ç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•</ins>ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬åœ¨<code>ColorPoint</code>å†…éƒ¨åŠ ä¸Šä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ColorPoint</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Point</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">x, y, color</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(x, y); <span class="comment">// è°ƒç”¨çˆ¶ç±»çš„ constructor(x, y)</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">color</span> = color;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">toString</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">color</span> + <span class="string">&#x27; &#x27;</span> + <span class="variable language_">super</span>.<span class="title function_">toString</span>(); <span class="comment">// è°ƒç”¨çˆ¶ç±»çš„ toString()</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ<code>constructor()</code>æ–¹æ³•å’Œ<code>toString()</code>æ–¹æ³•å†…éƒ¨ï¼Œéƒ½å‡ºç°äº†<code>super</code>å…³é”®å­—ã€‚<ins><code>super</code>åœ¨è¿™é‡Œè¡¨ç¤ºçˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œç”¨æ¥æ–°å»ºä¸€ä¸ªçˆ¶ç±»çš„å®ä¾‹å¯¹è±¡</ins>ã€‚</p><p><code>ES6</code> è§„å®šï¼Œ<ins>å­ç±»å¿…é¡»åœ¨<code>constructor()</code>æ–¹æ³•ä¸­è°ƒç”¨<code>super()</code></ins>ï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºå­ç±»è‡ªå·±çš„<code>this</code>å¯¹è±¡ï¼Œå¿…é¡»å…ˆé€šè¿‡çˆ¶ç±»çš„æ„é€ å‡½æ•°å®Œæˆå¡‘é€ ï¼Œå¾—åˆ°ä¸çˆ¶ç±»åŒæ ·çš„å®ä¾‹å±æ€§å’Œæ–¹æ³•ï¼Œç„¶åå†æ·»åŠ å­ç±»è‡ªå·±çš„å®ä¾‹å±æ€§å’Œæ–¹æ³•ã€‚å¦‚æœä¸è°ƒç”¨<code>super()</code>æ–¹æ³•ï¼Œå­ç±»å°±å¾—ä¸åˆ°è‡ªå·±çš„<code>this</code>å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ColorPoint</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Point</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> cp = <span class="keyword">new</span> <span class="title class_">ColorPoint</span>(); <span class="comment">// ReferenceError</span></span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆå­ç±»çš„æ„é€ å‡½æ•°ï¼Œä¸€å®šè¦è°ƒç”¨<code>super()</code>ï¼ŸåŸå› å°±åœ¨äº <code>ES6</code> çš„ç»§æ‰¿æœºåˆ¶ï¼Œä¸ <code>ES5</code> å®Œå…¨ä¸åŒã€‚</p><ul><li><code>ES5</code> çš„ç»§æ‰¿æœºåˆ¶ï¼Œæ˜¯å…ˆåˆ›é€ ä¸€ä¸ªç‹¬ç«‹çš„å­ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œç„¶åå†å°†çˆ¶ç±»çš„æ–¹æ³•æ·»åŠ åˆ°è¿™ä¸ªå¯¹è±¡ä¸Šé¢ï¼Œå³â€œå®ä¾‹åœ¨å‰ï¼Œç»§æ‰¿åœ¨åâ€ã€‚</li><li><code>ES6</code> çš„ç»§æ‰¿æœºåˆ¶ï¼Œåˆ™æ˜¯å…ˆå°†çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼ŒåŠ åˆ°ä¸€ä¸ªç©ºçš„å¯¹è±¡ä¸Šé¢ï¼Œç„¶åå†å°†è¯¥å¯¹è±¡ä½œä¸ºå­ç±»çš„å®ä¾‹ï¼Œå³â€œç»§æ‰¿åœ¨å‰ï¼Œå®ä¾‹åœ¨åâ€ã€‚</li></ul><p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ <code>ES6</code> çš„ç»§æ‰¿å¿…é¡»å…ˆè°ƒç”¨<code>super()</code>æ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸€æ­¥ä¼šç”Ÿæˆä¸€ä¸ªç»§æ‰¿çˆ¶ç±»çš„<code>this</code>å¯¹è±¡ï¼Œæ²¡æœ‰è¿™ä¸€æ­¥å°±æ— æ³•ç»§æ‰¿çˆ¶ç±»ã€‚</p><p>æ³¨æ„ï¼Œè¿™æ„å‘³ç€<ins>æ–°å»ºå­ç±»å®ä¾‹æ—¶ï¼Œçˆ¶ç±»çš„æ„é€ å‡½æ•°å¿…å®šä¼šå…ˆè¿è¡Œä¸€æ¬¡</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Bar</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Foo</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bar = <span class="keyword">new</span> <span class="title class_">Bar</span>();</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå­ç±» <code>Bar</code> æ–°å»ºå®ä¾‹æ—¶ï¼Œä¼šè¾“å‡º<code>1</code>å’Œ<code>2</code>ã€‚åŸå› å°±æ˜¯å­ç±»æ„é€ å‡½æ•°è°ƒç”¨<code>super()</code>æ—¶ï¼Œä¼šæ‰§è¡Œä¸€æ¬¡çˆ¶ç±»æ„é€ å‡½æ•°ã€‚</p><p>å¦ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œ<ins>åœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­ï¼Œåªæœ‰è°ƒç”¨<code>super()</code>ä¹‹åï¼Œæ‰å¯ä»¥ä½¿ç”¨<code>this</code>å…³é”®å­—</ins>ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºå­ç±»å®ä¾‹çš„æ„å»ºï¼Œå¿…é¡»å…ˆå®Œæˆçˆ¶ç±»çš„ç»§æ‰¿ï¼Œåªæœ‰<code>super()</code>æ–¹æ³•æ‰èƒ½è®©å­ç±»å®ä¾‹ç»§æ‰¿çˆ¶ç±»ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;Parent&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Parent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// Error: Must call super constructor in derived class before accessing &#x27;this&#x27;</span></span><br><span class="line">    <span class="comment">// console.log(this.name); </span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">super</span>(); <span class="comment">// æ­£ç¡®åˆå§‹åŒ–å­ç±»å®ä¾‹</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>); <span class="comment">// è¾“å‡º: &#x27;Parent&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Child</span>();</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­ç±»çš„<code>constructor()</code>æ–¹æ³•æ²¡æœ‰è°ƒç”¨<code>super()</code>ä¹‹å‰ï¼Œå°±ä½¿ç”¨<code>this</code>å…³é”®å­—ï¼Œç»“æœæŠ¥é”™ï¼Œè€Œæ”¾åœ¨<code>super()</code>ä¹‹åå°±æ˜¯æ­£ç¡®çš„ã€‚</p><p><ins>å¦‚æœå­ç±»æ²¡æœ‰å®šä¹‰<code>constructor()</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šé»˜è®¤æ·»åŠ ï¼Œå¹¶ä¸”é‡Œé¢ä¼šè°ƒç”¨<code>super()</code></ins>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ç®¡æœ‰æ²¡æœ‰æ˜¾å¼å®šä¹‰ï¼Œä»»ä½•ä¸€ä¸ªå­ç±»éƒ½æœ‰<code>constructor()</code>æ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Parent</span> &#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œæˆ‘ä»¬æ²¡æœ‰æ˜¾å¼å®šä¹‰ constructor()</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> child = <span class="keyword">new</span> <span class="title class_">Child</span>(<span class="string">&#x27;John&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(child.<span class="property">name</span>); <span class="comment">// è¾“å‡º: &#x27;John&#x27;</span></span><br></pre></td></tr></table></figure><p>æœ‰äº†å­ç±»çš„å®šä¹‰ï¼Œå°±å¯ä»¥ç”Ÿæˆå­ç±»çš„å®ä¾‹äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">child <span class="keyword">instanceof</span> <span class="title class_">Child</span> <span class="comment">// true</span></span><br><span class="line">child <span class="keyword">instanceof</span> <span class="title class_">Parent</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œ<ins>å¦‚æœçˆ¶ç±»å’Œå­ç±»æœ‰åŒåå±æ€§ï¼Œå­ç±»çš„å±æ€§ä¼šè¦†ç›–çˆ¶ç±»çš„å±æ€§</ins>ã€‚è¿™æ˜¯å› ä¸ºåœ¨å­ç±»ä¸­å®šä¹‰çš„å±æ€§å’Œæ–¹æ³•å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;Parent&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Parent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;Child&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">showName</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> child = <span class="keyword">new</span> <span class="title class_">Child</span>();</span><br><span class="line">child.<span class="title function_">showName</span>(); <span class="comment">// è¾“å‡º: &#x27;Child&#x27;</span></span><br></pre></td></tr></table></figure><hr><h3 id="22-2-ç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•çš„ç»§æ‰¿"><a href="#22-2-ç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•çš„ç»§æ‰¿" class="headerlink" title="22.2 ç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•çš„ç»§æ‰¿"></a>22.2 ç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•çš„ç»§æ‰¿</h3><p><ins>çˆ¶ç±»æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œéƒ½ä¼šè¢«å­ç±»ç»§æ‰¿ï¼Œé™¤äº†ç§æœ‰çš„å±æ€§å’Œæ–¹æ³•</ins>ã€‚å­ç±»æ— æ³•ç»§æ‰¿çˆ¶ç±»çš„ç§æœ‰å±æ€§ï¼Œæˆ–è€…è¯´ï¼Œ<ins>ç§æœ‰å±æ€§åªèƒ½åœ¨å®šä¹‰å®ƒçš„ <code>class</code> é‡Œé¢ä½¿ç”¨</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line">  #p = <span class="number">1</span>;</span><br><span class="line">  #<span class="title function_">m</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Bar</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Foo</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.#p); <span class="comment">// æŠ¥é”™</span></span><br><span class="line">    <span class="variable language_">this</span>.#<span class="title function_">m</span>(); <span class="comment">// æŠ¥é”™</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœ<ins>çˆ¶ç±»å®šä¹‰äº†ç§æœ‰å±æ€§çš„è¯»å†™æ–¹æ³•ï¼Œå­ç±»å°±å¯ä»¥é€šè¿‡è¿™äº›æ–¹æ³•ï¼Œè¯»å†™ç§æœ‰å±æ€§</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line">  #p = <span class="number">1</span>;</span><br><span class="line">  <span class="title function_">getP</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.#p;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Bar</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Foo</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="title function_">getP</span>()); <span class="comment">// 1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ<code>getP()</code>æ˜¯çˆ¶ç±»ç”¨æ¥è¯»å–ç§æœ‰å±æ€§çš„æ–¹æ³•ï¼Œå­ç±»å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•è¯»åˆ°çˆ¶ç±»çš„ç§æœ‰å±æ€§ã€‚</p><hr><h3 id="22-3-é™æ€å±æ€§å’Œé™æ€æ–¹æ³•çš„ç»§æ‰¿"><a href="#22-3-é™æ€å±æ€§å’Œé™æ€æ–¹æ³•çš„ç»§æ‰¿" class="headerlink" title="22.3 é™æ€å±æ€§å’Œé™æ€æ–¹æ³•çš„ç»§æ‰¿"></a>22.3 é™æ€å±æ€§å’Œé™æ€æ–¹æ³•çš„ç»§æ‰¿</h3><p><ins>çˆ¶ç±»çš„é™æ€å±æ€§å’Œé™æ€æ–¹æ³•ï¼Œä¹Ÿä¼šè¢«å­ç±»ç»§æ‰¿</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">hello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello world&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_ inherited__">A</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">B.<span class="title function_">hello</span>()  <span class="comment">// hello world</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>hello()</code>æ˜¯<code>A</code>ç±»çš„é™æ€æ–¹æ³•ï¼Œ<code>B</code>ç»§æ‰¿<code>A</code>ï¼Œä¹Ÿç»§æ‰¿äº†<code>A</code>çš„é™æ€æ–¹æ³•ã€‚</p><p>æ³¨æ„ï¼Œ<ins>é™æ€å±æ€§æ˜¯é€šè¿‡<a href="https://vue3js.cn/interview/JavaScript/copy.html">è½¯æ‹·è´</a>å®ç°ç»§æ‰¿çš„</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123; <span class="keyword">static</span> foo = <span class="number">100</span>; &#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_ inherited__">A</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    B.<span class="property">foo</span>--;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> b = <span class="keyword">new</span> <span class="title function_">B</span>();</span><br><span class="line">B.<span class="property">foo</span> <span class="comment">// 99</span></span><br><span class="line">A.<span class="property">foo</span> <span class="comment">// 100</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ<code>foo</code>æ˜¯ <code>A</code> ç±»çš„é™æ€å±æ€§ï¼Œ<code>B</code> ç±»ç»§æ‰¿äº† <code>A</code> ç±»ï¼Œå› æ­¤ä¹Ÿç»§æ‰¿äº†è¿™ä¸ªå±æ€§ã€‚ä½†æ˜¯ï¼Œ<ins>åœ¨ <code>B</code> ç±»å†…éƒ¨æ“ä½œ<code>B.foo</code>è¿™ä¸ªé™æ€å±æ€§ï¼Œå½±å“ä¸åˆ°<code>A.foo</code></ins>ï¼ŒåŸå› å°±æ˜¯ <code>B</code> ç±»ç»§æ‰¿é™æ€å±æ€§æ—¶ï¼Œä¼šé‡‡ç”¨æµ…æ‹·è´ï¼Œæ‹·è´çˆ¶ç±»é™æ€å±æ€§çš„å€¼ï¼Œå› æ­¤<code>A.foo</code>å’Œ<code>B.foo</code>æ˜¯ä¸¤ä¸ªå½¼æ­¤ç‹¬ç«‹çš„å±æ€§ã€‚</p><p>ä½†æ˜¯ï¼Œç”±äºè¿™ç§æ‹·è´æ˜¯æµ…æ‹·è´ï¼Œ<ins>å¦‚æœçˆ¶ç±»çš„é™æ€å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå­ç±»çš„é™æ€å±æ€§ä¹Ÿä¼šæŒ‡å‘è¿™ä¸ªå¯¹è±¡</ins>ï¼Œå› ä¸ºæµ…æ‹·è´åªä¼šæ‹·è´å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> foo = &#123; <span class="attr">n</span>: <span class="number">100</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_ inherited__">A</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    B.<span class="property">foo</span>.<span class="property">n</span>--;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> b = <span class="keyword">new</span> <span class="title function_">B</span>();</span><br><span class="line">B.<span class="property">foo</span>.<span class="property">n</span> <span class="comment">// 99</span></span><br><span class="line">A.<span class="property">foo</span>.<span class="property">n</span> <span class="comment">// 99</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ<code>A.foo</code>çš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæµ…æ‹·è´å¯¼è‡´<code>B.foo</code>å’Œ<code>A.foo</code>æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚æ‰€ä»¥ï¼Œå­ç±»<code>B</code>ä¿®æ”¹è¿™ä¸ªå¯¹è±¡çš„å±æ€§å€¼ï¼Œä¼šå½±å“åˆ°çˆ¶ç±»<code>A</code>ã€‚</p><hr><h3 id="22-4-super-å…³é”®å­—"><a href="#22-4-super-å…³é”®å­—" class="headerlink" title="22.4 super å…³é”®å­—"></a>22.4 super å…³é”®å­—</h3><p><code>super</code>è¿™ä¸ªå…³é”®å­—ï¼Œæ—¢å¯ä»¥å½“ä½œå‡½æ•°ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å½“ä½œå¯¹è±¡ä½¿ç”¨ã€‚</p><p>ï¼ˆ1ï¼‰å½“<code>super</code><ins>ä½œä¸ºå‡½æ•°è°ƒç”¨æ—¶ï¼Œä»£è¡¨çˆ¶ç±»çš„æ„é€ å‡½æ•°</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_ inherited__">A</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨<code>super()</code>çš„ä½œç”¨æ˜¯å½¢æˆå­ç±»çš„<code>this</code>å¯¹è±¡ï¼ŒæŠŠçˆ¶ç±»çš„å®ä¾‹å±æ€§å’Œæ–¹æ³•æ”¾åˆ°è¿™ä¸ª<code>this</code>å¯¹è±¡ä¸Šé¢ã€‚å­ç±»åœ¨è°ƒç”¨<code>super()</code>ä¹‹å‰ï¼Œæ˜¯æ²¡æœ‰<code>this</code>å¯¹è±¡çš„ï¼Œä»»ä½•å¯¹<code>this</code>çš„æ“ä½œéƒ½è¦æ”¾åœ¨<code>super()</code>çš„åé¢ã€‚</p><p>æ³¨æ„ï¼Œ<ins>è¿™é‡Œçš„<code>super</code>è™½ç„¶ä»£è¡¨äº†çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œä½†æ˜¯å› ä¸ºè¿”å›çš„æ˜¯å­ç±»çš„<code>this</code>ï¼ˆå³å­ç±»çš„å®ä¾‹å¯¹è±¡ï¼‰ï¼Œæ‰€ä»¥<code>super</code>å†…éƒ¨çš„<code>this</code>ä»£è¡¨å­ç±»çš„å®ä¾‹ï¼Œè€Œä¸æ˜¯çˆ¶ç±»çš„å®ä¾‹</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span>.<span class="property">target</span>.<span class="property">name</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_ inherited__">A</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> <span class="title function_">A</span>() <span class="comment">// A</span></span><br><span class="line"><span class="keyword">new</span> <span class="title function_">B</span>() <span class="comment">// B </span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ<code>new.target</code>æŒ‡å‘å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‡½æ•°ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨<code>super()</code>æ‰§è¡Œæ—¶ï¼Œå®ƒæŒ‡å‘çš„æ˜¯å­ç±»<code>B</code>çš„æ„é€ å‡½æ•°ï¼Œè€Œä¸æ˜¯çˆ¶ç±»<code>A</code>çš„æ„é€ å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>super()</code>å†…éƒ¨çš„<code>this</code>æŒ‡å‘çš„æ˜¯<code>B</code>ã€‚</p><p>ä¸è¿‡ï¼Œ<ins>ç”±äº<code>super()</code>åœ¨å­ç±»æ„é€ æ–¹æ³•ä¸­æ‰§è¡Œæ—¶ï¼Œå­ç±»çš„å±æ€§å’Œæ–¹æ³•è¿˜æ²¡æœ‰ç»‘å®šåˆ°<code>this</code>ï¼Œæ‰€ä»¥å¦‚æœå­˜åœ¨åŒåå±æ€§ï¼Œæ­¤æ—¶æ‹¿åˆ°çš„æ˜¯çˆ¶ç±»çš„å±æ€§</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">  name = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;My name is &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_ inherited__">A</span> &#123;</span><br><span class="line">  name = <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> b = <span class="keyword">new</span> <span class="title function_">B</span>(); <span class="comment">// My name is A</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œæœ€åä¸€è¡Œè¾“å‡ºçš„æ˜¯<code>A</code>ï¼Œè€Œä¸æ˜¯<code>B</code>ï¼ŒåŸå› å°±åœ¨äº<code>super()</code>æ‰§è¡Œæ—¶ï¼Œ<code>B</code>çš„<code>name</code>å±æ€§è¿˜æ²¡æœ‰ç»‘å®šåˆ°<code>this</code>ï¼Œæ‰€ä»¥<code>this.name</code>æ‹¿åˆ°çš„æ˜¯<code>A</code>ç±»çš„<code>name</code>å±æ€§ã€‚</p><p><ins>ä½œä¸ºå‡½æ•°æ—¶ï¼Œ<code>super()</code>åªèƒ½ç”¨åœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¹‹ä¸­</ins>ï¼Œç”¨åœ¨å…¶ä»–åœ°æ–¹å°±ä¼šæŠ¥é”™ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_ inherited__">A</span> &#123;</span><br><span class="line">  <span class="title function_">m</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(); <span class="comment">// æŠ¥é”™</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰å½“<code>super</code><ins>ä½œä¸ºå¯¹è±¡æ—¶ï¼Œåœ¨æ™®é€šæ–¹æ³•ä¸­æŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡ï¼Œåœ¨é™æ€æ–¹æ³•ä¸­æŒ‡å‘çˆ¶ç±»</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;Parent&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">sayHello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Hello from Parent class&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Parent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;Child&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>.<span class="title function_">greet</span>(); <span class="comment">// ä½¿ç”¨superåœ¨æ™®é€šæ–¹æ³•ä¸­è°ƒç”¨çˆ¶ç±»æ–¹æ³•</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span> from child class`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">sayHello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>.<span class="title function_">sayHello</span>(); <span class="comment">// åœ¨é™æ€æ–¹æ³•ä¸­ä½¿ç”¨superè°ƒç”¨çˆ¶ç±»é™æ€æ–¹æ³•</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Hello from Child class&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> c = <span class="keyword">new</span> <span class="title class_">Child</span>();</span><br><span class="line">c.<span class="title function_">greet</span>(); </span><br><span class="line"><span class="title class_">Child</span>.<span class="title function_">sayHello</span>(); </span><br></pre></td></tr></table></figure><p>å¦‚æœ<code>super</code>æŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡ï¼Œé‚£ä¹ˆå®šä¹‰åœ¨çˆ¶ç±»å®ä¾‹ä¸Šçš„æ–¹æ³•æˆ–å±æ€§ï¼ˆå³å®šä¹‰åœ¨<code>constructor</code>é‡Œï¼‰ï¼Œæ˜¯æ— æ³•é€šè¿‡<code>super</code>è°ƒç”¨çš„ã€‚è¿™æ—¶å€™æƒ³åœ¨å­ç±»ä¸­è®¿é—®åˆ°çˆ¶ç±»å®ä¾‹ä¸Šçš„å±æ€§ï¼Œåˆ™éœ€è¦åœ¨çˆ¶ç±»ä¸­å®šä¹‰ä¸€ä¸ªæ–¹æ³•æ¥è¿”å›è¿™ä¸ªå±æ€§ï¼Œç„¶ååœ¨å­ç±»ä¸­è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;Parent&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getName</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Parent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">super</span>.<span class="property">name</span>);  <span class="comment">// TypeError ...</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">super</span>.<span class="title function_">getName</span>());  <span class="comment">// &#x27;Parent&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><ins>åœ¨å­ç±»æ™®é€šæ–¹æ³•ä¸­é€šè¿‡<code>super</code>è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œæ–¹æ³•å†…éƒ¨çš„<code>this</code>æŒ‡å‘å½“å‰çš„å­ç±»å®ä¾‹</ins>ã€‚æ‰€ä»¥é€šè¿‡<code>super</code>å¯¹æŸä¸ªå±æ€§èµ‹å€¼ï¼Œ<code>super</code>å°±æ˜¯<code>this</code>ï¼Œèµ‹å€¼çš„å±æ€§ä¼šå˜æˆå­ç±»å®ä¾‹çš„å±æ€§ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">x</span> = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">print</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">x</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_ inherited__">A</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">x</span> = <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">m</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>.<span class="title function_">print</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> <span class="title function_">B</span>();</span><br><span class="line">b.<span class="title function_">m</span>() <span class="comment">// 2</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>super.print()</code>è™½ç„¶è°ƒç”¨çš„æ˜¯<code>A.prototype.print()</code>ï¼Œä½†æ˜¯<code>A.prototype.print()</code>å†…éƒ¨çš„<code>this</code>æŒ‡å‘å­ç±»<code>B</code>çš„å®ä¾‹ï¼Œå¯¼è‡´è¾“å‡ºçš„æ˜¯<code>2</code>ï¼Œè€Œä¸æ˜¯<code>1</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">x</span> = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_ inherited__">A</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">x</span> = <span class="number">2</span>;</span><br><span class="line">    <span class="variable language_">super</span>.<span class="property">x</span> = <span class="number">3</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">super</span>.<span class="property">x</span>); <span class="comment">// undefined</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">x</span>); <span class="comment">// 3</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> <span class="title function_">B</span>();</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>super.x</code>èµ‹å€¼ä¸º<code>3</code>ï¼Œè¿™æ—¶ç­‰åŒäºå¯¹<code>this.x</code>èµ‹å€¼ä¸º<code>3</code>ã€‚è€Œå½“è¯»å–<code>super.x</code>çš„æ—¶å€™ï¼Œè¯»çš„æ˜¯<code>A.prototype.x</code>ï¼Œæ‰€ä»¥è¿”å›<code>undefined</code>ã€‚</p><p><ins>å¦‚æœ<code>super</code>ä½œä¸ºå¯¹è±¡ï¼Œç”¨åœ¨é™æ€æ–¹æ³•ä¹‹ä¸­ï¼Œè¿™æ—¶<code>super</code>å°†æŒ‡å‘çˆ¶ç±»ï¼Œè€Œä¸æ˜¯çˆ¶ç±»çš„åŸå‹å¯¹è±¡</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">myMethod</span>(<span class="params">msg</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;static&#x27;</span>, msg);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">myMethod</span>(<span class="params">msg</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;instance&#x27;</span>, msg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Parent</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">myMethod</span>(<span class="params">msg</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>.<span class="title function_">myMethod</span>(msg);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">myMethod</span>(<span class="params">msg</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>.<span class="title function_">myMethod</span>(msg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Child</span>.<span class="title function_">myMethod</span>(<span class="number">1</span>); <span class="comment">// static 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> child = <span class="keyword">new</span> <span class="title class_">Child</span>();</span><br><span class="line">child.<span class="title function_">myMethod</span>(<span class="number">2</span>); <span class="comment">// instance 2</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>super</code>åœ¨é™æ€æ–¹æ³•ä¹‹ä¸­æŒ‡å‘çˆ¶ç±»ï¼Œåœ¨æ™®é€šæ–¹æ³•ä¹‹ä¸­æŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡ã€‚</p><p>å¦å¤–ï¼Œ<ins>åœ¨å­ç±»çš„é™æ€æ–¹æ³•ä¸­é€šè¿‡<code>super</code>è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œæ–¹æ³•å†…éƒ¨çš„<code>this</code>æŒ‡å‘å½“å‰çš„å­ç±»ï¼Œè€Œä¸æ˜¯å­ç±»çš„å®ä¾‹</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">x</span> = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">print</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">x</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_ inherited__">A</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">x</span> = <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">m</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>.<span class="title function_">print</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">B.<span class="property">x</span> = <span class="number">3</span>;</span><br><span class="line">B.<span class="title function_">m</span>() <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œé™æ€æ–¹æ³•<code>B.m</code>é‡Œé¢ï¼Œ<code>super.print</code>æŒ‡å‘çˆ¶ç±»çš„é™æ€æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•é‡Œé¢çš„<code>this</code>æŒ‡å‘çš„æ˜¯<code>B</code>ï¼Œè€Œä¸æ˜¯<code>B</code>çš„å®ä¾‹ã€‚</p><hr><h3 id="22-5-ç±»çš„-prototype-å±æ€§å’Œ-proto-å±æ€§"><a href="#22-5-ç±»çš„-prototype-å±æ€§å’Œ-proto-å±æ€§" class="headerlink" title="22.5 ç±»çš„ prototype å±æ€§å’Œ __proto__ å±æ€§"></a>22.5 ç±»çš„ prototype å±æ€§å’Œ __proto__ å±æ€§</h3><p>å¤§å¤šæ•°æµè§ˆå™¨çš„ <code>ES5</code> å®ç°ä¹‹ä¸­ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰<code>__proto__</code>å±æ€§ï¼ŒæŒ‡å‘å¯¹åº”çš„æ„é€ å‡½æ•°çš„<code>prototype</code>å±æ€§ã€‚<code>Class</code> ä½œä¸ºæ„é€ å‡½æ•°çš„è¯­æ³•ç³–ï¼ŒåŒæ—¶æœ‰<code>prototype</code>å±æ€§å’Œ<code>__proto__</code>å±æ€§ï¼Œå› æ­¤åŒæ—¶å­˜åœ¨ä¸¤æ¡ç»§æ‰¿é“¾ã€‚</p><ul><li>å­ç±»çš„<code>__proto__</code>å±æ€§ï¼Œ<ins>è¡¨ç¤ºæ„é€ å‡½æ•°çš„ç»§æ‰¿ï¼Œæ€»æ˜¯æŒ‡å‘çˆ¶ç±»</ins>ã€‚</li><li>å­ç±»<code>prototype</code>å±æ€§çš„<code>__proto__</code>å±æ€§ï¼Œ<ins>è¡¨ç¤ºæ–¹æ³•çš„ç»§æ‰¿ï¼Œæ€»æ˜¯æŒ‡å‘çˆ¶ç±»çš„<code>prototype</code>å±æ€§</ins>ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_ inherited__">A</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">B.<span class="property">__proto__</span> === A <span class="comment">// true</span></span><br><span class="line">B.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> === A.<span class="property"><span class="keyword">prototype</span></span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<ins>å­ç±»<code>B</code>çš„<code>__proto__</code>å±æ€§æŒ‡å‘çˆ¶ç±»<code>A</code>ï¼Œå­ç±»<code>B</code>çš„<code>prototype</code>å±æ€§çš„<code>__proto__</code>å±æ€§æŒ‡å‘çˆ¶ç±»<code>A</code>çš„<code>prototype</code>å±æ€§</ins>ã€‚</p><p>è¿™ä¸¤æ¡ç»§æ‰¿é“¾ï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼š</p><ul><li>ä½œä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå­ç±»ï¼ˆ<code>B</code>ï¼‰çš„åŸå‹ï¼ˆ<code>__proto__</code>å±æ€§ï¼‰æ˜¯çˆ¶ç±»ï¼ˆ<code>A</code>ï¼‰ã€‚</li><li>ä½œä¸ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå­ç±»ï¼ˆ<code>B</code>ï¼‰çš„åŸå‹å¯¹è±¡ï¼ˆ<code>prototype</code>å±æ€§ï¼‰æ˜¯çˆ¶ç±»çš„åŸå‹å¯¹è±¡ï¼ˆ<code>prototype</code>å±æ€§ï¼‰çš„å®ä¾‹ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">B.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(A.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line">B.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> = A.<span class="property"><span class="keyword">prototype</span></span>;</span><br></pre></td></tr></table></figure><hr><h3 id="22-6-åŸç”Ÿæ„é€ å‡½æ•°çš„ç»§æ‰¿"><a href="#22-6-åŸç”Ÿæ„é€ å‡½æ•°çš„ç»§æ‰¿" class="headerlink" title="22.6 åŸç”Ÿæ„é€ å‡½æ•°çš„ç»§æ‰¿"></a>22.6 åŸç”Ÿæ„é€ å‡½æ•°çš„ç»§æ‰¿</h3><p><code>ES6</code> å…è®¸ç»§æ‰¿åŸç”Ÿæ„é€ å‡½æ•°å®šä¹‰å­ç±»ï¼Œå› ä¸º <code>ES6</code> æ˜¯å…ˆæ–°å»ºçˆ¶ç±»çš„å®ä¾‹å¯¹è±¡<code>this</code>ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®é¥°<code>this</code>ï¼Œä½¿å¾—çˆ¶ç±»çš„æ‰€æœ‰è¡Œä¸ºéƒ½å¯ä»¥ç»§æ‰¿ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç»§æ‰¿<code>Array</code>çš„ä¾‹å­ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyArray</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Array</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(...args);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="title class_">MyArray</span>();</span><br><span class="line">arr[<span class="number">0</span>] = <span class="number">12</span>;</span><br><span class="line">arr.<span class="property">length</span> <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line">arr.<span class="property">length</span> = <span class="number">0</span>;</span><br><span class="line">arr[<span class="number">0</span>] <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ª<code>MyArray</code>ç±»ï¼Œç»§æ‰¿äº†<code>Array</code>æ„é€ å‡½æ•°ï¼Œå› æ­¤å°±å¯ä»¥ä»<code>MyArray</code>ç”Ÿæˆæ•°ç»„çš„å®ä¾‹ã€‚è¿™æ„å‘³ç€ï¼Œ<code>ES6</code> å¯ä»¥è‡ªå®šä¹‰åŸç”Ÿæ•°æ®ç»“æ„ï¼ˆæ¯”å¦‚<code>Array</code>ã€<code>String</code>ç­‰ï¼‰çš„å­ç±»ï¼Œè¿™æ˜¯ <code>ES5</code> æ— æ³•åšåˆ°çš„ã€‚</p><p>ä¸Šé¢è¿™ä¸ªä¾‹å­ä¹Ÿè¯´æ˜ï¼Œ<code>extends</code>å…³é”®å­—ä¸ä»…å¯ä»¥ç”¨æ¥ç»§æ‰¿ç±»ï¼Œè¿˜å¯ä»¥ç”¨æ¥ç»§æ‰¿åŸç”Ÿçš„æ„é€ å‡½æ•°ã€‚å› æ­¤å¯ä»¥åœ¨åŸç”Ÿæ•°æ®ç»“æ„çš„åŸºç¡€ä¸Šï¼Œå®šä¹‰è‡ªå·±çš„æ•°æ®ç»“æ„ã€‚ä¸‹é¢å°±æ˜¯å®šä¹‰äº†ä¸€ä¸ªå¸¦ç‰ˆæœ¬åŠŸèƒ½çš„æ•°ç»„ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">VersionedArray</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Array</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">history</span> = [[]];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">commit</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">history</span>.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="title function_">slice</span>());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">revert</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">splice</span>(<span class="number">0</span>, <span class="variable language_">this</span>.<span class="property">length</span>, ...<span class="variable language_">this</span>.<span class="property">history</span>[<span class="variable language_">this</span>.<span class="property">history</span>.<span class="property">length</span> - <span class="number">1</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> x = <span class="keyword">new</span> <span class="title class_">VersionedArray</span>();</span><br><span class="line"></span><br><span class="line">x.<span class="title function_">push</span>(<span class="number">1</span>);</span><br><span class="line">x.<span class="title function_">push</span>(<span class="number">2</span>);</span><br><span class="line">x <span class="comment">// [1, 2]</span></span><br><span class="line">x.<span class="property">history</span> <span class="comment">// [[]]</span></span><br><span class="line"></span><br><span class="line">x.<span class="title function_">commit</span>();</span><br><span class="line">x.<span class="property">history</span> <span class="comment">// [[], [1, 2]]</span></span><br><span class="line"></span><br><span class="line">x.<span class="title function_">push</span>(<span class="number">3</span>);</span><br><span class="line">x <span class="comment">// [1, 2, 3]</span></span><br><span class="line">x.<span class="property">history</span> <span class="comment">// [[], [1, 2]]</span></span><br><span class="line"></span><br><span class="line">x.<span class="title function_">revert</span>();</span><br><span class="line">x <span class="comment">// [1, 2]</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>VersionedArray</code>ä¼šé€šè¿‡<code>commit</code>æ–¹æ³•ï¼Œå°†è‡ªå·±çš„å½“å‰çŠ¶æ€ç”Ÿæˆä¸€ä¸ªç‰ˆæœ¬å¿«ç…§ï¼Œå­˜å…¥<code>history</code>å±æ€§ã€‚<code>revert</code>æ–¹æ³•ç”¨æ¥å°†æ•°ç»„é‡ç½®ä¸ºæœ€æ–°ä¸€æ¬¡ä¿å­˜çš„ç‰ˆæœ¬ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œ<code>VersionedArray</code>ä¾ç„¶æ˜¯ä¸€ä¸ªæ™®é€šæ•°ç»„ï¼Œæ‰€æœ‰åŸç”Ÿçš„æ•°ç»„æ–¹æ³•éƒ½å¯ä»¥åœ¨å®ƒä¸Šé¢è°ƒç”¨ã€‚</p><p>æ³¨æ„ï¼Œç»§æ‰¿<code>Object</code>çš„å­ç±»ï¼Œæœ‰ä¸€ä¸ª<a href="https://stackoverflow.com/questions/36203614/super-does-not-pass-arguments-when-instantiating-a-class-extended-from-object">è¡Œä¸ºå·®å¼‚</a>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">NewObj</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Object</span>&#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">super</span>(...<span class="variable language_">arguments</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> <span class="title class_">NewObj</span>(&#123;<span class="attr">attr</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">o.<span class="property">attr</span> === <span class="literal">true</span>  <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>NewObj</code>ç»§æ‰¿äº†<code>Object</code>ï¼Œä½†æ˜¯æ— æ³•é€šè¿‡<code>super</code>æ–¹æ³•å‘çˆ¶ç±»<code>Object</code>ä¼ å‚ã€‚è¿™æ˜¯å› ä¸º <code>ES6</code> æ”¹å˜äº†<code>Object</code>æ„é€ å‡½æ•°çš„è¡Œä¸ºï¼Œä¸€æ—¦å‘ç°<code>Object</code>æ–¹æ³•ä¸æ˜¯é€šè¿‡<code>new Object()</code>è¿™ç§å½¢å¼è°ƒç”¨ï¼Œ<code>ES6</code> è§„å®š<code>Object</code>æ„é€ å‡½æ•°ä¼šå¿½ç•¥å‚æ•°ã€‚</p><hr><h3 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h3><blockquote><p>è¯¥å­¦ä¹ ç¬”è®°çš„æ‰€æœ‰ç« èŠ‚å‡ä¿å­˜åœ¨<a href="https://github.com/Hongda-OSU/ES6-Journey">Github</a>ä¸­ï¼Œå¦‚æœ‰éœ€è¦ï¼Œå¯ä¸‹è½½å¹¶åœ¨<a href="https://typora.io/">Typora</a>ä¸­é˜…è¯»ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES6å­¦ä¹ ç¬”è®° â€¢ ä¸­</title>
      <link href="/posts/9413d22e.html"/>
      <url>/posts/9413d22e.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>æœ¬è¯»ä¹¦ç¬”è®°èŠ‚é€‰è‡ªé˜®ä¸€å³°ç¼–å†™çš„ <a href="https://es6.ruanyifeng.com/">ã€ŠECMAScript 6 å…¥é—¨æ•™ç¨‹ã€‹</a>ã€‚é€‚åˆå·²ç»æŒæ¡ <code>ES5</code> çš„è¯»è€…ï¼Œç”¨æ¥äº†è§£è¿™é—¨è¯­è¨€çš„æœ€æ–°å‘å±•ã€‚ç¬”è®°å†…å®¹ä»…åŒ…æ‹¬æ—¥å¸¸å¼€å‘ä¸­å¯èƒ½ä¼šç”¨åˆ°çš„æ¦‚å¿µï¼Œå‰©ä½™éƒ¨åˆ†è¯·è‡ªè¡Œé˜…è¯»ã€‚</p></blockquote><hr><h2 id="16-Promise-å¯¹è±¡"><a href="#16-Promise-å¯¹è±¡" class="headerlink" title="16. Promise å¯¹è±¡"></a>16. Promise å¯¹è±¡</h2><h3 id="16-1-äº‹ä»¶å¾ªç¯"><a href="#16-1-äº‹ä»¶å¾ªç¯" class="headerlink" title="16.1 äº‹ä»¶å¾ªç¯"></a>16.1 äº‹ä»¶å¾ªç¯</h3><p>æ¨èé˜…è¯»ï¼š<a href="https://segmentfault.com/a/1190000038928521">jsäº‹ä»¶å¾ªç¯æœºåˆ¶event-loop</a></p><hr><h3 id="16-2-Promise-çš„å«ä¹‰"><a href="#16-2-Promise-çš„å«ä¹‰" class="headerlink" title="16.2 Promise çš„å«ä¹‰"></a>16.2 Promise çš„å«ä¹‰</h3><p><code>Promise</code> æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œæ¯”ä¼ ç»Ÿçš„<a href="https://segmentfault.com/a/1190000021942060">å›è°ƒå‡½æ•°</a>å’Œ<a href="https://zh.javascript.info/introduction-browser-events">äº‹ä»¶</a>ï¼Œæ›´åˆç†å’Œæ›´å¼ºå¤§ã€‚å®ƒç±»ä¼¼äºä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢ä¿å­˜ç€æŸä¸ªæœªæ¥æ‰ä¼šç»“æŸçš„äº‹ä»¶ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœã€‚</p><p><code>Promise</code>å¯¹è±¡æœ‰ä»¥ä¸‹ä¸¤ä¸ªç‰¹ç‚¹ï¼š</p><ul><li><ins><code>Promise</code>å¯¹è±¡çš„çŠ¶æ€ä¸å—å¤–ç•Œå½±å“</ins>ã€‚<code>Promise</code>å¯¹è±¡ä»£è¡¨ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œæœ‰ä¸‰ç§çŠ¶æ€ï¼š<code>pending</code>ï¼ˆè¿›è¡Œä¸­ï¼‰ã€<code>fulfilled</code>ï¼ˆå·²æˆåŠŸï¼‰å’Œ<code>rejected</code>ï¼ˆå·²å¤±è´¥ï¼‰ã€‚<ins>åªæœ‰å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œå¯ä»¥å†³å®šå½“å‰æ˜¯å“ªä¸€ç§çŠ¶æ€ï¼Œä»»ä½•å…¶ä»–æ“ä½œéƒ½æ— æ³•æ”¹å˜è¿™ä¸ªçŠ¶æ€</ins>ã€‚</li><li><ins><code>Promise</code>å¯¹è±¡ä¸€æ—¦çŠ¶æ€æ”¹å˜ï¼Œå°±ä¸ä¼šå†å˜</ins>ã€‚<code>Promise</code>å¯¹è±¡çš„çŠ¶æ€æ”¹å˜ï¼Œåªæœ‰ä¸¤ç§å¯èƒ½ï¼šä»<code>pending</code>å˜ä¸º<code>fulfilled</code>å’Œä»<code>pending</code>å˜ä¸º<code>rejected</code>ã€‚åªè¦è¿™ä¸¤ç§æƒ…å†µå‘ç”Ÿï¼ŒçŠ¶æ€å°±å‡å›ºäº†ï¼Œè¿™æ—¶å°±ç§°ä¸º <code>resolved</code>ï¼ˆå·²å®šå‹ï¼‰ã€‚</li></ul><p><code>Promise</code>å¯¹è±¡çš„å¥½å¤„ï¼Œæ˜¯å¯ä»¥<ins>å°†å¼‚æ­¥æ“ä½œä»¥åŒæ­¥æ“ä½œçš„æµç¨‹è¡¨è¾¾å‡ºæ¥ï¼Œé¿å…äº†å±‚å±‚åµŒå¥—çš„å›è°ƒå‡½æ•°</ins>ã€‚æ­¤å¤–ï¼Œ<code>Promise</code>å¯¹è±¡æä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œä½¿å¾—æ§åˆ¶å¼‚æ­¥æ“ä½œæ›´åŠ å®¹æ˜“ã€‚</p><p><code>Promise</code>ä¹Ÿæœ‰ç¼ºç‚¹ã€‚é¦–å…ˆï¼Œ<ins>æ— æ³•å–æ¶ˆ<code>Promise</code>ï¼Œä¸€æ—¦æ–°å»ºå®ƒå°±ä¼šç«‹å³æ‰§è¡Œï¼Œæ— æ³•ä¸­é€”å–æ¶ˆ</ins>ã€‚å…¶æ¬¡ï¼Œ<ins>å¦‚æœä¸è®¾ç½®å›è°ƒå‡½æ•°ï¼Œ<code>Promise</code>å†…éƒ¨æŠ›å‡ºçš„é”™è¯¯ï¼Œä¸ä¼šååº”åˆ°å¤–éƒ¨</ins>ã€‚ç¬¬ä¸‰ï¼Œå½“å¤„äº<code>pending</code>çŠ¶æ€æ—¶ï¼Œæ— æ³•å¾—çŸ¥ç›®å‰è¿›å±•åˆ°å“ªä¸€ä¸ªé˜¶æ®µï¼ˆåˆšåˆšå¼€å§‹è¿˜æ˜¯å³å°†å®Œæˆï¼‰ã€‚</p><hr><h3 id="16-3-åŸºæœ¬ç”¨æ³•"><a href="#16-3-åŸºæœ¬ç”¨æ³•" class="headerlink" title="16.3 åŸºæœ¬ç”¨æ³•"></a>16.3 åŸºæœ¬ç”¨æ³•</h3><p><code>Promise</code>çš„æ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯<code>resolve</code>å’Œ<code>reject</code>ã€‚å®ƒä»¬æ˜¯ä¸¤ä¸ªå‡½æ•°ï¼Œç”± <code>JavaScript</code> å¼•æ“æä¾›ï¼Œä¸ç”¨è‡ªå·±éƒ¨ç½²ã€‚</p><ul><li><code>resolve</code>å‡½æ•°çš„ä½œç”¨æ˜¯ï¼Œå°†<code>Promise</code>å¯¹è±¡çš„çŠ¶æ€ä»â€œæœªå®Œæˆâ€å˜ä¸ºâ€œæˆåŠŸâ€ï¼ˆå³ä» <code>pending</code> å˜ä¸º <code>resolved</code>ï¼‰ï¼Œåœ¨å¼‚æ­¥æ“ä½œæˆåŠŸæ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ã€‚</li><li><code>reject</code>å‡½æ•°çš„ä½œç”¨æ˜¯ï¼Œå°†<code>Promise</code>å¯¹è±¡çš„çŠ¶æ€ä»â€œæœªå®Œæˆâ€å˜ä¸ºâ€œå¤±è´¥â€ï¼ˆå³ä» <code>pending</code> å˜ä¸º <code>rejected</code>ï¼‰ï¼Œåœ¨å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œæŠ¥å‡ºçš„é”™è¯¯ï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="comment">// ... </span></span><br><span class="line">  <span class="keyword">if</span> (<span class="comment">/* å¼‚æ­¥æ“ä½œæˆåŠŸ */</span>)&#123;</span><br><span class="line">    <span class="title function_">resolve</span>(value);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">reject</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>Promise</code>å®ä¾‹ç”Ÿæˆåå¯ä»¥<ins>ç”¨<code>then</code>æ–¹æ³•æŒ‡å®š<code>resolved</code>å’Œ<code>rejected</code>çš„å›è°ƒå‡½æ•°ã€‚è¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯å¯é€‰çš„ï¼Œä¸ä¸€å®šè¦æä¾›ã€‚å®ƒä»¬éƒ½æ¥å—<code>Promise</code>å¯¹è±¡ä¼ å‡ºçš„å€¼ä½œä¸ºå‚æ•°</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">promise.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">value</span>) &#123;</span><br><span class="line">  <span class="comment">// success</span></span><br><span class="line">&#125;, <span class="keyword">function</span>(<span class="params">error</span>) &#123;</span><br><span class="line">  <span class="comment">// failure</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯ä¸€ä¸ª<code>Promise</code>å¯¹è±¡çš„ä¾‹å­ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">timeout</span>(<span class="params">ms</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// https://developer.mozilla.org/en-US/docs/Web/API/setTimeout</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(resolve, ms, <span class="string">&#x27;done&#x27;</span>); <span class="comment">// &#x27;done&#x27; ä¼šä¼ å…¥å›è°ƒå‡½æ•° resolve</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">timeout</span>(<span class="number">1000</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 1ç§’å &quot;done&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>timeout</code>æ–¹æ³•è¿”å›ä¸€ä¸ª<code>Promise</code>å®ä¾‹ï¼Œè¡¨ç¤ºä¸€æ®µæ—¶é—´ä»¥åæ‰ä¼šå‘ç”Ÿçš„ç»“æœã€‚è¿‡äº†æŒ‡å®šçš„æ—¶é—´åï¼Œ<code>Promise</code>å®ä¾‹çš„çŠ¶æ€å˜ä¸º<code>resolved</code>ï¼Œå°±ä¼šè§¦å‘<code>then</code>æ–¹æ³•ç»‘å®šçš„å›è°ƒå‡½æ•°ã€‚</p><p><ins><code>Promise</code> æ–°å»ºåå°±ä¼šç«‹å³æ‰§è¡Œ</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Hello&#x27;</span>);</span><br><span class="line">  <span class="title function_">resolve</span>(); </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;resolved.&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Hi!&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Hello</span></span><br><span class="line"><span class="comment">// Hi!</span></span><br><span class="line"><span class="comment">// resolved</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Promise</code> æ–°å»ºåç«‹å³æ‰§è¡Œï¼Œæ‰€ä»¥é¦–å…ˆè¾“å‡ºçš„æ˜¯<code>Hello</code>ã€‚ç„¶åï¼Œ<ins><code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå°†åœ¨å½“å‰è„šæœ¬æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ‰ä¼šæ‰§è¡Œ</ins>ï¼Œæ‰€ä»¥<code>resolved</code>æœ€åè¾“å‡ºã€‚</p><p>å¦‚æœ<ins>è°ƒç”¨<code>resolve</code>å‡½æ•°å’Œ<code>reject</code>å‡½æ•°æ—¶å¸¦æœ‰å‚æ•°</ins>ï¼Œé‚£ä¹ˆå®ƒä»¬çš„<ins>å‚æ•°ä¼šè¢«ä¼ é€’ç»™å›è°ƒå‡½æ•°</ins>ã€‚</p><ul><li><code>reject</code>å‡½æ•°çš„å‚æ•°é€šå¸¸æ˜¯<code>Error</code>å¯¹è±¡çš„å®ä¾‹ï¼Œè¡¨ç¤ºæŠ›å‡ºçš„é”™è¯¯ã€‚</li><li><code>resolve</code>å‡½æ•°çš„å‚æ•°é™¤äº†æ­£å¸¸çš„å€¼ä»¥å¤–ï¼Œè¿˜å¯èƒ½æ˜¯å¦ä¸€ä¸ª <code>Promise</code> å®ä¾‹ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="title function_">resolve</span>(p1);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>p1</code>å’Œ<code>p2</code>éƒ½æ˜¯ <code>Promise</code> çš„å®ä¾‹ï¼Œä½†æ˜¯<code>p2</code>çš„<code>resolve</code>æ–¹æ³•å°†<code>p1</code>ä½œä¸ºå‚æ•°ï¼Œå³ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœæ˜¯è¿”å›å¦ä¸€ä¸ªå¼‚æ­¥æ“ä½œã€‚è¿™æ—¶<code>p1</code>çš„çŠ¶æ€å°±ä¼šä¼ é€’ç»™<code>p2</code>ï¼Œæ­¤æ—¶<code>p1</code>çš„çŠ¶æ€å†³å®šäº†<code>p2</code>çš„çŠ¶æ€ã€‚</p><ul><li>å¦‚æœ<code>p1</code>çš„çŠ¶æ€æ˜¯<code>pending</code>ï¼Œé‚£ä¹ˆ<code>p2</code>çš„å›è°ƒå‡½æ•°å°±ä¼šç­‰å¾…<code>p1</code>çš„çŠ¶æ€æ”¹å˜ã€‚</li><li>å¦‚æœ<code>p1</code>çš„çŠ¶æ€å·²ç»æ˜¯<code>resolved</code>æˆ–è€…<code>rejected</code>ï¼Œé‚£ä¹ˆ<code>p2</code>çš„å›è°ƒå‡½æ•°å°†ä¼šç«‹åˆ»æ‰§è¡Œã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;fail&#x27;</span>)), <span class="number">3000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">resolve</span>(p1), <span class="number">1000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">p2</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(result))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(error))</span><br><span class="line"><span class="comment">// Error: fail</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>p1</code>æ˜¯ä¸€ä¸ª <code>Promise</code>ï¼Œ<code>3</code> ç§’ä¹‹åå˜ä¸º<code>rejected</code>ã€‚<code>p2</code>çš„çŠ¶æ€åœ¨ <code>1</code> ç§’ä¹‹åæ”¹å˜ï¼Œè€Œä¸”<code>resolve</code>æ–¹æ³•è¿”å›çš„æ˜¯<code>p1</code>ã€‚</p><ul><li>ç”±äº<code>p2</code>è¿”å›çš„æ˜¯å¦ä¸€ä¸ª <code>Promise</code>ï¼Œå¯¼è‡´<code>p2</code>è‡ªå·±çš„çŠ¶æ€æ— æ•ˆäº†ï¼Œ<ins>ç”±<code>p1</code>çš„çŠ¶æ€å†³å®š<code>p2</code>çš„çŠ¶æ€</ins>ã€‚æ‰€ä»¥ï¼Œåé¢çš„<code>then</code>è¯­å¥éƒ½å˜æˆé’ˆå¯¹åè€…<code>p1</code>ã€‚åˆè¿‡äº† <code>2</code> ç§’ï¼Œ<code>p1</code>å˜ä¸º<code>rejected</code>ï¼Œå¯¼è‡´è§¦å‘<code>catch</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚</li></ul><p>æ³¨æ„ï¼Œè°ƒç”¨<code>resolve</code>æˆ–<code>reject</code>å¹¶ä¸ä¼šç»ˆç»“ <code>Promise</code> çš„å‚æ•°å‡½æ•°çš„æ‰§è¡Œã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">r</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(r);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 1</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨<code>resolve(1)</code>ä»¥åï¼Œåé¢çš„<code>console.log(2)</code>è¿˜æ˜¯ä¼šæ‰§è¡Œï¼Œ<ins>å¹¶ä¸”ä¼šé¦–å…ˆæ‰“å°å‡ºæ¥ã€‚è¿™æ˜¯å› ä¸ºç«‹å³ <code>resolved</code> çš„ <code>Promise</code> æ˜¯åœ¨æœ¬è½®äº‹ä»¶å¾ªç¯çš„æœ«å°¾æ‰§è¡Œï¼Œæ€»æ˜¯æ™šäºæœ¬è½®å¾ªç¯çš„åŒæ­¥ä»»åŠ¡</ins>ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œè°ƒç”¨<code>resolve</code>æˆ–<code>reject</code>ä»¥åï¼Œ<code>Promise</code> çš„ä½¿å‘½å°±å®Œæˆäº†ï¼Œåç»§æ“ä½œåº”è¯¥æ”¾åˆ°<code>then</code>æ–¹æ³•é‡Œé¢ï¼Œè€Œä¸åº”è¯¥ç›´æ¥å†™åœ¨<code>resolve</code>æˆ–<code>reject</code>çš„åé¢ã€‚æ‰€ä»¥ï¼Œ<ins>æœ€å¥½åœ¨å®ƒä»¬å‰é¢åŠ ä¸Š<code>return</code>è¯­å¥</ins>ï¼Œè¿™æ ·å°±ä¸ä¼šæœ‰æ„å¤–ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">resolve</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="comment">// åé¢çš„è¯­å¥ä¸ä¼šæ‰§è¡Œ</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><hr><h3 id="16-4-then-æ–¹æ³•"><a href="#16-4-then-æ–¹æ³•" class="headerlink" title="16.4 then æ–¹æ³•"></a>16.4 then æ–¹æ³•</h3><p><code>Promise.then()</code>æ–¹æ³•çš„ä½œç”¨æ˜¯ä¸º <code>Promise</code> å®ä¾‹æ·»åŠ çŠ¶æ€æ”¹å˜æ—¶çš„å›è°ƒå‡½æ•°ã€‚<ins><code>then</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<code>resolved</code>çŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯<code>rejected</code>çŠ¶æ€çš„å›è°ƒå‡½æ•°</ins>ï¼Œå®ƒä»¬éƒ½æ˜¯å¯é€‰çš„ã€‚</p><p><ins><code>then</code>æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°çš„<code>Promise</code>å®ä¾‹</ins>ï¼Œå› æ­¤å¯ä»¥é‡‡ç”¨é“¾å¼å†™æ³•ï¼Œå³<code>then</code>æ–¹æ³•åé¢å†è°ƒç”¨å¦ä¸€ä¸ª<code>then</code>æ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">getJSON</span>(<span class="string">&quot;/posts.json&quot;</span>).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">json</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> json.<span class="property">post</span>;</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">post</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ä½¿ç”¨<code>then</code>æ–¹æ³•ï¼Œä¾æ¬¡æŒ‡å®šäº†ä¸¤ä¸ªå›è°ƒå‡½æ•°ã€‚<ins>ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°å®Œæˆä»¥åï¼Œä¼šå°†è¿”å›ç»“æœä½œä¸ºå‚æ•°ï¼Œä¼ å…¥ç¬¬äºŒä¸ªå›è°ƒå‡½æ•°</ins>ã€‚</p><p>é“¾å¼å†™æ³•çš„<code>then</code>ï¼Œå¯ä»¥æŒ‡å®šä¸€ç»„æŒ‰ç…§æ¬¡åºè°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚<ins>è¿™æ—¶ï¼Œå‰ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæœ‰å¯èƒ½è¿”å›çš„è¿˜æ˜¯ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ï¼ˆå³æœ‰å¼‚æ­¥æ“ä½œï¼‰ï¼Œè¿™æ—¶åä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå°±ä¼šç­‰å¾…è¯¥<code>Promise</code>å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œæ‰ä¼šè¢«è°ƒç”¨</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">getJSON</span>(<span class="string">&quot;/post/1.json&quot;</span>).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">post</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">getJSON</span>(post.<span class="property">commentURL</span>);</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">comments</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;resolved: &quot;</span>, comments);</span><br><span class="line">&#125;, <span class="keyword">function</span> (<span class="params">err</span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;rejected: &quot;</span>, err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬ä¸€ä¸ª<code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œè¿”å›çš„æ˜¯å¦ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ã€‚<ins>è¿™æ—¶ï¼Œç¬¬äºŒä¸ª<code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå°±ä¼šç­‰å¾…è¿™ä¸ªæ–°çš„<code>Promise</code>å¯¹è±¡çŠ¶æ€å‘ç”Ÿå˜åŒ–</ins>ã€‚</p><ul><li>å¦‚æœå˜ä¸º<code>resolved</code>ï¼Œç¬¬äºŒä¸ª<code>then</code>æ–¹æ³•å°±è°ƒç”¨ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚</li><li>å¦‚æœçŠ¶æ€å˜ä¸º<code>rejected</code>ï¼Œç¬¬äºŒä¸ª<code>then</code>æ–¹æ³•å°±è°ƒç”¨ç¬¬äºŒä¸ªå›è°ƒå‡½æ•°ã€‚</li></ul><p>å¦‚æœé‡‡ç”¨ç®­å¤´å‡½æ•°ï¼Œä¸Šé¢çš„ä»£ç å¯ä»¥å†™å¾—æ›´ç®€æ´ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">getJSON</span>(<span class="string">&quot;/post/1.json&quot;</span>).<span class="title function_">then</span>(</span><br><span class="line">  <span class="function"><span class="params">post</span> =&gt;</span> <span class="title function_">getJSON</span>(post.<span class="property">commentURL</span>)</span><br><span class="line">).<span class="title function_">then</span>(</span><br><span class="line">  <span class="function"><span class="params">comments</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;resolved: &quot;</span>, comments),</span><br><span class="line">  <span class="function"><span class="params">err</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;rejected: &quot;</span>, err)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><hr><h3 id="16-5-catch-æ–¹æ³•"><a href="#16-5-catch-æ–¹æ³•" class="headerlink" title="16.5 catch æ–¹æ³•"></a>16.5 catch æ–¹æ³•</h3><p><code>Promise.catch()</code>æ–¹æ³•ç”¨äºæŒ‡å®šå‘ç”Ÿé”™è¯¯æ—¶çš„å›è°ƒå‡½æ•°ã€‚<ins>å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªæ–°çš„<code>Promise</code>å¯¹è±¡</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">getJSON</span>(<span class="string">&#x27;/posts.json&#x27;</span>).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">posts</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="keyword">function</span>(<span class="params">error</span>) &#123;</span><br><span class="line">  <span class="comment">// å¤„ç† getJSON å’Œ å‰ä¸€ä¸ªå›è°ƒå‡½æ•°è¿è¡Œæ—¶å‘ç”Ÿçš„é”™è¯¯</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å‘ç”Ÿé”™è¯¯ï¼&#x27;</span>, error);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>getJSON()</code>æ–¹æ³•è¿”å›ä¸€ä¸ª <code>Promise</code> å¯¹è±¡ã€‚</p><ul><li>å¦‚æœè¯¥å¯¹è±¡çŠ¶æ€å˜ä¸º<code>resolved</code>ï¼Œåˆ™ä¼šè°ƒç”¨<code>then()</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚</li><li>å¦‚æœå¼‚æ­¥æ“ä½œæŠ›å‡ºé”™è¯¯ï¼ŒçŠ¶æ€å°±ä¼šå˜ä¸º<code>rejected</code>ï¼Œå°±ä¼šè°ƒç”¨<code>catch()</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°å¤„ç†è¿™ä¸ªé”™è¯¯ã€‚</li></ul><p>æ³¨æ„ï¼Œ<ins><code>then()</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå¦‚æœè¿è¡Œä¸­æŠ›å‡ºé”™è¯¯ï¼Œä¹Ÿä¼šè¢«<code>catch()</code>æ–¹æ³•æ•è·</ins>ã€‚</p><p>ä¸‹é¢ä»£ç ä¸­ï¼Œ<code>promise</code>æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¢«<code>catch()</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°æ•è·ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;test&#x27;</span>); <span class="comment">// or reject(new Error(&#x27;test&#x27;));</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">catch</span>(<span class="keyword">function</span>(<span class="params">error</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// Error: test</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢ä¸¤ç§å†™æ³•ä¸ä¸Šé¢æ˜¯ç­‰ä»·çš„ã€‚ï¼ˆæ¯”è¾ƒå–œæ¬¢<code>try...catch...</code>çš„å†™æ³•ï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å†™æ³•ä¸€</span></span><br><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">    <span class="title function_">reject</span>(e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">catch</span>(<span class="keyword">function</span>(<span class="params">error</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†™æ³•äºŒ</span></span><br><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;test&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">catch</span>(<span class="keyword">function</span>(<span class="params">error</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œå¦‚æœ<code>Promise</code>çŠ¶æ€å·²ç»å˜æˆ<code>resolved</code>ï¼Œå†æŠ›å‡ºé”™è¯¯æ˜¯æ— æ•ˆçš„ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&#x27;ok&#x27;</span>);</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">value</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(value) &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="keyword">function</span>(<span class="params">error</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(error) &#125;);</span><br><span class="line"><span class="comment">// ok</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Promise</code> åœ¨<code>resolve</code>è¯­å¥åé¢ï¼Œå†æŠ›å‡ºé”™è¯¯ï¼Œå¹¶ä¸ä¼šè¢«æ•è·ã€‚å› ä¸º <code>Promise</code> çš„çŠ¶æ€ä¸€æ—¦æ”¹å˜ï¼Œå°±æ°¸ä¹…ä¿æŒè¯¥çŠ¶æ€ã€‚</p><p><code>Promise</code> å¯¹è±¡çš„é”™è¯¯å…·æœ‰â€œå†’æ³¡â€æ€§è´¨ï¼Œä¼šä¸€ç›´å‘åä¼ é€’ï¼Œç›´åˆ°è¢«æ•è·ä¸ºæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé”™è¯¯æ€»æ˜¯ä¼šè¢«ä¸‹ä¸€ä¸ª<code>catch</code>è¯­å¥æ•è·ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">getJSON</span>(<span class="string">&#x27;/post/1.json&#x27;</span>).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">post</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">getJSON</span>(post.<span class="property">commentURL</span>);</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">comments</span>) &#123;</span><br><span class="line">  <span class="comment">// some code</span></span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="keyword">function</span>(<span class="params">error</span>) &#123;</span><br><span class="line">  <span class="comment">// å¤„ç†å‰é¢ä¸‰ä¸ªPromiseäº§ç”Ÿçš„é”™è¯¯</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¸€å…±æœ‰ä¸‰ä¸ª <code>Promise</code> å¯¹è±¡ï¼šä¸€ä¸ªç”±<code>getJSON()</code>äº§ç”Ÿï¼Œä¸¤ä¸ªç”±<code>then()</code>äº§ç”Ÿã€‚å®ƒä»¬ä¹‹ä¸­ä»»ä½•ä¸€ä¸ªæŠ›å‡ºçš„é”™è¯¯ï¼Œéƒ½ä¼šè¢«æœ€åä¸€ä¸ª<code>catch()</code>æ•è·ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œ<ins>ä¸è¦åœ¨<code>then()</code>æ–¹æ³•é‡Œé¢å®šä¹‰ <code>Reject</code> çŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼Œæ€»æ˜¯ä½¿ç”¨<code>catch</code>æ–¹æ³•</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line">promise</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="comment">// success</span></span><br><span class="line">  &#125;, <span class="keyword">function</span>(<span class="params">err</span>) &#123;</span><br><span class="line">    <span class="comment">// error</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line">promise</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">data</span>) &#123; </span><br><span class="line">    <span class="comment">// success</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="keyword">function</span>(<span class="params">err</span>) &#123;</span><br><span class="line">    <span class="comment">// error</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>è·Ÿä¼ ç»Ÿçš„<code>try/catch</code>ä»£ç å—ä¸åŒçš„æ˜¯ï¼Œ<ins>å¦‚æœæ²¡æœ‰ä½¿ç”¨<code>catch()</code>æ–¹æ³•æŒ‡å®šé”™è¯¯å¤„ç†çš„å›è°ƒå‡½æ•°ï¼Œ<code>Promise</code> å¯¹è±¡æŠ›å‡ºçš„é”™è¯¯ä¸ä¼šä¼ é€’åˆ°å¤–å±‚ä»£ç </ins>ï¼Œå³ä¸ä¼šæœ‰ä»»ä½•ååº”ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> someAsyncThing = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="comment">// ä¸‹é¢ä¸€è¡Œä¼šæŠ¥é”™ï¼Œå› ä¸º x æ²¡æœ‰å£°æ˜</span></span><br><span class="line">    <span class="title function_">resolve</span>(x + <span class="number">2</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">someAsyncThing</span>().<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;everything is great&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">123</span>) &#125;, <span class="number">2000</span>);</span><br><span class="line"><span class="comment">// Uncaught (in promise) ReferenceError: x is not defined</span></span><br><span class="line"><span class="comment">// 123</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>someAsyncThing()</code>å‡½æ•°äº§ç”Ÿçš„ <code>Promise</code> å¯¹è±¡ï¼Œå†…éƒ¨æœ‰è¯­æ³•é”™è¯¯ã€‚è¿è¡Œåˆ°è¿™ä¸€è¡Œæ—¶ï¼Œä¼šæ‰“å°å‡ºé”™è¯¯æç¤ºï¼Œä½†æ˜¯ä¸ä¼šç»ˆæ­¢è„šæœ¬æ‰§è¡Œï¼Œ<code>2</code> ç§’ä¹‹åè¿˜æ˜¯ä¼šè¾“å‡º<code>123</code>ã€‚è¿™å°±æ˜¯è¯´ï¼Œ<ins><code>Promise</code> å†…éƒ¨çš„é”™è¯¯ä¸ä¼šå½±å“åˆ° <code>Promise</code> å¤–éƒ¨çš„ä»£ç </ins>ï¼Œé€šä¿—çš„è¯´æ³•å°±æ˜¯â€œ<code>Promise</code> ä¼šåƒæ‰é”™è¯¯â€ã€‚</p><p>æ‰€ä»¥å»ºè®®ï¼Œ<code>Promise</code> å¯¹è±¡åé¢è¦è·Ÿ<code>catch()</code>æ–¹æ³•ï¼Œè¿™æ ·å¯ä»¥å¤„ç† <code>Promise</code> å†…éƒ¨å‘ç”Ÿçš„é”™è¯¯ã€‚æ³¨æ„ï¼Œ<ins><code>catch()</code>æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°çš„<code>Promise</code>å¯¹è±¡</ins>ï¼Œå› æ­¤åé¢è¿˜å¯ä»¥æ¥ç€è°ƒç”¨<code>then()</code>æ–¹æ³•ï¼Œæˆ–è€…<code>catch()</code>æ–¹æ³•ï¼Œå»å¤„ç†å‰ä¸€ä¸ª<code>catch()</code>æ–¹æ³•æŠ›å‡ºçš„é”™è¯¯ã€‚</p><hr><h3 id="16-6-finally-æ–¹æ³•"><a href="#16-6-finally-æ–¹æ³•" class="headerlink" title="16.6 finally æ–¹æ³•"></a>16.6 finally æ–¹æ³•</h3><p><code>Promise.finally()</code>æ–¹æ³•ç”¨äºæŒ‡å®šä¸ç®¡<code>Promise</code>å¯¹è±¡æœ€åçŠ¶æ€å¦‚ä½•ï¼Œéƒ½ä¼šæ‰§è¡Œçš„æ“ä½œã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">promise</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;Â·Â·Â·&#125;)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;Â·Â·Â·&#125;)</span><br><span class="line">.<span class="title function_">finally</span>(<span class="function">() =&gt;</span> &#123;Â·Â·Â·&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¸ç®¡<code>promise</code>æœ€åçš„çŠ¶æ€ï¼Œåœ¨æ‰§è¡Œå®Œ<code>then</code>æˆ–<code>catch</code>æŒ‡å®šçš„å›è°ƒå‡½æ•°ä»¥åï¼Œéƒ½ä¼šæ‰§è¡Œ<code>finally</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼ŒæœåŠ¡å™¨ä½¿ç”¨ <code>Promise</code> å¤„ç†è¯·æ±‚ï¼Œç„¶åä½¿ç”¨<code>finally</code>æ–¹æ³•å…³æ‰æœåŠ¡å™¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">server.<span class="title function_">listen</span>(port)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">finally</span>(server.<span class="property">stop</span>);</span><br></pre></td></tr></table></figure><p>ç”±äº<ins><code>finally</code>æ–¹æ³•çš„å›è°ƒå‡½æ•°ä¸æ¥å—ä»»ä½•å‚æ•°</ins>ï¼Œè¿™è¡¨æ˜<ins><code>finally</code>æ–¹æ³•é‡Œé¢çš„æ“ä½œï¼Œåº”è¯¥æ˜¯ä¸çŠ¶æ€æ— å…³çš„ï¼Œä¸ä¾èµ–äº<code>Promise</code>çš„æ‰§è¡Œç»“æœ</ins>ã€‚</p><hr><h3 id="16-7-all-æ–¹æ³•"><a href="#16-7-all-æ–¹æ³•" class="headerlink" title="16.7 all æ–¹æ³•"></a>16.7 all æ–¹æ³•</h3><p><code>Promise.all()</code>æ–¹æ³•ç”¨äºå°†å¤šä¸ª<code>Promise</code>å®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„<code>Promise</code>å®ä¾‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="title class_">Promise</span>.<span class="title function_">all</span>([p1, p2, p3]); <span class="comment">// æ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢<code>p</code>çš„çŠ¶æ€ç”±<code>p1</code>ã€<code>p2</code>ã€<code>p3</code>å†³å®šï¼Œåˆ†æˆä¸¤ç§æƒ…å†µï¼š</p><ul><li>åªæœ‰<code>p1</code>ã€<code>p2</code>ã€<code>p3</code>çš„<ins>çŠ¶æ€éƒ½å˜æˆ<code>fulfilled</code>ï¼Œ<code>p</code>çš„çŠ¶æ€æ‰ä¼šå˜æˆ<code>fulfilled</code></ins>ï¼Œæ­¤æ—¶<ins><code>p1</code>ã€<code>p2</code>ã€<code>p3</code>çš„è¿”å›å€¼ç»„æˆä¸€ä¸ªæ•°ç»„ï¼Œä¼ é€’ç»™<code>p</code>çš„å›è°ƒå‡½æ•°</ins>ã€‚</li><li>åªè¦<code>p1</code>ã€<code>p2</code>ã€<code>p3</code>ä¹‹ä¸­<ins>æœ‰ä¸€ä¸ªè¢«<code>rejected</code>ï¼Œ<code>p</code>çš„çŠ¶æ€å°±å˜æˆ<code>rejected</code></ins>ï¼Œæ­¤æ—¶<ins>ç¬¬ä¸€ä¸ªè¢«<code>reject</code>çš„å®ä¾‹çš„è¿”å›å€¼ï¼Œä¼šä¼ é€’ç»™<code>p</code>çš„å›è°ƒå‡½æ•°</ins>ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç”Ÿæˆä¸€ä¸ªPromiseå¯¹è±¡çš„æ•°ç»„</span></span><br><span class="line"><span class="keyword">const</span> promises = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>].<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">id</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">getJSON</span>(<span class="string">&#x27;/post/&#x27;</span> + id + <span class="string">&quot;.json&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>(promises).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">posts</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="keyword">function</span>(<span class="params">reason</span>)&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œåªæœ‰<code>promises</code>ä¸­<code>6</code>ä¸ª<code>Promise</code>å®ä¾‹çš„çŠ¶æ€éƒ½å˜æˆ<code>fulfilled</code>ï¼Œæˆ–è€…æœ‰ä¸€ä¸ªå˜ä¸º<code>rejected</code>ï¼Œæ‰ä¼šè°ƒç”¨<code>Promise.all()</code>æ–¹æ³•åé¢çš„å›è°ƒå‡½æ•°ã€‚</p><p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> databasePromise = <span class="title function_">connectDatabase</span>(); <span class="comment">// è¿™é‡Œåº”è¯¥æ˜¯è¿”å›ä¸€ä¸ª Promise å®ä¾‹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> booksPromise = databasePromise</span><br><span class="line">  .<span class="title function_">then</span>(findAllBooks); <span class="comment">// è¿”å›ä¸€ä¸ª Promise Objectï¼Œä¸ºå½“å‰ Promise çš„çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userPromise = databasePromise</span><br><span class="line">  .<span class="title function_">then</span>(getCurrentUser);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>([ </span><br><span class="line">  booksPromise,</span><br><span class="line">  userPromise</span><br><span class="line">])</span><br><span class="line">.<span class="title function_">then</span>(<span class="function">(<span class="params">[books, user]</span>) =&gt;</span> <span class="title function_">pickTopRecommendations</span>(books, user));</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>booksPromise</code>å’Œ<code>userPromise</code>æ˜¯ä¸¤ä¸ªå¼‚æ­¥æ“ä½œï¼Œåªæœ‰ç­‰åˆ°å®ƒä»¬çš„ç»“æœéƒ½è¿”å›äº†ï¼Œæ‰ä¼šè§¦å‘<code>pickTopRecommendations</code>è¿™ä¸ªå›è°ƒå‡½æ•°ã€‚</p><p>æ³¨æ„ï¼Œå¦‚æœ<ins>ä½œä¸ºå‚æ•°çš„ <code>Promise</code> å®ä¾‹ï¼Œè‡ªå·±å®šä¹‰äº†<code>catch</code>æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒä¸€æ—¦è¢«<code>rejected</code>ï¼Œå¹¶ä¸ä¼šè§¦å‘<code>Promise.all()</code>çš„<code>catch</code>æ–¹æ³•</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> result)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> e);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;æŠ¥é”™äº†&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> result)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> e);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>([p1, p2])</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(result))</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(e));</span><br><span class="line"><span class="comment">// [&quot;hello&quot;, Error: æŠ¥é”™äº†]</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>p1</code>æ˜¯<code>resolved</code>ï¼Œ<code>p2</code>ä¼šè¢«<code>rejected</code>ã€‚ä½†æ˜¯<code>p2</code>æœ‰è‡ªå·±çš„<code>catch</code>æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ <code>Promise</code> å®ä¾‹ï¼Œ<code>p2</code>å®é™…æŒ‡å‘çš„æ˜¯è¿™ä¸ªæ–°çš„å®ä¾‹ã€‚<ins>è¯¥å®ä¾‹æ‰§è¡Œå®Œ<code>catch</code>æ–¹æ³•åï¼Œä¹Ÿä¼šå˜æˆ<code>resolved</code>ï¼Œå¯¼è‡´<code>Promise.all()</code>æ–¹æ³•å‚æ•°é‡Œé¢çš„ä¸¤ä¸ªå®ä¾‹éƒ½ä¼š<code>resolved</code>ï¼Œå› æ­¤ä¼šè°ƒç”¨<code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°</ins>ï¼Œè€Œä¸ä¼šè°ƒç”¨<code>catch</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚</p><p>å¦‚æœ<code>p2</code>æ²¡æœ‰è‡ªå·±çš„<code>catch</code>æ–¹æ³•ï¼Œå°±ä¼šè°ƒç”¨<code>Promise.all()</code>çš„<code>catch</code>æ–¹æ³•ã€‚</p><hr><h3 id="16-8-race-æ–¹æ³•"><a href="#16-8-race-æ–¹æ³•" class="headerlink" title="16.8 race æ–¹æ³•"></a>16.8 race æ–¹æ³•</h3><p><code>Promise.race()</code>æ–¹æ³•åŒæ ·æ˜¯å°†å¤šä¸ª <code>Promise</code> å®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ <code>Promise</code> å®ä¾‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="title class_">Promise</span>.<span class="title function_">race</span>([p1, p2, p3]);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦<code>p1</code>ã€<code>p2</code>ã€<code>p3</code>ä¹‹ä¸­<ins>æœ‰ä¸€ä¸ªå®ä¾‹ç‡å…ˆæ”¹å˜çŠ¶æ€ï¼Œ<code>p</code>çš„çŠ¶æ€å°±è·Ÿç€æ”¹å˜</ins>ã€‚é‚£ä¸ªç‡å…ˆæ”¹å˜çš„ <code>Promise</code> å®ä¾‹çš„è¿”å›å€¼ï¼Œå°±ä¼ é€’ç»™<code>p</code>çš„å›è°ƒå‡½æ•°ã€‚</p><p>ä¸‹é¢å¦‚æœæŒ‡å®šæ—¶é—´å†…æ²¡æœ‰è·å¾—ç»“æœï¼Œå°±å°† <code>Promise</code> çš„çŠ¶æ€å˜ä¸º<code>reject</code>ï¼Œå¦åˆ™å˜ä¸º<code>resolve</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="title class_">Promise</span>.<span class="title function_">race</span>([</span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&#x27;/resource-that-may-take-a-while&#x27;</span>),</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;request timeout&#x27;</span>)), <span class="number">5000</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line">p</span><br><span class="line">.<span class="title function_">then</span>(<span class="variable language_">console</span>.<span class="property">log</span>)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="variable language_">console</span>.<span class="property">error</span>);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœ <code>5</code> ç§’ä¹‹å†…<code>fetch</code>æ–¹æ³•æ— æ³•è¿”å›ç»“æœï¼Œå˜é‡<code>p</code>çš„çŠ¶æ€å°±ä¼šå˜ä¸º<code>rejected</code>ï¼Œä»è€Œè§¦å‘<code>catch</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚</p><hr><h3 id="16-9-allSettled-æ–¹æ³•"><a href="#16-9-allSettled-æ–¹æ³•" class="headerlink" title="16.9 allSettled æ–¹æ³•"></a>16.9 allSettled æ–¹æ³•</h3><p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›ç­‰åˆ°ä¸€ç»„å¼‚æ­¥æ“ä½œéƒ½ç»“æŸï¼Œä¸ç®¡æ¯ä¸€ä¸ªæ“ä½œæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œå†è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ<code>ES6</code> å¼•å…¥äº†<code>Promise.allSettled()</code>æ–¹æ³•ã€‚</p><p><code>Promise.allSettled()</code>æ–¹æ³•æ¥å—ä¸€ä¸ª<code>Promise</code>æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œå¹¶<ins>è¿”å›ä¸€ä¸ªæ–°çš„ <code>Promise</code> å¯¹è±¡</ins>ã€‚åªæœ‰ç­‰åˆ°å‚æ•°æ•°ç»„çš„<ins>æ‰€æœ‰ <code>Promise</code> å¯¹è±¡éƒ½å‘ç”ŸçŠ¶æ€å˜æ›´ï¼Œä¸ç®¡æ˜¯<code>fulfilled</code>è¿˜æ˜¯<code>rejected</code>ï¼Œè¿”å›çš„ <code>Promise</code> å¯¹è±¡æ‰ä¼šå‘ç”ŸçŠ¶æ€å˜æ›´</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> promises = [</span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&#x27;/api-1&#x27;</span>),</span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&#x27;/api-2&#x27;</span>),</span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&#x27;/api-3&#x27;</span>),</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">allSettled</span>(promises);</span><br><span class="line"><span class="title function_">removeLoadingIndicator</span>();</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œæ•°ç»„<code>promises</code>åŒ…å«äº†ä¸‰ä¸ªè¯·æ±‚ï¼Œåªæœ‰ç­‰åˆ°è¿™ä¸‰ä¸ªè¯·æ±‚éƒ½ç»“æŸäº†ï¼Œä¸ç®¡è¯·æ±‚æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œ<code>removeLoadingIndicator()</code>æ‰ä¼šæ‰§è¡Œã€‚</p><p><code>Promise.allSettled()</code>è¿”å›çš„ <code>Promise</code> å®ä¾‹ï¼Œ<ins>çŠ¶æ€æ€»æ˜¯<code>fulfilled</code>ï¼Œä¸ä¼šå˜æˆ<code>rejected</code></ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> resolved = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">42</span>);</span><br><span class="line"><span class="keyword">const</span> rejected = <span class="title class_">Promise</span>.<span class="title function_">reject</span>(-<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> allSettledPromise = <span class="title class_">Promise</span>.<span class="title function_">allSettled</span>([resolved, rejected]);</span><br><span class="line"></span><br><span class="line">allSettledPromise.<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">results</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(results);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// [</span></span><br><span class="line"><span class="comment">//    &#123; status: &#x27;fulfilled&#x27;, value: 42 &#125;,</span></span><br><span class="line"><span class="comment">//    &#123; status: &#x27;rejected&#x27;, reason: -1 &#125;</span></span><br><span class="line"><span class="comment">// ]</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Promise.allSettled()</code>çš„è¿”å›å€¼<code>allSettledPromise</code>ï¼ŒçŠ¶æ€åªå¯èƒ½å˜æˆ<code>fulfilled</code>ã€‚<ins>å®ƒçš„å›è°ƒå‡½æ•°æ¥æ”¶åˆ°çš„å‚æ•°æ˜¯æ•°ç»„<code>results</code>ï¼Œå¯¹åº”ä¼ å…¥<code>Promise.allSettled()</code>çš„æ•°ç»„é‡Œé¢çš„ä¸¤ä¸ª <code>Promise</code> å¯¹è±¡</ins>ã€‚</p><p>ä¸Šé¢<code>results</code>çš„æ¯ä¸ªæˆå‘˜æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹åº”å¼‚æ­¥æ“ä½œçš„ç»“æœã€‚ï¼ˆé‡ç‚¹ï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¼‚æ­¥æ“ä½œæˆåŠŸæ—¶</span></span><br><span class="line">&#123;<span class="attr">status</span>: <span class="string">&#x27;fulfilled&#x27;</span>, <span class="attr">value</span>: value&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶</span></span><br><span class="line">&#123;<span class="attr">status</span>: <span class="string">&#x27;rejected&#x27;</span>, <span class="attr">reason</span>: reason&#125;</span><br></pre></td></tr></table></figure><p>æˆå‘˜å¯¹è±¡çš„<code>status</code>å±æ€§çš„å€¼åªå¯èƒ½æ˜¯å­—ç¬¦ä¸²<code>fulfilled</code>æˆ–å­—ç¬¦ä¸²<code>rejected</code>ï¼Œç”¨æ¥åŒºåˆ†å¼‚æ­¥æ“ä½œæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚<ins>å¦‚æœæ˜¯æˆåŠŸ<code>fulfilled</code>ï¼Œå¯¹è±¡ä¼šæœ‰<code>value</code>å±æ€§ï¼Œå¦‚æœæ˜¯å¤±è´¥<code>rejected</code>ï¼Œä¼šæœ‰<code>reason</code>å±æ€§</ins>ï¼Œå¯¹åº”ä¸¤ç§çŠ¶æ€æ—¶å‰é¢å¼‚æ­¥æ“ä½œçš„è¿”å›å€¼ã€‚</p><hr><h3 id="16-10-any-æ–¹æ³•"><a href="#16-10-any-æ–¹æ³•" class="headerlink" title="16.10 any æ–¹æ³•"></a>16.10 any æ–¹æ³•</h3><p><code>Promise.any()</code> æ¥å—ä¸€ç»„ <code>Promise</code> å®ä¾‹ä½œä¸ºå‚æ•°ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ <code>Promise</code> å®ä¾‹è¿”å›ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">any</span>([</span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&#x27;https://v8.dev/&#x27;</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="string">&#x27;home&#x27;</span>),</span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&#x27;https://v8.dev/blog&#x27;</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="string">&#x27;blog&#x27;</span>),</span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&#x27;https://v8.dev/docs&#x27;</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="string">&#x27;docs&#x27;</span>)</span><br><span class="line">]).<span class="title function_">then</span>(<span class="function">(<span class="params">first</span>) =&gt;</span> &#123;  <span class="comment">// åªè¦æœ‰ä¸€ä¸ª fetch() è¯·æ±‚æˆåŠŸ</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(first);</span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123; <span class="comment">// æ‰€æœ‰ä¸‰ä¸ª fetch() å…¨éƒ¨è¯·æ±‚å¤±è´¥</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>åªè¦å‚æ•°å®ä¾‹æœ‰ä¸€ä¸ªå˜æˆ<code>fulfilled</code>çŠ¶æ€ï¼ŒåŒ…è£…å®ä¾‹å°±ä¼šå˜æˆ<code>fulfilled</code>çŠ¶æ€ã€‚</li><li>å¦‚æœæ‰€æœ‰å‚æ•°å®ä¾‹éƒ½å˜æˆ<code>rejected</code>çŠ¶æ€ï¼ŒåŒ…è£…å®ä¾‹å°±ä¼šå˜æˆ<code>rejected</code>çŠ¶æ€ã€‚</li></ul><p>ä¸‹é¢æ˜¯<code>Promise()</code>ä¸<code>await</code>å‘½ä»¤ç»“åˆä½¿ç”¨çš„ä¾‹å­ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> promises = [</span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&#x27;/endpoint-a&#x27;</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="string">&#x27;a&#x27;</span>),</span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&#x27;/endpoint-b&#x27;</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="string">&#x27;b&#x27;</span>),</span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&#x27;/endpoint-c&#x27;</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> <span class="string">&#x27;c&#x27;</span>),</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> first = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">any</span>(promises);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(first);</span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Promise.any()</code>æ–¹æ³•çš„å‚æ•°åŒ…å«ä¸‰ä¸ª <code>Promise</code> æ“ä½œã€‚å…¶ä¸­åªè¦æœ‰ä¸€ä¸ªå˜æˆ<code>fulfilled</code>ï¼Œ<code>Promise.any()</code>è¿”å›çš„ <code>Promise</code> å¯¹è±¡å°±å˜æˆ<code>fulfilled</code>ã€‚å¦‚æœæ‰€æœ‰ä¸‰ä¸ªæ“ä½œéƒ½å˜æˆ<code>rejected</code>ï¼Œé‚£ä¹ˆ<code>await</code>å‘½ä»¤å°±ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p><hr><h3 id="16-11-resolve-æ–¹æ³•"><a href="#16-11-resolve-æ–¹æ³•" class="headerlink" title="16.11 resolve æ–¹æ³•"></a>16.11 resolve æ–¹æ³•</h3><p>æœ‰æ—¶éœ€è¦å°†ç°æœ‰å¯¹è±¡è½¬ä¸º <code>Promise</code> å¯¹è±¡ï¼Œ<code>Promise.resolve()</code>æ–¹æ³•å°±èµ·åˆ°è¿™ä¸ªä½œç”¨ã€‚</p><p><strong>ï¼ˆ1ï¼‰å‚æ•°æ˜¯ä¸€ä¸ªthenableå¯¹è±¡</strong></p><p><code>thenable</code>å¯¹è±¡æŒ‡çš„æ˜¯å…·æœ‰<code>then</code>æ–¹æ³•çš„å¯¹è±¡ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªå¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> thenable = &#123;</span><br><span class="line">  <span class="attr">then</span>: <span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="number">42</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p1 = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(thenable);</span><br><span class="line"></span><br><span class="line">p1.<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">value</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value);  <span class="comment">// 42</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<ins><code>resolve()</code>æ–¹æ³•ä¼šå°†è¿™ä¸ªå¯¹è±¡è½¬ä¸º <code>Promise</code> å¯¹è±¡ï¼Œç„¶åç«‹å³æ‰§è¡Œ<code>thenable</code>å¯¹è±¡çš„<code>then()</code>æ–¹æ³•</ins>ã€‚</p><p><strong>ï¼ˆ2ï¼‰å‚æ•°ä¸æ˜¯å…·æœ‰then()æ–¹æ³•çš„å¯¹è±¡ï¼Œæˆ–æ ¹æœ¬å°±ä¸æ˜¯å¯¹è±¡</strong></p><p>å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªåŸå§‹å€¼ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªä¸å…·æœ‰<code>then()</code>æ–¹æ³•çš„å¯¹è±¡ï¼Œåˆ™<code>resolve()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„ <code>Promise</code> å¯¹è±¡ï¼ŒçŠ¶æ€ä¸º<code>resolved</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="string">&#x27;Hello&#x27;</span>);</span><br><span class="line"></span><br><span class="line">p.<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">s</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(s)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// Hello</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ3ï¼‰ä¸å¸¦æœ‰ä»»ä½•å‚æ•°</strong></p><p><code>resolve()</code>æ–¹æ³•è°ƒç”¨æ—¶å¯ä»¥<ins>ä¸å¸¦å‚æ•°ï¼Œç›´æ¥è¿”å›ä¸€ä¸ª<code>resolved</code>çŠ¶æ€çš„ <code>Promise</code> å¯¹è±¡</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>();</span><br><span class="line"></span><br><span class="line">p.<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><ins>ç«‹å³<code>resolve()</code>çš„ <code>Promise</code> å¯¹è±¡ï¼Œæ˜¯åœ¨æœ¬è½®â€œäº‹ä»¶å¾ªç¯â€çš„ç»“æŸæ—¶æ‰§è¡Œï¼Œè€Œä¸æ˜¯åœ¨ä¸‹ä¸€è½®â€œäº‹ä»¶å¾ªç¯â€çš„å¼€å§‹æ—¶</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;three&#x27;</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;two&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;one&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// one</span></span><br><span class="line"><span class="comment">// two</span></span><br><span class="line"><span class="comment">// three</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>setTimeout(fn, 0)</code>åœ¨ä¸‹ä¸€è½®â€œäº‹ä»¶å¾ªç¯â€å¼€å§‹æ—¶æ‰§è¡Œï¼Œ<code>resolve()</code>åœ¨æœ¬è½®â€œäº‹ä»¶å¾ªç¯â€ç»“æŸæ—¶æ‰§è¡Œï¼Œ<code>console.log(&#39;one&#39;)</code>åˆ™æ˜¯ç«‹å³æ‰§è¡Œï¼Œå› æ­¤æœ€å…ˆè¾“å‡ºã€‚</p><hr><h3 id="16-12-reject-æ–¹æ³•"><a href="#16-12-reject-æ–¹æ³•" class="headerlink" title="16.12 reject æ–¹æ³•"></a>16.12 reject æ–¹æ³•</h3><p><code>Promise.reject(reason)</code>æ–¹æ³•ä¹Ÿä¼šè¿”å›ä¸€ä¸ªæ–°çš„ <code>Promise</code> å®ä¾‹ï¼Œè¯¥å®ä¾‹çš„çŠ¶æ€ä¸º<code>rejected</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&#x27;å‡ºé”™äº†&#x27;</span>);</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> <span class="title function_">reject</span>(<span class="string">&#x27;å‡ºé”™äº†&#x27;</span>))</span><br><span class="line"></span><br><span class="line">p.<span class="title function_">then</span>(<span class="literal">null</span>, <span class="keyword">function</span> (<span class="params">s</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(s)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// å‡ºé”™äº†</span></span><br></pre></td></tr></table></figure><p><code>Promise.reject()</code>æ–¹æ³•çš„å‚æ•°ï¼Œä¼šåŸå°ä¸åŠ¨åœ°ä½œä¸º<code>reject</code>çš„ç†ç”±ï¼Œå˜æˆåç»­æ–¹æ³•çš„å‚æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&#x27;å‡ºé”™äº†&#x27;</span>)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(e === <span class="string">&#x27;å‡ºé”™äº†&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure><hr><h2 id="17-Iterator-å’Œ-forâ€¦of-å¾ªç¯"><a href="#17-Iterator-å’Œ-forâ€¦of-å¾ªç¯" class="headerlink" title="17. Iterator å’Œ forâ€¦of å¾ªç¯"></a>17. Iterator å’Œ forâ€¦of å¾ªç¯</h2><h3 id="17-1-Iterator-æ¦‚å¿µ"><a href="#17-1-Iterator-æ¦‚å¿µ" class="headerlink" title="17.1 Iterator æ¦‚å¿µ"></a>17.1 Iterator æ¦‚å¿µ</h3><p>éå†å™¨<code>Iterator</code>æ˜¯ä¸€ç§æ¥å£ï¼Œ<ins>ä¸ºå„ç§ä¸åŒçš„æ•°æ®ç»“æ„æä¾›ç»Ÿä¸€çš„è®¿é—®æœºåˆ¶</ins>ã€‚ä»»ä½•æ•°æ®ç»“æ„åªè¦éƒ¨ç½² <code>Iterator</code> æ¥å£ï¼Œå°±å¯ä»¥å®Œæˆéå†æ“ä½œï¼Œä¾æ¬¡å¤„ç†è¯¥æ•°æ®ç»“æ„çš„æ‰€æœ‰æˆå‘˜ã€‚</p><p><code>Iterator</code> çš„éå†è¿‡ç¨‹ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ï¼ŒæŒ‡å‘å½“å‰æ•°æ®ç»“æ„çš„èµ·å§‹ä½ç½®ã€‚</li><li>ç¬¬ä¸€æ¬¡è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼Œå¯ä»¥å°†æŒ‡é’ˆæŒ‡å‘æ•°æ®ç»“æ„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ã€‚</li><li>ç¬¬äºŒæ¬¡è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼ŒæŒ‡é’ˆå°±æŒ‡å‘æ•°æ®ç»“æ„çš„ç¬¬äºŒä¸ªæˆå‘˜ã€‚</li><li>ä¸æ–­è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼Œç›´åˆ°å®ƒæŒ‡å‘æ•°æ®ç»“æ„çš„ç»“æŸä½ç½®ã€‚</li></ol><p>æ¯ä¸€æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œéƒ½ä¼šè¿”å›æ•°æ®ç»“æ„çš„å½“å‰æˆå‘˜çš„ä¿¡æ¯ã€‚å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯è¿”å›ä¸€ä¸ªåŒ…å«<code>value</code>å’Œ<code>done</code>ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ã€‚å…¶ä¸­ï¼Œ<ins><code>value</code>å±æ€§æ˜¯å½“å‰æˆå‘˜çš„å€¼ï¼Œ<code>done</code>å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºéå†æ˜¯å¦ç»“æŸ</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> a = [<span class="number">1</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">25</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> it = a[<span class="title class_">Symbol</span>.<span class="property">iterator</span>]();</span><br><span class="line"></span><br><span class="line">it.<span class="title function_">next</span>().<span class="property">value</span> <span class="comment">// 1</span></span><br><span class="line">it.<span class="title function_">next</span>().<span class="property">value</span> <span class="comment">// 5</span></span><br><span class="line">it.<span class="title function_">next</span>().<span class="property">value</span> <span class="comment">// 15</span></span><br></pre></td></tr></table></figure><p><code>ES6</code> è§„å®šï¼Œé»˜è®¤çš„ <code>Iterator</code> æ¥å£éƒ¨ç½²åœ¨æ•°æ®ç»“æ„çš„<code>Symbol.iterator</code>å±æ€§ï¼Œæˆ–è€…è¯´ï¼Œä¸€ä¸ªæ•°æ®ç»“æ„åªè¦å…·æœ‰<code>Symbol.iterator</code>å±æ€§ï¼Œå°±å¯ä»¥è®¤ä¸ºæ˜¯â€œå¯éå†çš„â€ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    <span class="attr">numbers</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    [<span class="title class_">Symbol</span>.<span class="property">iterator</span>]: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> self = <span class="variable language_">this</span>;</span><br><span class="line">        <span class="keyword">let</span> idx = -<span class="number">1</span>; <span class="comment">// &lt;--- æŠµæ¶ˆ ++ çš„ side-effect</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">next</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                idx++;</span><br><span class="line">                <span class="comment">// å¯ä»¥å°è¯• log å‡ºä¸‹é¢çš„ object</span></span><br><span class="line">                <span class="keyword">return</span> &#123;</span><br><span class="line">                    <span class="attr">value</span>: self.<span class="property">numbers</span>[idx],</span><br><span class="line">                    <span class="attr">done</span>: idx &gt;= self.<span class="property">numbers</span>.<span class="property">length</span>,</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> num <span class="keyword">of</span> obj) <span class="variable language_">console</span>.<span class="title function_">log</span>(num); <span class="comment">// 1 2 3</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡<code>obj</code>æ˜¯å¯éå†çš„ï¼Œå› ä¸ºå…·æœ‰<code>Symbol.iterator</code>å±æ€§ã€‚æ‰§è¡Œè¿™ä¸ªå±æ€§ï¼Œä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ã€‚è¯¥å¯¹è±¡çš„æ ¹æœ¬ç‰¹å¾å°±æ˜¯å…·æœ‰<code>next</code>æ–¹æ³•ã€‚æ¯æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œéƒ½ä¼šè¿”å›ä¸€ä¸ªä»£è¡¨å½“å‰æˆå‘˜çš„ä¿¡æ¯å¯¹è±¡ï¼Œå…·æœ‰<code>value</code>å’Œ<code>done</code>ä¸¤ä¸ªå±æ€§ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸Šé¢ iterator æ‰“å°å‡ºæ¥çš„ objects</span></span><br><span class="line">&#123; <span class="attr">value</span>: <span class="number">1</span>, <span class="attr">done</span>: <span class="literal">false</span> &#125;</span><br><span class="line">&#123; <span class="attr">value</span>: <span class="number">2</span>, <span class="attr">done</span>: <span class="literal">false</span> &#125;</span><br><span class="line">&#123; <span class="attr">value</span>: <span class="number">3</span>, <span class="attr">done</span>: <span class="literal">false</span> &#125;</span><br><span class="line">&#123; <span class="attr">value</span>: <span class="literal">undefined</span>, <span class="attr">done</span>: <span class="literal">true</span> &#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œ<code>done</code> ä¸ä»£è¡¨è¿”å›çš„å€¼æ˜¯å¦æ˜¯æœ€åä¸€ä¸ªï¼Œè€Œæ˜¯è¡¨ç¤ºè¿­ä»£å™¨æ˜¯å¦æ²¡æœ‰æ›´å¤šçš„å€¼å¯ä»¥è¿”å›ã€‚</p><hr><h3 id="17-2-forâ€¦of-å¾ªç¯"><a href="#17-2-forâ€¦of-å¾ªç¯" class="headerlink" title="17.2 forâ€¦of å¾ªç¯"></a>17.2 forâ€¦of å¾ªç¯</h3><p><strong>ï¼ˆ1ï¼‰æ•°ç»„ï¼ŒSet ä¸ Map</strong> </p><p><code>ES6</code> çš„æ•°ç»„ï¼Œ<code>Set</code> å’Œ <code>Map</code> åŸç”Ÿå…·æœ‰ <code>Iterator</code> æ¥å£ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> color <span class="keyword">of</span> arr) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(color);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// red green blue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>(arr);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> color <span class="keyword">of</span> set) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(color);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// red green blue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>().<span class="title function_">set</span>(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>).<span class="title function_">set</span>(<span class="string">&#x27;b&#x27;</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> pair <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(pair);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// [&#x27;a&#x27;, 1]</span></span><br><span class="line"><span class="comment">// [&#x27;b&#x27;, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(key + <span class="string">&#x27; : &#x27;</span> + value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// a : 1</span></span><br><span class="line"><span class="comment">// b : 2</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç å¯ä»¥çœ‹å‡ºï¼Œ<code>Set</code> å’Œ <code>Map</code> éå†çš„é¡ºåºæ˜¯æŒ‰ç…§å„ä¸ªæˆå‘˜è¢«æ·»åŠ è¿›æ•°æ®ç»“æ„çš„é¡ºåºã€‚</p><p><strong>ï¼ˆ2ï¼‰è®¡ç®—ç”Ÿæˆçš„æ•°æ®ç»“æ„</strong> </p><p>æœ‰äº›æ•°æ®ç»“æ„æ˜¯åœ¨ç°æœ‰æ•°æ®ç»“æ„çš„åŸºç¡€ä¸Šï¼Œè®¡ç®—ç”Ÿæˆçš„ã€‚æ¯”å¦‚ï¼Œ<code>ES6</code> çš„æ•°ç»„ã€<code>Set</code>ã€<code>Map</code> éƒ½éƒ¨ç½²äº†ä»¥ä¸‹ä¸‰ä¸ªæ–¹æ³•ï¼Œè°ƒç”¨åéƒ½è¿”å›éå†å™¨å¯¹è±¡ã€‚</p><ul><li><code>entries()</code> è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨æ¥éå†[é”®å, é”®å€¼]ç»„æˆçš„æ•°ç»„ã€‚</li><li><code>keys()</code> è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨æ¥éå†æ‰€æœ‰çš„é”®åã€‚</li><li><code>values()</code> è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨æ¥éå†æ‰€æœ‰çš„é”®å€¼ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> pair <span class="keyword">of</span> arr.<span class="title function_">entries</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(pair);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// [0, &#x27;a&#x27;]</span></span><br><span class="line"><span class="comment">// [1, &#x27;b&#x27;]</span></span><br><span class="line"><span class="comment">// [2, &#x27;c&#x27;]</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ3ï¼‰ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡</strong> </p><p>å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œä¹ŸåŸç”Ÿå…·æœ‰ <code>Iterator</code> æ¥å£ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> s <span class="keyword">of</span> str) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(s); <span class="comment">// h e l l o</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// argumentså¯¹è±¡</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">printArgs</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> <span class="variable language_">arguments</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">printArgs</span>(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"><span class="comment">// &#x27;a&#x27;</span></span><br><span class="line"><span class="comment">// &#x27;b&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ4ï¼‰å¯¹è±¡</strong> </p><p><code>for...of</code>ä¸èƒ½ç›´æ¥ä½¿ç”¨äºæ™®é€šå¯¹è±¡ä¸Šï¼Œå¿…é¡»éƒ¨ç½² <code>Iterator</code> æ¥å£åæ‰èƒ½ä½¿ç”¨ã€‚</p><ul><li>ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ï¼Œéå†<code>Object.keys()</code>ç”Ÿæˆçš„å¯¹è±¡é”®åçš„æ•°ç»„ã€‚</li><li>ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ï¼Œä½¿ç”¨ <code>Generator</code> å‡½æ•°å°†å¯¹è±¡é‡æ–°åŒ…è£…ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ¡ˆä¸€</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> <span class="title class_">Object</span>.<span class="title function_">keys</span>(obj)) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(key, <span class="string">&#x27;-&gt;&#x27;</span>, value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ¡ˆäºŒ</span></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">entries</span>(<span class="params">obj</span>) &#123; </span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> <span class="title class_">Object</span>.<span class="title function_">keys</span>(obj)) &#123;</span><br><span class="line">    <span class="keyword">yield</span> [key, obj[key]];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> <span class="title function_">entries</span>(obj)) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(key, <span class="string">&#x27;-&gt;&#x27;</span>, value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// a -&gt; 1</span></span><br><span class="line"><span class="comment">// b -&gt; 2</span></span><br><span class="line"><span class="comment">// c -&gt; 3</span></span><br></pre></td></tr></table></figure><hr><h2 id="18-Generator-å‡½æ•°"><a href="#18-Generator-å‡½æ•°" class="headerlink" title="18. Generator å‡½æ•°"></a>18. Generator å‡½æ•°</h2><h3 id="18-1-åŸºæœ¬æ¦‚å¿µ"><a href="#18-1-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="18.1 åŸºæœ¬æ¦‚å¿µ"></a>18.1 åŸºæœ¬æ¦‚å¿µ</h3><p><code>Generator</code> å‡½æ•°æ˜¯ <code>ES6</code> æä¾›çš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆï¼Œè¯­æ³•è¡Œä¸ºä¸ä¼ ç»Ÿå‡½æ•°å®Œå…¨ä¸åŒã€‚</p><ul><li><strong>è¯­æ³•ä¸Šï¼š</strong><ins><code>Generator</code> å‡½æ•°ç±»ä¼¼ä¸€ä¸ªçŠ¶æ€æœºï¼Œå°è£…äº†å¤šä¸ªå†…éƒ¨çŠ¶æ€</ins>ã€‚æ‰§è¡Œ <code>Generator</code> å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œ<ins>å¯ä»¥ä¾æ¬¡éå† <code>Generator</code> å‡½æ•°å†…éƒ¨çš„æ¯ä¸€ä¸ªçŠ¶æ€</ins>ã€‚</li><li><strong>å½¢å¼ä¸Šï¼š</strong><code>Generator</code> å‡½æ•°æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªç‰¹å¾ã€‚ä¸€æ˜¯ï¼Œ<code>function</code>å…³é”®å­—ä¸å‡½æ•°åä¹‹é—´æœ‰ä¸€ä¸ªæ˜Ÿå·ï¼›äºŒæ˜¯ï¼Œå‡½æ•°ä½“å†…éƒ¨ä½¿ç”¨<code>yield</code>è¡¨è¾¾å¼ï¼Œå®šä¹‰ä¸åŒçš„å†…éƒ¨çŠ¶æ€ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">hwGenerator</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;ending&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> hw = <span class="title function_">hwGenerator</span>();</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ª <code>Generator</code> å‡½æ•°<code>hwGenerator</code>ï¼Œå®ƒå†…éƒ¨æœ‰ä¸¤ä¸ª<code>yield</code>è¡¨è¾¾å¼<code>hello</code>å’Œ<code>world</code>ï¼Œå³è¯¥å‡½æ•°æœ‰ä¸‰ä¸ªçŠ¶æ€ï¼š<code>hello</code>ï¼Œ<code>world</code> å’Œ <code>return</code> è¯­å¥ã€‚</p><p><code>Generator</code> å‡½æ•°çš„è°ƒç”¨æ–¹æ³•ä¸æ™®é€šå‡½æ•°ä¸€æ ·ã€‚ä¸åŒçš„æ˜¯ï¼Œ<ins>è°ƒç”¨ <code>Generator</code> å‡½æ•°åï¼Œè¯¥å‡½æ•°å¹¶ä¸æ‰§è¡Œï¼Œè¿”å›çš„ä¹Ÿä¸æ˜¯å‡½æ•°è¿è¡Œç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªæŒ‡å‘å†…éƒ¨çŠ¶æ€çš„æŒ‡é’ˆå¯¹è±¡</ins>ã€‚é€šè¿‡è°ƒç”¨éå†å™¨å¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼Œ<ins>ä½¿å¾—æŒ‡é’ˆç§»å‘ä¸‹ä¸€ä¸ªçŠ¶æ€</ins>ã€‚</p><p>æ¯æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œå†…éƒ¨æŒ‡é’ˆå°±ä»å‡½æ•°å¤´éƒ¨æˆ–ä¸Šä¸€æ¬¡åœä¸‹æ¥çš„åœ°æ–¹å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ª<code>yield</code>è¡¨è¾¾å¼ï¼ˆæˆ–<code>return</code>è¯­å¥ï¼‰ä¸ºæ­¢ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">hw.<span class="title function_">next</span>()</span><br><span class="line"><span class="comment">// &#123; value: &#x27;hello&#x27;, done: false &#125;</span></span><br><span class="line"></span><br><span class="line">hw.<span class="title function_">next</span>()</span><br><span class="line"><span class="comment">// &#123; value: &#x27;world&#x27;, done: false &#125;</span></span><br><span class="line"></span><br><span class="line">hw.<span class="title function_">next</span>()</span><br><span class="line"><span class="comment">// &#123; value: &#x27;ending&#x27;, done: true &#125;</span></span><br><span class="line"></span><br><span class="line">hw.<span class="title function_">next</span>()</span><br><span class="line"><span class="comment">// &#123; value: undefined, done: true &#125;</span></span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼Œè°ƒç”¨ <code>Generator</code> å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œä»£è¡¨ <code>Generator</code> å‡½æ•°çš„å†…éƒ¨æŒ‡é’ˆã€‚æ¯æ¬¡è°ƒç”¨éå†å™¨å¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªæœ‰ç€<code>value</code>å’Œ<code>done</code>ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ã€‚<code>value</code>å±æ€§è¡¨ç¤ºå½“å‰çš„å†…éƒ¨çŠ¶æ€çš„å€¼ï¼Œæ˜¯<code>yield</code>è¡¨è¾¾å¼åé¢é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼›<code>done</code>å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦éå†ç»“æŸã€‚</p><hr><h3 id="18-2-yield-è¡¨è¾¾å¼"><a href="#18-2-yield-è¡¨è¾¾å¼" class="headerlink" title="18.2 yield è¡¨è¾¾å¼"></a>18.2 yield è¡¨è¾¾å¼</h3><p>ç”±äº <code>Generator</code> å‡½æ•°è¿”å›çš„<ins>éå†å™¨å¯¹è±¡ï¼Œåªæœ‰è°ƒç”¨<code>next</code>æ–¹æ³•æ‰ä¼šéå†ä¸‹ä¸€ä¸ªå†…éƒ¨çŠ¶æ€</ins>ï¼Œæ‰€ä»¥<code>Generator</code>å…¶å®<ins>æä¾›äº†ä¸€ç§å¯ä»¥æš‚åœæ‰§è¡Œçš„å‡½æ•°</ins>ã€‚<code>yield</code>è¡¨è¾¾å¼å°±æ˜¯æš‚åœæ ‡å¿—ã€‚</p><p>éå†å™¨å¯¹è±¡çš„<code>next</code>æ–¹æ³•çš„è¿è¡Œé€»è¾‘å¦‚ä¸‹ï¼š</p><ul><li><ins>é‡åˆ°<code>yield</code>è¡¨è¾¾å¼ï¼Œå°±æš‚åœæ‰§è¡Œåé¢çš„æ“ä½œï¼Œå¹¶å°†ç´§è·Ÿåœ¨<code>yield</code>åé¢çš„é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œä½œä¸ºè¿”å›çš„å¯¹è±¡çš„<code>value</code>å±æ€§å€¼</ins>ã€‚</li><li>ä¸‹ä¸€æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•æ—¶ï¼Œå†ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ª<code>yield</code>è¡¨è¾¾å¼ã€‚</li><li>å¦‚æœæ²¡æœ‰å†é‡åˆ°æ–°çš„<code>yield</code>è¡¨è¾¾å¼ï¼Œå°±ä¸€ç›´è¿è¡Œåˆ°å‡½æ•°ç»“æŸï¼Œç›´åˆ°<code>return</code>è¯­å¥ä¸ºæ­¢ï¼Œå¹¶å°†<code>return</code>è¯­å¥åé¢çš„è¡¨è¾¾å¼çš„å€¼ï¼Œä½œä¸ºè¿”å›çš„å¯¹è±¡çš„<code>value</code>å±æ€§å€¼ã€‚</li><li>å¦‚æœè¯¥å‡½æ•°æ²¡æœ‰<code>return</code>è¯­å¥ï¼Œåˆ™è¿”å›çš„å¯¹è±¡çš„<code>value</code>å±æ€§å€¼ä¸º<code>undefined</code>ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">gen</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">yield</span>  <span class="number">123</span> + <span class="number">456</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> g = <span class="title function_">gen</span>()</span><br><span class="line">g.<span class="title function_">next</span>() <span class="comment">// &#123;value: 579, done: false&#125;</span></span><br><span class="line">g.<span class="title function_">next</span>() <span class="comment">// &#123;value: undefined, done: true&#125;</span></span><br></pre></td></tr></table></figure><p><code>yield</code>è¡¨è¾¾å¼ä¸<code>return</code>è¯­å¥æ—¢æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œä¹Ÿæœ‰åŒºåˆ«ã€‚ç›¸ä¼¼ä¹‹å¤„åœ¨äºï¼Œéƒ½èƒ½è¿”å›ç´§è·Ÿåœ¨è¯­å¥åé¢çš„é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚<ins>åŒºåˆ«åœ¨äºæ¯æ¬¡é‡åˆ°<code>yield</code>ï¼Œå‡½æ•°æš‚åœæ‰§è¡Œï¼Œä¸‹ä¸€æ¬¡å†ä»è¯¥ä½ç½®ç»§ç»­å‘åæ‰§è¡Œï¼Œè€Œ<code>return</code>è¯­å¥ä¸å…·å¤‡ä½ç½®è®°å¿†çš„åŠŸèƒ½</ins>ã€‚ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œåªèƒ½æ‰§è¡Œä¸€æ¬¡<code>return</code>è¯­å¥ï¼Œä½†æ˜¯å¯ä»¥æ‰§è¡Œå¤šæ¬¡<code>yield</code>è¡¨è¾¾å¼ã€‚</p><hr><h3 id="18-3-ä¸-Iterator-æ¥å£çš„å…³ç³»"><a href="#18-3-ä¸-Iterator-æ¥å£çš„å…³ç³»" class="headerlink" title="18.3 ä¸ Iterator æ¥å£çš„å…³ç³»"></a>18.3 ä¸ Iterator æ¥å£çš„å…³ç³»</h3><p>ç”±äº <code>Generator</code> å‡½æ•°å°±æ˜¯éå†å™¨ç”Ÿæˆå‡½æ•°ï¼Œå› æ­¤å¯ä»¥æŠŠ <code>Generator</code> èµ‹å€¼ç»™å¯¹è±¡çš„<code>Symbol.iterator</code>å±æ€§ï¼Œä»è€Œä½¿å¾—è¯¥å¯¹è±¡å…·æœ‰ <code>Iterator</code> æ¥å£ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> myIterable = &#123;&#125;;</span><br><span class="line">myIterable[<span class="title class_">Symbol</span>.<span class="property">iterator</span>] = <span class="keyword">function</span>* () &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">[...myIterable] <span class="comment">// [1, 2, 3]</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Generator</code> å‡½æ•°èµ‹å€¼ç»™<code>Symbol.iterator</code>å±æ€§ï¼Œä»è€Œä½¿å¾—<code>myIterable</code>å¯¹è±¡å…·æœ‰äº† <code>Iterator</code> æ¥å£ï¼Œå¯ä»¥è¢«<code>...</code>è¿ç®—ç¬¦éå†äº†ã€‚</p><hr><h3 id="18-4-next-æ–¹æ³•çš„å‚æ•°"><a href="#18-4-next-æ–¹æ³•çš„å‚æ•°" class="headerlink" title="18.4 next æ–¹æ³•çš„å‚æ•°"></a>18.4 next æ–¹æ³•çš„å‚æ•°</h3><p><code>yield</code>è¡¨è¾¾å¼æœ¬èº«æ²¡æœ‰è¿”å›å€¼ï¼Œæˆ–è€…è¯´æ€»æ˜¯è¿”å›<code>undefined</code>ã€‚<code>next</code>æ–¹æ³•å¯ä»¥å¸¦ä¸€ä¸ªå‚æ•°ï¼Œ<ins>è¯¥å‚æ•°å°±ä¼šè¢«å½“ä½œä¸Šä¸€ä¸ª<code>yield</code>è¡¨è¾¾å¼çš„è¿”å›å€¼</ins>ã€‚ï¼ˆæ¯ä¸€æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œéƒ½ä¼šè¿”å›æ•°æ®ç»“æ„çš„å½“å‰æˆå‘˜çš„ä¿¡æ¯ï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; <span class="literal">true</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> reset = <span class="keyword">yield</span> i;</span><br><span class="line">    <span class="keyword">if</span> (reset) &#123;</span><br><span class="line">      i = -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> g = <span class="title function_">f</span>(); <span class="comment">// å¯åŠ¨</span></span><br><span class="line"></span><br><span class="line">g.<span class="title function_">next</span>() <span class="comment">// &#123; value: 0, done: false &#125;</span></span><br><span class="line">g.<span class="title function_">next</span>() <span class="comment">// &#123; value: 1, done: false &#125;</span></span><br><span class="line">g.<span class="title function_">next</span>(<span class="literal">true</span>) <span class="comment">// &#123; value: 0, done: false &#125;</span></span><br><span class="line"><span class="comment">// æ­¤æ—¶ rest ä¸º trueï¼Œæ‰€ä»¥ i = -1ï¼Œåˆå› ä¸º i++ï¼Œ</span></span><br><span class="line"><span class="comment">// æ‰€ä»¥ä¸‹ä¸€æ¬¡è¿è¡Œåˆ° yield i çš„æ—¶å€™ i å°±æ˜¯ 0 </span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ªå¯ä»¥æ— é™è¿è¡Œçš„ <code>Generator</code> å‡½æ•°<code>f</code>ï¼Œå¦‚æœ<code>next</code>æ–¹æ³•æ²¡æœ‰å‚æ•°ï¼Œæ¯æ¬¡è¿è¡Œåˆ°<code>yield</code>è¡¨è¾¾å¼ï¼Œå˜é‡<code>reset</code>çš„å€¼æ€»æ˜¯<code>undefined</code>ã€‚å½“<code>next</code>æ–¹æ³•å¸¦ä¸€ä¸ªå‚æ•°<code>true</code>æ—¶ï¼Œå˜é‡<code>reset</code>å°±è¢«é‡ç½®ä¸ºè¿™ä¸ªå‚æ•°ï¼Œå› æ­¤<code>i</code>ä¼šç­‰äº<code>-1</code>ï¼Œä¸‹ä¸€è½®å¾ªç¯å°±ä¼šä»<code>-1</code>å¼€å§‹é€’å¢ã€‚</p><p>è¿™ä¸ªåŠŸèƒ½æœ‰å¾ˆé‡è¦çš„æ„ä¹‰ã€‚<code>Generator</code> å‡½æ•°ä»æš‚åœçŠ¶æ€åˆ°æ¢å¤è¿è¡Œï¼Œå®ƒçš„ä¸Šä¸‹æ–‡çŠ¶æ€<code>context</code>æ˜¯ä¸å˜çš„ã€‚é€šè¿‡<code>next</code>æ–¹æ³•çš„å‚æ•°ï¼Œå°±æœ‰åŠæ³•åœ¨ <code>Generator</code> å‡½æ•°å¼€å§‹è¿è¡Œä¹‹åï¼Œç»§ç»­å‘å‡½æ•°ä½“å†…éƒ¨æ³¨å…¥å€¼ã€‚<ins>ä»è€Œåœ¨ <code>Generator</code> å‡½æ•°è¿è¡Œçš„ä¸åŒé˜¶æ®µï¼Œè°ƒæ•´å‡½æ•°è¡Œä¸º</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">foo</span>(<span class="params">x</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> y = <span class="number">2</span> * (<span class="keyword">yield</span> (x + <span class="number">1</span>));</span><br><span class="line">  <span class="keyword">let</span> z = <span class="keyword">yield</span> (y / <span class="number">3</span>);</span><br><span class="line">  <span class="keyword">return</span> (x + y + z);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = <span class="title function_">foo</span>(<span class="number">5</span>);</span><br><span class="line">a.<span class="title function_">next</span>() <span class="comment">// &#123; value:6, done:false &#125;</span></span><br><span class="line">a.<span class="title function_">next</span>() <span class="comment">// æ­¤æ—¶ y ä¸º undefined, &#123; value:NaN, done:false &#125;</span></span><br><span class="line">a.<span class="title function_">next</span>() <span class="comment">// æ­¤æ—¶ z ä¸º undefined, &#123; value:NaN, done:true &#125;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒæ¬¡è¿è¡Œ<code>next()</code>çš„æ—¶å€™ä¸å¸¦å‚æ•°ï¼Œå¯¼è‡´ <code>y</code> çš„å€¼ç­‰äº<code>2 * undefined</code>ï¼Œé™¤ä»¥ <code>3</code> ä»¥åå˜æˆ<code>NaN</code>ï¼Œå› æ­¤è¿”å›å¯¹è±¡çš„<code>value</code>å±æ€§ä¹Ÿç­‰äº<code>NaN</code>ã€‚ç¬¬ä¸‰æ¬¡è¿è¡Œ<code>next</code>æ–¹æ³•çš„æ—¶å€™ä¸å¸¦å‚æ•°ï¼Œæ‰€ä»¥<code>z</code>ç­‰äº<code>undefined</code>ï¼Œè¿”å›å¯¹è±¡çš„<code>value</code>å±æ€§ç­‰äº<code>5 + NaN + undefined</code>ï¼Œå³<code>NaN</code>ã€‚</p><p>å¦‚æœå‘<code>next</code>æ–¹æ³•æä¾›å‚æ•°ï¼Œè¿”å›ç»“æœå°±å®Œå…¨ä¸ä¸€æ ·ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> b = <span class="title function_">foo</span>(<span class="number">5</span>);</span><br><span class="line">b.<span class="title function_">next</span>() <span class="comment">// &#123; value:6, done:false &#125;</span></span><br><span class="line">b.<span class="title function_">next</span>(<span class="number">12</span>) <span class="comment">// æ­¤æ—¶ y ä¸º 24, å› ä¸º yield (x + 1) = 12, &#123; value:8, done:false &#125;</span></span><br><span class="line">b.<span class="title function_">next</span>(<span class="number">13</span>) <span class="comment">// æ­¤æ—¶ z ä¸º 13, å› ä¸º yield (y / 3) = 13, &#123; value:42, done:true &#125;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ç¬¬ä¸€æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•æ—¶ï¼Œè¿”å›<code>x+1</code>çš„å€¼<code>6</code>ï¼›ç¬¬äºŒæ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œå°†ä¸Šä¸€æ¬¡<code>yield</code>è¡¨è¾¾å¼çš„å€¼è®¾ä¸º<code>12</code>ï¼Œå› æ­¤<code>y</code>ç­‰äº<code>24</code>ï¼Œè¿”å›<code>y / 3</code>çš„å€¼<code>8</code>ï¼›ç¬¬ä¸‰æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œå°†ä¸Šä¸€æ¬¡<code>yield</code>è¡¨è¾¾å¼çš„å€¼è®¾ä¸º<code>13</code>ï¼Œå› æ­¤<code>z</code>ç­‰äº<code>13</code>ï¼Œè¿™æ—¶<code>x</code>ç­‰äº<code>5</code>ï¼Œ<code>y</code>ç­‰äº<code>24</code>ï¼Œæ‰€ä»¥<code>return</code>è¯­å¥çš„å€¼ç­‰äº<code>42</code>ã€‚</p><p>æ³¨æ„ï¼Œç”±äº<code>next</code>æ–¹æ³•çš„å‚æ•°è¡¨ç¤ºä¸Šä¸€ä¸ª<code>yield</code>è¡¨è¾¾å¼çš„è¿”å›å€¼ï¼Œæ‰€ä»¥åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨<code>next</code>æ–¹æ³•æ—¶ï¼Œä¼ é€’å‚æ•°æ˜¯æ— æ•ˆçš„ã€‚</p><hr><h3 id="18-5-forâ€¦of-å¾ªç¯"><a href="#18-5-forâ€¦of-å¾ªç¯" class="headerlink" title="18.5 forâ€¦of å¾ªç¯"></a>18.5 forâ€¦of å¾ªç¯</h3><p><code>for...of</code>å¯ä»¥è‡ªåŠ¨éå† <code>Generator</code> å‡½æ•°ç”Ÿæˆçš„<code>Iterator</code>å¯¹è±¡ï¼Œä¸”ä¸éœ€è¦è°ƒç”¨<code>next</code>æ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> <span class="title function_">foo</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1 2 3 (æ²¡æœ‰4)</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œä¸€æ—¦è¿”å›å¯¹è±¡çš„<code>done</code>å±æ€§ä¸º<code>true</code>ï¼Œ<code>for...of</code>å¾ªç¯å°±ä¼šä¸­æ­¢ï¼Œä¸”ä¸åŒ…å«è¯¥è¿”å›å¯¹è±¡ã€‚æ‰€ä»¥ä¸Šé¢ä»£ç çš„<code>return</code>è¯­å¥è¿”å›çš„<code>4</code>ï¼Œä¸åŒ…æ‹¬åœ¨<code>for...of</code>å¾ªç¯ä¹‹ä¸­ã€‚</p><p>é™¤äº†<code>for...of</code>å¾ªç¯ä»¥å¤–ï¼Œæ‰©å±•è¿ç®—ç¬¦ã€è§£æ„èµ‹å€¼å’Œ<code>Array.from</code>æ–¹æ³•å†…éƒ¨è°ƒç”¨çš„ï¼Œéƒ½æ˜¯éå†å™¨æ¥å£ã€‚è¿™æ„å‘³ç€ï¼Œå®ƒä»¬éƒ½å¯ä»¥å°† <code>Generator</code> å‡½æ•°è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œä½œä¸ºå‚æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* numbers () &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">  <span class="keyword">yield</span> <span class="number">2</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">3</span></span><br><span class="line">  <span class="keyword">yield</span> <span class="number">4</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰©å±•è¿ç®—ç¬¦</span></span><br><span class="line">[...<span class="title function_">numbers</span>()] <span class="comment">// [1, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Array.from æ–¹æ³•</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="title function_">numbers</span>()) <span class="comment">// [1, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è§£æ„èµ‹å€¼</span></span><br><span class="line"><span class="keyword">let</span> [x, y] = <span class="title function_">numbers</span>();</span><br><span class="line">x <span class="comment">// 1</span></span><br><span class="line">y <span class="comment">// 2</span></span><br></pre></td></tr></table></figure><hr><h3 id="18-6-throw-æ–¹æ³•"><a href="#18-6-throw-æ–¹æ³•" class="headerlink" title="18.6 throw æ–¹æ³•"></a>18.6 throw æ–¹æ³•</h3><p>éå†å™¨å¯¹è±¡çš„<code>throw()</code>æ–¹æ³•ï¼Œå¯ä»¥<ins>åœ¨å‡½æ•°ä½“å¤–æŠ›å‡ºé”™è¯¯ï¼Œç„¶ååœ¨ <code>Generator</code> å‡½æ•°ä½“å†…æ•è·</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> g = <span class="keyword">function</span>* () &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">yield</span>;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å†…éƒ¨æ•è·&#x27;</span>, e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> i = <span class="title function_">g</span>();</span><br><span class="line">i.<span class="title function_">next</span>(); <span class="comment">// åˆå§‹åŒ–å¯åŠ¨</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  i.<span class="keyword">throw</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">  i.<span class="keyword">throw</span>(<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å¤–éƒ¨æ•è·&#x27;</span>, e);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å†…éƒ¨æ•è· a</span></span><br><span class="line"><span class="comment">// å¤–éƒ¨æ•è· b</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œéå†å™¨å¯¹è±¡<code>i</code>è¿ç»­æŠ›å‡ºä¸¤ä¸ªé”™è¯¯ã€‚<ins>ç¬¬ä¸€ä¸ªé”™è¯¯è¢« <code>Generator</code> å‡½æ•°ä½“å†…çš„<code>catch</code>è¯­å¥æ•è·</ins>ã€‚<code>i</code>ç¬¬äºŒæ¬¡æŠ›å‡ºé”™è¯¯ï¼Œç”±äº <code>Generator</code> å‡½æ•°å†…éƒ¨çš„<code>catch</code>è¯­å¥å·²ç»æ‰§è¡Œè¿‡äº†ï¼Œä¸ä¼šå†æ•æ‰åˆ°è¿™ä¸ªé”™è¯¯äº†ï¼Œæ‰€ä»¥è¿™ä¸ªé”™è¯¯å°±<ins>è¢«å‡½æ•°ä½“å¤–çš„<code>catch</code>è¯­å¥æ•è·</ins>ã€‚</p><p>æ³¨æ„ï¼Œä¸è¦æ··æ·†éå†å™¨å¯¹è±¡çš„<code>throw</code>æ–¹æ³•å’Œå…¨å±€çš„<code>throw</code>å‘½ä»¤ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å¤–éƒ¨æ•è·&#x27;</span>, e);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¤–éƒ¨æ•è· [Error: a]</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¹‹æ‰€ä»¥åªæ•è·äº†<code>a</code>ï¼Œæ˜¯å› ä¸ºå‡½æ•°ä½“å¤–çš„<code>catch</code>è¯­å¥å—ï¼Œæ•è·äº†æŠ›å‡ºçš„<code>a</code>é”™è¯¯ä»¥åï¼Œå°±ä¸ä¼šå†ç»§ç»­<code>try</code>ä»£ç å—é‡Œé¢å‰©ä½™çš„è¯­å¥äº†ã€‚</p><ul><li>å¦‚æœ <code>Generator</code> å‡½æ•°å†…éƒ¨æ²¡æœ‰éƒ¨ç½²<code>try...catch</code>ä»£ç å—ï¼Œé‚£ä¹ˆ<code>throw</code>æ–¹æ³•æŠ›å‡ºçš„é”™è¯¯ï¼Œ<ins>å°†è¢«å¤–éƒ¨<code>try...catch</code>ä»£ç å—æ•è·</ins>ã€‚</li><li>å¦‚æœ <code>Generator</code> å‡½æ•°å†…éƒ¨å’Œå¤–éƒ¨ï¼Œéƒ½æ²¡æœ‰éƒ¨ç½²<code>try...catch</code>ä»£ç å—ï¼Œé‚£ä¹ˆç¨‹åºå°†æŠ¥é”™ï¼Œç›´æ¥ä¸­æ–­æ‰§è¡Œã€‚</li></ul><p><code>throw</code>æ–¹æ³•æŠ›å‡ºçš„é”™è¯¯è¦è¢«å†…éƒ¨æ•è·ï¼Œ<ins>å‰ææ˜¯å¿…é¡»è‡³å°‘æ‰§è¡Œè¿‡ä¸€æ¬¡<code>next</code>æ–¹æ³•</ins>ã€‚åŒæ—¶ï¼Œ<ins><code>throw</code>æ–¹æ³•è¢«æ•è·åï¼Œä¼šé™„å¸¦æ‰§è¡Œä¸‹ä¸€æ¡<code>yield</code>è¡¨è¾¾å¼</ins>ï¼Œç­‰åŒäºæ‰§è¡Œä¸€æ¬¡<code>next</code>æ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> gen = <span class="keyword">function</span>* <span class="title function_">gen</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">yield</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line">  <span class="keyword">yield</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;c&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> g = <span class="title function_">gen</span>();</span><br><span class="line">g.<span class="title function_">next</span>() <span class="comment">// a</span></span><br><span class="line">g.<span class="keyword">throw</span>() <span class="comment">// b</span></span><br><span class="line">g.<span class="title function_">next</span>() <span class="comment">// c</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>g.throw()</code>æ–¹æ³•è¢«æ•è·ä»¥åï¼Œè‡ªåŠ¨æ‰§è¡Œäº†ä¸€æ¬¡<code>next</code>æ–¹æ³•ï¼Œæ‰€ä»¥ä¼šæ‰“å°<code>b</code>ã€‚è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œ<ins>åªè¦ <code>Generator</code> å‡½æ•°å†…éƒ¨éƒ¨ç½²äº†<code>try...catch</code>ä»£ç å—ï¼Œé‚£ä¹ˆéå†å™¨çš„<code>throw</code>æ–¹æ³•æŠ›å‡ºçš„é”™è¯¯ï¼Œä¸å½±å“ä¸‹ä¸€æ¬¡éå†</ins>ã€‚</p><p><code>Generator</code> å‡½æ•°ä½“å¤–æŠ›å‡ºçš„é”™è¯¯ï¼Œå¯ä»¥åœ¨å‡½æ•°ä½“å†…æ•è·ï¼›åè¿‡æ¥ï¼Œ<code>Generator</code> å‡½æ•°ä½“å†…æŠ›å‡ºçš„é”™è¯¯ï¼Œä¹Ÿå¯ä»¥è¢«å‡½æ•°ä½“å¤–çš„<code>catch</code>æ•è·ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> x = <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">let</span> y = x.<span class="title function_">toUpperCase</span>();</span><br><span class="line">  <span class="keyword">yield</span> y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> it = <span class="title function_">foo</span>();</span><br><span class="line"></span><br><span class="line">it.<span class="title function_">next</span>(); <span class="comment">// &#123; value:3, done:false &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  it.<span class="title function_">next</span>(<span class="number">42</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒä¸ª<code>next</code>æ–¹æ³•å‘å‡½æ•°ä½“å†…ä¼ å…¥ä¸€ä¸ªå‚æ•° <code>42</code>ï¼Œæ•°å€¼æ˜¯æ²¡æœ‰<code>toUpperCase</code>æ–¹æ³•çš„ï¼Œæ‰€ä»¥ä¼šæŠ›å‡ºä¸€ä¸ª <code>TypeError</code> é”™è¯¯ï¼Œè¢«å‡½æ•°ä½“å¤–çš„<code>catch</code>æ•è·ã€‚</p><hr><h3 id="18-7-return-æ–¹æ³•"><a href="#18-7-return-æ–¹æ³•" class="headerlink" title="18.7 return æ–¹æ³•"></a>18.7 return æ–¹æ³•</h3><p>éå†å™¨å¯¹è±¡çš„<code>return()</code>æ–¹æ³•ï¼Œå¯ä»¥è¿”å›ç»™å®šçš„å€¼ï¼Œå¹¶ä¸”<ins>ç»ˆç»“éå† <code>Generator</code> å‡½æ•°</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">gen</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> g = <span class="title function_">gen</span>();</span><br><span class="line"></span><br><span class="line">g.<span class="title function_">next</span>()        <span class="comment">// &#123; value: 1, done: false &#125;</span></span><br><span class="line">g.<span class="keyword">return</span>(<span class="string">&#x27;foo&#x27;</span>) <span class="comment">// &#123; value: &quot;foo&quot;, done: true &#125;</span></span><br><span class="line">g.<span class="title function_">next</span>()        <span class="comment">// &#123; value: undefined, done: true &#125;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œéå†å™¨å¯¹è±¡<code>g</code>è°ƒç”¨<code>return()</code>æ–¹æ³•åï¼Œè¿”å›å€¼çš„<code>value</code>å±æ€§å°±æ˜¯<code>return()</code>æ–¹æ³•çš„å‚æ•°<code>foo</code>ã€‚å¹¶ä¸”ï¼Œ<code>Generator</code> å‡½æ•°çš„éå†å°±ç»ˆæ­¢äº†ï¼Œè¿”å›å€¼çš„<code>done</code>å±æ€§ä¸º<code>true</code>ã€‚</p><ul><li>å¦‚æœ<code>return()</code>æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¸æä¾›å‚æ•°ï¼Œåˆ™è¿”å›å€¼çš„<code>value</code>å±æ€§ä¸º<code>undefined</code>ã€‚</li><li>å¦‚æœ <code>Generator</code> å‡½æ•°å†…éƒ¨æœ‰<code>try...finally</code>ä»£ç å—ï¼Œä¸”æ­£åœ¨æ‰§è¡Œ<code>try</code>ä»£ç å—ï¼Œé‚£ä¹ˆ<code>return()</code>æ–¹æ³•ä¼šå¯¼è‡´ç«‹åˆ»è¿›å…¥<code>finally</code>ä»£ç å—ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* numbers () &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">5</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">6</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> g = <span class="title function_">numbers</span>();</span><br><span class="line">g.<span class="title function_">next</span>() <span class="comment">// &#123; value: 1, done: false &#125;</span></span><br><span class="line">g.<span class="title function_">next</span>() <span class="comment">// &#123; value: 2, done: false &#125;</span></span><br><span class="line">g.<span class="keyword">return</span>(<span class="number">7</span>) <span class="comment">// &#123; value: 4, done: false &#125;</span></span><br><span class="line">g.<span class="title function_">next</span>() <span class="comment">// &#123; value: 5, done: false &#125;</span></span><br><span class="line">g.<span class="title function_">next</span>() <span class="comment">// &#123; value: 7, done: true &#125;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨<code>return()</code>æ–¹æ³•åï¼Œå°±å¼€å§‹æ‰§è¡Œ<code>finally</code>ä»£ç å—ï¼Œä¸æ‰§è¡Œ<code>try</code>é‡Œé¢å‰©ä¸‹çš„ä»£ç äº†ï¼Œç„¶åç­‰åˆ°<code>finally</code>ä»£ç å—æ‰§è¡Œå®Œï¼Œå†è¿”å›<code>return()</code>æ–¹æ³•æŒ‡å®šçš„è¿”å›å€¼ã€‚</p><hr><h3 id="18-8-æ–¹æ³•çš„å…±åŒç‚¹"><a href="#18-8-æ–¹æ³•çš„å…±åŒç‚¹" class="headerlink" title="18.8 æ–¹æ³•çš„å…±åŒç‚¹"></a>18.8 æ–¹æ³•çš„å…±åŒç‚¹</h3><p><code>Generator</code> å‡½æ•°è¿”å›çš„éå†å™¨å¯¹è±¡çš„<code>next()</code>ã€<code>throw()</code>ã€<code>return()</code>æœ¬è´¨ä¸Šæ˜¯åŒä¸€ä»¶äº‹ï¼Œå®ƒä»¬çš„ä½œç”¨éƒ½æ˜¯è®© <code>Generator</code> å‡½æ•°æ¢å¤æ‰§è¡Œï¼Œå¹¶ä¸”ä½¿ç”¨ä¸åŒçš„è¯­å¥æ›¿æ¢<code>yield</code>è¡¨è¾¾å¼ã€‚</p><ul><li><code>next()</code>æ–¹æ³•æ˜¯å°†<code>yield</code>è¡¨è¾¾å¼æ›¿æ¢æˆä¸€ä¸ªå€¼ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> g = <span class="keyword">function</span>* (x, y) &#123;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="keyword">yield</span> x + y;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> gen = <span class="title function_">g</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">gen.<span class="title function_">next</span>(); <span class="comment">// Object &#123;value: 3, done: false&#125;</span></span><br><span class="line"></span><br><span class="line">gen.<span class="title function_">next</span>(<span class="number">1</span>); <span class="comment">// Object &#123;value: 1, done: true&#125;</span></span><br><span class="line"><span class="comment">// ç›¸å½“äºå°† let result = yield x + y</span></span><br><span class="line"><span class="comment">// æ›¿æ¢æˆ let result = 1;</span></span><br></pre></td></tr></table></figure><ul><li><code>throw()</code>æ–¹æ³•æ˜¯å°†<code>yield</code>è¡¨è¾¾å¼æ›¿æ¢æˆä¸€ä¸ª<code>throw</code>è¯­å¥ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">gen.<span class="keyword">throw</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;å‡ºé”™äº†&#x27;</span>)); <span class="comment">// Uncaught Error: å‡ºé”™äº†</span></span><br><span class="line"><span class="comment">// ç›¸å½“äºå°† let result = yield x + y</span></span><br><span class="line"><span class="comment">// æ›¿æ¢æˆ let result = throw(new Error(&#x27;å‡ºé”™äº†&#x27;));</span></span><br></pre></td></tr></table></figure><ul><li><code>return()</code>æ–¹æ³•æ˜¯å°†<code>yield</code>è¡¨è¾¾å¼æ›¿æ¢æˆä¸€ä¸ª<code>return</code>è¯­å¥ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">gen.<span class="keyword">return</span>(<span class="number">2</span>); <span class="comment">// Object &#123;value: 2, done: true&#125;</span></span><br><span class="line"><span class="comment">// ç›¸å½“äºå°† let result = yield x + y</span></span><br><span class="line"><span class="comment">// æ›¿æ¢æˆ let result = return 2;</span></span><br></pre></td></tr></table></figure><hr><h3 id="18-9-yield-è¡¨è¾¾å¼"><a href="#18-9-yield-è¡¨è¾¾å¼" class="headerlink" title="18.9 yield* è¡¨è¾¾å¼"></a>18.9 yield* è¡¨è¾¾å¼</h3><p><code>ES6</code> æä¾›çš„<code>yield*</code>è¡¨è¾¾å¼ï¼Œå¯ä»¥åœ¨ä¸€ä¸ª <code>Generator</code> å‡½æ•°é‡Œé¢æ‰§è¡Œå¦ä¸€ä¸ª <code>Generator</code> å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> delegatedIterator = (<span class="keyword">function</span>* () &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;Hello!&#x27;</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;Bye!&#x27;</span>;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> delegatingIterator = (<span class="keyword">function</span>* () &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;Greetings!&#x27;</span>;</span><br><span class="line">  <span class="keyword">yield</span>* delegatedIterator;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;Ok, bye.&#x27;</span>;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> value <span class="keyword">of</span> delegatingIterator) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &quot;Greetings!</span></span><br><span class="line"><span class="comment">// &quot;Hello!&quot;</span></span><br><span class="line"><span class="comment">// &quot;Bye!&quot;</span></span><br><span class="line"><span class="comment">// &quot;Ok, bye.&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>delegatingIterator</code>æ˜¯ä»£ç†è€…ï¼Œ<code>delegatedIterator</code>æ˜¯è¢«ä»£ç†è€…ã€‚å¦‚æœè¢«ä»£ç†çš„ <code>Generator</code> å‡½æ•°æœ‰<code>return</code>è¯­å¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥å‘ä»£ç†å®ƒçš„ <code>Generator</code> å‡½æ•°è¿”å›æ•°æ®ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">genFuncWithReturn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;The result&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">logReturned</span>(<span class="params">genObj</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="keyword">yield</span>* genObj;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[...<span class="title function_">logReturned</span>(<span class="title function_">genFuncWithReturn</span>())]</span><br><span class="line"><span class="comment">// The result</span></span><br><span class="line"><span class="comment">// å€¼ä¸º [ &#x27;a&#x27;, &#x27;b&#x27; ]</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­˜åœ¨ä¸¤æ¬¡éå†ã€‚</p><ul><li>ç¬¬ä¸€æ¬¡æ˜¯æ‰©å±•è¿ç®—ç¬¦éå†å‡½æ•°<code>logReturned</code>è¿”å›çš„éå†å™¨å¯¹è±¡ã€‚</li><li>ç¬¬äºŒæ¬¡æ˜¯<code>yield*</code>è¯­å¥éå†å‡½æ•°<code>genFuncWithReturn</code>è¿”å›çš„éå†å™¨å¯¹è±¡ã€‚</li></ul><p>è¿™ä¸¤æ¬¡éå†çš„æ•ˆæœæ˜¯å åŠ çš„ï¼Œæœ€ç»ˆè¡¨ç°ä¸ºæ‰©å±•è¿ç®—ç¬¦éå†å‡½æ•°<code>genFuncWithReturn</code>è¿”å›çš„éå†å™¨å¯¹è±¡ã€‚æ‰€ä»¥æœ€åçš„æ•°æ®è¡¨è¾¾å¼å¾—åˆ°çš„å€¼ç­‰äº<code>[ &#39;a&#39;, &#39;b&#39; ]</code>ã€‚åŒæ—¶ï¼Œå‡½æ•°<code>genFuncWithReturn</code>çš„<code>return</code>è¯­å¥çš„è¿”å›å€¼<code>The result</code>ï¼Œä¼šè¿”å›ç»™å‡½æ•°<code>logReturned</code>å†…éƒ¨çš„<code>result</code>å˜é‡ã€‚</p><hr><h3 id="18-10-ä½œä¸ºå¯¹è±¡çš„å±æ€§"><a href="#18-10-ä½œä¸ºå¯¹è±¡çš„å±æ€§" class="headerlink" title="18.10 ä½œä¸ºå¯¹è±¡çš„å±æ€§"></a>18.10 ä½œä¸ºå¯¹è±¡çš„å±æ€§</h3><p>å¦‚æœä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ˜¯ <code>Generator</code> å‡½æ•°ï¼Œå¯ä»¥ç®€å†™æˆä¸‹é¢çš„å½¢å¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  * <span class="title function_">myGeneratorMethod</span>(<span class="params"></span>) &#123;</span><br><span class="line">    Â·Â·Â·</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å®ƒçš„å®Œæ•´å½¢å¼å¦‚ä¸‹ï¼Œä¸ä¸Šé¢çš„å†™æ³•æ˜¯ç­‰ä»·çš„ã€‚ï¼ˆè¯¦ç»†è¯·è§ä¸Šä¸€ç« çš„å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•ï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">myGeneratorMethod</span>: <span class="keyword">function</span>* () &#123;</span><br><span class="line">    <span class="comment">// Â·Â·Â·</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h3 id="18-11-å«ä¹‰"><a href="#18-11-å«ä¹‰" class="headerlink" title="18.11 å«ä¹‰"></a>18.11 å«ä¹‰</h3><p><strong>ï¼ˆ1ï¼‰Generator ä¸çŠ¶æ€æœº</strong></p><p><code>Generator</code> æ˜¯å®ç°çŠ¶æ€æœºçš„æœ€ä½³ç»“æ„ã€‚æ¯”å¦‚ï¼Œä¸‹é¢çš„<code>clock</code>å‡½æ•°å°±æ˜¯ä¸€ä¸ªçŠ¶æ€æœºã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> ticking = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">let</span> clock = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (ticking)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Tick!&#x27;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Tock!&#x27;</span>);</span><br><span class="line">  ticking = !ticking;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç çš„<code>clock</code>å‡½æ•°ä¸€å…±æœ‰ä¸¤ç§çŠ¶æ€<code>Tick</code>å’Œ<code>Tock</code>ï¼Œæ¯è¿è¡Œä¸€æ¬¡ï¼Œå°±æ”¹å˜ä¸€æ¬¡çŠ¶æ€ã€‚è¿™ä¸ªå‡½æ•°å¦‚æœç”¨ <code>Generator</code> å®ç°ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> clock = <span class="keyword">function</span>* () &#123;</span><br><span class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Tick!&#x27;</span>);</span><br><span class="line">    <span class="keyword">yield</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Tock!&#x27;</span>);</span><br><span class="line">    <span class="keyword">yield</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ <code>Generator</code> å®ç°ä¸ <code>ES5</code> å®ç°å¯¹æ¯”ï¼Œå¯ä»¥çœ‹åˆ°å°‘äº†ç”¨æ¥ä¿å­˜çŠ¶æ€çš„å¤–éƒ¨å˜é‡<code>ticking</code>ï¼Œè¿™æ ·å°±æ›´ç®€æ´ï¼Œæ›´å®‰å…¨ï¼Œåœ¨å†™æ³•ä¸Šä¹Ÿæ›´ä¼˜é›…ã€‚</p><p><strong>ï¼ˆ2ï¼‰Generator ä¸åç¨‹</strong></p><p>åç¨‹ <code>coroutine</code> æ˜¯ä¸€ç§ç¨‹åºè¿è¡Œçš„æ–¹å¼ï¼Œå¯ä»¥ç†è§£æˆâ€œåä½œçš„çº¿ç¨‹â€æˆ–â€œåä½œçš„å‡½æ•°â€ã€‚åç¨‹æ—¢å¯ä»¥ç”¨å•çº¿ç¨‹å®ç°ï¼Œä¹Ÿå¯ä»¥ç”¨å¤šçº¿ç¨‹å®ç°ã€‚</p><ul><li><p><strong>åç¨‹ä¸å­ä¾‹ç¨‹çš„å·®å¼‚</strong><br>  ä¼ ç»Ÿçš„â€œå­ä¾‹ç¨‹â€ <code>subroutine</code> é‡‡ç”¨å †æ ˆå¼â€œåè¿›å…ˆå‡ºâ€çš„æ‰§è¡Œæ–¹å¼ï¼Œåªæœ‰å½“è°ƒç”¨çš„å­å‡½æ•°å®Œå…¨æ‰§è¡Œå®Œæ¯•ï¼Œæ‰ä¼šç»“æŸæ‰§è¡Œçˆ¶å‡½æ•°ã€‚<ins>åç¨‹ä¸å…¶ä¸åŒï¼Œå¤šä¸ªçº¿ç¨‹ï¼ˆå•çº¿ç¨‹æƒ…å†µä¸‹ï¼Œå³å¤šä¸ªå‡½æ•°ï¼‰å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œä½†æ˜¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰å¤„äºæ­£åœ¨è¿è¡Œçš„çŠ¶æ€ï¼Œå…¶ä»–çº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰éƒ½å¤„äºæš‚åœæ€ <code>suspended</code>ï¼Œçº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰ä¹‹é—´å¯ä»¥äº¤æ¢æ‰§è¡Œæƒ</ins>ã€‚è¿™ç§å¯ä»¥å¹¶è¡Œæ‰§è¡Œã€äº¤æ¢æ‰§è¡Œæƒçš„çº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰ï¼Œå°±ç§°ä¸ºåç¨‹ã€‚</p></li><li><p><strong>åç¨‹ä¸æ™®é€šçº¿ç¨‹çš„å·®å¼‚</strong><br>  åç¨‹é€‚åˆç”¨äºå¤šä»»åŠ¡è¿è¡Œçš„ç¯å¢ƒã€‚åœ¨è¿™ä¸ªæ„ä¹‰ä¸Šï¼Œå®ƒä¸æ™®é€šçš„çº¿ç¨‹å¾ˆç›¸ä¼¼ï¼Œéƒ½æœ‰è‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€å¯ä»¥åˆ†äº«å…¨å±€å˜é‡ã€‚å®ƒä»¬çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œ<ins>åŒä¸€æ—¶é—´å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œä½†æ˜¯è¿è¡Œçš„åç¨‹åªèƒ½æœ‰ä¸€ä¸ªï¼Œå…¶ä»–åç¨‹éƒ½å¤„äºæš‚åœçŠ¶æ€</ins>ã€‚æ­¤å¤–ï¼Œ<ins>æ™®é€šçš„çº¿ç¨‹æ˜¯æŠ¢å…ˆå¼çš„ï¼Œåˆ°åº•å“ªä¸ªçº¿ç¨‹ä¼˜å…ˆå¾—åˆ°èµ„æºï¼Œå¿…é¡»ç”±è¿è¡Œç¯å¢ƒå†³å®šï¼Œä½†æ˜¯åç¨‹æ˜¯åˆä½œå¼çš„ï¼Œæ‰§è¡Œæƒç”±åç¨‹è‡ªå·±åˆ†é…</ins>ã€‚</p></li></ul><p><code>Generator</code> å‡½æ•°æ˜¯ <code>ES6</code> å¯¹åç¨‹çš„å®ç°ï¼Œ<ins>ä½†å±äºä¸å®Œå…¨å®ç°</ins>ã€‚<code>Generator</code> å‡½æ•°è¢«ç§°ä¸ºâ€œåŠåç¨‹â€ï¼Œæ„æ€æ˜¯åªæœ‰ <code>Generator</code> å‡½æ•°çš„è°ƒç”¨è€…ï¼Œæ‰èƒ½å°†ç¨‹åºçš„æ‰§è¡Œæƒè¿˜ç»™ <code>Generator</code> å‡½æ•°ã€‚å¦‚æœæ˜¯å®Œå…¨å®ç°çš„åç¨‹ï¼Œä»»ä½•å‡½æ•°éƒ½å¯ä»¥è®©æš‚åœçš„åç¨‹ç»§ç»­æ‰§è¡Œã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">A</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æˆ‘æ˜¯A&quot;</span>);</span><br><span class="line">  <span class="keyword">yield</span> <span class="title function_">B</span>(); <span class="comment">// Aåœä½ï¼Œåœ¨è¿™é‡Œè½¬äº¤çº¿ç¨‹æ‰§è¡Œæƒç»™B</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ç»“æŸäº†&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">B</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æˆ‘æ˜¯B&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">100</span>;<span class="comment">// è¿”å›ï¼Œå¹¶ä¸”å°†çº¿ç¨‹æ‰§è¡Œæƒè¿˜ç»™A</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> gen = <span class="title function_">A</span>();</span><br><span class="line">gen.<span class="title function_">next</span>();</span><br><span class="line">gen.<span class="title function_">next</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ‘æ˜¯A</span></span><br><span class="line"><span class="comment">// æˆ‘æ˜¯B</span></span><br><span class="line"><span class="comment">// ç»“æŸäº†</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>A</code>å°†æ‰§è¡Œæƒäº¤ç»™<code>B</code>ï¼Œæˆ‘ä»¬ç§°<code>A</code>æ˜¯<code>B</code>çš„çˆ¶åç¨‹ã€‚é‚£ä¹ˆç°åœ¨<code>B</code>æ‰§è¡Œï¼Œ<code>A</code>å°±ç›¸å½“äºå¤„äºæš‚åœçš„çŠ¶æ€ã€‚ç­‰åˆ°<code>B</code>æœ€å<code>return 100</code>ï¼Œæ‰§è¡Œæƒå°±ä¼šè¿˜ç»™<code>A</code>ã€‚</p><p><strong>ï¼ˆ3ï¼‰Generator ä¸ä¸Šä¸‹æ–‡</strong></p><p>æ‰§è¡Œ <code>JS</code> ä»£ç æ—¶ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªå…¨å±€çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼ŒåŒ…å«äº†å½“å‰æ‰€æœ‰çš„å˜é‡å’Œå¯¹è±¡ã€‚æ‰§è¡Œå‡½æ•°æˆ–å—çº§ä»£ç æ—¶ï¼Œåˆä¼š<mark class="hl-label red">åœ¨å½“å‰ä¸Šä¸‹æ–‡ç¯å¢ƒçš„ä¸Šå±‚</mark> ï¼Œäº§ç”Ÿä¸€ä¸ª <mark class="hl-label blue">å‡½æ•°è¿è¡Œçš„ä¸Šä¸‹æ–‡</mark> ï¼Œä½œä¸º <mark class="hl-label green">å½“å‰activeçš„ä¸Šä¸‹æ–‡</mark> ï¼Œç”±æ­¤å½¢æˆä¸€ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒçš„å †æ ˆã€‚</p><p>è¿™ä¸ªå †æ ˆæ˜¯â€œåè¿›å…ˆå‡ºâ€çš„æ•°æ®ç»“æ„ï¼Œæœ€åäº§ç”Ÿçš„ä¸Šä¸‹æ–‡ç¯å¢ƒé¦–å…ˆæ‰§è¡Œå®Œæˆï¼Œé€€å‡ºå †æ ˆï¼Œç„¶åå†æ‰§è¡Œå®Œæˆå®ƒä¸‹å±‚çš„ä¸Šä¸‹æ–‡ï¼Œç›´è‡³æ‰€æœ‰ä»£ç æ‰§è¡Œå®Œæˆï¼Œå †æ ˆæ¸…ç©ºã€‚</p><p><code>Generator</code> å‡½æ•°ä¸ä¸€æ ·ï¼Œå®ƒæ‰§è¡Œäº§ç”Ÿçš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œä¸€æ—¦<ins>é‡åˆ°<code>yield</code>å‘½ä»¤ï¼Œå°±ä¼šæš‚æ—¶é€€å‡ºå †æ ˆï¼Œä½†æ˜¯å¹¶ä¸æ¶ˆå¤±ï¼Œé‡Œé¢çš„æ‰€æœ‰å˜é‡å’Œå¯¹è±¡ä¼šå†»ç»“åœ¨å½“å‰çŠ¶æ€</ins>ã€‚ç­‰åˆ°å¯¹å®ƒæ‰§è¡Œ<code>next</code>å‘½ä»¤æ—¶ï¼Œè¿™ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒåˆä¼šé‡æ–°åŠ å…¥è°ƒç”¨æ ˆï¼Œå†»ç»“çš„å˜é‡å’Œå¯¹è±¡æ¢å¤æ‰§è¡Œã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">gen</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> g = <span class="title function_">gen</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">  g.<span class="title function_">next</span>().<span class="property">value</span>,</span><br><span class="line">  g.<span class="title function_">next</span>().<span class="property">value</span>,</span><br><span class="line">); <span class="comment">// 1, 2</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œ<code>g.next()</code>æ—¶ï¼Œ<code>Generator</code> å‡½æ•°<code>gen</code>çš„ä¸Šä¸‹æ–‡ä¼šåŠ å…¥å †æ ˆï¼Œå³å¼€å§‹è¿è¡Œ<code>gen</code>å†…éƒ¨çš„ä»£ç ã€‚ç­‰é‡åˆ°<code>yield 1</code>æ—¶ï¼Œ<code>gen</code>ä¸Šä¸‹æ–‡é€€å‡ºå †æ ˆï¼Œå†…éƒ¨çŠ¶æ€å†»ç»“ã€‚ç¬¬äºŒæ¬¡æ‰§è¡Œ<code>g.next()</code>æ—¶ï¼Œ<code>gen</code>ä¸Šä¸‹æ–‡é‡æ–°åŠ å…¥å †æ ˆï¼Œå˜æˆå½“å‰çš„ä¸Šä¸‹æ–‡ï¼Œé‡æ–°æ¢å¤æ‰§è¡Œã€‚</p><hr><h3 id="18-12-åº”ç”¨"><a href="#18-12-åº”ç”¨" class="headerlink" title="18.12 åº”ç”¨"></a>18.12 åº”ç”¨</h3><p><strong>ï¼ˆ1ï¼‰å¼‚æ­¥æ“ä½œçš„åŒæ­¥åŒ–è¡¨è¾¾</strong></p><p><code>Generator</code> å‡½æ•°çš„æš‚åœæ‰§è¡Œçš„æ•ˆæœï¼Œæ„å‘³ç€<ins>å¯ä»¥æŠŠå¼‚æ­¥æ“ä½œå†™åœ¨<code>yield</code>è¡¨è¾¾å¼é‡Œé¢</ins>ï¼Œç­‰åˆ°è°ƒç”¨<code>next</code>æ–¹æ³•æ—¶å†å¾€åæ‰§è¡Œã€‚æ‰€ä»¥ï¼Œ<code>Generator</code> å‡½æ•°çš„ä¸€ä¸ªé‡è¦å®é™…æ„ä¹‰å°±æ˜¯ç”¨æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œæ”¹å†™å›è°ƒå‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">loadUI</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">showLoadingScreen</span>();</span><br><span class="line">  <span class="keyword">yield</span> <span class="title function_">loadUIDataAsynchronously</span>();</span><br><span class="line">  <span class="title function_">hideLoadingScreen</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> loader = <span class="title function_">loadUI</span>();</span><br><span class="line"><span class="comment">// åŠ è½½UI</span></span><br><span class="line">loader.<span class="title function_">next</span>()</span><br><span class="line"><span class="comment">// å¸è½½UI</span></span><br><span class="line">loader.<span class="title function_">next</span>()</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨<code>loadUI</code>å‡½æ•°æ—¶ï¼Œè¯¥å‡½æ•°ä¸ä¼šæ‰§è¡Œï¼Œä»…è¿”å›ä¸€ä¸ªéå†å™¨ã€‚ä¸‹ä¸€æ¬¡å¯¹è¯¥éå†å™¨è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œåˆ™ä¼šæ˜¾ç¤º<code>Loading</code>ç•Œé¢ï¼Œå¹¶ä¸”å¼‚æ­¥åŠ è½½æ•°æ®ã€‚ç­‰åˆ°æ•°æ®åŠ è½½å®Œæˆï¼Œå†ä¸€æ¬¡ä½¿ç”¨<code>next</code>æ–¹æ³•ï¼Œåˆ™ä¼šéšè—<code>Loading</code>ç•Œé¢ã€‚</p><p><strong>ï¼ˆ2ï¼‰æ§åˆ¶æµç®¡ç†</strong></p><p>å¦‚æœæœ‰ä¸€ä¸ªå¤šæ­¥æ“ä½œï¼Œé‡‡ç”¨å›è°ƒå‡½æ•°ï¼Œå¯èƒ½ä¼šå†™æˆä¸‹é¢è¿™æ ·ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">step1</span>(<span class="keyword">function</span> (<span class="params">value1</span>) &#123;</span><br><span class="line">  <span class="title function_">step2</span>(value1, <span class="keyword">function</span>(<span class="params">value2</span>) &#123;</span><br><span class="line">    <span class="title function_">step3</span>(value2, <span class="keyword">function</span>(<span class="params">value3</span>) &#123;</span><br><span class="line">      <span class="title function_">step4</span>(value3, <span class="keyword">function</span>(<span class="params">value4</span>) &#123;</span><br><span class="line">        <span class="comment">// Do something with value4</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>é‡‡ç”¨ <code>Promise</code> æ”¹å†™ä¸Šé¢çš„ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>(step1)</span><br><span class="line">  .<span class="title function_">then</span>(step2)</span><br><span class="line">  .<span class="title function_">then</span>(step3)</span><br><span class="line">  .<span class="title function_">then</span>(step4)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">value4</span>) &#123;</span><br><span class="line">    <span class="comment">// Do something with value4</span></span><br><span class="line">  &#125;, <span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="comment">// Handle any error from step1 through step4</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">done</span>();</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç å·²ç»æŠŠå›è°ƒå‡½æ•°ï¼Œæ”¹æˆäº†ç›´çº¿æ‰§è¡Œçš„å½¢å¼ï¼Œä½†æ˜¯åŠ å…¥äº†å¤§é‡ <code>Promise</code> çš„è¯­æ³•ã€‚<code>Generator</code> å‡½æ•°å¯ä»¥è¿›ä¸€æ­¥æ”¹å–„ä»£ç è¿è¡Œæµç¨‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">longRunningTask</span>(<span class="params">value1</span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> value2 = <span class="keyword">yield</span> <span class="title function_">step1</span>(value1);</span><br><span class="line">    <span class="keyword">let</span> value3 = <span class="keyword">yield</span> <span class="title function_">step2</span>(value2);</span><br><span class="line">    <span class="keyword">let</span> value4 = <span class="keyword">yield</span> <span class="title function_">step3</span>(value3);</span><br><span class="line">    <span class="keyword">let</span> value5 = <span class="keyword">yield</span> <span class="title function_">step4</span>(value4);</span><br><span class="line">    <span class="comment">// Do something with value4</span></span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="comment">// Handle any error from step1 through step4</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œ<ins>ä½¿ç”¨ä¸€ä¸ªå‡½æ•°ï¼ŒæŒ‰æ¬¡åºè‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰æ­¥éª¤</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">scheduler</span>(<span class="title function_">longRunningTask</span>(initialValue));</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">scheduler</span>(<span class="params">task</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> taskObj = task.<span class="title function_">next</span>(task.<span class="property">value</span>);</span><br><span class="line">  <span class="comment">// å¦‚æœGeneratorå‡½æ•°æœªç»“æŸï¼Œå°±ç»§ç»­è°ƒç”¨</span></span><br><span class="line">  <span class="keyword">if</span> (!taskObj.<span class="property">done</span>) &#123;</span><br><span class="line">    task.<span class="property">value</span> = taskObj.<span class="property">value</span></span><br><span class="line">    <span class="title function_">scheduler</span>(task);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œä¸Šé¢è¿™ç§åšæ³•ï¼Œåªé€‚åˆåŒæ­¥æ“ä½œï¼Œå³æ‰€æœ‰çš„<code>task</code>éƒ½å¿…é¡»æ˜¯åŒæ­¥çš„ï¼Œä¸èƒ½æœ‰å¼‚æ­¥æ“ä½œã€‚å› ä¸ºè¿™é‡Œçš„ä»£ç ä¸€å¾—åˆ°è¿”å›å€¼ï¼Œå°±ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œæ²¡æœ‰åˆ¤æ–­å¼‚æ­¥æ“ä½œä½•æ—¶å®Œæˆã€‚</p><p><strong>ï¼ˆ3ï¼‰æ§åˆ¶æµç®¡ç† II</strong></p><p>åˆ©ç”¨<code>for...of</code>å¾ªç¯ä¼šè‡ªåŠ¨ä¾æ¬¡æ‰§è¡Œ<code>yield</code>å‘½ä»¤çš„ç‰¹æ€§ï¼Œèƒ½æä¾›ä¸€ç§æ›´ä¸€èˆ¬çš„æ§åˆ¶æµç®¡ç†çš„æ–¹æ³•ã€‚</p><p>é¦–å…ˆï¼Œç”¨æ•°ç»„<code>steps</code>å°è£…äº†ä¸€ä¸ªä»»åŠ¡çš„å¤šä¸ªæ­¥éª¤ï¼Œå¹¶ä¾æ¬¡ä¸ºè¿™äº›æ­¥éª¤åŠ ä¸Š<code>yield</code>å‘½ä»¤ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> steps = [step1Func, step2Func, step3Func];</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">iterateSteps</span>(<span class="params">steps</span>)&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; steps.<span class="property">length</span>; i++)&#123;</span><br><span class="line">    <span class="keyword">let</span> step = steps[i];</span><br><span class="line">    <span class="keyword">yield</span> <span class="title function_">step</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œå°†ä»»åŠ¡åˆ†è§£æˆæ­¥éª¤ä¹‹åï¼Œè¿˜å¯ä»¥å†å°†é¡¹ç›®åˆ†è§£æˆå¤šä¸ªä¾æ¬¡æ‰§è¡Œçš„ä»»åŠ¡<code>jobs</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> jobs = [job1, job2, job3];</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">iterateJobs</span>(<span class="params">jobs</span>)&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; jobs.<span class="property">length</span>; i++)&#123;</span><br><span class="line">    <span class="keyword">let</span> job = jobs[i];</span><br><span class="line">    <span class="keyword">yield</span>* <span class="title function_">iterateSteps</span>(job.<span class="property">steps</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œå°±å¯ä»¥ç”¨<code>for...of</code>å¾ªç¯ä¸€æ¬¡æ€§ä¾æ¬¡æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡çš„æ‰€æœ‰æ­¥éª¤ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> step <span class="keyword">of</span> <span class="title function_">iterateJobs</span>(jobs))&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(step.<span class="property">id</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†æ¬¡æé†’ï¼Œä¸Šé¢çš„åšæ³•åªèƒ½ç”¨äºæ‰€æœ‰æ­¥éª¤éƒ½æ˜¯åŒæ­¥æ“ä½œçš„æƒ…å†µï¼Œä¸èƒ½æœ‰å¼‚æ­¥æ“ä½œçš„æ­¥éª¤ã€‚</p><hr><h2 id="19-Generator-å‡½æ•°å¼‚æ­¥åº”ç”¨"><a href="#19-Generator-å‡½æ•°å¼‚æ­¥åº”ç”¨" class="headerlink" title="19. Generator å‡½æ•°å¼‚æ­¥åº”ç”¨"></a>19. Generator å‡½æ•°å¼‚æ­¥åº”ç”¨</h2><h3 id="19-1-åŸºæœ¬æ¦‚å¿µ"><a href="#19-1-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="19.1 åŸºæœ¬æ¦‚å¿µ"></a>19.1 åŸºæœ¬æ¦‚å¿µ</h3><p><strong>ï¼ˆ1ï¼‰å¼‚æ­¥</strong> </p><p>æ‰€è°“â€å¼‚æ­¥â€ï¼Œå¯ä»¥ç†è§£æˆä¸€ä¸ªä»»åŠ¡è¢«äººä¸ºåˆ†æˆä¸¤æ®µï¼Œå…ˆæ‰§è¡Œç¬¬ä¸€æ®µï¼Œç„¶åè½¬è€Œæ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œç­‰åšå¥½äº†å‡†å¤‡ï¼Œå†å›è¿‡å¤´æ‰§è¡Œç¬¬äºŒæ®µ</ins>ã€‚</p><ul><li>æ¯”å¦‚ï¼Œæœ‰ä¸€ä¸ªä»»åŠ¡æ˜¯è¯»å–æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œä»»åŠ¡çš„ç¬¬ä¸€æ®µå‘æ“ä½œç³»ç»Ÿå‘å‡ºè¯·æ±‚ï¼Œè¦æ±‚è¯»å–æ–‡ä»¶ã€‚ç„¶åï¼Œç¨‹åºæ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œç­‰åˆ°æ“ä½œç³»ç»Ÿè¿”å›æ–‡ä»¶ï¼Œå†æ¥ç€æ‰§è¡Œä»»åŠ¡çš„ç¬¬äºŒæ®µå¤„ç†æ–‡ä»¶ã€‚</li></ul><p>ç›¸åº”åœ°ï¼Œè¿ç»­çš„æ‰§è¡Œå°±å«åšåŒæ­¥ã€‚ç”±äºæ˜¯è¿ç»­æ‰§è¡Œï¼Œä¸èƒ½æ’å…¥å…¶ä»–ä»»åŠ¡ï¼Œæ‰€ä»¥æ“ä½œç³»ç»Ÿä»ç¡¬ç›˜è¯»å–æ–‡ä»¶çš„è¿™æ®µæ—¶é—´ï¼Œç¨‹åºåªèƒ½å¹²ç­‰ç€ã€‚</p><p><strong>ï¼ˆ2ï¼‰å›è°ƒå‡½æ•°</strong> </p><p><code>JS</code> è¯­è¨€å¯¹å¼‚æ­¥ç¼–ç¨‹çš„å®ç°ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°ã€‚æ‰€è°“<ins>å›è°ƒå‡½æ•°ï¼Œå°±æ˜¯æŠŠä»»åŠ¡çš„ç¬¬äºŒæ®µå•ç‹¬å†™åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œç­‰åˆ°é‡æ–°æ‰§è¡Œè¿™ä¸ªä»»åŠ¡çš„æ—¶å€™ï¼Œå°±ç›´æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;/etc/passwd&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>, <span class="keyword">function</span> (<span class="params">err, data</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>readFile</code>å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä»»åŠ¡çš„ç¬¬äºŒæ®µã€‚ç­‰åˆ°æ“ä½œç³»ç»Ÿè¿”å›äº†<code>/etc/passwd</code>è¿™ä¸ªæ–‡ä»¶ä»¥åï¼Œå›è°ƒå‡½æ•°æ‰ä¼šæ‰§è¡Œã€‚</p><p><strong>ï¼ˆ3ï¼‰Promise</strong> </p><p>å›è°ƒå‡½æ•°çš„é—®é¢˜å‡ºç°åœ¨å¤šä¸ªå›è°ƒå‡½æ•°åµŒå¥—ã€‚å‡å®šè¯»å–<code>A</code>æ–‡ä»¶ä¹‹åï¼Œå†è¯»å–<code>B</code>æ–‡ä»¶ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">fs.<span class="title function_">readFile</span>(fileA, <span class="string">&#x27;utf-8&#x27;</span>, <span class="keyword">function</span> (<span class="params">err, data</span>) &#123;</span><br><span class="line">  fs.<span class="title function_">readFile</span>(fileB, <span class="string">&#x27;utf-8&#x27;</span>, <span class="keyword">function</span> (<span class="params">err, data</span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸éš¾æƒ³è±¡ï¼Œå¦‚æœä¾æ¬¡è¯»å–ä¸¤ä¸ªä»¥ä¸Šçš„æ–‡ä»¶ï¼Œå°±ä¼šå‡ºç°å¤šé‡åµŒå¥—ã€‚å› ä¸ºå¤šä¸ªå¼‚æ­¥æ“ä½œå½¢æˆäº†å¼ºè€¦åˆï¼Œåªè¦æœ‰ä¸€ä¸ªæ“ä½œéœ€è¦ä¿®æ”¹ï¼Œå®ƒçš„ä¸Šå±‚å›è°ƒå‡½æ•°å’Œä¸‹å±‚å›è°ƒå‡½æ•°ï¼Œå¯èƒ½éƒ½è¦è·Ÿç€ä¿®æ”¹ã€‚</p><p><code>Promise</code> å¯¹è±¡å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œæå‡ºçš„ã€‚å®ƒä¸æ˜¯æ–°çš„è¯­æ³•åŠŸèƒ½ï¼Œè€Œæ˜¯ä¸€ç§æ–°çš„å†™æ³•ï¼Œ<ins>å…è®¸å°†å›è°ƒå‡½æ•°çš„åµŒå¥—ï¼Œæ”¹æˆé“¾å¼è°ƒç”¨</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> readFile = <span class="built_in">require</span>(<span class="string">&#x27;fs-readfile-promise&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">readFile</span>(fileA)</span><br><span class="line">.<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data.<span class="title function_">toString</span>());</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">readFile</span>(fileB);</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data.<span class="title function_">toString</span>());</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="keyword">function</span> (<span class="params">err</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­çš„<code>fs-readfile-promise</code>æ¨¡å—ï¼Œè¿”å›ä¸€ä¸ª <code>Promise</code> ç‰ˆæœ¬çš„<code>readFile</code>å‡½æ•°ï¼Œå¹¶é€šè¿‡<code>then</code>æ–¹æ³•åŠ è½½å›è°ƒå‡½æ•°ï¼Œ<code>catch</code>æ–¹æ³•æ•æ‰æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºçš„é”™è¯¯ã€‚</p><p><code>Promise</code> çš„å†™æ³•åªæ˜¯å›è°ƒå‡½æ•°çš„æ”¹è¿›ï¼Œä½¿ç”¨<code>then</code>æ–¹æ³•ä»¥åï¼Œå¼‚æ­¥ä»»åŠ¡çš„ä¸¤æ®µæ‰§è¡Œçœ‹å¾—æ›´æ¸…æ¥šäº†ã€‚ä½†æ˜¯ï¼Œ<code>Promise</code> çš„æœ€å¤§é—®é¢˜æ˜¯ä»£ç å†—ä½™ï¼ŒåŸæ¥çš„ä»»åŠ¡è¢« <code>Promise</code> åŒ…è£…äº†ä¸€ä¸‹ï¼Œä¸ç®¡ä»€ä¹ˆæ“ä½œï¼Œä¸€çœ¼çœ‹å»è®¸å¤š<code>then</code>ï¼ŒåŸæ¥çš„è¯­ä¹‰å˜å¾—å¾ˆä¸æ¸…æ¥šã€‚</p><p><strong>ï¼ˆ4ï¼‰Generator å‡½æ•°</strong> </p><p>â€œåç¨‹â€ <code>coroutine</code>ï¼Œæ˜¯å¤šä¸ªçº¿ç¨‹äº’ç›¸åä½œï¼Œå®Œæˆå¼‚æ­¥ä»»åŠ¡ã€‚åç¨‹æœ‰ç‚¹åƒå‡½æ•°ï¼Œåˆæœ‰ç‚¹åƒçº¿ç¨‹ã€‚å®ƒçš„è¿è¡Œæµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p><ul><li>ç¬¬ä¸€æ­¥ï¼Œåç¨‹<code>A</code>å¼€å§‹æ‰§è¡Œã€‚</li><li>ç¬¬äºŒæ­¥ï¼Œ<ins>åç¨‹<code>A</code>æ‰§è¡Œåˆ°ä¸€åŠï¼Œè¿›å…¥æš‚åœï¼Œæ‰§è¡Œæƒè½¬ç§»åˆ°åç¨‹<code>B</code></ins>ã€‚</li><li>ç¬¬ä¸‰æ­¥ï¼Œä¸€æ®µæ—¶é—´åï¼Œåç¨‹<code>B</code>äº¤è¿˜æ‰§è¡Œæƒã€‚</li><li>ç¬¬å››æ­¥ï¼Œåç¨‹<code>A</code>æ¢å¤æ‰§è¡Œã€‚</li></ul><p>ä¸Šé¢æµç¨‹çš„åç¨‹<code>A</code>ï¼Œå°±æ˜¯å¼‚æ­¥ä»»åŠ¡ï¼Œå› ä¸ºå®ƒåˆ†æˆä¸¤æ®µæˆ–å¤šæ®µæ‰§è¡Œã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">asyncJob</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// ...å…¶ä»–ä»£ç </span></span><br><span class="line">  <span class="keyword">let</span> f = <span class="keyword">yield</span> <span class="title function_">readFile</span>(fileA);</span><br><span class="line">  <span class="comment">// ...å…¶ä»–ä»£ç </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç çš„å‡½æ•°<code>asyncJob</code>æ˜¯ä¸€ä¸ªåç¨‹ï¼Œå®ƒçš„å¥¥å¦™å°±åœ¨å…¶ä¸­çš„<code>yield</code>å‘½ä»¤ï¼Œ<ins>è¡¨ç¤ºæ‰§è¡Œåˆ°æ­¤å¤„ï¼Œæ‰§è¡Œæƒå°†äº¤ç»™å…¶ä»–åç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>yield</code>å‘½ä»¤æ˜¯å¼‚æ­¥ä¸¤ä¸ªé˜¶æ®µçš„åˆ†ç•Œçº¿</ins>ã€‚</p><p><code>Generator</code> å‡½æ•°æ˜¯åç¨‹åœ¨ <code>ES6</code> çš„å®ç°ï¼Œæœ€å¤§ç‰¹ç‚¹å°±æ˜¯å¯ä»¥äº¤å‡ºå‡½æ•°çš„æ‰§è¡Œæƒï¼ˆå³æš‚åœæ‰§è¡Œï¼‰ã€‚å®ƒæ˜¯ä¸€ä¸ªå°è£…çš„å¼‚æ­¥ä»»åŠ¡ï¼Œæˆ–è€…è¯´æ˜¯å¼‚æ­¥ä»»åŠ¡çš„å®¹å™¨ã€‚å¼‚æ­¥æ“ä½œéœ€è¦æš‚åœçš„åœ°æ–¹ï¼Œéƒ½ç”¨<code>yield</code>è¯­å¥æ³¨æ˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">gen</span>(<span class="params">x</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> y = <span class="keyword">yield</span> x + <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> g = <span class="title function_">gen</span>(<span class="number">1</span>);</span><br><span class="line">g.<span class="title function_">next</span>() <span class="comment">// &#123; value: 3, done: false &#125;</span></span><br><span class="line">g.<span class="title function_">next</span>() <span class="comment">// &#123; value: undefined, done: true &#125;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨ <code>Generator</code> å‡½æ•°ï¼Œä¼šè¿”å›ä¸€ä¸ªå†…éƒ¨æŒ‡é’ˆï¼ˆå³éå†å™¨ï¼‰<code>g</code>ã€‚è¿™æ˜¯ <code>Generator</code> å‡½æ•°ä¸åŒäºæ™®é€šå‡½æ•°çš„å¦ä¸€ä¸ªåœ°æ–¹ï¼Œå³æ‰§è¡Œå®ƒä¸ä¼šè¿”å›ç»“æœï¼Œè¿”å›çš„æ˜¯æŒ‡é’ˆå¯¹è±¡ã€‚è°ƒç”¨æŒ‡é’ˆ<code>g</code>çš„<code>next</code>æ–¹æ³•ï¼Œä¼šç§»åŠ¨å†…éƒ¨æŒ‡é’ˆï¼ˆå³æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„ç¬¬ä¸€æ®µï¼‰ï¼ŒæŒ‡å‘ç¬¬ä¸€ä¸ªé‡åˆ°çš„<code>yield</code>è¯­å¥ï¼Œä¸Šä¾‹æ˜¯æ‰§è¡Œåˆ°<code>x + 2</code>ä¸ºæ­¢ã€‚</p><p>æ¢è¨€ä¹‹ï¼Œ<code>next</code>æ–¹æ³•çš„ä½œç”¨æ˜¯åˆ†é˜¶æ®µæ‰§è¡Œ<code>Generator</code>å‡½æ•°ã€‚æ¯æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºå½“å‰é˜¶æ®µçš„ä¿¡æ¯ï¼ˆ<code>value</code>å±æ€§å’Œ<code>done</code>å±æ€§ï¼‰ã€‚<code>value</code>å±æ€§æ˜¯<code>yield</code>è¯­å¥åé¢è¡¨è¾¾å¼çš„å€¼ï¼Œè¡¨ç¤ºå½“å‰é˜¶æ®µçš„å€¼ï¼›<code>done</code>å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤º <code>Generator</code> å‡½æ•°æ˜¯å¦æ‰§è¡Œå®Œæ¯•ï¼Œå³æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚</p><hr><h3 id="19-2-æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†"><a href="#19-2-æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†" class="headerlink" title="19.2 æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†"></a>19.2 æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†</h3><p><code>Generator</code> å‡½æ•°å¯ä»¥æš‚åœå’Œæ¢å¤æ‰§è¡Œï¼Œè¿™æ˜¯å®ƒèƒ½å°è£…å¼‚æ­¥ä»»åŠ¡çš„æ ¹æœ¬åŸå› ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒè¿˜æœ‰ä¸¤ä¸ªç‰¹æ€§ï¼Œä½¿å®ƒå¯ä»¥ä½œä¸ºå¼‚æ­¥ç¼–ç¨‹çš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼š<ins>å‡½æ•°ä½“å†…å¤–çš„æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†æœºåˆ¶</ins>ã€‚</p><p><code>next</code>è¿”å›å€¼çš„ <code>value</code> å±æ€§ï¼Œæ˜¯ <code>Generator</code> å‡½æ•°å‘å¤–è¾“å‡ºæ•°æ®ã€‚<code>next</code>æ–¹æ³•è¿˜å¯ä»¥æ¥å—å‚æ•°ï¼Œå‘ <code>Generator</code> å‡½æ•°ä½“å†…è¾“å…¥æ•°æ®ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">gen</span>(<span class="params">x</span>)&#123;</span><br><span class="line">  <span class="keyword">let</span> y = <span class="keyword">yield</span> x + <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> g = <span class="title function_">gen</span>(<span class="number">1</span>);</span><br><span class="line">g.<span class="title function_">next</span>() <span class="comment">// &#123; value: 3, done: false &#125;</span></span><br><span class="line">g.<span class="title function_">next</span>(<span class="number">2</span>) <span class="comment">// &#123; value: 2, done: true &#125;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬ä¸€ä¸ª<code>next</code>æ–¹æ³•çš„<code>value</code>å±æ€§ï¼Œè¿”å›è¡¨è¾¾å¼<code>x + 2</code>çš„å€¼ã€‚ç¬¬äºŒä¸ª<code>next</code>æ–¹æ³•å¸¦æœ‰å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°è¢«ä¼ å…¥ <code>Generator</code> å‡½æ•°ï¼Œä½œä¸ºä¸Šä¸ªé˜¶æ®µå¼‚æ­¥ä»»åŠ¡çš„è¿”å›ç»“æœï¼Œä¹Ÿå°±æ˜¯<code>y</code>çš„å€¼ã€‚å› æ­¤ï¼Œè¿™ä¸€æ­¥çš„<code>value</code>å±æ€§ï¼Œè¿”å›çš„å°±æ˜¯<code>2</code>ã€‚</p><p><code>Generator</code> å‡½æ•°å†…éƒ¨è¿˜å¯ä»¥éƒ¨ç½²é”™è¯¯å¤„ç†ä»£ç ï¼Œæ•è·å‡½æ•°ä½“å¤–æŠ›å‡ºçš„é”™è¯¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">gen</span>(<span class="params">x</span>)&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> y = <span class="keyword">yield</span> x + <span class="number">2</span>;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> g = <span class="title function_">gen</span>(<span class="number">1</span>);</span><br><span class="line">g.<span class="title function_">next</span>();</span><br><span class="line">g.<span class="keyword">throw</span>(<span class="string">&#x27;å‡ºé”™äº†&#x27;</span>);</span><br><span class="line"><span class="comment">// å‡ºé”™äº†</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç çš„æœ€åä¸€è¡Œï¼Œ<code>Generator</code> å‡½æ•°ä½“å¤–ï¼Œ<ins>ä½¿ç”¨æŒ‡é’ˆå¯¹è±¡çš„<code>throw</code>æ–¹æ³•æŠ›å‡ºçš„é”™è¯¯ï¼Œå¯ä»¥è¢«å‡½æ•°ä½“å†…çš„<code>try...catch</code>ä»£ç å—æ•è·</ins>ã€‚è¿™æ„å‘³ç€ï¼Œ<ins>å‡ºé”™çš„ä»£ç ä¸å¤„ç†é”™è¯¯çš„ä»£ç ï¼Œå®ç°äº†æ—¶é—´å’Œç©ºé—´ä¸Šçš„åˆ†ç¦»ï¼Œè¿™å¯¹äºå¼‚æ­¥ç¼–ç¨‹æ— ç–‘æ˜¯å¾ˆé‡è¦çš„</ins>ã€‚</p><hr><h3 id="19-3-å¼‚æ­¥ä»»åŠ¡çš„å°è£…"><a href="#19-3-å¼‚æ­¥ä»»åŠ¡çš„å°è£…" class="headerlink" title="19.3 å¼‚æ­¥ä»»åŠ¡çš„å°è£…"></a>19.3 å¼‚æ­¥ä»»åŠ¡çš„å°è£…</h3><p>ä½¿ç”¨<code>Generator</code>å°è£…å¼‚æ­¥æ“ä½œçš„æ ¸å¿ƒæ€è·¯ï¼š</p><ul><li>åœ¨å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œä½¿ç”¨<code>yield</code>äº¤å‡ºæ‰§è¡Œæƒã€‚</li><li>åœ¨å¼‚æ­¥ä»»åŠ¡ç»“æŸåï¼Œä½¿ç”¨<code>next</code>äº¤è¿˜æ‰§è¡Œæƒã€‚</li></ul><p>ä¸‹é¢çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ <code>Generator</code> å‡½æ•°ï¼Œæ‰§è¡Œä¸€ä¸ªçœŸå®çš„å¼‚æ­¥ä»»åŠ¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. é¦–å…ˆå†™ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡,åœ¨ä¸€ç§’åè¿”å›ç‰¹å®šå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">asyncTask</span>(<span class="params">callback</span>)&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="title function_">callback</span>(<span class="string">&#x27;Hello World&#x27;</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. æ¥ä¸‹æ¥å†™å‡ºæœŸæœ›æ‰§è¡Œçš„é¡ºåº</span></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">runTask</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> text = <span class="keyword">yield</span> asyncTask</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(text) <span class="comment">// æˆ‘ä»¬æœŸæœ›è¿™é‡Œæ­£å¸¸è¾“å‡º Hello World</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. æŒ‰ç…§æœŸæœ›å€¼æ‰§è¡Œå‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> gen = <span class="title function_">runTask</span>()<span class="comment">// æ­¤æ—¶æ‰§è¡Œæƒå·²ç»äº¤å‡º</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™é‡Œ gen.next().value å°±æ˜¯ asyncTaskï¼Œæ‰§è¡Œ asyncTask</span></span><br><span class="line"><span class="comment">// å…³é”®ç‚¹åœ¨äº callback é‡Œè°ƒç”¨ next äº¤è¿˜æ‰§è¡Œæƒ</span></span><br><span class="line"><span class="comment">// ç”±äº next æ–¹æ³•å¸¦æœ‰å‚æ•° textï¼Œä¸”æ˜¯ callback çš„è¿”å›å€¼ï¼Œæ‰€ä»¥æœ‰ç»ˆç«¯è¾“å‡ºã€‚</span></span><br><span class="line">gen.<span class="title function_">next</span>().<span class="title function_">value</span>(<span class="keyword">function</span> (<span class="params">text</span>) &#123;</span><br><span class="line">    gen.<span class="title function_">next</span>(text)</span><br><span class="line">&#125;) </span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç è™½ç„¶å¾ˆç²—ç³™ï¼Œä½†æ˜¯å·²ç»åæ˜ äº†ä½¿ç”¨<code>Generator</code>å°è£…å¼‚æ­¥ä»»åŠ¡çš„æ ¸å¿ƒæ€æƒ³ã€‚æœ€ç›´è§‚çš„å—ç›Šå°±æ˜¯ï¼Œ<code>runTask</code>çš„å†…å®¹ä¸åŒæ­¥ä»£ç ç›¸ä¼¼ï¼Œæ¡ç†æ¸…æ™°ï¼Œå¾ˆé€‚åˆé˜…è¯»ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶ <code>Generator</code> å‡½æ•°å°†å¼‚æ­¥æ“ä½œè¡¨ç¤ºå¾—å¾ˆç®€æ´ï¼Œä½†æ˜¯ä¸Šé¢ä»£ç ä¸­ç¬¬ä¸‰éƒ¨åˆ†çš„æµç¨‹ç®¡ç†å´ä¸æ–¹ä¾¿ï¼Œå³ä½•æ—¶æ‰§è¡Œç¬¬ä¸€é˜¶æ®µã€ä½•æ—¶æ‰§è¡Œç¬¬äºŒé˜¶æ®µã€‚</p><hr><h3 id="19-4-Thunk-å‡½æ•°"><a href="#19-4-Thunk-å‡½æ•°" class="headerlink" title="19.4 Thunk å‡½æ•°"></a>19.4 Thunk å‡½æ•°</h3><p><code>Thunk</code> å‡½æ•°æ˜¯è‡ªåŠ¨æ‰§è¡Œ <code>Generator</code> å‡½æ•°çš„ä¸€ç§æ–¹æ³•ã€‚</p><p><strong>ï¼ˆ1ï¼‰å‚æ•°çš„æ±‚å€¼ç­–ç•¥</strong> </p><p><code>Thunk</code> å‡½æ•°æ—©åœ¨ä¸Šä¸ªä¸–çºª <code>60</code> å¹´ä»£å°±è¯ç”Ÿäº†ã€‚é‚£æ—¶ï¼Œç¼–ç¨‹è¯­è¨€åˆšåˆšèµ·æ­¥ï¼Œè®¡ç®—æœºå­¦å®¶è¿˜åœ¨ç ”ç©¶ï¼Œç¼–è¯‘å™¨æ€ä¹ˆå†™æ¯”è¾ƒå¥½ã€‚ä¸€ä¸ªäº‰è®ºçš„ç„¦ç‚¹æ˜¯â€æ±‚å€¼ç­–ç•¥â€ï¼Œå³å‡½æ•°çš„å‚æ•°åˆ°åº•åº”è¯¥ä½•æ—¶æ±‚å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">m</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> m * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">f</span>(x + <span class="number">5</span>)ï¼›</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç å…ˆå®šä¹‰å‡½æ•°<code>f</code>ï¼Œç„¶åå‘å®ƒä¼ å…¥è¡¨è¾¾å¼<code>x + 5</code>ã€‚è¯·é—®ï¼Œè¿™ä¸ªè¡¨è¾¾å¼åº”è¯¥ä½•æ—¶æ±‚å€¼ï¼Ÿ</p><p>ä¸€ç§æ„è§æ˜¯<ins>â€œä¼ å€¼è°ƒç”¨â€</ins>ï¼Œå³åœ¨è¿›å…¥å‡½æ•°ä½“ä¹‹å‰ï¼Œå°±è®¡ç®—<code>x + 5</code>çš„å€¼ï¼Œå†å°†è¿™ä¸ªå€¼ä¼ å…¥å‡½æ•°<code>f</code>ã€‚<code>C</code> è¯­è¨€å°±é‡‡ç”¨è¿™ç§ç­–ç•¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">f</span>(x + <span class="number">5</span>)</span><br><span class="line"><span class="comment">// ä¼ å€¼è°ƒç”¨æ—¶ï¼Œç­‰åŒäº</span></span><br><span class="line"><span class="title function_">f</span>(<span class="number">6</span>)</span><br></pre></td></tr></table></figure><p>å¦ä¸€ç§æ„è§æ˜¯<ins>â€œä¼ åè°ƒç”¨â€</ins>ï¼Œå³ç›´æ¥å°†è¡¨è¾¾å¼<code>x + 5</code>ä¼ å…¥å‡½æ•°ä½“ï¼Œåªåœ¨ç”¨åˆ°å®ƒçš„æ—¶å€™æ±‚å€¼ã€‚<code>Haskell</code> è¯­è¨€é‡‡ç”¨è¿™ç§ç­–ç•¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">f</span>(x + <span class="number">5</span>)</span><br><span class="line"><span class="comment">// ä¼ åè°ƒç”¨æ—¶ï¼Œç­‰åŒäº</span></span><br><span class="line">(x + <span class="number">5</span>) * <span class="number">2</span></span><br></pre></td></tr></table></figure><p>ä¼ å€¼è°ƒç”¨å’Œä¼ åè°ƒç”¨ï¼Œå“ªä¸€ç§æ¯”è¾ƒå¥½ï¼Ÿå›ç­”æ˜¯å„æœ‰åˆ©å¼Šã€‚ä¼ å€¼è°ƒç”¨æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å¯¹å‚æ•°æ±‚å€¼çš„æ—¶å€™ï¼Œå®é™…ä¸Šè¿˜æ²¡ç”¨åˆ°è¿™ä¸ªå‚æ•°ï¼Œæœ‰å¯èƒ½é€ æˆæ€§èƒ½æŸå¤±ã€‚</p><p><strong>ï¼ˆ2ï¼‰Thunk å‡½æ•°çš„å«ä¹‰</strong> </p><p>ç¼–è¯‘å™¨â€œä¼ åè°ƒç”¨â€çš„å®ç°ï¼Œå¾€å¾€æ˜¯å°†å‚æ•°æ”¾åˆ°ä¸€ä¸ªä¸´æ—¶å‡½æ•°ä¹‹ä¸­ï¼Œå†å°†è¿™ä¸ªä¸´æ—¶å‡½æ•°ä¼ å…¥å‡½æ•°ä½“ã€‚è¿™ä¸ªä¸´æ—¶å‡½æ•°å°±å«åš <code>Thunk</code> å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">m</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> m * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">f</span>(x + <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> thunk = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x + <span class="number">5</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">thunk</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">thunk</span>() * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•° <code>f</code> çš„å‚æ•°<code>x + 5</code>è¢«ä¸€ä¸ªå‡½æ•°æ›¿æ¢äº†ã€‚å‡¡æ˜¯ç”¨åˆ°åŸå‚æ•°çš„åœ°æ–¹ï¼Œå¯¹<code>Thunk</code>å‡½æ•°æ±‚å€¼å³å¯ã€‚è¿™å°±æ˜¯ <code>Thunk</code> å‡½æ•°çš„å®šä¹‰ï¼Œ<ins>å®ƒæ˜¯â€œä¼ åè°ƒç”¨â€çš„ä¸€ç§å®ç°ç­–ç•¥ï¼Œç”¨æ¥æ›¿æ¢æŸä¸ªè¡¨è¾¾å¼</ins>ã€‚</p><p><strong>ï¼ˆ3ï¼‰JS è¯­è¨€çš„ Thunk å‡½æ•°</strong> </p><p><ins><code>JavaScript</code> æ˜¯ä¼ å€¼è°ƒç”¨</ins>ï¼Œå®ƒçš„ <code>Thunk</code> å‡½æ•°å«ä¹‰æœ‰æ‰€ä¸åŒã€‚åœ¨ <code>JavaScript</code> ä¸­ï¼Œ<code>Thunk</code> å‡½æ•°æ›¿æ¢çš„ä¸æ˜¯è¡¨è¾¾å¼ï¼Œè€Œæ˜¯å¤šå‚æ•°å‡½æ•°ï¼Œå°†å…¶æ›¿æ¢æˆä¸€ä¸ªåªæ¥å—å›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°çš„å•å‚æ•°å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ­£å¸¸ç‰ˆæœ¬çš„ readFileï¼ˆå¤šå‚æ•°ç‰ˆæœ¬ï¼‰</span></span><br><span class="line">fs.<span class="title function_">readFile</span>(fileName, callback);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Thunkç‰ˆæœ¬çš„ readFileï¼ˆå•å‚æ•°ç‰ˆæœ¬ï¼‰</span></span><br><span class="line"><span class="keyword">let</span> <span class="title class_">Thunk</span> = <span class="keyword">function</span> (<span class="params">fileName</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">callback</span>) &#123; <span class="comment">// æ³¨æ„</span></span><br><span class="line">    <span class="keyword">return</span> fs.<span class="title function_">readFile</span>(fileName, callback);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> readFileThunk = <span class="title class_">Thunk</span>(fileName);</span><br><span class="line"><span class="title function_">readFileThunk</span>(callback);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>fs</code>æ¨¡å—çš„<code>readFile</code>æ–¹æ³•æ˜¯ä¸€ä¸ªå¤šå‚æ•°å‡½æ•°ï¼Œä¸¤ä¸ªå‚æ•°åˆ†åˆ«ä¸ºæ–‡ä»¶åå’Œå›è°ƒå‡½æ•°ã€‚ç»è¿‡è½¬æ¢å™¨å¤„ç†ï¼Œå®ƒå˜æˆäº†ä¸€ä¸ªå•å‚æ•°å‡½æ•°ï¼Œåªæ¥å—å›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªå•å‚æ•°ç‰ˆæœ¬ï¼Œå°±å«åš <code>Thunk</code> å‡½æ•°ã€‚</p><p>ä»»ä½•å‡½æ•°ï¼Œåªè¦å‚æ•°æœ‰å›è°ƒå‡½æ•°ï¼Œå°±èƒ½å†™æˆ <code>Thunk</code> å‡½æ•°çš„å½¢å¼ã€‚ï¼ˆ<a href="https://zhuanlan.zhihu.com/p/404060484">æ¨èé˜…è¯»</a>ï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Thunk</span> = <span class="keyword">function</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">callback</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> fn.<span class="title function_">call</span>(<span class="variable language_">this</span>, ...args, callback);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ4ï¼‰Thunkify æ¨¡å—</strong> </p><p><code>Thunkify</code> æ¨¡å—çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> thunkify = <span class="built_in">require</span>(<span class="string">&#x27;thunkify&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> read = <span class="title function_">thunkify</span>(fs.<span class="property">readFile</span>);</span><br><span class="line"><span class="title function_">read</span>(<span class="string">&#x27;package.json&#x27;</span>)(<span class="keyword">function</span>(<span class="params">err, str</span>)&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>Thunkify</code> çš„æºç ä¸ä¸Šä¸€èŠ‚é‚£ä¸ªç®€å•çš„è½¬æ¢å™¨éå¸¸åƒã€‚ï¼ˆ<a href="https://segmentfault.com/a/1190000010414406">æºç è§£è¯»</a>ï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">thunkify</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> args = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="variable language_">arguments</span>.<span class="property">length</span>);</span><br><span class="line">    <span class="keyword">let</span> ctx = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; args.<span class="property">length</span>; ++i) &#123;</span><br><span class="line">      args[i] = <span class="variable language_">arguments</span>[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">done</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> called;</span><br><span class="line"></span><br><span class="line">      args.<span class="title function_">push</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (called)&#123;</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        called = <span class="literal">true</span>;</span><br><span class="line">        done.<span class="title function_">apply</span>(<span class="literal">null</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        fn.<span class="title function_">apply</span>(ctx, args);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="title function_">done</span>(err);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å®ƒçš„æºç ä¸»è¦å¤šäº†ä¸€ä¸ªæ£€æŸ¥æœºåˆ¶ï¼Œå˜é‡<code>called</code>ç¡®ä¿å›è°ƒå‡½æ•°åªè¿è¡Œä¸€æ¬¡ã€‚è¿™æ ·çš„è®¾è®¡ä¸ä¸‹é¢çš„ <code>Generator</code> å‡½æ•°ç›¸å…³ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">a, b, callback</span>)&#123;</span><br><span class="line">  <span class="keyword">let</span> sum = a + b;</span><br><span class="line">  <span class="title function_">callback</span>(sum);</span><br><span class="line">  <span class="title function_">callback</span>(sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ft = <span class="title function_">thunkify</span>(f);</span><br><span class="line"><span class="keyword">let</span> print = <span class="variable language_">console</span>.<span class="property">log</span>.<span class="title function_">bind</span>(<span class="variable language_">console</span>);</span><br><span class="line"><span class="title function_">ft</span>(<span class="number">1</span>, <span class="number">2</span>)(print);</span><br><span class="line"><span class="comment">// 3</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äº<code>thunkify</code>åªå…è®¸å›è°ƒå‡½æ•°æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥åªè¾“å‡ºä¸€è¡Œç»“æœã€‚</p><p><strong>ï¼ˆ5ï¼‰Generator å‡½æ•°çš„æµç¨‹ç®¡ç†</strong> </p><p><code>Thunk</code> å‡½æ•°å¯ä»¥ç”¨äº <code>Generator</code> å‡½æ•°çš„è‡ªåŠ¨æµç¨‹ç®¡ç†ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">gen</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> g = <span class="title function_">gen</span>();</span><br><span class="line"><span class="keyword">let</span> res = g.<span class="title function_">next</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(!res.<span class="property">done</span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">value</span>);</span><br><span class="line">  res = g.<span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Generator</code> å‡½æ•°<code>gen</code>ä¼šè‡ªåŠ¨æ‰§è¡Œå®Œæ‰€æœ‰æ­¥éª¤ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™ä¸é€‚åˆå¼‚æ­¥æ“ä½œã€‚<ins>å¦‚æœå¿…é¡»ä¿è¯å‰ä¸€æ­¥æ‰§è¡Œå®Œï¼Œæ‰èƒ½æ‰§è¡Œåä¸€æ­¥ï¼Œä¸Šé¢çš„è‡ªåŠ¨æ‰§è¡Œå°±ä¸å¯è¡Œ</ins>ã€‚è¿™æ—¶ï¼Œ<code>Thunk</code> å‡½æ•°å°±èƒ½æ´¾ä¸Šç”¨å¤„ã€‚</p><p>ä»¥è¯»å–æ–‡ä»¶ä¸ºä¾‹ã€‚ä¸‹é¢çš„ <code>Generator</code> å‡½æ•°å°è£…äº†ä¸¤ä¸ªå¼‚æ­¥æ“ä½œã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> thunkify = <span class="built_in">require</span>(<span class="string">&#x27;thunkify&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> readFileThunk = <span class="title function_">thunkify</span>(fs.<span class="property">readFile</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> gen = <span class="keyword">function</span>* ()&#123;</span><br><span class="line">  <span class="keyword">let</span> r1 = <span class="keyword">yield</span> <span class="title function_">readFileThunk</span>(<span class="string">&#x27;/etc/fstab&#x27;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(r1.<span class="title function_">toString</span>());</span><br><span class="line">  <span class="keyword">let</span> r2 = <span class="keyword">yield</span> <span class="title function_">readFileThunk</span>(<span class="string">&#x27;/etc/shells&#x27;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(r2.<span class="title function_">toString</span>());</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<ins><code>yield</code>å‘½ä»¤ç”¨äºå°†ç¨‹åºçš„æ‰§è¡Œæƒç§»å‡º <code>Generator</code> å‡½æ•°ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸€ç§æ–¹æ³•ï¼Œå°†æ‰§è¡Œæƒå†äº¤è¿˜ç»™ <code>Generator</code> å‡½æ•°</ins>ã€‚</p><p>è¿™ç§æ–¹æ³•å°±æ˜¯ <code>Thunk</code> å‡½æ•°ï¼Œ<ins>å› ä¸ºå®ƒå¯ä»¥åœ¨å›è°ƒå‡½æ•°é‡Œï¼Œå°†æ‰§è¡Œæƒäº¤è¿˜ç»™ <code>Generator</code> å‡½æ•°</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> g = <span class="title function_">gen</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> r1 = g.<span class="title function_">next</span>();</span><br><span class="line">r1.<span class="title function_">value</span>(<span class="keyword">function</span> (<span class="params">err, data</span>) &#123; <span class="comment">// r1.value å°±æ˜¯ readFileThunk æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">if</span> (err)&#123;</span><br><span class="line">    <span class="keyword">throw</span> err; <span class="comment">// é”™è¯¯å¤„ç†</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> r2 = g.<span class="title function_">next</span>(data); <span class="comment">// å¦‚æœ data ä» readFileThunk æ–¹æ³•å›è°ƒå‡ºæ¥</span></span><br><span class="line">                         <span class="comment">// å½’è¿˜æ‰§è¡Œæƒï¼Œr1 èµ‹å€¼æˆåŠŸï¼Œè¿è¡Œè‡³ä¸‹ä¸€ä¸ª yield</span></span><br><span class="line">  r2.<span class="title function_">value</span>(<span class="keyword">function</span> (<span class="params">err, data</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (err)&#123;</span><br><span class="line">      <span class="keyword">throw</span> err;</span><br><span class="line">    &#125;</span><br><span class="line">    g.<span class="title function_">next</span>(data); </span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>g</code>æ˜¯ <code>Generator</code> å‡½æ•°çš„å†…éƒ¨æŒ‡é’ˆï¼Œè¡¨ç¤ºç›®å‰æ‰§è¡Œåˆ°å“ªä¸€æ­¥ã€‚<code>next</code>æ–¹æ³•è´Ÿè´£å°†æŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€æ­¥ï¼Œå¹¶è¿”å›è¯¥æ­¥çš„<code>value</code>å±æ€§å’Œ<code>done</code>å±æ€§ã€‚</p><p>ä»”ç»†çœ‹ä¸Šé¢çš„ä»£ç ï¼Œå¯ä»¥å‘ç° <code>Generator</code> å‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå…¶å®æ˜¯<ins>å°†åŒä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œåå¤ä¼ å…¥<code>next</code>æ–¹æ³•çš„<code>value</code>å±æ€§</ins>ã€‚è¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥ç”¨é€’å½’æ¥è‡ªåŠ¨å®Œæˆè¿™ä¸ªè¿‡ç¨‹ã€‚ï¼ˆç†è®ºä¸Šï¼‰</p><p><strong>ï¼ˆ6ï¼‰Thunk å‡½æ•°çš„è‡ªåŠ¨æµç¨‹ç®¡ç†</strong> </p><p><code>Thunk</code> å‡½æ•°çœŸæ­£çš„å¨åŠ›ï¼Œåœ¨äºå¯ä»¥è‡ªåŠ¨æ‰§è¡Œ <code>Generator</code> å‡½æ•°ã€‚ä¸‹é¢å°±æ˜¯ä¸€ä¸ªåŸºäº <code>Thunk</code> å‡½æ•°çš„ <code>Generator</code> æ‰§è¡Œå™¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">run</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> gen = <span class="title function_">fn</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">next</span>(<span class="params">err, data</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> result = gen.<span class="title function_">next</span>(data);</span><br><span class="line">    <span class="keyword">if</span> (result.<span class="property">done</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    result.<span class="title function_">value</span>(next);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">g</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">run</span>(g);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç çš„<code>run</code>å‡½æ•°ï¼Œå°±æ˜¯ä¸€ä¸ª <code>Generator</code> å‡½æ•°çš„è‡ªåŠ¨æ‰§è¡Œå™¨ã€‚å†…éƒ¨çš„<code>next</code>å‡½æ•°å°±æ˜¯ <code>Thunk</code> çš„å›è°ƒå‡½æ•°ã€‚<code>next</code>å‡½æ•°å…ˆå°†æŒ‡é’ˆç§»åˆ° <code>Generator</code> å‡½æ•°çš„ä¸‹ä¸€æ­¥ï¼ˆ<code>gen.next</code>æ–¹æ³•ï¼‰ï¼Œç„¶ååˆ¤æ–­ <code>Generator</code> å‡½æ•°æ˜¯å¦ç»“æŸï¼ˆ<code>result.done</code>å±æ€§ï¼‰ï¼Œå¦‚æœæ²¡ç»“æŸï¼Œå°±å°†<code>next</code>å‡½æ•°å†ä¼ å…¥ <code>Thunk</code> å‡½æ•°ï¼ˆ<code>result.value</code>å±æ€§ï¼‰ï¼Œå¦åˆ™å°±ç›´æ¥é€€å‡ºã€‚</p><p>æœ‰äº†è¿™ä¸ªæ‰§è¡Œå™¨ï¼Œæ‰§è¡Œ <code>Generator</code> å‡½æ•°æ–¹ä¾¿å¤šäº†ã€‚ä¸ç®¡å†…éƒ¨æœ‰å¤šå°‘ä¸ªå¼‚æ­¥æ“ä½œï¼Œç›´æ¥æŠŠ <code>Generator</code> å‡½æ•°ä¼ å…¥<code>run</code>å‡½æ•°å³å¯ã€‚æ³¨æ„ï¼Œ<ins>å‰ææ˜¯æ¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œéƒ½è¦æ˜¯ <code>Thunk</code> å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè·Ÿåœ¨<code>yield</code>å‘½ä»¤åé¢çš„å¿…é¡»æ˜¯ <code>Thunk</code> å‡½æ•°</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> g = <span class="keyword">function</span>* ()&#123;</span><br><span class="line">  <span class="keyword">let</span> f1 = <span class="keyword">yield</span> <span class="title function_">readFileThunk</span>(<span class="string">&#x27;fileA&#x27;</span>);</span><br><span class="line">  <span class="keyword">let</span> f2 = <span class="keyword">yield</span> <span class="title function_">readFileThunk</span>(<span class="string">&#x27;fileB&#x27;</span>);</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">let</span> fn = <span class="keyword">yield</span> <span class="title function_">readFileThunk</span>(<span class="string">&#x27;fileN&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">run</span>(g);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>g</code>å°è£…äº†<code>n</code>ä¸ªå¼‚æ­¥çš„è¯»å–æ–‡ä»¶æ“ä½œï¼Œåªè¦æ‰§è¡Œ<code>run</code>å‡½æ•°ï¼Œè¿™äº›æ“ä½œå°±ä¼šè‡ªåŠ¨å®Œæˆã€‚è¿™æ ·ä¸€æ¥ï¼Œå¼‚æ­¥æ“ä½œä¸ä»…å¯ä»¥å†™å¾—åƒåŒæ­¥æ“ä½œï¼Œè€Œä¸”ä¸€è¡Œä»£ç å°±å¯ä»¥æ‰§è¡Œã€‚</p><p><code>Thunk</code> å‡½æ•°å¹¶ä¸æ˜¯ <code>Generator</code> å‡½æ•°è‡ªåŠ¨æ‰§è¡Œçš„å”¯ä¸€æ–¹æ¡ˆã€‚å› ä¸ºè‡ªåŠ¨æ‰§è¡Œçš„å…³é”®æ˜¯ï¼Œå¿…é¡»æœ‰ä¸€ç§æœºåˆ¶ï¼Œè‡ªåŠ¨æ§åˆ¶ <code>Generator</code> å‡½æ•°çš„æµç¨‹ï¼Œæ¥æ”¶å’Œäº¤è¿˜ç¨‹åºçš„æ‰§è¡Œæƒã€‚å›è°ƒå‡½æ•°å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œ<code>Promise</code> å¯¹è±¡ä¹Ÿå¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><hr><h3 id="19-5-co-æ¨¡å—"><a href="#19-5-co-æ¨¡å—" class="headerlink" title="19.5 co æ¨¡å—"></a>19.5 co æ¨¡å—</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ª <code>Generator</code> å‡½æ•°ï¼Œç”¨äºä¾æ¬¡è¯»å–ä¸¤ä¸ªæ–‡ä»¶ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> gen = <span class="keyword">function</span>* () &#123;</span><br><span class="line">  <span class="keyword">let</span> f1 = <span class="keyword">yield</span> <span class="title function_">readFile</span>(<span class="string">&#x27;/etc/fstab&#x27;</span>);</span><br><span class="line">  <span class="keyword">let</span> f2 = <span class="keyword">yield</span> <span class="title function_">readFile</span>(<span class="string">&#x27;/etc/shells&#x27;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(f1.<span class="title function_">toString</span>());</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(f2.<span class="title function_">toString</span>());</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><a href="https://github.com/tj/co">co æ¨¡å—</a>å¯ä»¥ç”¨äº <code>Generator</code> å‡½æ•°çš„è‡ªåŠ¨æ‰§è¡Œï¼Œä¸ç”¨å†ç¼–å†™ <code>Generator</code> å‡½æ•°çš„æ‰§è¡Œå™¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> co = <span class="built_in">require</span>(<span class="string">&#x27;co&#x27;</span>);</span><br><span class="line"><span class="title function_">co</span>(gen);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Generator</code> å‡½æ•°åªè¦ä¼ å…¥<code>co</code>å‡½æ•°ï¼Œå°±ä¼šè‡ªåŠ¨æ‰§è¡Œã€‚</p><p><code>co</code>å‡½æ•°è¿”å›ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥ç”¨<code>then</code>æ–¹æ³•æ·»åŠ å›è°ƒå‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">co</span>(gen).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Generator å‡½æ•°æ‰§è¡Œå®Œæˆ&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œç­‰åˆ° <code>Generator</code> å‡½æ•°æ‰§è¡Œç»“æŸï¼Œå°±ä¼šè¾“å‡ºä¸€è¡Œæç¤ºã€‚</p><p><strong>ï¼ˆ1ï¼‰co æ¨¡å—çš„åŸç†</strong></p><p>ä¸ºä»€ä¹ˆ <code>co</code> å¯ä»¥è‡ªåŠ¨æ‰§è¡Œ <code>Generator</code> å‡½æ•°ï¼Ÿ</p><p>å‰é¢è¯´è¿‡ï¼Œ<ins><code>Generator</code> å°±æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„å®¹å™¨ã€‚å®ƒçš„è‡ªåŠ¨æ‰§è¡Œéœ€è¦ä¸€ç§æœºåˆ¶ï¼Œå½“å¼‚æ­¥æ“ä½œæœ‰äº†ç»“æœï¼Œèƒ½å¤Ÿè‡ªåŠ¨äº¤å›æ‰§è¡Œæƒ</ins>ã€‚</p><p>ä¸¤ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼š</p><ul><li>å›è°ƒå‡½æ•°ã€‚å°†å¼‚æ­¥æ“ä½œåŒ…è£…æˆ <code>Thunk</code> å‡½æ•°ï¼Œåœ¨å›è°ƒå‡½æ•°é‡Œé¢äº¤å›æ‰§è¡Œæƒã€‚</li><li><code>Promise</code> å¯¹è±¡ã€‚å°†å¼‚æ­¥æ“ä½œåŒ…è£…æˆ <code>Promise</code> å¯¹è±¡ï¼Œç”¨<code>then</code>æ–¹æ³•äº¤å›æ‰§è¡Œæƒã€‚</li></ul><p><code>co</code> æ¨¡å—å…¶å®å°±æ˜¯å°†ä¸¤ç§è‡ªåŠ¨æ‰§è¡Œå™¨ï¼ˆ<code>Thunk</code> å‡½æ•°å’Œ <code>Promise</code> å¯¹è±¡ï¼‰ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ¨¡å—ã€‚</p><ul><li>ä½¿ç”¨ <code>co</code> çš„å‰ææ¡ä»¶æ˜¯ï¼Œ<code>Generator</code> å‡½æ•°çš„<code>yield</code>å‘½ä»¤åé¢ï¼Œåªèƒ½æ˜¯ <code>Thunk</code> å‡½æ•°æˆ– <code>Promise</code> å¯¹è±¡ã€‚å¦‚æœæ•°ç»„æˆ–å¯¹è±¡çš„æˆå‘˜ï¼Œå…¨éƒ¨éƒ½æ˜¯ <code>Promise</code> å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>co</code>ã€‚</li></ul><p><strong>ï¼ˆ2ï¼‰åŸºäº Promise å¯¹è±¡çš„è‡ªåŠ¨æ‰§è¡Œ</strong></p><p>æ²¿ç”¨ä¸Šé¢çš„ä¾‹å­ã€‚é¦–å…ˆï¼ŒæŠŠ<code>fs</code>æ¨¡å—çš„<code>readFile</code>æ–¹æ³•åŒ…è£…æˆä¸€ä¸ª <code>Promise</code> å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> readFile = <span class="keyword">function</span> (<span class="params">fileName</span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>)&#123; <span class="comment">// Promise æ–°å»ºåç«‹å³æ‰§è¡Œ</span></span><br><span class="line">    fs.<span class="title function_">readFile</span>(fileName, <span class="keyword">function</span>(<span class="params">error, data</span>)&#123;</span><br><span class="line">      <span class="keyword">if</span> (error)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">reject</span>(error);</span><br><span class="line">      &#125; </span><br><span class="line">      <span class="title function_">resolve</span>(data); <span class="comment">// è¯»å–æˆåŠŸï¼Œä¼  data è¿› then æ–¹æ³•</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> gen = <span class="keyword">function</span>* ()&#123;</span><br><span class="line">  <span class="keyword">let</span> f1 = <span class="keyword">yield</span> <span class="title function_">readFile</span>(<span class="string">&#x27;/etc/fstab&#x27;</span>);</span><br><span class="line">  <span class="keyword">let</span> f2 = <span class="keyword">yield</span> <span class="title function_">readFile</span>(<span class="string">&#x27;/etc/shells&#x27;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(f1.<span class="title function_">toString</span>());</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(f2.<span class="title function_">toString</span>());</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œæ‰‹åŠ¨æ‰§è¡Œä¸Šé¢çš„ <code>Generator</code> å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> g = <span class="title function_">gen</span>();</span><br><span class="line"><span class="comment">// æ³¨æ„ï¼Œæ­¤æ—¶ gen.next().value æ˜¯ readFile è¿”å›çš„ Promise å¯¹è±¡</span></span><br><span class="line"><span class="comment">// resolve è¿”å›çš„ data è¿›å…¥å›è°ƒå‡½æ•°</span></span><br><span class="line">g.<span class="title function_">next</span>().<span class="property">value</span>.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">data</span>)&#123; </span><br><span class="line">  g.<span class="title function_">next</span>(data).<span class="property">value</span>.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">data</span>)&#123;</span><br><span class="line">    g.<span class="title function_">next</span>(data);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ‰‹åŠ¨æ‰§è¡Œå°±æ˜¯ç”¨<code>then</code>æ–¹æ³•ï¼Œå±‚å±‚æ·»åŠ å›è°ƒå‡½æ•°ã€‚ç†è§£äº†è¿™ä¸€ç‚¹ï¼Œå°±å¯ä»¥å†™å‡ºä¸€ä¸ªè‡ªåŠ¨æ‰§è¡Œå™¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">run</span>(<span class="params">gen</span>)&#123;</span><br><span class="line">  <span class="keyword">let</span> g = <span class="title function_">gen</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">next</span>(<span class="params">data</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> result = g.<span class="title function_">next</span>(data);</span><br><span class="line">    <span class="keyword">if</span> (result.<span class="property">done</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> result.<span class="property">value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    result.<span class="property">value</span>.<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">data</span>)&#123;</span><br><span class="line">      <span class="title function_">next</span>(data);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">run</span>(gen);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦ <code>Generator</code> å‡½æ•°è¿˜æ²¡æ‰§è¡Œåˆ°æœ€åä¸€æ­¥ï¼Œ<code>next</code>å‡½æ•°å°±è°ƒç”¨è‡ªèº«ï¼Œå®ç°è‡ªåŠ¨æ‰§è¡Œã€‚</p><p><strong>ï¼ˆ3ï¼‰co æ¨¡å—çš„æºç </strong></p><p>é¦–å…ˆï¼Œ<code>co</code> å‡½æ•°æ¥å— <code>Generator</code> å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ª <code>Promise</code> å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">co</span>(<span class="params">gen</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> ctx = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿”å›çš„ <code>Promise</code> å¯¹è±¡é‡Œé¢ï¼Œ<code>co</code> å…ˆæ£€æŸ¥å‚æ•°<code>gen</code>æ˜¯å¦ä¸º <code>Generator</code> å‡½æ•°ã€‚å¦‚æœæ˜¯ï¼Œå°±æ‰§è¡Œè¯¥å‡½æ•°ï¼Œå¾—åˆ°ä¸€ä¸ªå†…éƒ¨æŒ‡é’ˆå¯¹è±¡ï¼›å¦‚æœä¸æ˜¯å°±è¿”å›ï¼Œå¹¶å°† <code>Promise</code> å¯¹è±¡çš„çŠ¶æ€æ”¹ä¸º<code>resolved</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">co</span>(<span class="params">gen</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> ctx = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> gen === <span class="string">&#x27;function&#x27;</span>)&#123;</span><br><span class="line">      gen = gen.<span class="title function_">call</span>(ctx);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!gen || <span class="keyword">typeof</span> gen.<span class="property">next</span> !== <span class="string">&#x27;function&#x27;</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">resolve</span>(gen);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ç€ï¼Œ<code>co</code> å°† <code>Generator</code> å‡½æ•°çš„å†…éƒ¨æŒ‡é’ˆå¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼ŒåŒ…è£…æˆ<code>onFulfilled</code>å‡½æ•°ã€‚è¿™ä¸»è¦æ˜¯ä¸ºäº†èƒ½å¤Ÿæ•æ‰æŠ›å‡ºçš„é”™è¯¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">co</span>(<span class="params">gen</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> ctx = <span class="variable language_">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> gen === <span class="string">&#x27;function&#x27;</span>)&#123;</span><br><span class="line">      gen = gen.<span class="title function_">call</span>(ctx);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!gen || <span class="keyword">typeof</span> gen.<span class="property">next</span> !== <span class="string">&#x27;function&#x27;</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">resolve</span>(gen);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">onFulfilled</span>();</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">onFulfilled</span>(<span class="params">res</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> ret;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        ret = gen.<span class="title function_">next</span>(res);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">reject</span>(e);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">next</span>(ret);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œå°±æ˜¯å…³é”®çš„<code>next</code>å‡½æ•°ï¼Œå®ƒä¼šåå¤è°ƒç”¨è‡ªèº«ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">next</span>(<span class="params">ret</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (ret.<span class="property">done</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">resolve</span>(ret.<span class="property">value</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> value = toPromise.<span class="title function_">call</span>(ctx, ret.<span class="property">value</span>);</span><br><span class="line">  <span class="keyword">if</span> (value &amp;&amp; <span class="title function_">isPromise</span>(value))&#123;</span><br><span class="line">    <span class="keyword">return</span> value.<span class="title function_">then</span>(onFulfilled, onRejected);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">onRejected</span>(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">TypeError</span>(</span><br><span class="line">      <span class="string">&#x27;You may only yield a function, promise, generator, array, or object, &#x27;</span></span><br><span class="line">      + <span class="string">&#x27;but the following object was passed: &quot;&#x27;</span></span><br><span class="line">      + <span class="title class_">String</span>(ret.<span class="property">value</span>)</span><br><span class="line">      + <span class="string">&#x27;&quot;&#x27;</span></span><br><span class="line">    )</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>next</code>å‡½æ•°çš„å†…éƒ¨ä»£ç ï¼Œä¸€å…±åªæœ‰å››è¡Œå‘½ä»¤ã€‚</p><ul><li>æ£€æŸ¥å½“å‰æ˜¯å¦ä¸º <code>Generator</code> å‡½æ•°çš„æœ€åä¸€æ­¥ï¼Œå¦‚æœæ˜¯å°±è¿”å›ã€‚</li><li>ç¡®ä¿æ¯ä¸€æ­¥çš„è¿”å›å€¼ï¼Œæ˜¯ <code>Promise</code> å¯¹è±¡ã€‚</li><li><code>then</code>æ–¹æ³•ä¸ºè¿”å›å€¼åŠ ä¸Šå›è°ƒå‡½æ•°ï¼Œç„¶åé€šè¿‡<code>onFulfilled</code>å‡½æ•°å†æ¬¡è°ƒç”¨<code>next</code>å‡½æ•°ã€‚</li><li>åœ¨å‚æ•°ä¸ç¬¦åˆè¦æ±‚çš„æƒ…å†µä¸‹ï¼ˆå‚æ•°é <code>Thunk</code> å‡½æ•°å’Œ <code>Promise</code> å¯¹è±¡ï¼‰ï¼Œå°† <code>Promise</code> å¯¹è±¡çš„çŠ¶æ€æ”¹ä¸º<code>rejected</code>ï¼Œä»è€Œç»ˆæ­¢æ‰§è¡Œã€‚</li></ul><p><strong>ï¼ˆ4ï¼‰å¤„ç†å¹¶å‘çš„å¼‚æ­¥æ“ä½œ</strong></p><p><code>co</code> æ”¯æŒå¹¶å‘çš„å¼‚æ­¥æ“ä½œï¼Œå³å…è®¸æŸäº›æ“ä½œåŒæ—¶è¿›è¡Œï¼Œç­‰åˆ°å®ƒä»¬å…¨éƒ¨å®Œæˆï¼Œæ‰è¿›è¡Œä¸‹ä¸€æ­¥ã€‚è¿™æ—¶ï¼Œè¦æŠŠå¹¶å‘çš„æ“ä½œéƒ½æ”¾åœ¨æ•°ç»„æˆ–å¯¹è±¡é‡Œé¢ï¼Œè·Ÿåœ¨<code>yield</code>è¯­å¥åé¢ã€‚ï¼ˆ<a href="https://es6.ruanyifeng.com/#docs/generator-async#%E5%AE%9E%E4%BE%8B%EF%BC%9A%E5%A4%84%E7%90%86-Stream">ä¾‹å­</a>ï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ•°ç»„çš„å†™æ³•</span></span><br><span class="line"><span class="title function_">co</span>(<span class="keyword">function</span>* () &#123;</span><br><span class="line">  <span class="keyword">let</span> res = <span class="keyword">yield</span> [</span><br><span class="line">    <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">1</span>),</span><br><span class="line">    <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">2</span>)</span><br><span class="line">  ];</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">&#125;).<span class="title function_">catch</span>(onerror);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹è±¡çš„å†™æ³•</span></span><br><span class="line"><span class="title function_">co</span>(<span class="keyword">function</span>* () &#123;</span><br><span class="line">  <span class="keyword">let</span> res = <span class="keyword">yield</span> &#123;</span><br><span class="line">    <span class="number">1</span>: <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">1</span>),</span><br><span class="line">    <span class="number">2</span>: <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">2</span>),</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">&#125;).<span class="title function_">catch</span>(onerror);</span><br></pre></td></tr></table></figure><hr><h3 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h3><blockquote><p>è¯¥å­¦ä¹ ç¬”è®°çš„æ‰€æœ‰ç« èŠ‚å‡ä¿å­˜åœ¨<a href="https://github.com/Hongda-OSU/ES6-Journey">Github</a>ä¸­ï¼Œå¦‚æœ‰éœ€è¦ï¼Œå¯ä¸‹è½½å¹¶åœ¨<a href="https://typora.io/">Typora</a>ä¸­é˜…è¯»ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES6å­¦ä¹ ç¬”è®° â€¢ ä¸Š</title>
      <link href="/posts/fbe58254.html"/>
      <url>/posts/fbe58254.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>æœ¬è¯»ä¹¦ç¬”è®°èŠ‚é€‰è‡ªé˜®ä¸€å³°ç¼–å†™çš„ <a href="https://es6.ruanyifeng.com/">ã€ŠECMAScript 6 å…¥é—¨æ•™ç¨‹ã€‹</a>ã€‚é€‚åˆå·²ç»æŒæ¡ <code>ES5</code> çš„è¯»è€…ï¼Œç”¨æ¥äº†è§£è¿™é—¨è¯­è¨€çš„æœ€æ–°å‘å±•ã€‚ç¬”è®°å†…å®¹ä»…åŒ…æ‹¬æ—¥å¸¸å¼€å‘ä¸­å¯èƒ½ä¼šç”¨åˆ°çš„æ¦‚å¿µï¼Œå‰©ä½™éƒ¨åˆ†è¯·è‡ªè¡Œé˜…è¯»ã€‚</p></blockquote><hr><h2 id="1-let-å’Œ-const-å‘½ä»¤"><a href="#1-let-å’Œ-const-å‘½ä»¤" class="headerlink" title="1. let å’Œ const å‘½ä»¤"></a>1. let å’Œ const å‘½ä»¤</h2><h3 id="1-1-let-å‘½ä»¤"><a href="#1-1-let-å‘½ä»¤" class="headerlink" title="1.1 let å‘½ä»¤"></a>1.1 let å‘½ä»¤</h3><p><code>let</code>çš„ç”¨æ³•ç±»ä¼¼äº<code>var</code>ï¼Œä½†æ‰€å£°æ˜çš„å˜é‡åªåœ¨<code>let</code>å‘½ä»¤æ‰€åœ¨çš„ä»£ç å—ï¼ˆå³ <code>&#123;&#125;</code> åŒ…è£¹èµ·æ¥çš„å†…å®¹ï¼‰å†…æœ‰æ•ˆã€‚è€Œ<code>var</code>æ‰€å£°æ˜çš„å˜é‡åœ¨å…¨å±€èŒƒå›´å†…éƒ½æœ‰æ•ˆã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">a <span class="comment">// ReferenceError: a is not defined.</span></span><br><span class="line">b <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ1ï¼‰ä¸å­˜åœ¨å˜é‡æå‡</strong></p><p><code>var</code>å‘½ä»¤ä¼šå‘ç”Ÿ<ins>â€œå˜é‡æå‡â€ç°è±¡ï¼Œå³å˜é‡å¯ä»¥åœ¨å£°æ˜ä¹‹å‰ä½¿ç”¨ï¼Œå€¼ä¸º<code>undefined</code></ins>ã€‚ä¸ºäº†çº æ­£è¿™ç§ç°è±¡ï¼Œ<code>let</code>å‘½ä»¤æ”¹å˜äº†è¯­æ³•è¡Œä¸ºï¼Œå®ƒæ‰€å£°æ˜çš„å˜é‡ä¸€å®šè¦åœ¨å£°æ˜åä½¿ç”¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// var çš„æƒ…å†µ</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo); <span class="comment">// è¾“å‡º undefined</span></span><br><span class="line"><span class="keyword">var</span> foo = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// let çš„æƒ…å†µ</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(bar); <span class="comment">// æŠ¥é”™ ReferenceError</span></span><br><span class="line"><span class="keyword">let</span> bar = <span class="number">2</span>;</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ2ï¼‰æš‚æ—¶æ€§æ­»åŒº</strong></p><p>åªè¦<a href="https://blog.poetries.top/browser-working-principle/guide/part2/lesson09.html#%E4%BD%9C%E7%94%A8%E5%9F%9F-scope">å—çº§ä½œç”¨åŸŸ</a>å†…å­˜åœ¨<code>let</code>å’Œ<code>const</code>å‘½ä»¤ï¼Œå®ƒæ‰€å£°æ˜çš„å˜é‡å°±â€œç»‘å®šâ€ï¼ˆ<code>binding</code>ï¼‰è¿™ä¸ªåŒºåŸŸï¼Œä¸å†å—å¤–éƒ¨çš„å½±å“ã€‚å‡¡æ˜¯åœ¨å£°æ˜ä¹‹å‰å°±ä½¿ç”¨è¿™äº›å˜é‡ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> tmp = <span class="number">123</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="comment">// TDZ å¼€å§‹</span></span><br><span class="line">  tmp = <span class="string">&#x27;abc&#x27;</span>; <span class="comment">// ReferenceError</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(tmp); <span class="comment">// ReferenceError</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> tmp; <span class="comment">// TDZ ç»“æŸ</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(tmp); <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line">  tmp = <span class="number">123</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(tmp); <span class="comment">// 123</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="1-2-å—çº§ä½œç”¨åŸŸ"><a href="#1-2-å—çº§ä½œç”¨åŸŸ" class="headerlink" title="1.2 å—çº§ä½œç”¨åŸŸ"></a>1.2 å—çº§ä½œç”¨åŸŸ</h3><p><code>ES5</code> åªæœ‰å…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸï¼Œæ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œè¿™å¸¦æ¥å¾ˆå¤šä¸åˆç†çš„æƒ…å†µï¼š</p><p><strong>ï¼ˆ1ï¼‰å†…å±‚å˜é‡è¦†ç›–å¤–å±‚å˜é‡</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> tmp = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(tmp);</span><br><span class="line">  <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> tmp = <span class="string">&#x27;hello world&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">f</span>(); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç çš„åŸæ„æ˜¯ï¼Œ<code>if</code>ä»£ç å—çš„å¤–éƒ¨ä½¿ç”¨å¤–å±‚çš„<code>tmp</code>å˜é‡ï¼Œå†…éƒ¨ä½¿ç”¨å†…å±‚çš„<code>tmp</code>å˜é‡ã€‚ä½†æ˜¯å‡½æ•°<code>f</code>æ‰§è¡Œåï¼Œè¾“å‡ºç»“æœå´ä¸º<code>undefined</code>ã€‚</p><p><ins>åŸå› å…¶å®å°±æ˜¯å˜é‡æå‡ï¼Œå¯¼è‡´å†…å±‚çš„<code>tmp</code>å˜é‡è¦†ç›–äº†å¤–å±‚çš„<code>tmp</code>å˜é‡</ins>ã€‚å®é™…ä¸­çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> tmp = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> tmp; <span class="comment">// å£°æ˜ä½†æœªèµ‹å€¼ undefined</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(tmp); <span class="comment">// è¾“å‡º undefined</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</span><br><span class="line">    tmp = <span class="string">&#x27;hello world&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">f</span>(); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ2ï¼‰ç”¨æ¥è®¡æ•°çš„å¾ªç¯å˜é‡æ³„éœ²ä¸ºå…¨å±€å˜é‡</strong></p><p>ä¸‹é¢ä»£ç ä¸­ï¼Œå˜é‡<code>i</code>åªç”¨æ¥æ§åˆ¶å¾ªç¯ï¼Œä½†æ˜¯å¾ªç¯ç»“æŸåï¼Œå®ƒå¹¶æ²¡æœ‰æ¶ˆå¤±ï¼Œæ³„éœ²æˆäº†å…¨å±€å˜é‡ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; s.<span class="property">length</span>; i++) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(s[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(i); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure><p>ä¸ºäº†åº”å¯¹ä¸Šé¢è¿™äº›æƒ…å†µï¼Œ<code>ES6</code> æ–°å¢äº†å—çº§ä½œç”¨åŸŸï¼Œ<ins>å¤–å±‚ä½œç”¨åŸŸæ— æ³•è·å–åˆ°å†…å±‚ä½œç”¨åŸŸ</ins>ã€‚<ins>å³ä½¿å¤–å±‚å’Œå†…å±‚éƒ½ä½¿ç”¨ç›¸åŒå˜é‡åï¼Œä¹Ÿéƒ½äº’ä¸å¹²æ‰°</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> n = <span class="number">5</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> n = <span class="number">10</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(n); <span class="comment">// 5</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„å‡½æ•°æœ‰ä¸¤ä¸ªä»£ç å—ï¼Œéƒ½å£°æ˜äº†å˜é‡<code>n</code>ï¼Œè¿è¡Œåè¾“å‡º <code>5</code>ã€‚è¿™è¡¨ç¤ºå¤–å±‚ä»£ç å—ä¸å—å†…å±‚ä»£ç å—çš„å½±å“ã€‚å¦‚æœä¸¤æ¬¡éƒ½ä½¿ç”¨<code>var</code>å®šä¹‰å˜é‡<code>n</code>ï¼Œæœ€åè¾“å‡ºçš„å€¼å°±æ˜¯ <code>10</code>ã€‚</p><hr><h3 id="1-3-const-å‘½ä»¤"><a href="#1-3-const-å‘½ä»¤" class="headerlink" title="1.3 const å‘½ä»¤"></a>1.3 const å‘½ä»¤</h3><p><code>const</code>å£°æ˜ä¸€ä¸ªåªè¯»å¸¸é‡ã€‚ä¸€æ—¦å£°æ˜ï¼Œå¸¸é‡çš„å€¼å°±ä¸èƒ½æ”¹å˜ï¼Œ<ins>ä¸”å¿…é¡»ç«‹å³åˆå§‹åŒ–</ins>ã€‚ï¼ˆä¸ <code>let</code> ä¸€æ ·ï¼Œ<code>const</code> ä¸å­˜åœ¨å˜é‡æå‡ï¼Œå­˜åœ¨æš‚æ—¶æ€§æ­»åŒºï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">PI</span> = <span class="number">3.1415</span>;</span><br><span class="line"><span class="variable constant_">PI</span> <span class="comment">// 3.1415</span></span><br><span class="line"><span class="variable constant_">PI</span> = <span class="number">3</span>;</span><br><span class="line"><span class="comment">// TypeError: Assignment to constant variable.</span></span><br></pre></td></tr></table></figure><p><code>const</code>ä¿è¯çš„ï¼Œå¹¶ä¸æ˜¯å˜é‡çš„å€¼ä¸å¾—æ”¹åŠ¨ï¼Œ<ins>è€Œæ˜¯å˜é‡æŒ‡å‘çš„é‚£ä¸ªå†…å­˜åœ°å€æ‰€ä¿å­˜çš„æ•°æ®ä¸å¾—æ”¹åŠ¨</ins>ã€‚</p><ul><li>å¯¹äºç®€å•ç±»å‹çš„æ•°æ®ï¼ˆæ¯”å¦‚æ•°å€¼ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ï¼‰ï¼Œå€¼å°±ä¿å­˜åœ¨å˜é‡æŒ‡å‘çš„é‚£ä¸ªå†…å­˜åœ°å€ï¼Œå› æ­¤ç­‰åŒäºå¸¸é‡ã€‚</li><li>ä½†å¯¹äºå¤åˆç±»å‹çš„æ•°æ®ï¼ˆæ¯”å¦‚å¯¹è±¡ã€æ•°ç»„ï¼‰ï¼Œå˜é‡æŒ‡å‘çš„å†…å­˜åœ°å€ï¼Œä¿å­˜çš„åªæ˜¯ä¸€ä¸ªæŒ‡å‘å®é™…æ•°æ®çš„æŒ‡é’ˆã€‚<code>const</code>åªèƒ½ä¿è¯è¿™ä¸ªæŒ‡é’ˆæ˜¯å›ºå®šçš„ï¼Œè‡³äºå®ƒæŒ‡å‘çš„æ•°æ®ç»“æ„æ˜¯ä¸æ˜¯å¯å˜çš„ï¼Œå°±å®Œå…¨ä¸èƒ½æ§åˆ¶äº†ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸º foo æ·»åŠ ä¸€ä¸ªå±æ€§</span></span><br><span class="line">foo.<span class="property">prop</span> = <span class="number">123</span>;</span><br><span class="line">foo.<span class="property">prop</span> <span class="comment">// 123</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å°† foo æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ï¼ŒæŠ¥é”™</span></span><br><span class="line">foo = &#123;&#125;; <span class="comment">// TypeError: &quot;foo&quot; is read-only</span></span><br></pre></td></tr></table></figure><hr><h2 id="2-å˜é‡çš„è§£æ„èµ‹å€¼"><a href="#2-å˜é‡çš„è§£æ„èµ‹å€¼" class="headerlink" title="2. å˜é‡çš„è§£æ„èµ‹å€¼"></a>2. å˜é‡çš„è§£æ„èµ‹å€¼</h2><h3 id="2-1-æ•°ç»„çš„è§£æ„èµ‹å€¼"><a href="#2-1-æ•°ç»„çš„è§£æ„èµ‹å€¼" class="headerlink" title="2.1 æ•°ç»„çš„è§£æ„èµ‹å€¼"></a>2.1 æ•°ç»„çš„è§£æ„èµ‹å€¼</h3><p>ä»æ•°ç»„æˆ–å¯¹è±¡ä¸­æå–å€¼ï¼ŒæŒ‰ç…§å¯¹åº”ä½ç½®, å¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«ç§°ä¸ºè§£æ„ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> [a, b, c] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br></pre></td></tr></table></figure><p>è¿™ç§å†™æ³•å±äºâ€œæ¨¡å¼åŒ¹é…â€ï¼Œåªè¦ç­‰å·ä¸¤è¾¹çš„æ¨¡å¼ç›¸åŒï¼Œå·¦è¾¹çš„å˜é‡å°±ä¼šè¢«èµ‹äºˆå¯¹åº”çš„å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> [foo, [[bar], baz]] = [<span class="number">1</span>, [[<span class="number">2</span>], <span class="number">3</span>]];</span><br><span class="line">foo <span class="comment">// 1</span></span><br><span class="line">bar <span class="comment">// 2</span></span><br><span class="line">baz <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [ , , third] = [<span class="string">&quot;foo&quot;</span>, <span class="string">&quot;bar&quot;</span>, <span class="string">&quot;baz&quot;</span>];</span><br><span class="line">third <span class="comment">// &quot;baz&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [head, ...tail] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">head <span class="comment">// 1</span></span><br><span class="line">tail <span class="comment">// [2, 3, 4]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [x, y, ...z] = [<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">x <span class="comment">// &quot;a&quot;</span></span><br><span class="line">y <span class="comment">// undefined</span></span><br><span class="line">z <span class="comment">// []</span></span><br></pre></td></tr></table></figure><p>æ•°ç»„çš„è§£æ„èµ‹å€¼æœ‰ä¸¤ç§ç‰¹æ®Šæƒ…å†µï¼š</p><ul><li>è§£æ„ä¸æˆåŠŸï¼Œé‚£ä¹ˆå¯¹åº”å˜é‡çš„å€¼å°±ç­‰äº<code>undefined</code>ã€‚</li><li>ä¸å®Œå…¨è§£æ„ï¼Œç­‰å·å·¦è¾¹çš„æ¨¡å¼ï¼Œåªä¼šåŒ¹é…ä¸€éƒ¨åˆ†çš„ç­‰å·å³è¾¹çš„æ•°ç»„ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> [foo] = []; <span class="comment">// foo == undefined</span></span><br><span class="line"><span class="keyword">let</span> [bar, foo] = [<span class="number">1</span>]; <span class="comment">// foo == undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [a, [b], d] = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>], <span class="number">4</span>];</span><br><span class="line">a <span class="comment">// 1</span></span><br><span class="line">b <span class="comment">// 2</span></span><br><span class="line">d <span class="comment">// 4</span></span><br></pre></td></tr></table></figure><p>äº‹å®ä¸Šï¼Œåªè¦æŸç§æ•°æ®ç»“æ„å…·æœ‰ <code>Iterator</code> æ¥å£ï¼Œéƒ½å¯ä»¥é‡‡ç”¨æ•°ç»„å½¢å¼çš„è§£æ„èµ‹å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> [x, y, z] = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]); <span class="comment">// Set åŸç”Ÿå¸¦æœ‰ Iterator æ¥å£</span></span><br><span class="line">x <span class="comment">// &quot;a&quot;</span></span><br></pre></td></tr></table></figure><p>æ•°ç»„çš„è§£æ„èµ‹å€¼å¯ä»¥æŒ‡å®šé»˜è®¤å€¼ï¼Œå¹¶ä¸”<ins>å¿…é¡»ä¸¥æ ¼ç­‰äº<code>undefined</code></ins>æ‰ä¼šç”Ÿæ•ˆã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> [foo = <span class="literal">true</span>] = [];</span><br><span class="line">foo <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [x, y = <span class="string">&#x27;b&#x27;</span>] = [<span class="string">&#x27;a&#x27;</span>]; <span class="comment">// x=&#x27;a&#x27;, y=&#x27;b&#x27;</span></span><br><span class="line"><span class="keyword">let</span> [x, y = <span class="string">&#x27;b&#x27;</span>] = [<span class="string">&#x27;a&#x27;</span>, <span class="literal">undefined</span>]; <span class="comment">// x=&#x27;a&#x27;, y=&#x27;b&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [x = <span class="number">1</span>] = [<span class="literal">undefined</span>];</span><br><span class="line">x <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [x = <span class="number">1</span>] = [<span class="literal">null</span>];</span><br><span class="line">x <span class="comment">// null</span></span><br></pre></td></tr></table></figure><hr><h3 id="2-2-å¯¹è±¡çš„è§£æ„èµ‹å€¼"><a href="#2-2-å¯¹è±¡çš„è§£æ„èµ‹å€¼" class="headerlink" title="2.2 å¯¹è±¡çš„è§£æ„èµ‹å€¼"></a>2.2 å¯¹è±¡çš„è§£æ„èµ‹å€¼</h3><p>å¯¹è±¡çš„è§£æ„ä¸æ•°ç»„æœ‰ä¸€ä¸ªé‡è¦çš„ä¸åŒã€‚<ins>æ•°ç»„çš„å…ƒç´ æ˜¯æŒ‰æ¬¡åºæ’åˆ—çš„ï¼Œå˜é‡çš„å–å€¼ç”±å®ƒçš„ä½ç½®å†³å®š</ins>ã€‚<ins>è€Œå¯¹è±¡çš„å±æ€§æ²¡æœ‰æ¬¡åºï¼Œå˜é‡å¿…é¡»ä¸å±æ€§åŒåï¼Œæ‰èƒ½å–åˆ°æ­£ç¡®çš„å€¼</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123; bar, foo &#125; = &#123; <span class="attr">foo</span>: <span class="string">&#x27;aaa&#x27;</span>, <span class="attr">bar</span>: <span class="string">&#x27;bbb&#x27;</span> &#125;;</span><br><span class="line">foo <span class="comment">// &quot;aaa&quot;</span></span><br><span class="line">bar <span class="comment">// &quot;bbb&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123; baz &#125; = &#123; <span class="attr">foo</span>: <span class="string">&#x27;aaa&#x27;</span>, <span class="attr">bar</span>: <span class="string">&#x27;bbb&#x27;</span> &#125;;</span><br><span class="line">baz <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>å¦‚æœ<ins>å˜é‡åä¸å±æ€§åä¸ä¸€è‡´</ins>ï¼Œå¿…é¡»å†™æˆä¸‹é¢è¿™æ ·ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">first</span>: <span class="string">&#x27;hello&#x27;</span>, <span class="attr">last</span>: <span class="string">&#x27;world&#x27;</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> &#123; <span class="attr">first</span>: f, <span class="attr">last</span>: l &#125; = obj;</span><br><span class="line">f <span class="comment">// &#x27;hello&#x27;</span></span><br><span class="line">l <span class="comment">// &#x27;world&#x27;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œå¯¹è±¡çš„è§£æ„èµ‹å€¼çš„æœºåˆ¶ï¼Œæ˜¯<ins>å…ˆæ‰¾åˆ°åŒåå±æ€§ï¼Œç„¶åå†èµ‹ç»™å¯¹åº”çš„å˜é‡</ins>ï¼Œ<mark class="hl-label red">çœŸæ­£è¢«èµ‹å€¼çš„æ˜¯åè€…ï¼Œè€Œä¸æ˜¯å‰è€…</mark> ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123; <span class="attr">foo</span>: foo, <span class="attr">bar</span>: bar &#125; = &#123; <span class="attr">foo</span>: <span class="string">&#x27;aaa&#x27;</span>, <span class="attr">bar</span>: <span class="string">&#x27;bbb&#x27;</span> &#125;; </span><br><span class="line"><span class="comment">// let &#123;foo, bar&#125; = &#123; foo: &#x27;aaa&#x27;, bar: &#x27;bbb&#x27; &#125;; </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123; <span class="attr">foo</span>: baz &#125; = &#123; <span class="attr">foo</span>: <span class="string">&#x27;aaa&#x27;</span>, <span class="attr">bar</span>: <span class="string">&#x27;bbb&#x27;</span> &#125;;</span><br><span class="line">baz <span class="comment">// &quot;aaa&quot;</span></span><br><span class="line">foo <span class="comment">// error: foo is not defined</span></span><br></pre></td></tr></table></figure><p>è§£æ„ä¹Ÿå¯ä»¥ç”¨äºåµŒå¥—ç»“æ„çš„å¯¹è±¡ã€‚ä¸‹é¢ä»£ç åˆ†åˆ«å¯¹<code>p</code>ï¼Œ<code>x</code>ï¼Œ<code>y</code>ä¸‰ä¸ªå±æ€§è¿›è¡Œè§£æ„èµ‹å€¼ã€‚æ³¨æ„ï¼Œåœ¨å¯¹<code>x</code>ï¼Œ<code>y</code>å±æ€§çš„è§£æ„èµ‹å€¼ä¹‹ä¸­ï¼Œ<code>x</code>ï¼Œ<code>y</code>æ˜¯å˜é‡ï¼Œ<code>p</code>æ˜¯æ¨¡å¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  <span class="attr">p</span>: [</span><br><span class="line">    <span class="string">&#x27;Hello&#x27;</span>,</span><br><span class="line">    &#123; <span class="attr">y</span>: <span class="string">&#x27;World&#x27;</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123; p, <span class="attr">p</span>: [x, &#123; y &#125;] &#125; = obj;</span><br><span class="line">p <span class="comment">// [&quot;Hello&quot;, &#123;y: &quot;World&quot;&#125;]</span></span><br><span class="line">x <span class="comment">// &quot;Hello&quot;</span></span><br><span class="line">y <span class="comment">// &quot;World&quot;</span></span><br></pre></td></tr></table></figure><p>å¯¹è±¡çš„è§£æ„ä¹Ÿå¯ä»¥æŒ‡å®šé»˜è®¤å€¼ï¼Œå¹¶ä¸”å¿…é¡»ä¸¥æ ¼ç­‰äº<code>undefined</code>æ‰ä¼šç”Ÿæ•ˆã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123;x = <span class="number">3</span>&#125; = &#123;&#125;;</span><br><span class="line">x <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123;x, y = <span class="number">5</span>&#125; = &#123;<span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="literal">undefined</span>&#125;;</span><br><span class="line">x <span class="comment">// 1</span></span><br><span class="line">y <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123;<span class="attr">x</span>: y = <span class="number">3</span>&#125; = &#123;&#125;;</span><br><span class="line">y <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123;<span class="attr">x</span>: y = <span class="number">3</span>&#125; = &#123;<span class="attr">x</span>: <span class="number">5</span>&#125;;</span><br><span class="line">y <span class="comment">// 5</span></span><br></pre></td></tr></table></figure><hr><h3 id="2-3-å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼"><a href="#2-3-å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼" class="headerlink" title="2.3 å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼"></a>2.3 å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼</h3><p>å‡½æ•°çš„å‚æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨è§£æ„èµ‹å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">move</span>(<span class="params">&#123;x = <span class="number">0</span>, y = <span class="number">0</span>&#125; = &#123;&#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> [x, y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">move</span>(&#123;<span class="attr">x</span>: <span class="number">3</span>, <span class="attr">y</span>: <span class="number">8</span>&#125;); <span class="comment">// [3, 8]</span></span><br><span class="line"><span class="title function_">move</span>(&#123;<span class="attr">x</span>: <span class="number">3</span>&#125;); <span class="comment">// [3, 0]</span></span><br><span class="line"><span class="title function_">move</span>(&#123;&#125;); <span class="comment">// [0, 0]</span></span><br><span class="line"><span class="title function_">move</span>(); <span class="comment">// [0, 0]</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>move</code>çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚é€šè¿‡å¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œè§£æ„ï¼Œå¾—åˆ°å˜é‡<code>x</code>å’Œ<code>y</code>çš„å€¼ã€‚å¦‚æœè§£æ„å¤±è´¥ï¼Œ<code>x</code>å’Œ<code>y</code>ç­‰äºé»˜è®¤å€¼ã€‚</p><p>æ³¨æ„ï¼Œä¸‹é¢çš„å†™æ³•ä¼šå¾—åˆ°ä¸ä¸Šé¢ä¸ä¸€æ ·çš„ç»“æœã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">move</span>(<span class="params">&#123;x, y&#125; = &#123; x: <span class="number">0</span>, y: <span class="number">0</span> &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> [x, y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">move</span>(&#123;<span class="attr">x</span>: <span class="number">3</span>, <span class="attr">y</span>: <span class="number">8</span>&#125;); <span class="comment">// [3, 8]</span></span><br><span class="line"><span class="title function_">move</span>(&#123;<span class="attr">x</span>: <span class="number">3</span>&#125;); <span class="comment">// [3, undefined]</span></span><br><span class="line"><span class="title function_">move</span>(&#123;&#125;); <span class="comment">// [undefined, undefined]</span></span><br><span class="line"><span class="title function_">move</span>(); <span class="comment">// [0, 0]</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç <ins>ä¸ºå‡½æ•°<code>move</code>çš„å‚æ•°æŒ‡å®šé»˜è®¤å€¼ï¼Œè€Œä¸æ˜¯ä¸ºå˜é‡<code>x</code>å’Œ<code>y</code>æŒ‡å®šé»˜è®¤å€¼</ins>ã€‚å½“å‚æ•°ä¸º<code>undefined</code>æ—¶ï¼Œå‚æ•°é»˜è®¤å€¼å¯ç”¨ã€‚</p><hr><h3 id="2-4-è§£æ„èµ‹å€¼çš„ç”¨é€”"><a href="#2-4-è§£æ„èµ‹å€¼çš„ç”¨é€”" class="headerlink" title="2.4 è§£æ„èµ‹å€¼çš„ç”¨é€”"></a>2.4 è§£æ„èµ‹å€¼çš„ç”¨é€”</h3><p><strong>ï¼ˆ1ï¼‰äº¤æ¢å˜é‡çš„å€¼</strong></p><p>ä¸‹é¢ä»£ç äº¤æ¢å˜é‡<code>x</code>å’Œ<code>y</code>çš„å€¼ï¼Œè¿™æ ·çš„å†™æ³•ç®€æ´æ˜“è¯»ï¼Œè¯­ä¹‰æ¸…æ™°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> y = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">[x, y] = [y, x]; <span class="comment">// x = 2, y = 1</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ2ï¼‰ä»å‡½æ•°è¿”å›å¤šä¸ªå€¼</strong></p><p>å‡½æ•°åªèƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œå¦‚æœè¦è¿”å›å¤šä¸ªå€¼ï¼Œåªèƒ½å°†å®ƒä»¬æ”¾åœ¨æ•°ç»„æˆ–å¯¹è±¡é‡Œè¿”å›ã€‚æœ‰äº†è§£æ„èµ‹å€¼ï¼Œå–å‡ºè¿™äº›å€¼å°±éå¸¸æ–¹ä¾¿ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¿”å›ä¸€ä¸ªæ•°ç»„</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">example</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> [a, b, c] = <span class="title function_">example</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å›ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">example</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">foo</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">bar</span>: <span class="number">2</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> &#123; foo, bar &#125; = <span class="title function_">example</span>();</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ3ï¼‰æå– JSON æ•°æ®</strong></p><p>è§£æ„èµ‹å€¼å¯¹æå– <code>JSON</code> å¯¹è±¡ä¸­çš„æ•°æ®ï¼Œå°¤å…¶æœ‰ç”¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> jsonData = &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="number">42</span>,</span><br><span class="line">  <span class="attr">status</span>: <span class="string">&quot;OK&quot;</span>,</span><br><span class="line">  <span class="attr">data</span>: [<span class="number">867</span>, <span class="number">5309</span>]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123; id, status, <span class="attr">data</span>: number &#125; = jsonData;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(id, status, number);</span><br><span class="line"><span class="comment">// 42, &quot;OK&quot;, [867, 5309]</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ4ï¼‰å‡½æ•°å‚æ•°çš„å®šä¹‰</strong></p><p>è§£æ„èµ‹å€¼å¯ä»¥æ–¹ä¾¿åœ°å°†ä¸€ç»„å‚æ•°ä¸å˜é‡åå¯¹åº”èµ·æ¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‚æ•°æ˜¯ä¸€ç»„æœ‰æ¬¡åºçš„å€¼</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">[x, y, z]</span>) &#123; ... &#125;</span><br><span class="line"><span class="title function_">f</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‚æ•°æ˜¯ä¸€ç»„æ— æ¬¡åºçš„å€¼</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">&#123;x, y, z&#125;</span>) &#123; ... &#125;</span><br><span class="line"><span class="title function_">f</span>(&#123;<span class="attr">z</span>: <span class="number">3</span>, <span class="attr">y</span>: <span class="number">2</span>, <span class="attr">x</span>: <span class="number">1</span>&#125;);</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ5ï¼‰éå† Map ç»“æ„</strong></p><p>å‰é¢æåˆ°ï¼Œä»»ä½•éƒ¨ç½²äº† <code>Iterator</code> æ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ç”¨<code>for...of</code>å¾ªç¯éå†ã€‚<code>Map</code> ç»“æ„åŸç”Ÿæ”¯æŒ <code>Iterator</code> æ¥å£ï¼Œé…åˆå˜é‡çš„è§£æ„èµ‹å€¼ï¼Œè·å–é”®åå’Œé”®å€¼å°±éå¸¸æ–¹ä¾¿ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">map.<span class="title function_">set</span>(<span class="string">&#x27;first&#x27;</span>, <span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line">map.<span class="title function_">set</span>(<span class="string">&#x27;second&#x27;</span>, <span class="string">&#x27;world&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(key + <span class="string">&quot; is &quot;</span> + value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// first is hello</span></span><br><span class="line"><span class="comment">// second is world</span></span><br></pre></td></tr></table></figure><hr><h2 id="3-å­—ç¬¦ä¸²çš„æ‰©å±•"><a href="#3-å­—ç¬¦ä¸²çš„æ‰©å±•" class="headerlink" title="3. å­—ç¬¦ä¸²çš„æ‰©å±•"></a>3. å­—ç¬¦ä¸²çš„æ‰©å±•</h2><p><a href="https://es6.ruanyifeng.com/#docs/string">æœ¬ç« </a>å†…å®¹å¤æ‚ï¼Œæ•…å…ˆè·³è¿‡ä¸€éƒ¨åˆ†ã€‚</p><h3 id="3-1-æ¨¡æ¿å­—ç¬¦ä¸²"><a href="#3-1-æ¨¡æ¿å­—ç¬¦ä¸²" class="headerlink" title="3.1 æ¨¡æ¿å­—ç¬¦ä¸²"></a>3.1 æ¨¡æ¿å­—ç¬¦ä¸²</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$(<span class="string">&#x27;#result&#x27;</span>).<span class="title function_">append</span>(<span class="string">`</span></span><br><span class="line"><span class="string">  There are &lt;b&gt;<span class="subst">$&#123;basket.count&#125;</span>&lt;/b&gt; items</span></span><br><span class="line"><span class="string">   in your basket, &lt;em&gt;<span class="subst">$&#123;basket.onSale&#125;</span>&lt;/em&gt;</span></span><br><span class="line"><span class="string">  are on sale!</span></span><br><span class="line"><span class="string">`</span>);</span><br></pre></td></tr></table></figure><p>æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆ<code>template string</code>ï¼‰æ˜¯å¢å¼ºç‰ˆçš„å­—ç¬¦ä¸²ã€‚å®ƒå¯ä»¥å½“ä½œæ™®é€šå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œæˆ–è€…åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡</span></span><br><span class="line"><span class="keyword">let</span> name = <span class="string">&quot;Bob&quot;</span>, time = <span class="string">&quot;today&quot;</span>;</span><br><span class="line"><span class="string">`Hello <span class="subst">$&#123;name&#125;</span>, how are you <span class="subst">$&#123;time&#125;</span>?`</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œå¦‚æœä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²è¡¨ç¤ºå¤šè¡Œå­—ç¬¦ä¸²ï¼Œæ‰€æœ‰çš„ç©ºæ ¼ï¼Œæ¢è¡Œï¼Œç¼©è¿›éƒ½ä¼šè¢«ä¿ç•™åœ¨è¾“å‡ºä¹‹ä¸­ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> str1 = <span class="string">&#x27;Hello&#x27;</span> +</span><br><span class="line">    <span class="string">&#x27;World&#x27;</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">let</span> str2 = <span class="string">`Hello</span></span><br><span class="line"><span class="string">World`</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str1); <span class="comment">// HelloWorld</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str2); <span class="comment">// Hello</span></span><br><span class="line">                   <span class="comment">// World æ¢è¡Œè¢«ä¿ç•™</span></span><br></pre></td></tr></table></figure><hr><h3 id="3-2-æ ‡ç­¾æ¨¡æ¿"><a href="#3-2-æ ‡ç­¾æ¨¡æ¿" class="headerlink" title="3.2 æ ‡ç­¾æ¨¡æ¿"></a>3.2 æ ‡ç­¾æ¨¡æ¿</h3><p>æ¨¡æ¿å­—ç¬¦ä¸²å¯ä»¥ç´§è·Ÿåœ¨ä¸€ä¸ªå‡½æ•°ååé¢ï¼Œè¯¥å‡½æ•°å°†è¢«è°ƒç”¨æ¥å¤„ç†è¿™ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ã€‚è¿™è¢«ç§°ä¸ºâ€œæ ‡ç­¾æ¨¡æ¿â€åŠŸèƒ½ï¼ˆ<code>tagged template</code>ï¼‰ã€‚</p><ul><li>æ ‡ç­¾æ¨¡æ¿ä¸æ˜¯æ¨¡æ¿ï¼Œè€Œæ˜¯å‡½æ•°è°ƒç”¨çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚â€œæ ‡ç­¾â€æŒ‡çš„æ˜¯å‡½æ•°ï¼Œå®ƒçš„å‚æ•°æ˜¯ç´§è·Ÿåœ¨åé¢çš„æ¨¡æ¿å­—ç¬¦ä¸²ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">alert<span class="string">`hello`</span></span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="title function_">alert</span>([<span class="string">&#x27;hello&#x27;</span>])</span><br></pre></td></tr></table></figure><p>å¦‚æœæ¨¡æ¿å­—ç¬¦é‡Œé¢æœ‰å˜é‡ï¼Œå°±ä¸æ˜¯ç›´æ¥è°ƒç”¨äº†ã€‚ä¼šå…ˆå°†æ¨¡æ¿å­—ç¬¦ä¸²å…ˆå¤„ç†æˆå¤šä¸ªå‚æ•°ï¼Œå†è°ƒç”¨å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">let</span> b = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">tag</span>(<span class="params">stringArr, ...values</span>)&#123; ... &#125;</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">tag</span>(<span class="params">stringArr, value1, value2</span>)&#123; ... &#125;</span><br><span class="line"></span><br><span class="line">tag<span class="string">`Hello <span class="subst">$&#123; a + b &#125;</span> world <span class="subst">$&#123; a * b &#125;</span>`</span>;</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="title function_">tag</span>([<span class="string">&#x27;Hello &#x27;</span>, <span class="string">&#x27; world &#x27;</span>, <span class="string">&#x27;&#x27;</span>], <span class="number">15</span>, <span class="number">50</span>); </span><br></pre></td></tr></table></figure><hr><h2 id="4-å­—ç¬¦ä¸²çš„æ–°å¢æ–¹æ³•"><a href="#4-å­—ç¬¦ä¸²çš„æ–°å¢æ–¹æ³•" class="headerlink" title="4. å­—ç¬¦ä¸²çš„æ–°å¢æ–¹æ³•"></a>4. å­—ç¬¦ä¸²çš„æ–°å¢æ–¹æ³•</h2><h3 id="4-1-æ–°å¢æ–¹æ³•"><a href="#4-1-æ–°å¢æ–¹æ³•" class="headerlink" title="4.1 æ–°å¢æ–¹æ³•"></a>4.1 æ–°å¢æ–¹æ³•</h3><p><strong>å®ä¾‹æ–¹æ³• 1ï¼š</strong><code>ES5</code> ä¸­åªæœ‰<code>indexOf()</code>æ–¹æ³•å¯ä»¥ç”¨æ¥ç¡®å®šä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ…å«åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚<code>ES6</code> åˆæä¾›äº†ä¸‰ç§æ–°æ–¹æ³•ï¼š</p><ul><li><code>includes()</code>ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ‰¾åˆ°äº†å‚æ•°å­—ç¬¦ä¸²ã€‚</li><li><code>startsWith()</code>ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨åŸå­—ç¬¦ä¸²çš„å¤´éƒ¨ã€‚</li><li><code>endsWith()</code>ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨åŸå­—ç¬¦ä¸²çš„å°¾éƒ¨ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">&#x27;Hello world!&#x27;</span>;</span><br><span class="line"></span><br><span class="line">s.<span class="title function_">startsWith</span>(<span class="string">&#x27;Hello&#x27;</span>) <span class="comment">// true</span></span><br><span class="line">s.<span class="title function_">endsWith</span>(<span class="string">&#x27;!&#x27;</span>) <span class="comment">// true</span></span><br><span class="line">s.<span class="title function_">includes</span>(<span class="string">&#x27;o&#x27;</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸‰ä¸ªæ–¹æ³•éƒ½æ”¯æŒç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºå¼€å§‹æœç´¢çš„ä½ç½®ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">&#x27;Hello world!&#x27;</span>;</span><br><span class="line"></span><br><span class="line">s.<span class="title function_">startsWith</span>(<span class="string">&#x27;world&#x27;</span>, <span class="number">6</span>) <span class="comment">// true</span></span><br><span class="line">s.<span class="title function_">endsWith</span>(<span class="string">&#x27;Hello&#x27;</span>, <span class="number">5</span>) <span class="comment">// true</span></span><br><span class="line">s.<span class="title function_">includes</span>(<span class="string">&#x27;Hello&#x27;</span>, <span class="number">6</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°<code>n</code>æ—¶ï¼Œ<code>endsWith()</code>çš„è¡Œä¸ºä¸å…¶ä»–ä¸¤ä¸ªæ–¹æ³•ä¸åŒã€‚å®ƒé’ˆå¯¹å‰<code>n</code>ä¸ªå­—ç¬¦ï¼Œè€Œå…¶ä»–ä¸¤ä¸ªæ–¹æ³•é’ˆå¯¹ä»ç¬¬<code>n</code>ä¸ªä½ç½®ç›´åˆ°å­—ç¬¦ä¸²ç»“æŸã€‚</p><p><strong>å®ä¾‹æ–¹æ³• 2ï¼š</strong><code>repeat()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œå°†åŸå­—ç¬¦ä¸²é‡å¤<code>n</code>æ¬¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;na&#x27;</span>.<span class="title function_">repeat</span>(<span class="number">3</span>) <span class="comment">// &quot;nana&quot;</span></span><br><span class="line"><span class="string">&#x27;na&#x27;</span>.<span class="title function_">repeat</span>(<span class="string">&#x27;2&#x27;</span>) <span class="comment">// &quot;nana&quot; è½¬æ¢æˆæ•°å­—</span></span><br><span class="line"><span class="string">&#x27;na&#x27;</span>.<span class="title function_">repeat</span>(<span class="number">0</span>) <span class="comment">// &quot;&quot;</span></span><br><span class="line"><span class="string">&#x27;na&#x27;</span>.<span class="title function_">repeat</span>(<span class="number">2.9</span>) <span class="comment">// &quot;nana&quot; å–æ•´</span></span><br><span class="line"><span class="string">&#x27;na&#x27;</span>.<span class="title function_">repeat</span>(-<span class="number">1</span>) <span class="comment">// RangeError</span></span><br></pre></td></tr></table></figure><p><strong>å®ä¾‹æ–¹æ³• 3ï¼š</strong><code>ES6</code> å¼•å…¥å­—ç¬¦ä¸²è¡¥å…¨é•¿åº¦åŠŸèƒ½ï¼Œèƒ½åœ¨æŸä¸ªå­—ç¬¦ä¸²ä¸å¤ŸæŒ‡å®šé•¿åº¦æ—¶ï¼Œå¾€å¤´éƒ¨æˆ–å°¾éƒ¨è¡¥å…¨ã€‚<code>padStart()</code>ç”¨äºå¤´éƒ¨è¡¥å…¨ï¼Œ<code>padEnd()</code>ç”¨äºå°¾éƒ¨è¡¥å…¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;x&#x27;</span>.<span class="title function_">padStart</span>(<span class="number">5</span>, <span class="string">&#x27;ab&#x27;</span>) <span class="comment">// &#x27;ababx&#x27; è¡¥åˆ°length == 5</span></span><br><span class="line"><span class="string">&#x27;abc&#x27;</span>.<span class="title function_">padStart</span>(<span class="number">10</span>, <span class="string">&#x27;0123456789&#x27;</span>)</span><br><span class="line"><span class="comment">// &#x27;0123456abc&#x27; å¦‚æœä¸¤è€…çš„é•¿åº¦ä¹‹å’Œè¶…è¿‡äº†æœ€å¤§é•¿åº¦ï¼Œåˆ™ä¼šæˆªå»è¶…å‡ºçš„ä½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;x&#x27;</span>.<span class="title function_">padEnd</span>(<span class="number">5</span>, <span class="string">&#x27;ab&#x27;</span>) <span class="comment">// &#x27;xabab&#x27;</span></span><br><span class="line"><span class="string">&#x27;x&#x27;</span>.<span class="title function_">padEnd</span>(<span class="number">4</span>, <span class="string">&#x27;ab&#x27;</span>) <span class="comment">// &#x27;xaba&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>å®ä¾‹æ–¹æ³• 4ï¼š</strong><code>ES6</code> æ–°å¢äº†<code>trimStart()</code>å’Œ<code>trimEnd()</code>ä¸¤ä¸ªæ–¹æ³•ã€‚å®ƒä»¬çš„è¡Œä¸ºä¸<code>trim()</code>ä¸€è‡´ï¼Œ<code>trimStart()</code>æ¶ˆé™¤å­—ç¬¦ä¸²å¤´éƒ¨çš„ç©ºæ ¼ï¼Œ<code>trimEnd()</code>æ¶ˆé™¤å°¾éƒ¨çš„ç©ºæ ¼ã€‚å®ƒä»¬è¿”å›çš„éƒ½æ˜¯æ–°å­—ç¬¦ä¸²ï¼Œä¸ä¼šä¿®æ”¹åŸå§‹å­—ç¬¦ä¸²ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> s = <span class="string">&#x27;  abc  &#x27;</span>;</span><br><span class="line"></span><br><span class="line">s.<span class="title function_">trim</span>() <span class="comment">// &quot;abc&quot;</span></span><br><span class="line">s.<span class="title function_">trimStart</span>() <span class="comment">// &quot;abc  &quot;</span></span><br><span class="line">s.<span class="title function_">trimEnd</span>() <span class="comment">// &quot;  abc&quot;</span></span><br></pre></td></tr></table></figure><p><strong>å®ä¾‹æ–¹æ³• 5ï¼š</strong><code>ES5</code>ä¸­ï¼Œ<code>replace()</code>åªèƒ½æ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…ã€‚å¦‚æœè¦æ›¿æ¢æ‰€æœ‰çš„åŒ¹é…ï¼Œéœ€è¦ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„<code>g</code>ä¿®é¥°ç¬¦ã€‚<code>ES6</code>å¼•å…¥äº†<code>replaceAll()</code>æ–¹æ³•ï¼Œå¯ä»¥ä¸€æ¬¡æ€§æ›¿æ¢æ‰€æœ‰åŒ¹é…ã€‚å®ƒè¿”å›çš„æ˜¯æ–°å­—ç¬¦ä¸²ï¼Œä¸ä¼šä¿®æ”¹åŸå§‹å­—ç¬¦ä¸²ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;aabbcc&#x27;</span>.<span class="title function_">replace</span>(<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;_&#x27;</span>)</span><br><span class="line"><span class="comment">// &#x27;aa_bcc&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;aabbcc&#x27;</span>.<span class="title function_">replace</span>(<span class="regexp">/b/g</span>, <span class="string">&#x27;_&#x27;</span>)</span><br><span class="line"><span class="comment">// &#x27;aa__cc&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;aabbcc&#x27;</span>.<span class="title function_">replaceAll</span>(<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;_&#x27;</span>)</span><br><span class="line"><span class="comment">// &#x27;aa__cc&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>å®ä¾‹æ–¹æ³• 6ï¼š</strong><code>ES6</code> å¢åŠ äº†<code>matchAll()</code>æ–¹æ³•ï¼Œå¯ä»¥ä¸€æ¬¡æ€§å–å‡ºå­—ç¬¦ä¸²é‡Œé¢æ‰€æœ‰åŒ¹é…ã€‚ä½†æ˜¯ï¼Œå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªéå†å™¨ï¼Œè€Œä¸æ˜¯æ•°ç»„ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> string = <span class="string">&#x27;test1test2test3&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/t(e)(st(\d?))/g</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> match <span class="keyword">of</span> string.<span class="title function_">matchAll</span>(regex)) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(match);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// [&quot;test1&quot;, &quot;e&quot;, &quot;st1&quot;, &quot;1&quot;, index: 0, input: &quot;test1test2test3&quot;]</span></span><br><span class="line"><span class="comment">// [&quot;test2&quot;, &quot;e&quot;, &quot;st2&quot;, &quot;2&quot;, index: 5, input: &quot;test1test2test3&quot;]</span></span><br><span class="line"><span class="comment">// [&quot;test3&quot;, &quot;e&quot;, &quot;st3&quot;, &quot;3&quot;, index: 10, input: &quot;test1test2test3&quot;]</span></span><br></pre></td></tr></table></figure><p>éå†å™¨è½¬ä¸ºæ•°ç»„æ˜¯éå¸¸ç®€å•çš„ï¼Œä½¿ç”¨<code>...</code>è¿ç®—ç¬¦å’Œ<code>Array.from()</code>æ–¹æ³•å°±å¯ä»¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è½¬ä¸ºæ•°ç»„çš„æ–¹æ³•ä¸€</span></span><br><span class="line">[...string.<span class="title function_">matchAll</span>(regex)]</span><br><span class="line"></span><br><span class="line"><span class="comment">// è½¬ä¸ºæ•°ç»„çš„æ–¹æ³•äºŒ</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">from</span>(string.<span class="title function_">matchAll</span>(regex))</span><br></pre></td></tr></table></figure><hr><h2 id="5-æ­£åˆ™çš„æ‰©å±•"><a href="#5-æ­£åˆ™çš„æ‰©å±•" class="headerlink" title="5. æ­£åˆ™çš„æ‰©å±•"></a>5. æ­£åˆ™çš„æ‰©å±•</h2><p><a href="https://es6.ruanyifeng.com/#docs/regex">æœ¬ç« </a>å†…å®¹å¤æ‚ï¼Œæ•…å…ˆè·³è¿‡ä¸€éƒ¨åˆ†ã€‚</p><h3 id="5-1-å…·åç»„åŒ¹é…"><a href="#5-1-å…·åç»„åŒ¹é…" class="headerlink" title="5.1 å…·åç»„åŒ¹é…"></a>5.1 å…·åç»„åŒ¹é…</h3><p>æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨åœ†æ‹¬å·è¿›è¡Œ<a href="https://segmentfault.com/a/1190000021043947">ç»„åŒ¹é…</a>ã€‚ä½¿ç”¨<code>exec</code>æ–¹æ³•ï¼Œå°±å¯ä»¥å°†è¿™åŒ¹é…ç»“æœæå–å‡ºæ¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">RE_DATE</span> = <span class="regexp">/(\d&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;)/</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> matchObj = <span class="variable constant_">RE_DATE</span>.<span class="title function_">exec</span>(<span class="string">&#x27;1999-12-31&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> year = matchObj[<span class="number">1</span>]; <span class="comment">// 1999</span></span><br><span class="line"><span class="keyword">const</span> month = matchObj[<span class="number">2</span>]; <span class="comment">// 12</span></span><br><span class="line"><span class="keyword">const</span> day = matchObj[<span class="number">3</span>]; <span class="comment">// 31</span></span><br></pre></td></tr></table></figure><p>ç»„åŒ¹é…çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œæ¯ä¸€ç»„çš„åŒ¹é…å«ä¹‰ä¸å®¹æ˜“çœ‹å‡ºæ¥ï¼Œè€Œä¸”åªèƒ½ç”¨æ•°å­—åºå·<code>XXX[1]</code>å¼•ç”¨ï¼Œè¦æ˜¯ç»„çš„é¡ºåºå˜äº†ï¼Œå¼•ç”¨çš„æ—¶å€™å°±å¿…é¡»ä¿®æ”¹åºå·ã€‚</p><p><code>ES6</code> å¼•å…¥äº†å…·åç»„åŒ¹é…ï¼ˆ<code>Named Capture Groups</code>ï¼‰ï¼Œå…è®¸ä¸ºæ¯ä¸€ä¸ªç»„åŒ¹é…æŒ‡å®šä¸€ä¸ªåå­—ï¼Œæ—¢ä¾¿äºé˜…è¯»ä»£ç ï¼Œåˆä¾¿äºå¼•ç”¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">RE_DATE</span> = <span class="regexp">/(?&lt;year&gt;\d&#123;4&#125;)-(?&lt;month&gt;\d&#123;2&#125;)-(?&lt;day&gt;\d&#123;2&#125;)/</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> matchObj = <span class="variable constant_">RE_DATE</span>.<span class="title function_">exec</span>(<span class="string">&#x27;1999-12-31&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> year = matchObj.<span class="property">groups</span>.<span class="property">year</span>; <span class="comment">// &quot;1999&quot;</span></span><br><span class="line"><span class="keyword">const</span> month = matchObj.<span class="property">groups</span>.<span class="property">month</span>; <span class="comment">// &quot;12&quot;</span></span><br><span class="line"><span class="keyword">const</span> day = matchObj.<span class="property">groups</span>.<span class="property">day</span>; <span class="comment">// &quot;31&quot;</span></span><br></pre></td></tr></table></figure><hr><h2 id="6-æ•°å€¼çš„æ‰©å±•"><a href="#6-æ•°å€¼çš„æ‰©å±•" class="headerlink" title="6. æ•°å€¼çš„æ‰©å±•"></a>6. æ•°å€¼çš„æ‰©å±•</h2><p><a href="https://es6.ruanyifeng.com/#docs/number">æœ¬ç« </a>å†…å®¹å¤æ‚ï¼Œæ•…å…ˆè·³è¿‡ä¸€éƒ¨åˆ†ã€‚</p><h3 id="6-1-BigInt-æ•°æ®ç±»å‹"><a href="#6-1-BigInt-æ•°æ®ç±»å‹" class="headerlink" title="6.1 BigInt æ•°æ®ç±»å‹"></a>6.1 BigInt æ•°æ®ç±»å‹</h3><p><code>ES5</code> ä¸­æ‰€æœ‰æ•°å­—éƒ½ä¿å­˜æˆ <code>64</code> ä½æµ®ç‚¹æ•°ï¼Œè¿™ç»™æ•°å€¼çš„è¡¨ç¤ºå¸¦æ¥äº†ä¸¤å¤§é™åˆ¶ï¼š</p><ul><li>æ•°å€¼çš„ç²¾åº¦åªèƒ½åˆ° <code>53</code> ä¸ªäºŒè¿›åˆ¶ä½ï¼Œç›¸å½“äº <code>16</code> ä¸ªåè¿›åˆ¶ä½ï¼Œå¤§äºè¿™ä¸ªèŒƒå›´çš„æ•´æ•°ï¼Œæ— æ³•ç²¾ç¡®è¡¨ç¤ºã€‚ ï¼ˆä¸é€‚åˆè¿›è¡Œç§‘å­¦å’Œé‡‘èæ–¹é¢çš„ç²¾ç¡®è®¡ç®—ï¼‰</li><li>å¤§äºæˆ–ç­‰äº<code>2</code>çš„<code>1024</code>æ¬¡æ–¹çš„æ•°å€¼æ— æ³•è¡¨ç¤ºï¼Œä¼šè¿”å›<code>Infinity</code>ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¶…è¿‡ 53 ä¸ªäºŒè¿›åˆ¶ä½çš„æ•°å€¼ï¼Œæ— æ³•ä¿æŒç²¾åº¦</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">pow</span>(<span class="number">2</span>, <span class="number">53</span>) === <span class="title class_">Math</span>.<span class="title function_">pow</span>(<span class="number">2</span>, <span class="number">53</span>) + <span class="number">1</span> <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¶…è¿‡ 2 çš„ 1024 æ¬¡æ–¹çš„æ•°å€¼ï¼Œæ— æ³•è¡¨ç¤º</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">pow</span>(<span class="number">2</span>, <span class="number">1024</span>) <span class="comment">// Infinity</span></span><br></pre></td></tr></table></figure><p><code>ES6</code> å¼•å…¥äº†ä¸€ç§æ–°çš„æ•°æ®ç±»å‹ <code>BigInt</code>ï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿™æ˜¯ <code>ECMAScript</code> çš„<a href="https://juejin.cn/post/6954892721173561358">ç¬¬å…«ç§æ•°æ®ç±»å‹</a>ã€‚<code>BigInt</code> <ins>åªç”¨æ¥è¡¨ç¤ºæ•´æ•°</ins>ï¼Œæ²¡æœ‰ä½æ•°çš„é™åˆ¶ï¼Œä»»ä½•ä½æ•°çš„æ•´æ•°éƒ½å¯ä»¥ç²¾ç¡®è¡¨ç¤ºã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> a = <span class="number">2172141653n</span>;</span><br><span class="line"><span class="keyword">const</span> b = <span class="number">15346349309n</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// BigInt å¯ä»¥ä¿æŒç²¾åº¦</span></span><br><span class="line">a * b <span class="comment">// 33334444555566667777n</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ™®é€šæ•´æ•°æ— æ³•ä¿æŒç²¾åº¦</span></span><br><span class="line"><span class="title class_">Number</span>(a) * <span class="title class_">Number</span>(b) <span class="comment">// 33334444555566670000</span></span><br></pre></td></tr></table></figure><p><code>BigInt</code> ä¸æ™®é€šæ•´æ•°æ˜¯ä¸¤ç§å€¼ï¼Œå®ƒä»¬ä¹‹é—´å¹¶ä¸ç›¸ç­‰ï¼Œä¸”ä¸èƒ½è¿›è¡Œæ··åˆè¿ç®—ã€‚ä¸ºäº†ä¸ <code>Number</code> ç±»å‹åŒºåˆ«ï¼Œ<code>BigInt</code> ç±»å‹çš„æ•°æ®å¿…é¡»æ·»åŠ åç¼€<code>n</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">42n</span> === <span class="number">42</span> <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="number">1n</span> + <span class="number">1.3</span> <span class="comment">// æŠ¥é”™</span></span><br></pre></td></tr></table></figure><hr><h2 id="7-å‡½æ•°çš„æ‰©å±•"><a href="#7-å‡½æ•°çš„æ‰©å±•" class="headerlink" title="7. å‡½æ•°çš„æ‰©å±•"></a>7. å‡½æ•°çš„æ‰©å±•</h2><h3 id="7-1-å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼"><a href="#7-1-å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼" class="headerlink" title="7.1 å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼"></a>7.1 å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼</h3><p><code>ES6</code> å…è®¸ä¸ºå‡½æ•°çš„å‚æ•°è®¾ç½®é»˜è®¤å€¼ï¼Œå¯ä»¥ç›´æ¥å†™åœ¨å‚æ•°å®šä¹‰çš„åé¢ï¼ˆé€šå¸¸æ˜¯å‡½æ•°çš„å°¾å‚æ•°ï¼‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Point</span>(<span class="params">x = <span class="number">0</span>, y = <span class="number">0</span></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">x</span> = x; <span class="comment">// this.x = x || 0 ï¼ˆES5 å†™æ³•ï¼‰</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">y</span> = y; <span class="comment">// this.y = y || 0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">Point</span>();</span><br><span class="line">p <span class="comment">// &#123; x: 0, y: 0 &#125;</span></span><br></pre></td></tr></table></figure><p>å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼æœ‰ä¸¤ä¸ªå¥½å¤„ï¼š</p><ul><li>é˜…è¯»ä»£ç çš„äººï¼Œå¯ä»¥ç«‹åˆ»æ„è¯†åˆ°å“ªäº›å‚æ•°æ˜¯å¯ä»¥çœç•¥çš„ï¼Œä¸ç”¨æŸ¥çœ‹å‡½æ•°ä½“æˆ–æ–‡æ¡£ã€‚</li><li>æœ‰åˆ©äºå°†æ¥çš„ä»£ç ä¼˜åŒ–ï¼Œå³ä½¿æœªæ¥çš„ç‰ˆæœ¬åœ¨å¯¹å¤–æ¥å£ä¸­ï¼Œå½»åº•æ‹¿æ‰è¿™ä¸ªå‚æ•°ï¼Œä¹Ÿä¸ä¼šå¯¼è‡´ä»¥å‰çš„ä»£ç æ— æ³•è¿è¡Œã€‚</li></ul><p>å‚æ•°é»˜è®¤å€¼å¯ä»¥ä¸è§£æ„èµ‹å€¼çš„é»˜è®¤å€¼ç»“åˆä½¿ç”¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fetch</span>(<span class="params">url, &#123; body = <span class="string">&#x27;&#x27;</span>, method = <span class="string">&#x27;GET&#x27;</span>, headers = &#123;&#125; &#125;</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(method);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;http://example.com&#x27;</span>, &#123;&#125;)</span><br><span class="line"><span class="comment">// &quot;GET&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;http://example.com&#x27;</span>)</span><br><span class="line"><span class="comment">// æŠ¥é”™</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>fetch</code>çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„ä¸‰ä¸ªå±æ€§éƒ½æœ‰é»˜è®¤å€¼ã€‚è¿™ç§å†™æ³•ä¸èƒ½çœç•¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœç»“åˆå‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ï¼Œå°±å¯ä»¥çœç•¥ç¬¬äºŒä¸ªå‚æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fetch</span>(<span class="params">url, &#123; body = <span class="string">&#x27;&#x27;</span>, method = <span class="string">&#x27;GET&#x27;</span>, headers = &#123;&#125; &#125; = &#123;&#125;</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(method);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;http://example.com&#x27;</span>)</span><br><span class="line"><span class="comment">// &quot;GET&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå½“å‡½æ•°<code>fetch</code>æ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°æ—¶ï¼Œå‡½æ•°å‚æ•°çš„é»˜è®¤å€¼å°±ä¼šç”Ÿæ•ˆï¼Œç„¶åæ‰æ˜¯è§£æ„èµ‹å€¼çš„é»˜è®¤å€¼ç”Ÿæ•ˆï¼Œå˜é‡<code>method</code>æ‰ä¼šå–åˆ°é»˜è®¤å€¼<code>GET</code>ã€‚</p><p>æ³¨æ„ï¼Œå‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ç”Ÿæ•ˆä»¥åï¼Œå‚æ•°è§£æ„èµ‹å€¼ä¾ç„¶ä¼šè¿›è¡Œã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">&#123; a, b = <span class="string">&#x27;world&#x27;</span> &#125; = &#123; a: <span class="string">&#x27;hello&#x27;</span> &#125;</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">f</span>() <span class="comment">// world</span></span><br></pre></td></tr></table></figure><hr><h3 id="7-2-rest-å‚æ•°"><a href="#7-2-rest-å‚æ•°" class="headerlink" title="7.2 rest å‚æ•°"></a>7.2 rest å‚æ•°</h3><p><code>rest</code> å‚æ•°å¯ä»¥ä»£æ›¿<code>arguments</code>å¯¹è±¡ï¼Œå»è·å–å‡½æ•°çš„å¤šä½™å‚æ•°ã€‚<code>rest</code> å‚æ•°ä¹‹åä¸èƒ½å†æœ‰å…¶ä»–å‚æ•°ï¼Œå®ƒåªèƒ½æ˜¯æœ€åä¸€ä¸ªå‚æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// argumentså˜é‡çš„å†™æ³•</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sortNumbers</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="variable language_">arguments</span>).<span class="title function_">sort</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">sortNumbers</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">3</span>))</span><br><span class="line"><span class="comment">// [1,2,3,5]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// restå‚æ•°çš„å†™æ³•</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">sortNumbers</span> = (<span class="params">...numbers</span>) =&gt; numbers.<span class="title function_">sort</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">sortNumbers</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">3</span>)) </span><br><span class="line"><span class="comment">// [1,2,3,5]</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç çš„ä¸¤ç§å†™æ³•ï¼Œæ¯”è¾ƒåå¯ä»¥å‘ç°ï¼Œ<code>rest</code> å‚æ•°çš„å†™æ³•æ›´è‡ªç„¶ä¹Ÿæ›´ç®€æ´ã€‚</p><hr><h3 id="7-3-ç®­å¤´å‡½æ•°"><a href="#7-3-ç®­å¤´å‡½æ•°" class="headerlink" title="7.3 ç®­å¤´å‡½æ•°"></a>7.3 ç®­å¤´å‡½æ•°</h3><p><code>ES6</code> å…è®¸ä½¿ç”¨â€œç®­å¤´â€ <code>=&gt;</code> å®šä¹‰å‡½æ•°ã€‚</p><ul><li>å¦‚æœç®­å¤´å‡½æ•°ä¸éœ€è¦å‚æ•°æˆ–éœ€è¦å¤šä¸ªå‚æ•°ï¼Œå°±ä½¿ç”¨ä¸€ä¸ªåœ†æ‹¬å·ä»£è¡¨å‚æ•°éƒ¨åˆ†ã€‚</li><li>å¦‚æœç®­å¤´å‡½æ•°çš„ä»£ç å—éƒ¨åˆ†å¤šäºä¸€æ¡è¯­å¥ï¼Œå°±è¦ä½¿ç”¨å¤§æ‹¬å·å°†å®ƒä»¬æ‹¬èµ·æ¥ï¼Œå¹¶ä¸”ä½¿ç”¨<code>return</code>è¯­å¥è¿”å›ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title function_">f</span> = (<span class="params"></span>) =&gt; <span class="number">5</span>;</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">let</span> f = <span class="keyword">function</span> (<span class="params"></span>) &#123; <span class="keyword">return</span> <span class="number">5</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="title function_">sum</span> = (<span class="params">num1, num2</span>) =&gt; num1 + num2;</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">let</span> <span class="title function_">sum</span> = (<span class="params">num1, num2</span>) =&gt; &#123; <span class="keyword">return</span> num1 + num2; &#125;</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">let</span> sum = <span class="keyword">function</span>(<span class="params">num1, num2</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> num1 + num2;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç®­å¤´å‡½æ•°å¯ä»¥ä¸å˜é‡è§£æ„ç»“åˆä½¿ç”¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">full</span> = (<span class="params">&#123; first, last &#125;</span>) =&gt; first + <span class="string">&#x27; &#x27;</span> + last;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">full</span>(<span class="params">person</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> person.<span class="property">first</span> + <span class="string">&#x27; &#x27;</span> + person.<span class="property">last</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®­å¤´å‡½æ•°è¿˜å¯ä»¥å’Œä¸Šé¢çš„ <code>rest</code> å‚æ•°ç»“åˆä½¿ç”¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">numbers</span> = (<span class="params">...nums</span>) =&gt; nums;</span><br><span class="line"></span><br><span class="line"><span class="title function_">numbers</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"><span class="comment">// [1,2,3,4,5]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">headAndTail</span> = (<span class="params">head, ...tail</span>) =&gt; [head, tail];</span><br><span class="line"></span><br><span class="line"><span class="title function_">headAndTail</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"><span class="comment">// [1,[2,3,4,5]]</span></span><br></pre></td></tr></table></figure><p>ç®­å¤´å‡½æ•°çš„é‡è¦ç”¨å¤„æ˜¯ç®€åŒ–<a href="https://segmentfault.com/a/1190000021942060">å›è°ƒå‡½æ•°</a>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ™®é€šå‡½æ•°å†™æ³•</span></span><br><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">x</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x * x;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç®­å¤´å‡½æ•°å†™æ³•</span></span><br><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].<span class="title function_">map</span>(<span class="function"><span class="params">x</span> =&gt;</span> x * x);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ™®é€šå‡½æ•°å†™æ³•</span></span><br><span class="line"><span class="keyword">let</span> result = values.<span class="title function_">sort</span>(<span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> a - b;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç®­å¤´å‡½æ•°å†™æ³•</span></span><br><span class="line"><span class="keyword">let</span> result = values.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b);</span><br></pre></td></tr></table></figure><p>ç®­å¤´å‡½æ•°æœ‰å‡ ä¸ªä½¿ç”¨<a href="https://es6.ruanyifeng.com/#docs/function#%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E7%82%B9">æ³¨æ„ç‚¹</a>ï¼Œå…¶ä¸­æœ€é‡è¦çš„æ˜¯ï¼Œç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„<code>this</code>å¯¹è±¡ã€‚</p><ul><li>å¯¹äº<ins>æ™®é€šå‡½æ•°æ¥è¯´ï¼Œå†…éƒ¨çš„<code>this</code>æŒ‡å‘å‡½æ•°è¿è¡Œæ—¶æ‰€åœ¨çš„å¯¹è±¡</ins>ï¼Œä½†æ˜¯<ins>è¿™ä¸€ç‚¹å¯¹ç®­å¤´å‡½æ•°ä¸æˆç«‹ã€‚å®ƒæ²¡æœ‰è‡ªå·±çš„<code>this</code>å¯¹è±¡ï¼Œå†…éƒ¨çš„<code>this</code>å°±æ˜¯å®šä¹‰æ—¶ä¸Šå±‚ä½œç”¨åŸŸä¸­çš„<code>this</code></ins>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<ins>ç®­å¤´å‡½æ•°å†…éƒ¨çš„<code>this</code>æŒ‡å‘æ˜¯å›ºå®šçš„</ins>ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼Œ<ins>æ™®é€šå‡½æ•°çš„<code>this</code>æŒ‡å‘æ˜¯å¯å˜çš„</ins>ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Timer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">s1</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">s2</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">// ç®­å¤´å‡½æ•°</span></span><br><span class="line">  <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="property">s1</span>++, <span class="number">1000</span>);</span><br><span class="line">  <span class="comment">// æ™®é€šå‡½æ•°</span></span><br><span class="line">  <span class="built_in">setInterval</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">s2</span>++;</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> timer = <span class="keyword">new</span> <span class="title class_">Timer</span>(); <span class="comment">// æ³¨æ„</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;s1: &#x27;</span>, timer.<span class="property">s1</span>), <span class="number">3100</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;s2: &#x27;</span>, timer.<span class="property">s2</span>), <span class="number">3100</span>);</span><br><span class="line"><span class="comment">// s1: 3</span></span><br><span class="line"><span class="comment">// s2: 0</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Timer</code>å‡½æ•°å†…éƒ¨è®¾ç½®äº†ä¸¤ä¸ªå®šæ—¶å™¨ï¼Œåˆ†åˆ«ä½¿ç”¨äº†ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°ã€‚<ins>å‰è€…çš„<code>this</code>ç»‘å®šå®šä¹‰æ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸï¼Œå³<code>Timer</code>å‡½æ•°ï¼Œåè€…çš„<code>this</code>æŒ‡å‘è¿è¡Œæ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸï¼Œå³å…¨å±€å¯¹è±¡</ins>ã€‚æ‰€ä»¥ï¼Œ<code>3100</code> æ¯«ç§’ä¹‹åï¼Œ<code>timer.s1</code>è¢«æ›´æ–°äº† <code>3</code> æ¬¡ï¼Œè€Œ<code>timer.s2</code>ä¸€æ¬¡éƒ½æ²¡æ›´æ–°ã€‚</p><hr><h2 id="8-æ•°ç»„çš„æ‰©å±•"><a href="#8-æ•°ç»„çš„æ‰©å±•" class="headerlink" title="8. æ•°ç»„çš„æ‰©å±•"></a>8. æ•°ç»„çš„æ‰©å±•</h2><h3 id="8-1-æ‰©å±•è¿ç®—ç¬¦"><a href="#8-1-æ‰©å±•è¿ç®—ç¬¦" class="headerlink" title="8.1 æ‰©å±•è¿ç®—ç¬¦"></a>8.1 æ‰©å±•è¿ç®—ç¬¦</h3><p>æ‰©å±•è¿ç®—ç¬¦ <code>...</code>ï¼Œå°†ä¸€ä¸ªæ•°ç»„è½¬ä¸ºç”¨é€—å·åˆ†éš”çš„å‚æ•°åºåˆ—ã€‚ç±»ä¼¼ <code>rest</code> å‚æ•°çš„é€†è¿ç®—ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(...[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="comment">// 1 2 3</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>, ...[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="number">5</span>)</span><br><span class="line"><span class="comment">// 1 2 3 4 5</span></span><br><span class="line"></span><br><span class="line">[...<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;div&#x27;</span>)]</span><br><span class="line"><span class="comment">// [&lt;div&gt;, &lt;div&gt;, &lt;div&gt;]</span></span><br></pre></td></tr></table></figure><p>æ‰©å±•è¿ç®—ç¬¦ä¸»è¦ç”¨äºå‡½æ•°è°ƒç”¨ï¼Œå¯ä»¥ä»£æ›¿<code>apply()</code>æ–¹æ³•å°†æ•°ç»„è½¬ä¸ºå‡½æ•°çš„å‚æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ES5 çš„å†™æ³•</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">x, y, z</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> args = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line">f.<span class="title function_">apply</span>(<span class="literal">null</span>, args);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6 çš„å†™æ³•</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params">x, y, z</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> args = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="title function_">f</span>(...args);</span><br></pre></td></tr></table></figure><hr><h3 id="8-2-æ‰©å±•è¿ç®—ç¬¦çš„åº”ç”¨"><a href="#8-2-æ‰©å±•è¿ç®—ç¬¦çš„åº”ç”¨" class="headerlink" title="8.2 æ‰©å±•è¿ç®—ç¬¦çš„åº”ç”¨"></a>8.2 æ‰©å±•è¿ç®—ç¬¦çš„åº”ç”¨</h3><p><strong>ï¼ˆ1ï¼‰å¤åˆ¶æ•°ç»„</strong></p><p>æ•°ç»„æ˜¯å¤åˆçš„æ•°æ®ç±»å‹ï¼Œç›´æ¥å¤åˆ¶çš„è¯ï¼Œåªæ˜¯å¤åˆ¶äº†æŒ‡å‘åº•å±‚æ•°æ®ç»“æ„çš„æŒ‡é’ˆï¼Œè€Œä¸æ˜¯å…‹éš†ä¸€ä¸ªå…¨æ–°çš„æ•°ç»„ã€‚æ‰©å±•è¿ç®—ç¬¦æä¾›äº†å¤åˆ¶æ•°ç»„çš„ç®€ä¾¿å†™æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> a1 = [<span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="keyword">const</span> a2 = a1;</span><br><span class="line"></span><br><span class="line">a2[<span class="number">0</span>] = <span class="number">2</span>;</span><br><span class="line">a1 <span class="comment">// [2, 2]ï¼Œæµ…æ‹·è´</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å†™æ³•ä¸€</span></span><br><span class="line"><span class="keyword">const</span> a2 = [...a1];</span><br><span class="line"><span class="comment">// å†™æ³•äºŒ</span></span><br><span class="line"><span class="keyword">const</span> [...a2] = a1;</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ2ï¼‰åˆå¹¶æ•°ç»„</strong></p><p>æ‰©å±•è¿ç®—ç¬¦æä¾›äº†æ•°ç»„åˆå¹¶çš„æ–°å†™æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr1 = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">const</span> arr2 = [<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="keyword">const</span> arr3 = [<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES5 çš„åˆå¹¶æ•°ç»„</span></span><br><span class="line">arr1.<span class="title function_">concat</span>(arr2, arr3);</span><br><span class="line"><span class="comment">// [ &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27; ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6 çš„åˆå¹¶æ•°ç»„</span></span><br><span class="line">[...arr1, ...arr2, ...arr3]</span><br><span class="line"><span class="comment">// [ &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27; ]</span></span><br></pre></td></tr></table></figure><p>ä¸è¿‡ä¸¤ç§æ–¹æ³•éƒ½æ˜¯<a href="https://vue3js.cn/interview/JavaScript/copy.html">æµ…æ‹·è´</a>ï¼Œä½¿ç”¨çš„æ—¶å€™éœ€è¦ç‰¹åˆ«å°å¿ƒã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> a1 = [&#123; <span class="attr">foo</span>: <span class="number">1</span> &#125;];</span><br><span class="line"><span class="keyword">const</span> a2 = [&#123; <span class="attr">bar</span>: <span class="number">2</span> &#125;];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a3 = a1.<span class="title function_">concat</span>(a2);</span><br><span class="line"><span class="keyword">const</span> a4 = [...a1, ...a2];</span><br><span class="line"></span><br><span class="line">a3[<span class="number">0</span>] === a1[<span class="number">0</span>] <span class="comment">// true</span></span><br><span class="line">a4[<span class="number">0</span>] === a1[<span class="number">0</span>] <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>a3</code>å’Œ<code>a4</code>æ˜¯ç”¨ä¸¤ç§ä¸åŒæ–¹æ³•åˆå¹¶è€Œæˆçš„æ–°æ•°ç»„ï¼Œä½†æ˜¯å®ƒä»¬çš„æˆå‘˜éƒ½æ˜¯å¯¹åŸæ•°ç»„æˆå‘˜çš„å¼•ç”¨ï¼Œè¿™å°±æ˜¯æµ…æ‹·è´ã€‚<ins>å¦‚æœä¿®æ”¹äº†å¼•ç”¨æŒ‡å‘çš„å€¼ï¼Œä¼šåŒæ­¥åæ˜ åˆ°æ–°æ•°ç»„</ins>ã€‚</p><p><strong>ï¼ˆ3ï¼‰ä¸è§£æ„èµ‹å€¼ç»“åˆ</strong></p><p>æ‰©å±•è¿ç®—ç¬¦å¯ä»¥ä¸è§£æ„èµ‹å€¼ç»“åˆèµ·æ¥ï¼Œç”¨äºç”Ÿæˆæ•°ç»„ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> [first, ...rest] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">first <span class="comment">// 1</span></span><br><span class="line">rest  <span class="comment">// [2, 3, 4, 5]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> [first, ...rest] = [];</span><br><span class="line">first <span class="comment">// undefined</span></span><br><span class="line">rest  <span class="comment">// []</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ4ï¼‰å…·æœ‰ Iterator æ¥å£çš„å¯¹è±¡</strong></p><p>æ‰©å±•è¿ç®—ç¬¦è°ƒç”¨çš„æ˜¯æ•°æ®ç»“æ„çš„ <code>Iterator</code> æ¥å£ï¼Œå› æ­¤åªè¦å…·æœ‰ <code>Iterator</code> æ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ã€‚æ¯”å¦‚å­—ç¬¦ä¸²ï¼Œ<code>Map</code>å’Œ<code>Set</code>ï¼Œ<code>Generator</code>å‡½æ•°è¿”å›çš„éå†å™¨å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">[...<span class="string">&#x27;hello&#x27;</span>]</span><br><span class="line"><span class="comment">// [ &quot;h&quot;, &quot;e&quot;, &quot;l&quot;, &quot;l&quot;, &quot;o&quot; ]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>([</span><br><span class="line">  [<span class="number">1</span>, <span class="string">&#x27;one&#x27;</span>],</span><br><span class="line">  [<span class="number">2</span>, <span class="string">&#x27;two&#x27;</span>],</span><br><span class="line">  [<span class="number">3</span>, <span class="string">&#x27;three&#x27;</span>],</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = [...map.<span class="title function_">keys</span>()]; <span class="comment">// [1, 2, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> go = <span class="keyword">function</span>*()&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">[...<span class="title function_">go</span>()] <span class="comment">// [1, 2, 3]</span></span><br></pre></td></tr></table></figure><hr><h3 id="8-3-æ–°å¢æ–¹æ³•"><a href="#8-3-æ–°å¢æ–¹æ³•" class="headerlink" title="8.3 æ–°å¢æ–¹æ³•"></a>8.3 æ–°å¢æ–¹æ³•</h3><p><strong>é™æ€æ–¹æ³• 1ï¼š</strong><code>Array.from()</code>æ–¹æ³•ç”¨äºå°†ä¸¤ç±»å¯¹è±¡è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼Œç±»ä¼¼æ•°ç»„çš„å¯¹è±¡å’Œå¯éå†çš„å¯¹è±¡ã€‚ï¼ˆåŒ…æ‹¬ <code>ES6</code> æ–°å¢çš„æ•°æ®ç»“æ„ <code>Set</code> å’Œ <code>Map</code>ï¼Œå’Œéƒ¨ç½²äº† <code>Iterator</code> æ¥å£çš„æ•°æ®ç»“æ„ï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arrayLike = &#123;</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;a&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;b&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;c&#x27;</span>,</span><br><span class="line">    <span class="attr">length</span>: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES5 çš„å†™æ³•</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [].<span class="property">slice</span>.<span class="title function_">call</span>(arrayLike); <span class="comment">// [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6 çš„å†™æ³•</span></span><br><span class="line"><span class="keyword">let</span> arr2 = <span class="title class_">Array</span>.<span class="title function_">from</span>(arrayLike); <span class="comment">// [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;]</span></span><br></pre></td></tr></table></figure><p><code>Array.from()</code>è¿˜å¯ä»¥æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œç”¨ç±»ä¼¼äºæ•°ç»„çš„<code>map()</code>æ–¹æ³•ï¼Œç”¨æ¥å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œå¤„ç†ï¼Œå°†å¤„ç†åçš„å€¼æ”¾å…¥è¿”å›çš„æ•°ç»„ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Array</span>.<span class="title function_">from</span>(arrayLike, <span class="function"><span class="params">x</span> =&gt;</span> x * x);</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">from</span>(arrayLike).<span class="title function_">map</span>(<span class="function"><span class="params">x</span> =&gt;</span> x * x);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">from</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="function">(<span class="params">x</span>) =&gt;</span> x * x)</span><br><span class="line"><span class="comment">// [1, 4, 9]</span></span><br></pre></td></tr></table></figure><p><strong>é™æ€æ–¹æ³• 2ï¼š</strong><code>Array.of()</code>æ–¹æ³•ç”¨äºå°†ä¸€ç»„å€¼ï¼Œè½¬æ¢ä¸ºæ•°ç»„ã€‚å®ƒå¯ä»¥æ›¿ä»£<code>Array()</code>æˆ–<code>new Array()</code>ï¼Œå¹¶ä¸”ä¸å­˜åœ¨ç”±äºå‚æ•°ä¸åŒè€Œå¯¼è‡´çš„é‡è½½ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Array</span>.<span class="title function_">of</span>(<span class="number">3</span>, <span class="number">11</span>, <span class="number">8</span>) <span class="comment">// [3,11,8]</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">of</span>(<span class="number">3</span>) <span class="comment">// [3]</span></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">of</span>(<span class="number">3</span>).<span class="property">length</span> <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡è½½</span></span><br><span class="line"><span class="title class_">Array</span>() <span class="comment">// []</span></span><br><span class="line"><span class="title class_">Array</span>(<span class="number">3</span>) <span class="comment">// [, , ,]</span></span><br><span class="line"><span class="title class_">Array</span>(<span class="number">3</span>, <span class="number">11</span>, <span class="number">8</span>) <span class="comment">// [3, 11, 8]</span></span><br></pre></td></tr></table></figure><p><strong>å®ä¾‹æ–¹æ³• 1ï¼š</strong><code>find()</code>æ–¹æ³•ï¼Œç”¨äºæ‰¾å‡ºç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°ç»„æˆå‘˜ã€‚å®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ‰€æœ‰æ•°ç»„æˆå‘˜ä¾æ¬¡æ‰§è¡Œè¯¥å›è°ƒå‡½æ•°ï¼Œç›´åˆ°æ‰¾å‡ºç¬¬ä¸€ä¸ªè¿”å›å€¼ä¸º<code>true</code>çš„æˆå‘˜ï¼Œç„¶åè¿”å›è¯¥æˆå‘˜ã€‚å¦‚æœæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æˆå‘˜ï¼Œåˆ™è¿”å›<code>undefined</code>ã€‚</p><p><code>findIndex()</code>æ–¹æ³•çš„ç”¨æ³•ä¸<code>find()</code>æ–¹æ³•ç±»ä¼¼ï¼Œè¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°ç»„æˆå‘˜çš„ä½ç½®ï¼Œå¦‚æœæ‰€æœ‰æˆå‘˜éƒ½ä¸ç¬¦åˆæ¡ä»¶ï¼Œåˆ™è¿”å›<code>-1</code>ã€‚<code>find()</code>å’Œ<code>findIndex()</code>éƒ½æ˜¯ä»æ•°ç»„çš„<code>0</code>å·ä½ï¼Œä¾æ¬¡å‘åæ£€æŸ¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">4</span>, -<span class="number">5</span>, <span class="number">10</span>].<span class="title function_">find</span>(<span class="function">(<span class="params">n</span>) =&gt;</span> n &lt; <span class="number">0</span>)</span><br><span class="line"><span class="comment">// -5</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>].<span class="title function_">findIndex</span>(<span class="keyword">function</span>(<span class="params">value, index, arr</span>) &#123; <span class="comment">// å½“å‰çš„å€¼ã€å½“å‰çš„ä½ç½®å’ŒåŸæ•°ç»„</span></span><br><span class="line">  <span class="keyword">return</span> value &gt; <span class="number">9</span>;</span><br><span class="line">&#125;) <span class="comment">// 2</span></span><br></pre></td></tr></table></figure><p>ä¸ä¹‹ç›¸åï¼Œ<code>findLast()</code>å’Œ<code>findLastIndex()</code>æ˜¯ä»æ•°ç»„çš„æœ€åä¸€ä¸ªæˆå‘˜å¼€å§‹ï¼Œä¾æ¬¡å‘å‰æ£€æŸ¥ï¼Œå…¶ä»–éƒ½ä¿æŒä¸å˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> array = [</span><br><span class="line">  &#123; <span class="attr">value</span>: <span class="number">1</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">value</span>: <span class="number">2</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">value</span>: <span class="number">3</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">value</span>: <span class="number">4</span> &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">array.<span class="title function_">findLast</span>(<span class="function"><span class="params">n</span> =&gt;</span> n.<span class="property">value</span> % <span class="number">2</span> === <span class="number">1</span>); <span class="comment">// &#123; value: 3 &#125;</span></span><br><span class="line">array.<span class="title function_">findLastIndex</span>(<span class="function"><span class="params">n</span> =&gt;</span> n.<span class="property">value</span> % <span class="number">2</span> === <span class="number">1</span>); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure><p><strong>å®ä¾‹æ–¹æ³• 2ï¼š</strong><code>fill()</code>æ–¹æ³•ä½¿ç”¨ç»™å®šå€¼ï¼Œå¡«å……ä¸€ä¸ªæ•°ç»„ã€‚å®ƒè¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œç”¨äºæŒ‡å®šå¡«å……çš„èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>].<span class="title function_">fill</span>(<span class="number">7</span>)</span><br><span class="line"><span class="comment">// [7, 7, 7]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">3</span>).<span class="title function_">fill</span>(<span class="number">7</span>)</span><br><span class="line"><span class="comment">// [7, 7, 7]</span></span><br><span class="line"></span><br><span class="line">[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>].<span class="title function_">fill</span>(<span class="number">7</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment">// [&#x27;a&#x27;, 7, &#x27;c&#x27;]</span></span><br></pre></td></tr></table></figure><p><strong>å®ä¾‹æ–¹æ³• 3ï¼š</strong><code>ES6</code> æä¾›ä¸‰ä¸ªæ–°çš„æ–¹æ³•ç”¨äºéå†æ•°ç»„ã€‚<code>keys()</code>æ˜¯å¯¹é”®åçš„éå†ï¼Œ<code>values()</code>æ˜¯å¯¹é”®å€¼çš„éå†ï¼Œ<code>entries()</code>æ˜¯å¯¹é”®å€¼å¯¹çš„éå†ã€‚å®ƒä»¬éƒ½å¯ä»¥ç”¨<code>for...of</code>å¾ªç¯è¿›è¡Œéå†ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> index <span class="keyword">of</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>].<span class="title function_">keys</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(index);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 0</span></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> elem <span class="keyword">of</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>].<span class="title function_">values</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(elem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &#x27;a&#x27;</span></span><br><span class="line"><span class="comment">// &#x27;b&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [index, elem] <span class="keyword">of</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>].<span class="title function_">entries</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(index, elem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 0 &quot;a&quot;</span></span><br><span class="line"><span class="comment">// 1 &quot;b&quot;</span></span><br></pre></td></tr></table></figure><p><strong>å®ä¾‹æ–¹æ³• 4ï¼š</strong><code>includes()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªæ•°ç»„æ˜¯å¦åŒ…å«ç»™å®šçš„å€¼ã€‚è¯¥æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæœç´¢çš„èµ·å§‹ä½ç½®ï¼Œé»˜è®¤ä¸º<code>0</code>ã€‚å¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸ºè´Ÿæ•°ï¼Œåˆ™è¡¨ç¤ºå€’æ•°çš„ä½ç½®ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].<span class="title function_">includes</span>(<span class="number">2</span>)     <span class="comment">// true</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].<span class="title function_">includes</span>(<span class="number">4</span>)     <span class="comment">// false</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="title class_">NaN</span>].<span class="title function_">includes</span>(<span class="title class_">NaN</span>) <span class="comment">// true</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].<span class="title function_">includes</span>(<span class="number">3</span>, -<span class="number">1</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p><strong>å®ä¾‹æ–¹æ³• 5ï¼š</strong>æ•°ç»„çš„æˆå‘˜æœ‰æ—¶è¿˜æ˜¯æ•°ç»„ï¼Œ<code>flat()</code>æ–¹æ³•ç”¨äºå°†åµŒå¥—çš„æ•°ç»„â€œæ‹‰å¹³â€ï¼Œå˜æˆä¸€ç»´çš„æ•°ç»„ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œå¯¹åŸæ•°æ®æ²¡æœ‰å½±å“ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>]].<span class="title function_">flat</span>()</span><br><span class="line"><span class="comment">// [1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure><p><code>flat()</code>æ–¹æ³•é»˜è®¤åªä¼šâ€œæ‹‰å¹³â€ä¸€å±‚ï¼Œå¦‚æœæƒ³è¦â€œæ‹‰å¹³â€å¤šå±‚çš„åµŒå¥—æ•°ç»„ï¼Œå¯ä»¥æŒ‡å®š<code>flat()</code>æ–¹æ³•çš„å‚æ•°ï¼Œè¡¨ç¤ºæƒ³è¦æ‹‰å¹³çš„å±‚æ•°ï¼Œé»˜è®¤ä¸º<code>1</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>]]].<span class="title function_">flat</span>()</span><br><span class="line"><span class="comment">// [1, 2, 3, [4, 5]]</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>]]].<span class="title function_">flat</span>(<span class="number">2</span>)</span><br><span class="line"><span class="comment">// [1, 2, 3, 4, 5]</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, [<span class="number">2</span>, [<span class="number">3</span>]]].<span class="title function_">flat</span>(<span class="title class_">Infinity</span>)</span><br><span class="line"><span class="comment">// [1, 2, 3]</span></span><br></pre></td></tr></table></figure><p><code>flatMap()</code>æ–¹æ³•å¯¹åŸæ•°ç»„çš„æ¯ä¸ªæˆå‘˜æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼ˆç›¸å½“äºæ‰§è¡Œ<code>map()</code>ï¼‰, ç„¶åå¯¹è¿”å›å€¼ç»„æˆçš„æ•°ç»„æ‰§è¡Œ<code>flat()</code>æ–¹æ³•ã€‚æ³¨æ„ï¼Œ<code>flatMap()</code>åªèƒ½å±•å¼€ä¸€å±‚æ•°ç»„ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œä¸æ”¹å˜åŸæ•°ç»„ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç›¸å½“äº [[2, 4], [3, 6], [4, 8]].flat()</span></span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>].<span class="title function_">flatMap</span>(<span class="function">(<span class="params">x</span>) =&gt;</span> [x, x * <span class="number">2</span>])</span><br><span class="line"><span class="comment">// [2, 4, 3, 6, 4, 8]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›¸å½“äº [[[2]], [[4]], [[6]], [[8]]].flat()</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>].<span class="title function_">flatMap</span>(<span class="function"><span class="params">x</span> =&gt;</span> [[x * <span class="number">2</span>]])</span><br><span class="line"><span class="comment">// [[2], [4], [6], [8]]</span></span><br></pre></td></tr></table></figure><p><strong>å®ä¾‹æ–¹æ³• 6ï¼š</strong><code>ES5</code> ä¸æ”¯æŒæ•°ç»„çš„è´Ÿç´¢å¼•ï¼Œå¦‚æœè¦å¼•ç”¨æ•°ç»„çš„æœ€åä¸€ä¸ªæˆå‘˜ï¼Œä¸èƒ½å†™æˆ<code>arr[-1]</code>ï¼Œåªèƒ½ä½¿ç”¨<code>arr[arr.length - 1]</code>ã€‚<code>ES6</code> ä¸ºæ•°ç»„å®ä¾‹å¢åŠ äº†<code>at()</code>æ–¹æ³•ï¼Œæ¥å—ä¸€ä¸ªæ•´æ•°ä½œä¸ºå‚æ•°ï¼Œè¿”å›å¯¹åº”ä½ç½®çš„æˆå‘˜ï¼Œå¹¶æ”¯æŒè´Ÿç´¢å¼•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">5</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">130</span>, <span class="number">44</span>];</span><br><span class="line"></span><br><span class="line">arr[-<span class="number">2</span>] <span class="comment">// Error</span></span><br><span class="line">arr.<span class="title function_">at</span>(<span class="number">2</span>) <span class="comment">// 8</span></span><br><span class="line">arr.<span class="title function_">at</span>(-<span class="number">2</span>) <span class="comment">// 130</span></span><br></pre></td></tr></table></figure><hr><h2 id="9-å¯¹è±¡çš„æ‰©å±•"><a href="#9-å¯¹è±¡çš„æ‰©å±•" class="headerlink" title="9. å¯¹è±¡çš„æ‰©å±•"></a>9. å¯¹è±¡çš„æ‰©å±•</h2><p><a href="https://es6.ruanyifeng.com/#docs/object">æœ¬ç« </a>å†…å®¹å¤æ‚ï¼Œæ•…å…ˆè·³è¿‡ä¸€éƒ¨åˆ†ã€‚</p><h3 id="9-1-å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•"><a href="#9-1-å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•" class="headerlink" title="9.1 å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•"></a>9.1 å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•</h3><p><code>ES6</code> å…è®¸åœ¨å¤§æ‹¬å·é‡Œé¢ï¼Œç›´æ¥å†™å…¥å˜é‡å’Œå‡½æ•°ï¼Œä½œä¸ºå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> birth = <span class="string">&#x27;2000/01/01&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Person</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;å¼ ä¸‰&#x27;</span>,</span><br><span class="line">  birth, <span class="comment">// ç­‰åŒäº birth: birth</span></span><br><span class="line">  <span class="title function_">hello</span>(<span class="params"></span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æˆ‘çš„åå­—æ˜¯&#x27;</span>, <span class="variable language_">this</span>.<span class="property">name</span>); &#125;  </span><br><span class="line">  <span class="comment">// ç­‰åŒäº hello: function ()...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><h3 id="9-2-super-å…³é”®å­—"><a href="#9-2-super-å…³é”®å­—" class="headerlink" title="9.2 super å…³é”®å­—"></a>9.2 super å…³é”®å­—</h3><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œ<ins><code>this</code>å…³é”®å­—æ€»æ˜¯æŒ‡å‘å‡½æ•°æ‰€åœ¨çš„å½“å‰å¯¹è±¡</ins>ï¼Œ<code>ES6</code> åˆæ–°å¢äº†å¦ä¸€ä¸ªç±»ä¼¼çš„å…³é”®å­—<ins><code>super</code>ï¼ŒæŒ‡å‘å½“å‰å¯¹è±¡çš„åŸå‹å¯¹è±¡</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> proto = &#123;</span><br><span class="line">  <span class="attr">x</span>: <span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">  <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">x</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">x</span>: <span class="string">&#x27;world&#x27;</span>,</span><br><span class="line">  <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>.<span class="title function_">foo</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">setPrototypeOf</span>(obj, proto);</span><br><span class="line">obj.<span class="title function_">foo</span>() <span class="comment">// &quot;world&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡<code>obj.foo()</code>æ–¹æ³•ä¹‹ä¸­ï¼Œé€šè¿‡<code>super.foo</code>å¼•ç”¨äº†åŸå‹å¯¹è±¡<code>proto</code>çš„<code>foo</code>æ–¹æ³•ã€‚<ins>ä½†æ˜¯ç»‘å®šçš„<code>this</code>å´è¿˜æ˜¯å½“å‰å¯¹è±¡<code>obj</code>ï¼Œå› æ­¤è¾“å‡ºçš„å°±æ˜¯<code>world</code></ins>ã€‚</p><p>æ³¨æ„ï¼Œ<code>super</code>å…³é”®å­—è¡¨ç¤ºåŸå‹å¯¹è±¡æ—¶ï¼Œ<ins>åªèƒ½ç”¨åœ¨å¯¹è±¡çš„æ–¹æ³•ä¹‹ä¸­</ins>ï¼Œç”¨åœ¨å…¶ä»–åœ°æ–¹éƒ½ä¼šæŠ¥é”™ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">/ æŠ¥é”™</span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="variable language_">super</span>.<span class="property">foo</span> <span class="comment">// å¯¹è±¡å±æ€§</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ¥é”™</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="function">() =&gt;</span> <span class="variable language_">super</span>.<span class="property">foo</span> <span class="comment">// å¯¹è±¡å±æ€§ </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ¥é”™</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123; <span class="comment">// å¯¹è±¡å±æ€§</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">super</span>.<span class="property">foo</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="9-3-å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦"><a href="#9-3-å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦" class="headerlink" title="9.3 å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦"></a>9.3 å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦</h3><p><strong>ï¼ˆ1ï¼‰è§£æ„èµ‹å€¼</strong></p><p>å¯¹è±¡çš„è§£æ„èµ‹å€¼ç”¨äºä»ä¸€ä¸ªå¯¹è±¡å–å€¼ï¼Œå°†ç›®æ ‡å¯¹è±¡æ‰€æœ‰<a href="https://es6.ruanyifeng.com/#docs/object#%E5%B1%9E%E6%80%A7%E7%9A%84%E5%8F%AF%E6%9E%9A%E4%B8%BE%E6%80%A7%E5%92%8C%E9%81%8D%E5%8E%86">å¯éå†</a>çš„ã€ä½†å°šæœªè¢«è¯»å–çš„å±æ€§ï¼Œåˆ†é…åˆ°æŒ‡å®šçš„å¯¹è±¡ä¸Šé¢ã€‚ï¼ˆæ³¨æ„ï¼Œè§£æ„èµ‹å€¼å¿…é¡»æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼Œä¸”ç­‰å·å³è¾¹ä¸èƒ½æ˜¯<code>undefined</code>æˆ–<code>null</code>ï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123; x, y, ...z &#125; = &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>, <span class="attr">a</span>: <span class="number">3</span>, <span class="attr">b</span>: <span class="number">4</span> &#125;;</span><br><span class="line">x <span class="comment">// 1</span></span><br><span class="line">y <span class="comment">// 2</span></span><br><span class="line">z <span class="comment">// &#123; a: 3, b: 4 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> z = &#123; <span class="attr">a</span>: <span class="number">3</span>, <span class="attr">b</span>: <span class="number">4</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> n = &#123; ...z &#125;;</span><br><span class="line">n <span class="comment">// &#123; a: 3, b: 4 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123; ...x, y, z &#125; = someObject; <span class="comment">// å¥æ³•é”™è¯¯</span></span><br></pre></td></tr></table></figure><p>è§£æ„èµ‹å€¼çš„æ‹·è´æ˜¯<a href="https://vue3js.cn/interview/JavaScript/copy.html">æµ…æ‹·è´</a>ï¼Œå³<ins>å¦‚æœä¸€ä¸ªé”®çš„å€¼æ˜¯å¤åˆç±»å‹çš„å€¼ï¼ˆå¦‚æ•°ç»„ã€å¯¹è±¡ã€å‡½æ•°ï¼‰ï¼Œé‚£ä¹ˆè§£æ„èµ‹å€¼æ‹·è´çš„æ˜¯è¿™ä¸ªå€¼çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯è¿™ä¸ªå€¼çš„å‰¯æœ¬</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">a</span>: &#123; <span class="attr">b</span>: <span class="number">1</span> &#125; &#125;;</span><br><span class="line"><span class="keyword">let</span> &#123; ...x &#125; = obj;</span><br><span class="line">obj.<span class="property">a</span>.<span class="property">b</span> = <span class="number">2</span>;</span><br><span class="line">x.<span class="property">a</span>.<span class="property">b</span> <span class="comment">// 2</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>x</code>æ˜¯è§£æ„èµ‹å€¼æ‰€åœ¨çš„å¯¹è±¡ï¼Œæ‹·è´äº†å¯¹è±¡<code>obj</code>çš„<code>a</code>å±æ€§ã€‚<code>a</code>å±æ€§å¼•ç”¨äº†ä¸€ä¸ªå¯¹è±¡ï¼Œä¿®æ”¹è¿™ä¸ªå¯¹è±¡çš„å€¼ï¼Œä¼šå½±å“åˆ°è§£æ„èµ‹å€¼å¯¹å®ƒçš„å¼•ç”¨ã€‚</p><p>è§£æ„èµ‹å€¼çš„ä¸€ä¸ªç”¨å¤„ï¼Œæ˜¯æ‰©å±•æŸä¸ªå‡½æ•°çš„å‚æ•°ï¼Œå¼•å…¥å…¶ä»–æ“ä½œã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">baseFunction</span>(<span class="params">&#123; a, b &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">wrapperFunction</span>(<span class="params">&#123; x, y, ...restConfig &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// ä½¿ç”¨ x å’Œ y å‚æ•°è¿›è¡Œæ“ä½œ</span></span><br><span class="line">  <span class="comment">// å…¶ä½™å‚æ•°ä¼ ç»™åŸå§‹å‡½æ•°</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">baseFunction</span>(restConfig);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼ŒåŸå§‹å‡½æ•°<code>baseFunction</code>æ¥å—<code>a</code>å’Œ<code>b</code>ä½œä¸ºå‚æ•°ï¼Œå‡½æ•°<code>wrapperFunction</code>åœ¨<code>baseFunction</code>çš„åŸºç¡€ä¸Šè¿›è¡Œäº†æ‰©å±•ï¼Œèƒ½å¤Ÿæ¥å—å¤šä½™çš„å‚æ•°ï¼Œå¹¶ä¸”ä¿ç•™åŸå§‹å‡½æ•°çš„è¡Œä¸ºã€‚</p><p><strong>ï¼ˆ2ï¼‰æ‰©å±•è¿ç®—ç¬¦</strong></p><p>å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦ <code>...</code> ç”¨äºå–å‡ºå‚æ•°å¯¹è±¡çš„æ‰€æœ‰å¯éå†å±æ€§ï¼Œæ‹·è´åˆ°å½“å‰å¯¹è±¡ä¹‹ä¸­ã€‚ï¼ˆæ‰©å±•è¿ç®—ç¬¦ä¸éœ€è¦æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> z = &#123; <span class="attr">a</span>: <span class="number">3</span>, <span class="attr">b</span>: <span class="number">4</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> n = &#123; ...z &#125;;</span><br><span class="line">n <span class="comment">// &#123; a: 3, b: 4 &#125;</span></span><br><span class="line"></span><br><span class="line">&#123;...&#123;&#125;, <span class="attr">a</span>: <span class="number">1</span>&#125;</span><br><span class="line"><span class="comment">// &#123; a: 1 &#125;</span></span><br></pre></td></tr></table></figure><p>æ‰©å±•è¿ç®—ç¬¦è¿˜å¯ä»¥ç”¨äºåˆå¹¶ä¸¤ä¸ªå¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> ab = &#123; ...a, ...b &#125;;</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">let</span> ab = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, a, b);</span><br></pre></td></tr></table></figure><p>å¦‚æœç”¨æˆ·è‡ªå®šä¹‰çš„å±æ€§ï¼Œæ”¾åœ¨æ‰©å±•è¿ç®—ç¬¦åé¢ï¼Œåˆ™æ‰©å±•è¿ç®—ç¬¦å†…éƒ¨çš„åŒåå±æ€§ä¼šè¢«è¦†ç›–æ‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> aWithOverrides = &#123; ...a, <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125;;</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">let</span> aWithOverrides = &#123; ...a, ...&#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125; &#125;;</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">let</span> x = <span class="number">1</span>, y = <span class="number">2</span>, aWithOverrides = &#123; ...a, x, y &#125;;</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">let</span> aWithOverrides = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, a, &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>a</code>å¯¹è±¡çš„<code>x</code>å±æ€§å’Œ<code>y</code>å±æ€§ï¼Œæ‹·è´åˆ°æ–°å¯¹è±¡åä¼šè¢«è¦†ç›–æ‰ã€‚</p><hr><h2 id="10-å¯¹è±¡çš„æ–°å¢æ–¹æ³•"><a href="#10-å¯¹è±¡çš„æ–°å¢æ–¹æ³•" class="headerlink" title="10. å¯¹è±¡çš„æ–°å¢æ–¹æ³•"></a>10. å¯¹è±¡çš„æ–°å¢æ–¹æ³•</h2><p><a href="https://es6.ruanyifeng.com/#docs/object-methods">æœ¬ç« </a>å†…å®¹å¤æ‚ï¼Œæ•…å…ˆè·³è¿‡ä¸€éƒ¨åˆ†ã€‚</p><h3 id="10-1-é™æ€æ–¹æ³•"><a href="#10-1-é™æ€æ–¹æ³•" class="headerlink" title="10.1 é™æ€æ–¹æ³•"></a>10.1 é™æ€æ–¹æ³•</h3><p><code>ES5</code> ä¸­æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œåªæœ‰ä¸¤ä¸ªè¿ç®—ç¬¦ï¼Œç›¸ç­‰è¿ç®—ç¬¦<code>==</code>å’Œä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦<code>===</code>ã€‚å®ƒä»¬éƒ½æœ‰ç¼ºç‚¹ï¼Œå‰è€…ä¼šè‡ªåŠ¨è½¬æ¢æ•°æ®ç±»å‹ï¼Œåè€…çš„<code>NaN</code>ä¸ç­‰äºè‡ªèº«ï¼Œä»¥åŠ<code>+0</code>ç­‰äº<code>-0</code>ã€‚</p><p><strong>é™æ€æ–¹æ³• 1ï¼š</strong><code>Object.is()</code>æ–¹æ³•ç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ä¸¥æ ¼ç›¸ç­‰ï¼Œä¸ä¸¥æ ¼æ¯”è¾ƒè¿ç®—ç¬¦<code>===</code>çš„è¡Œä¸ºåŸºæœ¬ä¸€è‡´ã€‚ä¸åŒä¹‹å¤„åªæœ‰ä¸¤ä¸ªï¼Œä¸€æ˜¯<code>+0</code>ä¸ç­‰äº<code>-0</code>ï¼ŒäºŒæ˜¯<code>NaN</code>ç­‰äºè‡ªèº«ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">is</span>(<span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">is</span>(&#123;&#125;, &#123;&#125;)</span><br><span class="line"><span class="comment">// false</span></span><br></pre></td></tr></table></figure><p><strong>é™æ€æ–¹æ³• 2ï¼š</strong><code>Object.assign()</code>æ–¹æ³•ç”¨äºå¯¹è±¡çš„åˆå¹¶ï¼Œå°†æºå¯¹è±¡<code>source</code>çš„æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼Œå¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡<code>target</code>ã€‚å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡å¯¹è±¡ï¼Œåé¢çš„å‚æ•°éƒ½æ˜¯æºå¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> target = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> source1 = &#123; <span class="attr">b</span>: <span class="number">2</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> source2 = &#123; <span class="attr">c</span>: <span class="number">3</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(target, source1, source2);</span><br><span class="line">target <span class="comment">// &#123;a:1, b:2, c:3&#125;</span></span><br></pre></td></tr></table></figure><p><code>Object.assign()</code>æœ‰ä»¥ä¸‹å‡ ä¸ªä½¿ç”¨æ³¨æ„ç‚¹ã€‚</p><p><strong>ï¼ˆ1ï¼‰æµ…æ‹·è´</strong></p><p><code>Object.assign()</code>æ–¹æ³•å®è¡Œçš„æ˜¯æµ…æ‹·è´ï¼Œè€Œä¸æ˜¯æ·±æ‹·è´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæºå¯¹è±¡æŸä¸ªå±æ€§çš„å€¼æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆç›®æ ‡å¯¹è±¡æ‹·è´å¾—åˆ°çš„æ˜¯è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const obj1 = &#123;a: &#123;b: 1&#125;&#125;;</span><br><span class="line">const obj2 = Object.assign(&#123;&#125;, obj1);</span><br><span class="line"></span><br><span class="line">obj1.a.b = 2;</span><br><span class="line">obj2.a.b // 2</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œæºå¯¹è±¡<code>obj1</code>çš„<code>a</code>å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œ<code>Object.assign()</code>æ‹·è´å¾—åˆ°çš„æ˜¯è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚è¿™ä¸ªå¯¹è±¡çš„ä»»ä½•å˜åŒ–ï¼Œéƒ½ä¼šåæ˜ åˆ°ç›®æ ‡å¯¹è±¡ä¸Šé¢ã€‚</p><p><strong>ï¼ˆ2ï¼‰åŒåå±æ€§çš„æ›¿æ¢</strong></p><p>å¯¹äºåµŒå¥—çš„å¯¹è±¡ï¼Œä¸€æ—¦é‡åˆ°åŒåå±æ€§ï¼Œ<code>Object.assign()</code>çš„å¤„ç†æ–¹æ³•æ˜¯æ›¿æ¢ï¼Œè€Œä¸æ˜¯æ·»åŠ ã€‚è¿™é€šå¸¸ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œéœ€è¦ç‰¹åˆ«å°å¿ƒã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> target = &#123; <span class="attr">a</span>: &#123; <span class="attr">b</span>: <span class="string">&#x27;c&#x27;</span>, <span class="attr">d</span>: <span class="string">&#x27;e&#x27;</span> &#125; &#125;</span><br><span class="line"><span class="keyword">const</span> source = &#123; <span class="attr">a</span>: &#123; <span class="attr">b</span>: <span class="string">&#x27;hello&#x27;</span> &#125; &#125;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(target, source)</span><br><span class="line"><span class="comment">// &#123; a: &#123; b: &#x27;hello&#x27; &#125; &#125;</span></span><br></pre></td></tr></table></figure><p><strong>é™æ€æ–¹æ³• 3ï¼š</strong>å¯¹äºæ™®é€šå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•å¯¹å¯¹è±¡è¿›è¡Œéå†ã€‚</p><ul><li><code>Object.keys()</code>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‚æ•°å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å¯éå†å±æ€§çš„é”®åã€‚</li><li><code>Object.values()</code>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‚æ•°å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å¯éå†å±æ€§çš„é”®å€¼ã€‚</li><li><code>Object.entries()</code>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‚æ•°å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å¯éå†å±æ€§çš„é”®å€¼å¯¹æ•°ç»„ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">foo</span>: <span class="string">&#x27;bar&#x27;</span>, <span class="attr">baz</span>: <span class="number">42</span> &#125;;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>(obj)</span><br><span class="line"><span class="comment">// [&quot;foo&quot;, &quot;baz&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">foo</span>: <span class="string">&#x27;bar&#x27;</span>, <span class="attr">baz</span>: <span class="number">42</span> &#125;;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">values</span>(obj)</span><br><span class="line"><span class="comment">// [&quot;bar&quot;, 42]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">foo</span>: <span class="string">&#x27;bar&#x27;</span>, <span class="attr">baz</span>: <span class="number">42</span> &#125;;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">entries</span>(obj)</span><br><span class="line"><span class="comment">// [ [&quot;foo&quot;, &quot;bar&quot;], [&quot;baz&quot;, 42] ]</span></span><br></pre></td></tr></table></figure><hr><h2 id="11-è¿ç®—ç¬¦çš„æ‰©å±•"><a href="#11-è¿ç®—ç¬¦çš„æ‰©å±•" class="headerlink" title="11. è¿ç®—ç¬¦çš„æ‰©å±•"></a>11. è¿ç®—ç¬¦çš„æ‰©å±•</h2><h3 id="11-1-é“¾åˆ¤æ–­è¿ç®—ç¬¦"><a href="#11-1-é“¾åˆ¤æ–­è¿ç®—ç¬¦" class="headerlink" title="11.1 é“¾åˆ¤æ–­è¿ç®—ç¬¦"></a>11.1 é“¾åˆ¤æ–­è¿ç®—ç¬¦</h3><p>å½“æˆ‘ä»¬æ‰“ç®—è¯»å–å¯¹è±¡å†…éƒ¨çš„æŸä¸ªå±æ€§æ—¶ï¼Œå¾€å¾€éœ€è¦åˆ¤æ–­ä¸€ä¸‹å±æ€§çš„ä¸Šå±‚å¯¹è±¡æ˜¯å¦å­˜åœ¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é”™è¯¯çš„å†™æ³•</span></span><br><span class="line"><span class="keyword">const</span> firstName = message.<span class="property">body</span>.<span class="property">user</span>.<span class="property">firstName</span> || <span class="string">&#x27;default&#x27;</span>; <span class="comment">// æ— æ³•ä¿è¯ message.body å­˜åœ¨...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­£ç¡®çš„å†™æ³•</span></span><br><span class="line"><span class="keyword">const</span> firstName = (message</span><br><span class="line">  &amp;&amp; message.<span class="property">body</span></span><br><span class="line">  &amp;&amp; message.<span class="property">body</span>.<span class="property">user</span></span><br><span class="line">  &amp;&amp; message.<span class="property">body</span>.<span class="property">user</span>.<span class="property">firstName</span>) || <span class="string">&#x27;default&#x27;</span>;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>firstName</code>å±æ€§åœ¨å¯¹è±¡çš„ç¬¬å››å±‚ï¼Œæ‰€ä»¥éœ€è¦åˆ¤æ–­å››æ¬¡ï¼Œæ¯ä¸€å±‚æ˜¯å¦æœ‰å€¼ã€‚è¿™æ ·çš„å±‚å±‚åˆ¤æ–­éå¸¸éº»çƒ¦ï¼Œå› æ­¤ <code>ES6</code> å¼•å…¥äº†â€œé“¾åˆ¤æ–­è¿ç®—ç¬¦â€ <code>?.</code>ï¼Œç”¨æ¥ç®€åŒ–ä¸Šé¢çš„å†™æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> firstName = message?.<span class="property">body</span>?.<span class="property">user</span>?.<span class="property">firstName</span> || <span class="string">&#x27;default&#x27;</span>;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä½¿ç”¨äº†<code>?.</code>è¿ç®—ç¬¦ï¼Œç›´æ¥åœ¨é“¾å¼è°ƒç”¨çš„æ—¶å€™åˆ¤æ–­ï¼Œå·¦ä¾§çš„å¯¹è±¡æ˜¯å¦ä¸º<code>null</code>æˆ–<code>undefined</code>ã€‚å¦‚æœæ˜¯çš„ï¼Œå°±ä¸å†å¾€ä¸‹è¿ç®—ï¼Œè€Œæ˜¯è¿”å›<code>undefined</code>ã€‚</p><p>ä¸‹é¢æ˜¯ <code>?.</code> è¿ç®—ç¬¦å¸¸è§å½¢å¼ï¼Œä»¥åŠä¸ä½¿ç”¨è¯¥è¿ç®—ç¬¦æ—¶çš„ç­‰ä»·å½¢å¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">a?.<span class="property">b</span></span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line">a == <span class="literal">null</span> ? <span class="literal">undefined</span> : a.<span class="property">b</span></span><br><span class="line"></span><br><span class="line">a?.[x]</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line">a == <span class="literal">null</span> ? <span class="literal">undefined</span> : a[x]</span><br><span class="line"></span><br><span class="line">a?.<span class="title function_">b</span>()</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line">a == <span class="literal">null</span> ? <span class="literal">undefined</span> : a.<span class="title function_">b</span>()</span><br><span class="line"></span><br><span class="line">a?.()</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line">a == <span class="literal">null</span> ? <span class="literal">undefined</span> : <span class="title function_">a</span>()</span><br></pre></td></tr></table></figure><hr><h3 id="11-2-Null-åˆ¤æ–­è¿ç®—ç¬¦"><a href="#11-2-Null-åˆ¤æ–­è¿ç®—ç¬¦" class="headerlink" title="11.2 Null åˆ¤æ–­è¿ç®—ç¬¦"></a>11.2 Null åˆ¤æ–­è¿ç®—ç¬¦</h3><p>è¯»å–å¯¹è±¡å±æ€§çš„æ—¶å€™ï¼Œå¦‚æœæŸä¸ªå±æ€§çš„å€¼æ˜¯<code>null</code>æˆ–<code>undefined</code>ï¼Œæœ‰æ—¶å€™éœ€è¦ä¸ºå®ƒä»¬æŒ‡å®šé»˜è®¤å€¼ã€‚å¸¸è§åšæ³•æ˜¯é€šè¿‡<code>||</code>è¿ç®—ç¬¦æŒ‡å®šé»˜è®¤å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> headerText = response.<span class="property">settings</span>.<span class="property">headerText</span> || <span class="string">&#x27;Hello, world!&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> animationDuration = response.<span class="property">settings</span>.<span class="property">animationDuration</span> || <span class="number">300</span>;</span><br><span class="line"><span class="keyword">const</span> showSplashScreen = response.<span class="property">settings</span>.<span class="property">showSplashScreen</span> || <span class="literal">true</span>;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å±æ€§çš„å€¼å¦‚æœä¸ºç©ºå­—ç¬¦ä¸²æˆ–<code>false</code>æˆ–<code>0</code>ï¼Œé»˜è®¤å€¼ä¹Ÿä¼šç”Ÿæ•ˆã€‚ä¸ºæ­¤ï¼Œ<code>ES6</code> å¼•å…¥äº†ä¸€ä¸ªæ–°çš„ <code>Null</code> åˆ¤æ–­è¿ç®—ç¬¦<code>??</code>ã€‚å®ƒçš„è¡Œä¸ºç±»ä¼¼<code>||</code>ï¼Œä½†æ˜¯åªæœ‰è¿ç®—ç¬¦å·¦ä¾§çš„å€¼ä¸º<code>null</code>æˆ–<code>undefined</code>æ—¶ï¼Œæ‰ä¼šè¿”å›å³ä¾§çš„å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> animationDuration = response.<span class="property">settings</span>?.<span class="property">animationDuration</span> ?? <span class="number">300</span>;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœ<code>response.settings</code>æ˜¯<code>null</code>æˆ–<code>undefined</code>ï¼Œæˆ–è€…<code>response.settings.animationDuration</code>æ˜¯<code>null</code>æˆ–<code>undefined</code>ï¼Œå°±ä¼šè¿”å›é»˜è®¤å€¼<code>300</code>ã€‚</p><hr><h2 id="12-Symbol-æ•°æ®ç±»å‹"><a href="#12-Symbol-æ•°æ®ç±»å‹" class="headerlink" title="12. Symbol æ•°æ®ç±»å‹"></a>12. Symbol æ•°æ®ç±»å‹</h2><p><a href="https://es6.ruanyifeng.com/#docs/symbol">æœ¬ç« </a>å†…å®¹å¤æ‚ï¼Œæ•…å…ˆè·³è¿‡ä¸€éƒ¨åˆ†ã€‚</p><h3 id="12-1-Symbol-æ¦‚è¿°"><a href="#12-1-Symbol-æ¦‚è¿°" class="headerlink" title="12.1 Symbol æ¦‚è¿°"></a>12.1 Symbol æ¦‚è¿°</h3><p><code>ES6</code> å¼•å…¥äº†ä¸€ç§æ–°çš„åŸå§‹æ•°æ®ç±»å‹ <code>Symbol</code>ï¼Œè¡¨ç¤ºç‹¬ä¸€æ— äºŒçš„å€¼ã€‚</p><p><code>Symbol</code> é€šè¿‡ <code>Symbol()</code> å‡½æ•°ç”Ÿæˆï¼Œå¯ä»¥ç”¨äºä¸ºå¯¹è±¡æ·»åŠ æ–°çš„æ–¹æ³•ï¼Œä¸”ä¸å­˜åœ¨å±æ€§åå†²çªã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="title class_">Symbol</span>(); <span class="comment">// Symbol() å‡½æ•°å‰ä¸èƒ½ä½¿ç”¨ new å‘½ä»¤</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typeof</span> s</span><br><span class="line"><span class="comment">// &quot;symbol&quot;</span></span><br></pre></td></tr></table></figure><p><code>ES6</code> æä¾›äº†ä¸€ä¸ª <code>Symbol</code> å€¼çš„å®ä¾‹å±æ€§<code>description</code>ï¼Œç›´æ¥è¿”å› <code>Symbol</code> å€¼çš„æè¿°ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> sym = <span class="title class_">Symbol</span>(<span class="string">&#x27;foo&#x27;</span>); <span class="comment">// å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°</span></span><br><span class="line"></span><br><span class="line">sym <span class="comment">// [object Symbol] &#123; ... &#125;</span></span><br><span class="line">sym.<span class="title function_">toString</span>() <span class="comment">// &quot;Symbol(foo)&quot;</span></span><br><span class="line"></span><br><span class="line">sym.<span class="property">description</span> <span class="comment">// &quot;foo&quot;</span></span><br></pre></td></tr></table></figure><p>å› ä¸º <code>Symbol</code> å€¼éƒ½æ˜¯ä¸ç›¸ç­‰çš„ï¼ˆå°±ç®—æ˜¯ç›¸åŒæè¿°ï¼Œé™¤éä½¿ç”¨ <a href="https://es6.ruanyifeng.com/#docs/symbol#Symbol-for%EF%BC%8CSymbol-keyFor"><code>Symbol.for</code></a>ï¼‰ï¼Œä½¿ç”¨ <code>Symbol</code> å€¼ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œç”¨äºå¯¹è±¡çš„å±æ€§åï¼Œå°±èƒ½ä¿è¯ä¸ä¼šå‡ºç°åŒåçš„å±æ€§ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> mySymbol = <span class="title class_">Symbol</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸€ç§å†™æ³•</span></span><br><span class="line"><span class="keyword">let</span> a = &#123;&#125;;</span><br><span class="line">a[mySymbol] = <span class="string">&#x27;Hello!&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬äºŒç§å†™æ³•</span></span><br><span class="line"><span class="keyword">let</span> a = &#123;</span><br><span class="line">  [mySymbol]: <span class="string">&#x27;Hello!&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»¥ä¸Šå†™æ³•éƒ½å¾—åˆ°åŒæ ·ç»“æœ</span></span><br><span class="line">a[mySymbol] <span class="comment">// &quot;Hello!&quot;</span></span><br></pre></td></tr></table></figure><hr><h2 id="13-Set-å’Œ-Map-æ•°æ®ç»“æ„"><a href="#13-Set-å’Œ-Map-æ•°æ®ç»“æ„" class="headerlink" title="13. Set å’Œ Map æ•°æ®ç»“æ„"></a>13. Set å’Œ Map æ•°æ®ç»“æ„</h2><p><a href="https://es6.ruanyifeng.com/#docs/set-map">æœ¬ç« </a>è·³è¿‡ <code>WeakSet</code> å’Œ <code>WeakMap</code> éƒ¨åˆ†ã€‚</p><h3 id="13-1-Set-åŸºæœ¬ç”¨æ³•"><a href="#13-1-Set-åŸºæœ¬ç”¨æ³•" class="headerlink" title="13.1 Set åŸºæœ¬ç”¨æ³•"></a>13.1 Set åŸºæœ¬ç”¨æ³•</h3><p><code>ES6</code>æä¾›äº†æ–°çš„æ•°æ®ç»“æ„ <code>Set</code>ã€‚å®ƒç±»ä¼¼äºæ•°ç»„ï¼Œä½†æ˜¯<ins>æˆå‘˜çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæ²¡æœ‰é‡å¤çš„å€¼</ins>ã€‚å®ƒå¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„ï¼Œæˆ–è€…å…·æœ‰ <code>iterable</code> æ¥å£çš„å…¶ä»–æ•°æ®ç»“æ„ï¼Œä½œä¸ºå‚æ•°åˆå§‹åŒ–ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> s = <span class="keyword">new</span> <span class="title class_">Set</span>();</span><br><span class="line"></span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">2</span>].<span class="title function_">forEach</span>(<span class="function"><span class="params">x</span> =&gt;</span> s.<span class="title function_">add</span>(x));</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> s) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2 3 5 4</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢ä»‹ç» <code>Set</code> å®ä¾‹çš„å±æ€§å’Œæ–¹æ³•ï¼š</p><ul><li><code>Set.prototype.size</code>ï¼šè¿”å›<code>Set</code>å®ä¾‹çš„æˆå‘˜æ€»æ•°ã€‚</li><li><code>Set.prototype.add(value)</code>ï¼šæ·»åŠ æŸä¸ªå€¼ï¼Œè¿”å› <code>Set</code> ç»“æ„æœ¬èº«ã€‚</li><li><code>Set.prototype.delete(value)</code>ï¼šåˆ é™¤æŸä¸ªå€¼ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºåˆ é™¤æ˜¯å¦æˆåŠŸã€‚</li><li><code>Set.prototype.has(value)</code>ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥å€¼æ˜¯å¦ä¸º<code>Set</code>çš„æˆå‘˜ã€‚</li><li><code>Set.prototype.clear()</code>ï¼šæ¸…é™¤æ‰€æœ‰æˆå‘˜ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> s = <span class="keyword">new</span> <span class="title class_">Set</span>();</span><br><span class="line">s.<span class="title function_">add</span>(<span class="number">1</span>).<span class="title function_">add</span>(<span class="number">2</span>).<span class="title function_">add</span>(<span class="number">2</span>);</span><br><span class="line"><span class="comment">// æ³¨æ„2è¢«åŠ å…¥äº†ä¸¤æ¬¡</span></span><br><span class="line"></span><br><span class="line">s.<span class="property">size</span> <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line">s.<span class="title function_">has</span>(<span class="number">1</span>) <span class="comment">// true</span></span><br><span class="line">s.<span class="title function_">has</span>(<span class="number">2</span>) <span class="comment">// true</span></span><br><span class="line">s.<span class="title function_">has</span>(<span class="number">3</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">s.<span class="title function_">delete</span>(<span class="number">2</span>);</span><br><span class="line">s.<span class="title function_">has</span>(<span class="number">2</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p><code>Set</code> ç»“æ„çš„å®ä¾‹é»˜è®¤å¯éå†, å¯ä»¥ç›´æ¥ç”¨<code>for...of</code>å¾ªç¯éå† <code>Set</code>ã€‚ä¹Ÿå¯ä»¥ç”¨<code>forEach</code>æ–¹æ³•ï¼Œç”¨äºå¯¹æ¯ä¸ªæˆå‘˜æ‰§è¡ŒæŸç§æ“ä½œï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> set) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// red</span></span><br><span class="line"><span class="comment">// green</span></span><br><span class="line"><span class="comment">// blue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>]);</span><br><span class="line">set.<span class="title function_">forEach</span>(<span class="function">(<span class="params">value, key</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(key + <span class="string">&#x27; : &#x27;</span> + value))</span><br><span class="line"><span class="comment">// 1 : 1</span></span><br><span class="line"><span class="comment">// 4 : 4</span></span><br><span class="line"><span class="comment">// 9 : 9</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­<code>forEach</code>æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªå¤„ç†å‡½æ•°ã€‚ä½†æ˜¯å› ä¸º <code>Set</code> ç»“æ„çš„é”®åå°±æ˜¯é”®å€¼ï¼Œå› æ­¤ç¬¬ä¸€ä¸ªå‚æ•°ä¸ç¬¬äºŒä¸ªå‚æ•°çš„å€¼æ°¸è¿œéƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><hr><h3 id="13-2-Set-éå†çš„åº”ç”¨"><a href="#13-2-Set-éå†çš„åº”ç”¨" class="headerlink" title="13.2 Set éå†çš„åº”ç”¨"></a>13.2 Set éå†çš„åº”ç”¨</h3><p>æ‰©å±•è¿ç®—ç¬¦å’Œ <code>Set</code> ç»“æ„ç›¸ç»“åˆï¼Œå¯ä»¥å»é™¤æ•°ç»„çš„é‡å¤æˆå‘˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å»é™¤æ•°ç»„çš„é‡å¤æˆå‘˜</span></span><br><span class="line">[...<span class="keyword">new</span> <span class="title class_">Set</span>(array)]</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»é™¤å­—ç¬¦ä¸²é‡Œé¢çš„é‡å¤å­—ç¬¦</span></span><br><span class="line">[...<span class="keyword">new</span> <span class="title class_">Set</span>(<span class="string">&#x27;ababbc&#x27;</span>)].<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">// &quot;abc&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨Array.fromæ–¹æ³•å¯ä»¥å°† Set ç»“æ„è½¬ä¸ºæ•°ç»„ã€‚</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">dedupe</span>(<span class="params">array</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="keyword">new</span> <span class="title class_">Set</span>(array));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">dedupe</span>([<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]) <span class="comment">// [1, 2, 3]</span></span><br></pre></td></tr></table></figure><p>æ•°ç»„çš„<code>map</code>å’Œ<code>filter</code>æ–¹æ³•ä¹Ÿå¯ä»¥é—´æ¥ç”¨äº <code>Set</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line">set = <span class="keyword">new</span> <span class="title class_">Set</span>([...set].<span class="title function_">map</span>(<span class="function"><span class="params">x</span> =&gt;</span> x * <span class="number">2</span>));</span><br><span class="line"><span class="comment">// è¿”å›Setç»“æ„ï¼š&#123;2, 4, 6&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]);</span><br><span class="line">set = <span class="keyword">new</span> <span class="title class_">Set</span>([...set].<span class="title function_">filter</span>(<span class="function"><span class="params">x</span> =&gt;</span> (x % <span class="number">2</span>) == <span class="number">0</span>));</span><br><span class="line"><span class="comment">// è¿”å›Setç»“æ„ï¼š&#123;2, 4&#125;</span></span><br></pre></td></tr></table></figure><hr><h3 id="13-3-Map-åŸºæœ¬ç”¨æ³•"><a href="#13-3-Map-åŸºæœ¬ç”¨æ³•" class="headerlink" title="13.3 Map åŸºæœ¬ç”¨æ³•"></a>13.3 Map åŸºæœ¬ç”¨æ³•</h3><p><code>Map</code> æ•°æ®ç»“æ„ç±»ä¼¼äºå¯¹è±¡ï¼Œæ˜¯é”®å€¼å¯¹çš„é›†åˆï¼Œä½†æ˜¯å„ç§ç±»å‹çš„å€¼ï¼ˆåŒ…æ‹¬å¯¹è±¡ï¼‰éƒ½å¯ä»¥å½“ä½œé”®ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>([</span><br><span class="line">  [<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;å¼ ä¸‰&#x27;</span>],</span><br><span class="line">  [<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;Author&#x27;</span>]</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line">map.<span class="property">size</span> <span class="comment">// 2</span></span><br><span class="line">map.<span class="title function_">has</span>(<span class="string">&#x27;name&#x27;</span>) <span class="comment">// true</span></span><br><span class="line">map.<span class="title function_">get</span>(<span class="string">&#x27;name&#x27;</span>) <span class="comment">// &quot;å¼ ä¸‰&quot;</span></span><br><span class="line">map.<span class="title function_">has</span>(<span class="string">&#x27;title&#x27;</span>) <span class="comment">// true</span></span><br><span class="line">map.<span class="title function_">get</span>(<span class="string">&#x27;title&#x27;</span>) <span class="comment">// &quot;Author&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢ä»‹ç» <code>Map</code> å®ä¾‹çš„å±æ€§å’Œæ–¹æ³•ï¼š</p><ul><li><code>Map.prototype.size</code>ï¼šè¿”å› <code>Map</code> ç»“æ„çš„æˆå‘˜æ€»æ•°ã€‚</li><li><code>Map.prototype.set(key, value)</code>ï¼šè®¾ç½®é”®å<code>key</code>å¯¹åº”çš„é”®å€¼ä¸º<code>value</code>ï¼Œç„¶åè¿”å›æ•´ä¸ª <code>Map</code> ç»“æ„ã€‚å¦‚æœ<code>key</code>å·²ç»æœ‰å€¼ï¼Œåˆ™é”®å€¼ä¼šè¢«æ›´æ–°ï¼Œå¦åˆ™å°±æ–°ç”Ÿæˆè¯¥é”®ã€‚</li><li><code>Map.prototype.get(key)</code>ï¼šè¯»å–<code>key</code>å¯¹åº”çš„é”®å€¼ï¼Œå¦‚æœæ‰¾ä¸åˆ°<code>key</code>ï¼Œè¿”å›<code>undefined</code>ã€‚</li><li><code>Map.prototype.has(key)</code>ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªé”®æ˜¯å¦åœ¨å½“å‰ <code>Map</code> å¯¹è±¡ä¹‹ä¸­ã€‚</li><li><code>Map.prototype.delete(key)</code>ï¼šåˆ é™¤æŸä¸ªé”®ï¼Œè¿”å›<code>true</code>ã€‚å¦‚æœåˆ é™¤å¤±è´¥ï¼Œè¿”å›<code>false</code>ã€‚</li><li><code>Map.prototype.clear()</code>ï¼šæ¸…é™¤æ‰€æœ‰æˆå‘˜ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">map.<span class="title function_">set</span>(<span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line">map.<span class="title function_">set</span>(<span class="string">&#x27;bar&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">map.<span class="property">size</span> <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line">map.<span class="title function_">get</span>(<span class="string">&#x27;foo&#x27;</span>) <span class="comment">// hello</span></span><br><span class="line">map.<span class="title function_">has</span>(<span class="string">&#x27;foo&#x27;</span>) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">map.<span class="title function_">delete</span>(<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line">map.<span class="title function_">has</span>(<span class="string">&#x27;foo&#x27;</span>) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">map.<span class="title function_">clear</span>()</span><br><span class="line">map.<span class="property">size</span> <span class="comment">// 0</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢ä»‹ç» <code>Map</code> ç»“æ„åŸç”Ÿæä¾›ä¸‰ä¸ªéå†å™¨ç”Ÿæˆå‡½æ•°å’Œä¸€ä¸ªéå†æ–¹æ³•ï¼š</p><ul><li><code>Map.prototype.keys()</code>ï¼šè¿”å›é”®åçš„éå†å™¨ã€‚</li><li><code>Map.prototype.values()</code>ï¼šè¿”å›é”®å€¼çš„éå†å™¨ã€‚</li><li><code>Map.prototype.entries()</code>ï¼šè¿”å›æ‰€æœ‰æˆå‘˜çš„éå†å™¨ã€‚</li><li><code>Map.prototype.forEach()</code>ï¼šéå† <code>Map</code> çš„æ‰€æœ‰æˆå‘˜ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>([</span><br><span class="line">  [<span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;no&#x27;</span>],</span><br><span class="line">  [<span class="string">&#x27;T&#x27;</span>,  <span class="string">&#x27;yes&#x27;</span>],</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> map.<span class="title function_">keys</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &quot;F&quot;</span></span><br><span class="line"><span class="comment">// &quot;T&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> map.<span class="title function_">values</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &quot;no&quot;</span></span><br><span class="line"><span class="comment">// &quot;yes&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> map.<span class="title function_">entries</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(item[<span class="number">0</span>], item[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &quot;F&quot; &quot;no&quot;</span></span><br><span class="line"><span class="comment">// &quot;T&quot; &quot;yes&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map.<span class="title function_">entries</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(key, value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &quot;F&quot; &quot;no&quot;</span></span><br><span class="line"><span class="comment">// &quot;T&quot; &quot;yes&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰åŒäºä½¿ç”¨map.entries()</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(key, value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &quot;F&quot; &quot;no&quot;</span></span><br><span class="line"><span class="comment">// &quot;T&quot; &quot;yes&quot;</span></span><br><span class="line"></span><br><span class="line">map.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">value, key, map</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Key: %s, Value: %s&quot;</span>, key, value);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œ<code>Map</code> çš„éå†é¡ºåºå°±æ˜¯æ’å…¥é¡ºåºã€‚</p><hr><h3 id="13-4-Map-ä¸å…¶ä»–æ•°æ®ç»“æ„è½¬æ¢"><a href="#13-4-Map-ä¸å…¶ä»–æ•°æ®ç»“æ„è½¬æ¢" class="headerlink" title="13.4 Map ä¸å…¶ä»–æ•°æ®ç»“æ„è½¬æ¢"></a>13.4 Map ä¸å…¶ä»–æ•°æ®ç»“æ„è½¬æ¢</h3><p><strong>ï¼ˆ1ï¼‰Map è½¬ä¸ºæ•°ç»„</strong></p><p><code>Map</code> è½¬ä¸ºæ•°ç»„æœ€æ–¹ä¾¿çš„æ–¹æ³•ï¼Œå°±æ˜¯ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦<code>...</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> myMap = <span class="keyword">new</span> <span class="title class_">Map</span>()</span><br><span class="line">  .<span class="title function_">set</span>(<span class="literal">true</span>, <span class="number">7</span>)</span><br><span class="line">  .<span class="title function_">set</span>(&#123;<span class="attr">foo</span>: <span class="number">3</span>&#125;, [<span class="string">&#x27;abc&#x27;</span>]);</span><br><span class="line">[...myMap]</span><br><span class="line"><span class="comment">// [ [ true, 7 ], [ &#123; foo: 3 &#125;, [ &#x27;abc&#x27; ] ] ]</span></span><br></pre></td></tr></table></figure><p>ç»“åˆæ•°ç»„çš„<code>map</code>æ–¹æ³•ã€<code>filter</code>æ–¹æ³•ï¼Œå°±å¯ä»¥å®ç° <code>Map</code> çš„éå†å’Œè¿‡æ»¤ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> map0 = <span class="keyword">new</span> <span class="title class_">Map</span>()</span><br><span class="line">  .<span class="title function_">set</span>(<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">  .<span class="title function_">set</span>(<span class="number">2</span>, <span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">  .<span class="title function_">set</span>(<span class="number">3</span>, <span class="string">&#x27;c&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> map1 = <span class="keyword">new</span> <span class="title class_">Map</span>(</span><br><span class="line">  [...map0].<span class="title function_">filter</span>(<span class="function">(<span class="params">[k, v]</span>) =&gt;</span> k &lt; <span class="number">3</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">// äº§ç”Ÿ Map ç»“æ„ &#123;1 =&gt; &#x27;a&#x27;, 2 =&gt; &#x27;b&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> map2 = <span class="keyword">new</span> <span class="title class_">Map</span>(</span><br><span class="line">  [...map0].<span class="title function_">map</span>(<span class="function">(<span class="params">[k, v]</span>) =&gt;</span> [k * <span class="number">2</span>, <span class="string">&#x27;_&#x27;</span> + v])</span><br><span class="line">);</span><br><span class="line"><span class="comment">// äº§ç”Ÿ Map ç»“æ„ &#123;2 =&gt; &#x27;_a&#x27;, 4 =&gt; &#x27;_b&#x27;, 6 =&gt; &#x27;_c&#x27;&#125;</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ2ï¼‰æ•°ç»„ è½¬ä¸º Map</strong></p><p>å°†æ•°ç»„ä¼ å…¥ <code>Map</code> æ„é€ å‡½æ•°ï¼Œå°±å¯ä»¥è½¬ä¸º <code>Map</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Map</span>([</span><br><span class="line">  [<span class="literal">true</span>, <span class="number">7</span>],</span><br><span class="line">  [&#123;<span class="attr">foo</span>: <span class="number">3</span>&#125;, [<span class="string">&#x27;abc&#x27;</span>]]</span><br><span class="line">])</span><br><span class="line"><span class="comment">// Map &#123;</span></span><br><span class="line"><span class="comment">//   true =&gt; 7,</span></span><br><span class="line"><span class="comment">//   Object &#123;foo: 3&#125; =&gt; [&#x27;abc&#x27;]</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ3ï¼‰Map è½¬ä¸ºå¯¹è±¡</strong></p><p>å¦‚æœæ‰€æœ‰ <code>Map</code> çš„é”®éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå¯ä»¥æ— æŸåœ°è½¬ä¸ºå¯¹è±¡ã€‚å¦‚æœæœ‰éå­—ç¬¦ä¸²çš„é”®åï¼Œé‚£ä¹ˆè¿™ä¸ªé”®åä¼šè¢«è½¬æˆå­—ç¬¦ä¸²ï¼Œå†ä½œä¸ºå¯¹è±¡çš„é”®åã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">strMapToObj</span>(<span class="params">strMap</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> obj = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> [k,v] <span class="keyword">of</span> strMap) &#123;</span><br><span class="line">    obj[k] = v;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myMap = <span class="keyword">new</span> <span class="title class_">Map</span>()</span><br><span class="line">  .<span class="title function_">set</span>(<span class="string">&#x27;yes&#x27;</span>, <span class="literal">true</span>)</span><br><span class="line">  .<span class="title function_">set</span>(<span class="string">&#x27;no&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="title function_">strMapToObj</span>(myMap)</span><br><span class="line"><span class="comment">// &#123; yes: true, no: false &#125;</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ4ï¼‰å¯¹è±¡è½¬ä¸º Map</strong></p><p>å¯¹è±¡è½¬ä¸º <code>Map</code> å¯ä»¥é€šè¿‡ <code>Object.entries()</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;<span class="string">&quot;a&quot;</span>:<span class="number">1</span>, <span class="string">&quot;b&quot;</span>:<span class="number">2</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>(<span class="title class_">Object</span>.<span class="title function_">entries</span>(obj));</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ5ï¼‰Map è½¬ä¸º JSON</strong></p><p><code>Map</code> è½¬ä¸º <code>JSON</code> è¦åŒºåˆ†ä¸¤ç§æƒ…å†µã€‚</p><p>ä¸€ç§æƒ…å†µæ˜¯ï¼Œ<code>Map</code> çš„é”®åéƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ—¶å¯ä»¥é€‰æ‹©è½¬ä¸ºå¯¹è±¡ <code>JSON</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">strMapToJson</span>(<span class="params">strMap</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="title function_">strMapToObj</span>(strMap));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> myMap = <span class="keyword">new</span> <span class="title class_">Map</span>().<span class="title function_">set</span>(<span class="string">&#x27;yes&#x27;</span>, <span class="literal">true</span>).<span class="title function_">set</span>(<span class="string">&#x27;no&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="title function_">strMapToJson</span>(myMap)</span><br><span class="line"><span class="comment">// &#x27;&#123;&quot;yes&quot;:true,&quot;no&quot;:false&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>å¦ä¸€ç§æƒ…å†µæ˜¯ï¼Œ<code>Map</code> çš„é”®åæœ‰éå­—ç¬¦ä¸²ï¼Œè¿™æ—¶å¯ä»¥é€‰æ‹©è½¬ä¸ºæ•°ç»„ <code>JSON</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">mapToArrayJson</span>(<span class="params">map</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">stringify</span>([...map]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> myMap = <span class="keyword">new</span> <span class="title class_">Map</span>().<span class="title function_">set</span>(<span class="literal">true</span>, <span class="number">7</span>).<span class="title function_">set</span>(&#123;<span class="attr">foo</span>: <span class="number">3</span>&#125;, [<span class="string">&#x27;abc&#x27;</span>]);</span><br><span class="line"><span class="title function_">mapToArrayJson</span>(myMap)</span><br><span class="line"><span class="comment">// &#x27;[[true,7],[&#123;&quot;foo&quot;:3&#125;,[&quot;abc&quot;]]]&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ6ï¼‰JSON è½¬ä¸º Map</strong></p><p><code>JSON</code> è½¬ä¸º <code>Map</code>ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œæ‰€æœ‰é”®åéƒ½æ˜¯å­—ç¬¦ä¸²ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">objToStrMap</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> strMap = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> k <span class="keyword">of</span> <span class="title class_">Object</span>.<span class="title function_">keys</span>(obj)) &#123;</span><br><span class="line">    strMap.<span class="title function_">set</span>(k, obj[k]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> strMap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">jsonToStrMap</span>(<span class="params">jsonStr</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">objToStrMap</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(jsonStr)); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">jsonToStrMap</span>(<span class="string">&#x27;&#123;&quot;yes&quot;: true, &quot;no&quot;: false&#125;&#x27;</span>)</span><br><span class="line"><span class="comment">// Map &#123;&#x27;yes&#x27; =&gt; true, &#x27;no&#x27; =&gt; false&#125;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæ•´ä¸ª <code>JSON</code> å°±æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¸”æ¯ä¸ªæ•°ç»„æˆå‘˜æœ¬èº«ï¼Œåˆæ˜¯ä¸€ä¸ªæœ‰ä¸¤ä¸ªæˆå‘˜çš„æ•°ç»„ã€‚è¿™æ—¶ï¼Œå®ƒå¯ä»¥ç›´æ¥è½¬ä¸º <code>Map</code>ã€‚ï¼ˆç±»ä¼¼ <code>Map</code> è½¬ä¸ºæ•°ç»„ <code>JSON</code> çš„é€†æ“ä½œï¼‰</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">jsonToMap</span>(<span class="params">jsonStr</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Map</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(jsonStr));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">jsonToMap</span>(<span class="string">&#x27;[[true,7],[&#123;&quot;foo&quot;:3&#125;,[&quot;abc&quot;]]]&#x27;</span>)</span><br><span class="line"><span class="comment">// Map &#123;true =&gt; 7, Object &#123;foo: 3&#125; =&gt; [&#x27;abc&#x27;]&#125;</span></span><br></pre></td></tr></table></figure><hr><h2 id="14-Proxy"><a href="#14-Proxy" class="headerlink" title="14. Proxy"></a>14. Proxy</h2><p><a href="https://es6.ruanyifeng.com/#docs/proxy">æœ¬ç« </a>å†…å®¹å¤æ‚ï¼Œæ•…å…ˆè·³è¿‡ä¸€éƒ¨åˆ†ã€‚</p><h3 id="14-1-Proxy-æ¦‚è¿°"><a href="#14-1-Proxy-æ¦‚è¿°" class="headerlink" title="14.1 Proxy æ¦‚è¿°"></a>14.1 Proxy æ¦‚è¿°</h3><p><code>Proxy</code> å¯ä»¥ç†è§£æˆï¼Œ<ins>åœ¨ç›®æ ‡å¯¹è±¡ä¹‹å‰æ¶è®¾ä¸€å±‚â€œæ‹¦æˆªâ€ï¼Œå¤–ç•Œå¯¹è¯¥å¯¹è±¡çš„è®¿é—®ï¼Œéƒ½å¿…é¡»å…ˆé€šè¿‡è¿™å±‚æ‹¦æˆªï¼Œå› æ­¤æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥å¯¹å¤–ç•Œçš„è®¿é—®è¿›è¡Œè¿‡æ»¤å’Œæ”¹å†™</ins>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> <span class="title class_">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">  <span class="attr">get</span>: <span class="keyword">function</span> (<span class="params">target, propKey, receiver</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`getting <span class="subst">$&#123;propKey&#125;</span>!`</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">get</span>(target, propKey, receiver);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">set</span>: <span class="keyword">function</span> (<span class="params">target, propKey, value, receiver</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`setting <span class="subst">$&#123;propKey&#125;</span>!`</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">set</span>(target, propKey, value, receiver);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç å¯¹ä¸€ä¸ªç©ºå¯¹è±¡æ¶è®¾äº†ä¸€å±‚æ‹¦æˆªï¼Œé‡å®šä¹‰äº†å±æ€§çš„è¯»å–<code>get</code>å’Œè®¾ç½®<code>set</code>è¡Œä¸ºã€‚å¯¹è®¾ç½®äº†æ‹¦æˆªè¡Œä¸ºçš„å¯¹è±¡<code>obj</code>è¯»å†™å®ƒçš„å±æ€§ï¼Œå°±ä¼šå¾—åˆ°ä¸‹é¢çš„ç»“æœã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">obj.<span class="property">count</span> = <span class="number">1</span></span><br><span class="line"><span class="comment">//  setting count!</span></span><br><span class="line">++obj.<span class="property">count</span></span><br><span class="line"><span class="comment">//  getting count!</span></span><br><span class="line"><span class="comment">//  setting count!</span></span><br><span class="line"><span class="comment">//  2</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œ<code>Proxy</code> å®é™…ä¸Šé‡è½½<code>overload</code>äº†ç‚¹è¿ç®—ç¬¦ï¼Œå³ç”¨è‡ªå·±çš„å®šä¹‰è¦†ç›–äº†è¯­è¨€çš„åŸå§‹å®šä¹‰ã€‚(ç±»ä¼¼<code>C++</code>çš„é‡è½½)</p><p><code>ES6</code> åŸç”Ÿæä¾› <code>Proxy</code> æ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆ <code>Proxy</code> å®ä¾‹ã€‚<code>target</code>å‚æ•°è¡¨ç¤ºæ‰€è¦æ‹¦æˆªçš„ç›®æ ‡å¯¹è±¡ï¼Œ<code>handler</code>å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥å®šåˆ¶æ‹¦æˆªè¡Œä¸ºã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> proxy = <span class="keyword">new</span> <span class="title class_">Proxy</span>(target, handler);</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªæ‹¦æˆªè¯»å–å±æ€§è¡Œä¸ºçš„ä¾‹å­ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> proxy = <span class="keyword">new</span> <span class="title class_">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">  <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params">target, propKey</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">35</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">proxy.<span class="property">time</span> <span class="comment">// 35</span></span><br><span class="line">proxy.<span class="property">name</span> <span class="comment">// 35</span></span><br><span class="line">proxy.<span class="property">title</span> <span class="comment">// 35</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œä½œä¸ºæ„é€ å‡½æ•°ï¼Œ<code>Proxy</code>æ¥å—ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ‰€è¦ä»£ç†çš„ç›®æ ‡å¯¹è±¡ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œå¯¹äºæ¯ä¸€ä¸ªè¢«ä»£ç†çš„æ“ä½œï¼Œéœ€è¦æä¾›ä¸€ä¸ªå¯¹åº”çš„å¤„ç†å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†æ‹¦æˆªå¯¹åº”çš„æ“ä½œã€‚</p><p>æ³¨æ„ï¼Œè¦ä½¿å¾—<code>Proxy</code>èµ·ä½œç”¨ï¼Œå¿…é¡»é’ˆå¯¹<code>Proxy</code>å®ä¾‹è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯é’ˆå¯¹ç›®æ ‡å¯¹è±¡è¿›è¡Œæ“ä½œã€‚</p><hr><h3 id="14-2-Proxy-çš„å®ä¾‹æ–¹æ³•"><a href="#14-2-Proxy-çš„å®ä¾‹æ–¹æ³•" class="headerlink" title="14.2 Proxy çš„å®ä¾‹æ–¹æ³•"></a>14.2 Proxy çš„å®ä¾‹æ–¹æ³•</h3><p><code>Proxy</code> æ”¯æŒçš„æ‹¦æˆªæ“ä½œä¸€å…± <code>13</code> ç§ã€‚(å‰©ä¸‹çš„å¯ä»¥åœ¨<a href="https://es6.ruanyifeng.com/#docs/proxy#Proxy-%E5%AE%9E%E4%BE%8B%E7%9A%84%E6%96%B9%E6%B3%95">è¿™é‡Œ</a>æ‰¾åˆ°)</p><p><strong>å®ä¾‹æ–¹æ³• 1ï¼š</strong><code>get()</code>æ–¹æ³•ç”¨äºæ‹¦æˆªæŸä¸ªå±æ€§çš„è¯»å–æ“ä½œï¼Œå¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºç›®æ ‡å¯¹è±¡ã€å±æ€§åå’Œ <code>proxy</code> å®ä¾‹æœ¬èº«ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;å¼ ä¸‰&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> proxy = <span class="keyword">new</span> <span class="title class_">Proxy</span>(person, &#123;</span><br><span class="line">  <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params">target, propKey</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (propKey <span class="keyword">in</span> target) &#123;</span><br><span class="line">      <span class="keyword">return</span> target[propKey];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ReferenceError</span>(<span class="string">&quot;Prop name \&quot;&quot;</span> + propKey + <span class="string">&quot;\&quot; does not exist.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">proxy.<span class="property">name</span> <span class="comment">// &quot;å¼ ä¸‰&quot;</span></span><br><span class="line">proxy.<span class="property">age</span> <span class="comment">// æŠ›å‡ºä¸€ä¸ªé”™è¯¯</span></span><br></pre></td></tr></table></figure><p><strong>å®ä¾‹æ–¹æ³• 2ï¼š</strong> <code>set()</code>æ–¹æ³•ç”¨æ¥æ‹¦æˆªæŸä¸ªå±æ€§çš„èµ‹å€¼æ“ä½œï¼Œå¯ä»¥æ¥å—å››ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºç›®æ ‡å¯¹è±¡ã€å±æ€§åã€å±æ€§å€¼å’Œ <code>Proxy</code> å®ä¾‹æœ¬èº«ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> validator = &#123;</span><br><span class="line">  <span class="attr">set</span>: <span class="keyword">function</span>(<span class="params">obj, prop, value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (prop === <span class="string">&#x27;age&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="title class_">Number</span>.<span class="title function_">isInteger</span>(value)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;The age is not an integer&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (value &gt; <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RangeError</span>(<span class="string">&#x27;The age seems invalid&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹äºæ»¡è¶³æ¡ä»¶çš„ age å±æ€§ä»¥åŠå…¶ä»–å±æ€§ï¼Œç›´æ¥ä¿å­˜</span></span><br><span class="line">    obj[prop] = value;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> <span class="title class_">Proxy</span>(&#123;&#125;, validator);</span><br><span class="line">person.<span class="property">age</span> = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">person.<span class="property">age</span> <span class="comment">// 100</span></span><br><span class="line">person.<span class="property">age</span> = <span class="string">&#x27;young&#x27;</span> <span class="comment">// æŠ¥é”™</span></span><br><span class="line">person.<span class="property">age</span> = <span class="number">300</span> <span class="comment">// æŠ¥é”™</span></span><br></pre></td></tr></table></figure><hr><h2 id="15-Reflect"><a href="#15-Reflect" class="headerlink" title="15. Reflect"></a>15. Reflect</h2><h3 id="15-1-Reflect-æ¦‚è¿°"><a href="#15-1-Reflect-æ¦‚è¿°" class="headerlink" title="15.1 Reflect æ¦‚è¿°"></a>15.1 Reflect æ¦‚è¿°</h3><p><code>Reflect</code>å¯¹è±¡ä¸<code>Proxy</code>å¯¹è±¡ä¸€æ ·ï¼Œä¹Ÿæ˜¯ <code>ES6</code> ä¸ºäº†æ“ä½œå¯¹è±¡è€Œæä¾›çš„æ–° <code>API</code>ã€‚<code>Reflect</code>å¯¹è±¡çš„è®¾è®¡ç›®çš„æœ‰è¿™æ ·å‡ ä¸ªã€‚</p><p>ï¼ˆ1ï¼‰å°†<code>Object</code>å¯¹è±¡çš„ä¸€äº›å±äºè¯­è¨€å†…éƒ¨çš„æ–¹æ³•ï¼ˆæ¯”å¦‚<code>Object.defineProperty</code>ï¼‰ï¼Œæ”¾åˆ°<code>Reflect</code>å¯¹è±¡ä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœªæ¥å¯ä»¥ä»<code>Reflect</code>å¯¹è±¡ä¸Šæ‹¿åˆ°è¯­è¨€å†…éƒ¨çš„æ–¹æ³•ã€‚</p><p>ï¼ˆ2ï¼‰ä¿®æ”¹æŸäº›<code>Object</code>æ–¹æ³•çš„è¿”å›ç»“æœï¼Œè®©å…¶å˜å¾—æ›´åˆç†ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è€å†™æ³•</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(target, property, attributes);</span><br><span class="line">  <span class="comment">// success</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123; <span class="comment">// æŠ¥é”™</span></span><br><span class="line">  <span class="comment">// failure</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–°å†™æ³•</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title class_">Reflect</span>.<span class="title function_">defineProperty</span>(target, property, attributes)) &#123;</span><br><span class="line">  <span class="comment">// success</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123; <span class="comment">// ç›´æ¥è¿”å› false</span></span><br><span class="line">  <span class="comment">// failure</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰è®©<code>Object</code>æ“ä½œéƒ½å˜æˆå‡½æ•°è¡Œä¸ºã€‚æ¯”å¦‚<code>name in obj</code>å’Œ<code>delete obj[name]</code>ï¼Œè€Œ<code>Reflect.has(obj, name)</code>å’Œ<code>Reflect.deleteProperty(obj, name)</code>è®©å®ƒä»¬å˜æˆäº†å‡½æ•°è¡Œä¸ºã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è€å†™æ³•</span></span><br><span class="line"><span class="string">&#x27;assign&#x27;</span> <span class="keyword">in</span> <span class="title class_">Object</span> <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–°å†™æ³•</span></span><br><span class="line"><span class="title class_">Reflect</span>.<span class="title function_">has</span>(<span class="title class_">Object</span>, <span class="string">&#x27;assign&#x27;</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>ï¼ˆ4ï¼‰è®©<code>Reflect</code>å¯¹è±¡çš„æ–¹æ³•ä¸<code>Proxy</code>å¯¹è±¡çš„æ–¹æ³•å¯¹åº”ï¼Œåªè¦æ˜¯<code>Proxy</code>å¯¹è±¡çš„æ–¹æ³•ï¼Œå°±èƒ½åœ¨<code>Reflect</code>å¯¹è±¡ä¸Šæ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ã€‚è¿™å°±è®©<code>Proxy</code>å¯¹è±¡å¯ä»¥æ–¹ä¾¿åœ°è°ƒç”¨å¯¹åº”çš„<code>Reflect</code>æ–¹æ³•ï¼Œå®Œæˆé»˜è®¤è¡Œä¸ºï¼Œä½œä¸ºä¿®æ”¹è¡Œä¸ºçš„åŸºç¡€ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> loggedObj = <span class="keyword">new</span> <span class="title class_">Proxy</span>(obj, &#123;</span><br><span class="line">  <span class="title function_">get</span>(<span class="params">target, name</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;get&#x27;</span>, target, name);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">get</span>(target, name);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">deleteProperty</span>(<span class="params">target, name</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;delete&#x27;</span> + name);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">deleteProperty</span>(target, name);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">has</span>(<span class="params">target, name</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;has&#x27;</span> + name);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">has</span>(target, name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ¯ä¸€ä¸ª<code>Proxy</code>å¯¹è±¡çš„æ‹¦æˆªæ“ä½œ<code>get</code>ã€<code>delete</code>ã€<code>has</code>ï¼Œå†…éƒ¨éƒ½è°ƒç”¨å¯¹åº”çš„<code>Reflect</code>æ–¹æ³•ï¼Œä¿è¯åŸç”Ÿè¡Œä¸ºèƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œã€‚</p><p>ç®€å•æ¥è¯´ï¼Œæœ‰äº†<code>Reflect</code>å¯¹è±¡ä»¥åï¼Œå¾ˆå¤šæ“ä½œä¼šæ›´æ˜“è¯»ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è€å†™æ³•</span></span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">apply</span>.<span class="title function_">call</span>(<span class="title class_">Math</span>.<span class="property">floor</span>, <span class="literal">undefined</span>, [<span class="number">1.75</span>]) <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–°å†™æ³•</span></span><br><span class="line"><span class="title class_">Reflect</span>.<span class="title function_">apply</span>(<span class="title class_">Math</span>.<span class="property">floor</span>, <span class="literal">undefined</span>, [<span class="number">1.75</span>]) <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><hr><h3 id="15-2-Reflect-é™æ€æ–¹æ³•"><a href="#15-2-Reflect-é™æ€æ–¹æ³•" class="headerlink" title="15.2 Reflect é™æ€æ–¹æ³•"></a>15.2 Reflect é™æ€æ–¹æ³•</h3><p><code>Reflect</code>å¯¹è±¡ä¹Ÿæœ‰ <code>13</code> ä¸ªé™æ€æ–¹æ³•ã€‚(å‰©ä¸‹çš„å¯ä»¥åœ¨<a href="https://es6.ruanyifeng.com/#docs/reflect#%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95">è¿™é‡Œ</a>æ‰¾åˆ°)</p><p><strong>é™æ€æ–¹æ³• 1ï¼š</strong><code>Reflect.get</code>æ–¹æ³•æŸ¥æ‰¾å¹¶è¿”å›<code>target</code>å¯¹è±¡çš„<code>name</code>å±æ€§ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> myObject = &#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">bar</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">baz</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">foo</span> + <span class="variable language_">this</span>.<span class="property">bar</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Reflect</span>.<span class="title function_">get</span>(myObject, <span class="string">&#x27;foo&#x27;</span>) <span class="comment">// 1</span></span><br><span class="line"><span class="title class_">Reflect</span>.<span class="title function_">get</span>(myObject, <span class="string">&#x27;bar&#x27;</span>) <span class="comment">// 2</span></span><br><span class="line"><span class="title class_">Reflect</span>.<span class="title function_">get</span>(myObject, <span class="string">&#x27;baz&#x27;</span>) <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><p><strong>é™æ€æ–¹æ³• 2ï¼š</strong><code>Reflect.set</code>æ–¹æ³•è®¾ç½®<code>target</code>å¯¹è±¡çš„<code>name</code>å±æ€§ç­‰äº<code>value</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> myObject = &#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="keyword">set</span> <span class="title function_">bar</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">foo</span> = value;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myObject.<span class="property">foo</span> <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Reflect</span>.<span class="title function_">set</span>(myObject, <span class="string">&#x27;foo&#x27;</span>, <span class="number">2</span>);</span><br><span class="line">myObject.<span class="property">foo</span> <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Reflect</span>.<span class="title function_">set</span>(myObject, <span class="string">&#x27;bar&#x27;</span>, <span class="number">3</span>)</span><br><span class="line">myObject.<span class="property">foo</span> <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><hr><h3 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h3><blockquote><p>è¯¥å­¦ä¹ ç¬”è®°çš„æ‰€æœ‰ç« èŠ‚å‡ä¿å­˜åœ¨<a href="https://github.com/Hongda-OSU/ES6-Journey">Github</a>ä¸­ï¼Œå¦‚æœ‰éœ€è¦ï¼Œå¯ä¸‹è½½å¹¶åœ¨<a href="https://typora.io/">Typora</a>ä¸­é˜…è¯»ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
